<html>
<head>
<meta charset="UTF-8">
<title>Term-possible-numbers-of-results</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____TERM-POSSIBLE-NUMBERS-OF-RESULTS">Click for Term-possible-numbers-of-results in the Full Manual</a></h3>

<p>Calculate the possible numbers of results of a translated term.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(term-possible-numbers-of-results term wrld) 
  → 
possible-numbers-of-results</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">term</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____PSEUDO-TERMP.html">pseudo-termp</a> term)</span>.</font>
</dd> 
  <dd>
<span class="tt">wrld</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____PLIST-WORLDP.html">plist-worldp</a> wrld)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">possible-numbers-of-results</span> — <font color="#606060">Type <span class="v">(<a href="ACL2____POS-LISTP.html">pos-listp</a> possible-numbers-of-results)</span>.</font>
</dd> 
 
</dl></div> 
<p>The number of results of an untranslated term, 
     which is either 1 or more if <span class="tt"><a href="ACL2____MV.html">mv</a></span> is involved directly or indirectly, 
     can be always determined by translating the term 
     (see <span class="tt"><a href="ACL2____CHECK-USER-TERM.html">check-user-term</a></span>). 
     However, that information is largely lost in translated terms. 
     In some cases, the number of results can be determined, 
     but in other cases there may be two possilities, 
     namely 1 or a number greater than 1. 
     The reason is that calls of the macro <span class="tt"><a href="ACL2____MV.html">mv</a></span> 
     become calls of <span class="tt"><a href="COMMON-LISP____LIST.html">list</a></span> when terms are translated, 
     and therefore we cannot distinguish a single list result 
     from multiple results.</p><p>This utility returns the possible number of results of a translated term, 
     as follows.</p><ul>
<li>If the term is a variable or a quoted constants, 
      it always returns one result. 
      This would not be true for the <span class="tt"><a href="ACL2____MV.html">mv</a></span> variables 
      that result from translating <span class="tt"><a href="ACL2____MV-LET.html">mv-let</a></span>s 
      (see <span class="tt"><a href="ACL2____CHECK-MV-LET-CALL.html">check-mv-let-call</a></span>), 
      but this utility never reaches such variables (see below); 
      it only reaches other variables, 
      which are always bound to single results.</li>
<li>If the term is a (translated) call of <span class="tt"><a href="COMMON-LISP____LIST.html">list</a></span>, 
      we have two possibilities in general, as mentioned above. 
      Unless the call builds an empty or singleton list, 
      in which case it cannot result from an <span class="tt"><a href="ACL2____MV.html">mv</a></span>, 
      which always takes at least two arguments, 
      and thus the call must return a single list result.</li>
<li>If the term is a call of <span class="tt"><a href="ACL2____RETURN-LAST.html">return-last</a></span>, 
      we recursively process its last argument. 
      Note that <span class="tt"><a href="ACL2____RETURN-LAST.html">return-last</a></span> is in <span class="v">*stobjs-out-invalid*</span>, 
      because it returns the same number of results as its last argument.</li>
<li>If the term is a call of <span class="tt"><a href="COMMON-LISP____IF.html">if</a></span>, 
      we recursively process its second and third arguments, 
      and intersect the possible numbers for the two branches. 
      Note that <span class="tt"><a href="COMMON-LISP____IF.html">if</a></span> is in <span class="v">*stojbjs-out-invalid*</span>, 
      because it returns the same number of results as its branches. 
      Thus, for example, 
      if one branch is a <span class="tt"><a href="COMMON-LISP____LIST.html">list</a></span> call 
      that may return either 1 or 3 results, 
      while the other branch is a call of a named function 
      that returns 3 results, 
      the <span class="tt"><a href="COMMON-LISP____IF.html">if</a></span> call must return 3 results; 
      one branch resolves the ambiguity of the other branch. 
      However, a translated call <span class="v">(<a href="COMMON-LISP____IF.html">if</a> ... (<a href="ACL2____MV.html">mv</a> ...) (<a href="ACL2____MV.html">mv</a> ...))</span> 
      remains ambiguous, with two possible numbers of results. 
      The case in which the two branches have no numbers of results in common 
      should never happen in translated terms 
      obtained by translating valid untranslated terms; 
      however, this utility cannot make that assumption, 
      and may well return <span class="v">nil</span>.</li>
<li>A call of any other named function is unambiguous, 
      based on the number of results of that function.</li>
<li>Finally, if the term is a call of a lambda expression, 
      we recursively process its body. 
      Its arguments and bound variables do not matter 
      for determining the number of results of the lambda call. 
      In particular, if the term is a translated <span class="tt"><a href="ACL2____MV-LET.html">mv-let</a></span>, 
      the <span class="v">mv</span> variables is skipped over (see <span class="tt"><a href="ACL2____CHECK-MV-LET-CALL.html">check-mv-let-call</a></span>), 
      as mentioned above.</li>
</ul><p>Since this utility always returns 1 or 2 numbers explicitly, 
     or intersects the numbers for subterms, 
     the result always consists of 0, 1, or 2 numbers.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>term-possible-numbers-of-results</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 term-possible-numbers-of-results
 (<a href="ACL2____TERM.html">term</a> wrld)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____PSEUDO-TERMP.html">pseudo-termp</a> term)
                             (<a href="ACL2____PLIST-WORLDP.html">plist-worldp</a> wrld))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'term-possible-numbers-of-results))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
   (((when (<a href="ACL2____VARIABLEP.html">variablep</a> term)) (<a href="COMMON-LISP____LIST.html">list</a> 1))
    ((when (<a href="ACL2____FQUOTEP.html">fquotep</a> term)) (<a href="COMMON-LISP____LIST.html">list</a> 1))
    ((<a href="ACL2____MV.html">mv</a> list-call-p elements)
     (<a href="ACL2____CHECK-LIST-CALL.html">check-list-call</a> term))
    ((when list-call-p)
     (<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP_____E3_D3.html">&gt;=</a> (<a href="ACL2____LEN.html">len</a> elements) 2)
         (<a href="COMMON-LISP____LIST.html">list</a> 1 (<a href="ACL2____LEN.html">len</a> elements))
         (<a href="COMMON-LISP____LIST.html">list</a> 1)))
    (fn (<a href="ACL2____FFN-SYMB.html">ffn-symb</a> term))
    ((when (<a href="COMMON-LISP____EQ.html">eq</a> fn 'return-last))
     (<a href="ACL2____TERM-POSSIBLE-NUMBERS-OF-RESULTS.html">term-possible-numbers-of-results</a> (<a href="ACL2____FARGN.html">fargn</a> term 3)
                                       wrld))
    ((when (<a href="COMMON-LISP____EQ.html">eq</a> fn 'if))
     (<a href="ACL2____INTERSECTION_42.html">intersection$</a> (<a href="ACL2____TERM-POSSIBLE-NUMBERS-OF-RESULTS.html">term-possible-numbers-of-results</a> (<a href="ACL2____FARGN.html">fargn</a> term 2)
                                                      wrld)
                    (<a href="ACL2____TERM-POSSIBLE-NUMBERS-OF-RESULTS.html">term-possible-numbers-of-results</a> (<a href="ACL2____FARGN.html">fargn</a> term 3)
                                                      wrld)))
    ((when (<a href="COMMON-LISP____EQ.html">eq</a> fn 'do$))
     (<a href="COMMON-LISP____LET_A2.html">let*</a>
      ((quoted-do-fn (<a href="ACL2____FARGN.html">fargn</a> term 3))
       (do-fn (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____QUOTEP.html">quotep</a> quoted-do-fn)
                   (<a href="ACL2____UNQUOTE.html">unquote</a> quoted-do-fn)))
       (<a href="ACL2____BODY.html">body</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____CONSP.html">consp</a> do-fn)
                  (<a href="COMMON-LISP____EQ.html">eq</a> (<a href="COMMON-LISP____CAR.html">car</a> do-fn) 'lambda)
                  (<a href="ACL2____TRUE-LISTP.html">true-listp</a> do-fn)
                  (<a href="COMMON-LISP____CAR.html">car</a> (<a href="COMMON-LISP____LAST.html">last</a> do-fn)))))
      (<a href="COMMON-LISP____COND.html">cond</a>
       ((<a href="ACL2____PSEUDO-TERMP.html">pseudo-termp</a> body)
        (<a href="ACL2____TERM-POSSIBLE-NUMBERS-OF-RESULTS.html">term-possible-numbers-of-results</a> body wrld))
       (t
        (<a href="ACL2____PROG2_42.html">prog2$</a> (<a href="ACL2____ER.html">er</a> hard? 'term-possible-numbers-of-results
                    "Unable to guess the number of results for ~x0."
                    term)
                '(1))))))
    ((when (<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> fn))
     (<a href="COMMON-LISP____LIST.html">list</a> (<a href="ACL2____NUMBER-OF-RESULTS_B2.html">number-of-results+</a> fn wrld))))
   (<a href="ACL2____TERM-POSSIBLE-NUMBERS-OF-RESULTS.html">term-possible-numbers-of-results</a> (<a href="ACL2____LAMBDA-BODY.html">lambda-body</a> fn)
                                     wrld))))</pre> 
<p><b>Theorem: </b>pos-listp-of-term-possible-numbers-of-results</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> pos-listp-of-term-possible-numbers-of-results
        (<a href="ACL2____B_A2.html">b*</a> ((possible-numbers-of-results
                  (<a href="ACL2____TERM-POSSIBLE-NUMBERS-OF-RESULTS.html">term-possible-numbers-of-results</a> term wrld)))
            (<a href="ACL2____POS-LISTP.html">pos-listp</a> possible-numbers-of-results))
        :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>len-of-term-possible-numbers-of-results-upper-bound</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> len-of-term-possible-numbers-of-results-upper-bound
        (<a href="ACL2____B_A2.html">b*</a> ((?possible-numbers-of-results
                  (<a href="ACL2____TERM-POSSIBLE-NUMBERS-OF-RESULTS.html">term-possible-numbers-of-results</a> term wrld)))
            (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> (<a href="ACL2____LEN.html">len</a> possible-numbers-of-results)
                2))
        :rule-classes :linear)</pre> 

</body>
</html>
