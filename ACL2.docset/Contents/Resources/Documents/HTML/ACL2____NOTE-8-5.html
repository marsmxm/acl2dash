<html>
<head>
<meta charset="UTF-8">
<title>Note-8-5</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____NOTE-8-5">Click for Note-8-5 in the Full Manual</a></h3>

<p>ACL2 Version  8.5 (xx, 20xx) Notes</p><p>NOTE!  New users can ignore these release notes, because the <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> has been updated to reflect all changes that are recorded 
 here.</p> 
 
 <p>Below we roughly organize the changes to ACL2 since Version 8.4 into the 
 following categories of changes: existing features, new features, heuristic 
 and efficiency improvements, bug fixes, changes at the system level, Emacs 
 support, and experimental versions.  Each change is described in just one 
 category, though of course many changes could be placed in more than one 
 category.</p> 
 
 <p>Note that only ACL2 system changes are listed below.  See also <a href="ACL2____NOTE-8-5-BOOKS.html">note-8-5-books</a> for a summary of changes made to the ACL2 Community Books 
 since ACL2 8.4, including the build system.  Also note that with each release, 
 it is typical that the value of constant <span class="tt"><a href="ACL2_____A2ACL2-EXPORTS_A2.html">*ACL2-exports*</a></span> has been 
 extended, and that some built-in functions that were formerly in <span class="v">:</span><span class="tt"><a href="ACL2____PROGRAM.html">program</a></span> mode are now <a href="ACL2____GUARD.html">guard</a>-verified <span class="v">:</span><span class="tt"><a href="ACL2____LOGIC.html">logic</a></span> mode 
 functions.</p> 
 
 <h3>Changes to Existing Features</h3> 
 
 <p>Weakened hypotheses from built-in theorems (thus strengthening them) 
 <span class="v">symbol-equality</span>, <span class="v">true-listp-first-n-ac-type-prescription</span>, 
 <span class="v">ordered-symbol-alistp-getprops</span>, <span class="v">add-pair-preserves-all-boundp</span>, and 
 <span class="v">symbol&lt;-asymmetric</span>.  Eliminated built-in theorem 
 <span class="v">main-timer-type-prescription</span> entirely (that rule was already deduced by 
 ACL2 at definition time).  Simplified guards slightly for built-in functions 
 <span class="v">serialize-write-fn</span> and <span class="v">serialize-read-fn</span>.  Thanks to Eric Smith for 
 correspondence, based on his linter, leading to these improvements.</p> 
 
 <p>The utility <span class="tt"><a href="ACL2____WITHOUT-EVISC.html">without-evisc</a></span> formerly always (or nearly always) 
 returned the <a href="ACL2____ERROR-TRIPLE.html">error-triple</a> <span class="v">(<a href="ACL2____MV.html">mv</a> nil :invisible state)</span> after printing 
 the result.  Now it generally returns <span class="v">(<a href="ACL2____MV.html">mv</a> t nil state)</span> when evaluation of 
 the given form causes an error.  See <a href="ACL2____WITHOUT-EVISC.html">without-evisc</a>.  Thanks to Karthik 
 Nukala and Eric Smith for reporting the former (undesirable) behavior.</p> 
 
 <p>One would get an error when including an uncertified book when a 
 <span class="v">:type-prescription</span> specified in an <span class="tt"><a href="ACL2____XARGS.html">xargs</a></span> <a href="COMMON-LISP____DECLARATION.html">declaration</a> 
 failed a validity check, even when no such failure occurs when that book is 
 certified.  (That could happen because type-prescription information from 
 locally included books is saved in the book's <a href="ACL2____CERTIFICATE.html">certificate</a> file and is 
 used when checking such <span class="v">:type-prescription</span> declarations.)  This situation 
 now generates a warning rather than an error.  Thanks to Karthik Nukala and 
 Eric Smith for sending an example that pointed out this problem.</p> 
 
 <p>Output from <span class="v">:</span><span class="tt"><a href="ACL2____OOPS.html">oops</a></span> may now be inhibited as <span class="v">OBSERVATION</span> 
 output, by using <span class="tt"><a href="ACL2____SET-INHIBIT-OUTPUT-LST.html">set-inhibit-output-lst</a></span> or <span class="tt"><a href="ACL2____WITH-OUTPUT.html">with-output</a></span>.</p> 
 
 <p><a href="ACL2____RAW-MODE.html">Raw-mode</a> has been fixed so that reasonable results are printed when 
 multiple values are returned by a function defined in raw-mode or raw Lisp 
 (rather than in the logic).  The following examples illustrate the problem and 
 the fixed behavior.  The utilities <span class="v">add-raw-arity</span> and 
 <span class="v">remove-raw-arity</span> are no longer necessary (and they had no effect anyhow, 
 at least in recent ACL2 versions), so they have been removed.</p> 
 
 <pre class="code">(<a href="ACL2____DEFSTOBJ.html">defstobj</a> st fld)
(<a href="ACL2____SET-RAW-MODE-ON_12.html">set-raw-mode-on!</a>)
(<a href="COMMON-LISP____DEFUN.html">defun</a> f1 (st) st)
(f1 st) ; printed a vector; now prints &lt;st&gt;
(<a href="COMMON-LISP____DEFUN.html">defun</a> f2 (<a href="ACL2____STATE.html">state</a>) state)
(f2 state) ; printed ACL2_INVISIBLE::|The Live State Itself|;
           ; now prints &lt;state&gt;
(<a href="COMMON-LISP____DEFUN.html">defun</a> bar (x st state) (<a href="ACL2____MV.html">mv</a> x st state))
(bar 3 st state) ; printed 3; now prints (3 &lt;st&gt; &lt;state&gt;)</pre> 
 
 <p>The keyword <span class="v">:concrete</span> for <span class="tt"><a href="ACL2____DEFABSSTOBJ.html">defabsstobj</a></span> and the keyword 
 <span class="v">:witness-dcls</span> for <span class="tt"><a href="ACL2____DEFUN-SK.html">defun-sk</a></span> are no longer supported, as they were 
 deprecated in ACL2 Version 8.4 in favor of <span class="v">:foundation</span> and <span class="tt"><a href="COMMON-LISP____DECLARE.html">declare</a></span> forms, respectively.  Also: the following symbols, deprecated in ACL2 
 Version 8.4, are no longer names of <a href="ACL2____EVENTS.html">events</a>.</p> 
 
 <pre class="code">logical-defun
merge-sort-symbol-&lt;
merge-symbol-&lt;
strict-merge-sort-symbol-&lt;
strict-merge-sort-symbol-&lt;-cdrs
strict-merge-symbol-&lt;
strict-symbol-&lt;-sortedp
symbol-&lt;</pre> 
 
 <p>The string <span class="v">"Proof succeeded"</span> or <span class="v">"Proof skipped"</span> was formerly 
 printed when <span class="v">SUMMARY</span> output is not inhibited (see <a href="ACL2____SET-INHIBIT-OUTPUT-LST.html">set-inhibit-output-lst</a>), but now that printing takes place instead when 
 <span class="v">PROVE</span> output is not inhibited.  Thanks to Pete Manolios for pointing out 
 a printing issue that is resolved with this change.</p> 
 
 <p>Some error messages were improved for the <a href="ACL2____PROOF-BUILDER.html">proof-builder</a>, primarily 
 when refusing a command to dive into an <span class="v">OR</span> expression.  Thanks to Warren 
 Hunt for bringing this issue to our attention.</p> 
 
 <p>There was a restriction on certain events, notably <span class="tt"><a href="ACL2____DEFCONST.html">defconst</a></span> and 
 <span class="tt"><a href="COMMON-LISP____DEFMACRO.html">defmacro</a></span> events, to ensure that they are not ancestrally dependent on 
 <span class="tt"><a href="ACL2____LOOP_42.html">loop$</a></span> or <span class="tt"><a href="ACL2____LAMBDA_42.html">lambda$</a></span> expressions.  That restriction has been 
 removed in the case that the body of the event is a quoted constant.</p> 
 
 <p>A <span class="tt"><a href="ACL2____DEFWARRANT.html">defwarrant</a></span> event may complete more quickly because a generated 
 hint now <a href="ACL2____DISABLE.html">disable</a>s the function.</p> 
 
 <p>Functions that take or return <a href="ACL2____STOBJ.html">stobj</a>s may now have <a href="ACL2____BADGE.html">badge</a>s and 
 <a href="ACL2____WARRANT.html">warrant</a>s.  One cannot (yet) take advantage of these in general because 
 one cannot put a <a href="ACL2____STOBJ.html">stobj</a> into a list, as required for the second argument 
 of <span class="tt"><a href="ACL2____APPLY_42.html">apply$</a></span>.  However, this change supports the use of stobjs in <span class="tt"><a href="ACL2____LOOP_42.html">loop$</a></span> expressions that use the new keyword, <span class="v">DO</span>.</p> 
 
 <p>The function <span class="v">the-check</span>, which is generated by calls of <span class="tt"><a href="COMMON-LISP____THE.html">the</a></span>, is 
 now a guard-holder.</p> 
 
 <h3>New Features</h3> 
 
 <p>A new <span class="tt"><a href="ACL2____LOOP_42.html">loop$</a></span> keyword, <span class="v">DO</span>, supports an imperative style of 
 programming in loops.  In particular, <span class="v">DO loop$</span> expressions may use 
 <span class="v">setq</span> and <span class="v">mv-setq</span> for assigning to one or several variables 
 (respectively), they may reference and return <a href="ACL2____STOBJ.html">stobj</a>s, and they may 
 return multiple values.  See <a href="ACL2____LOOP_42.html">loop$</a>.</p> 
 
 <p>One can now suppress output from <span class="tt"><a href="ACL2____CW.html">cw</a></span>, <span class="tt"><a href="ACL2____CW_12.html">cw!</a></span>, <span class="tt"><a href="ACL2____FMT-TO-COMMENT-WINDOW.html">fmt-to-comment-window</a></span>, and <span class="tt"><a href="ACL2____FMT-TO-COMMENT-WINDOW_12.html">fmt-to-comment-window!</a></span>, and from utilities 
 that use these such as <span class="tt"><a href="ACL2____TIME_42.html">time$</a></span>, by inhibiting a new output type, 
 <span class="v">COMMENT</span>.  (Thus, that symbol has been added to the value of 
 <span class="v">*valid-output-names*</span>.)  See <a href="ACL2____SET-INHIBIT-OUTPUT-LST.html">set-inhibit-output-lst</a> and <a href="ACL2____WITH-OUTPUT.html">with-output</a>.  Thanks to Eric McCarthy for a conversation via GitHub Issue 
 #1293 that led to this enhancement.  Moreover, new macros <span class="tt"><a href="ACL2____CW_B2.html">cw+</a></span> and 
 <span class="tt"><a href="ACL2____CW_12_B2.html">cw!+</a></span> and new functions <span class="tt"><a href="ACL2____FMT-TO-COMMENT-WINDOW_B2.html">fmt-to-comment-window+</a></span> and <span class="tt"><a href="ACL2____FMT-TO-COMMENT-WINDOW_12_B2.html">fmt-to-comment-window!+</a></span> never suppress output; the <span class="v">"+"</span> suffix is 
 intended to indicate that feature.  Thus, these new utilities behave like the 
 previous utilities without the <span class="v">"+"</span> suffix.  Thanks to Eric Smith, 
 Karthik Nukala, and Alessandro Coglio for observing inappropriate suppression 
 of output from the utility <span class="tt"><a href="ACL2____ER-SOFT_B2.html">er-soft+</a></span> and the connection of this problem 
 to the addition of the <span class="v">COMMENT</span> output type; it was resolved by using 
 <span class="v">fmt-to-comment-window+</span> in place of <span class="v">fmt-to-comment-window</span> in the 
 implementation of a utility underlying <span class="v">er-soft+</span> (see <a href="ACL2____COMMUNITY-BOOK.html">community-book</a> <span class="v">books/tools/er-soft-logic.lisp</span>).</p> 
 
 <p>You can now arrange that an interrupt will kill a proof immediately by 
 evaluating <span class="v">(<a href="ACL2____ASSIGN.html">assign</a> abort-soft nil)</span>, and you can restore the default 
 behavior — where an interrupt instructs the proof to quick cleanly at an 
 appropriate opportunity — by evaluating <span class="v">(<a href="ACL2____ASSIGN.html">assign</a> abort-soft t)</span>. 
 Note that this can interfere with <span class="v">:</span><span class="tt"><a href="ACL2____REDO-FLAT.html">redo-flat</a></span>; see <a href="ACL2____ABORT-SOFT.html">abort-soft</a>.  Thanks to Eric Smith for reporting an inability to abort a 
 series of proof attempts using the <span class="tt"><a href="ACL2____PROVE_42.html">prove$</a></span> utility, which led to this 
 enhancement.</p> 
 
 <p>A <a href="ACL2____STOBJ.html">stobj</a> may now have a field of type <span class="v">STOBJ-TABLE</span>, which 
 associates arbitrary stobj names with corresponding stobjs.  As of this 
 writing, that feature should be considered experimental; see <a href="ACL2____STOBJ-TABLE.html">stobj-table</a>.  Thanks to Rob Sumners for suggesting the idea and to him and 
 Sol Swords for useful design discussions.</p> 
 
 <p>The utility <span class="tt"><a href="ACL2____WET.html">wet</a></span> has a new keyword option, <span class="v">:fullp</span>, that allows 
 it to work even when there is a raw Lisp error.  Thanks to Eric Smith for 
 requesting that <span class="v">wet</span> be able to work in such cases.</p> 
 
 <p>Rewriting of <a href="COMMON-LISP____LAMBDA.html">lambda</a> objects (see <a href="ACL2____REWRITE-LAMBDA-OBJECT.html">rewrite-lambda-object</a>) may 
 now be <a href="ACL2____DISABLE.html">disable</a>d, by disabling the <a href="ACL2____EXECUTABLE-COUNTERPART.html">executable-counterpart</a> <a href="ACL2____RUNE.html">rune</a> for (trivial function), <span class="v">rewrite-lambda-modep</span> — for example, 
 with a hint <span class="v">:in-theory (<a href="ACL2____DISABLE.html">disable</a> (:e rewrite-lambda-modep))</span>.  Also 
 improved a couple of warnings and a bit of documentation pertaining to such 
 rewriting.</p> 
 
 <h3>Heuristic and Efficiency Improvements</h3> 
 
 <p>Improved the efficiency of some computations involving calls of <span class="tt"><a href="ACL2____DEFATTACH.html">defattach</a></span> with option <span class="v">:aokp t</span>, in particular, of <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> 
 events for books including such calls.  Thanks to Mertcan Temel for reporting 
 this efficiency issue and sending an <span class="v">include-book</span> event, whose execution 
 time was reduced from 24 seconds to 10 seconds by this change.</p> 
 
 <h3>Bug Fixes</h3> 
 
 <p>Fixed an error that could occur when the <a href="ACL2____BREAK-REWRITE.html">break-rewrite</a> utility is 
 displaying failure information for an attempt to apply a <a href="ACL2____LINEAR.html">linear</a> rule 
 containing <a href="ACL2____FREE-VARIABLES.html">free-variables</a>.  Thanks to Karthik Nukala and Eric Smith for 
 sending a bug report with a replayable example.</p> 
 
 <p>Strengthened syntax checking for accessor expressions in <span class="tt"><a href="ACL2____STOBJ-LET.html">stobj-let</a></span> 
 bindings.  See a comment about this in <span class="v">(<a href="ACL2____DEFXDOC.html">defxdoc</a> note-8-5 ...)</span>.</p> 
 
 <p>The writing of <a href="ACL2____USELESS-RUNES.html">useless-runes</a> files was sensitive to the global <a href="ACL2____EVISC-TABLE.html">evisc-table</a>, which could cause failures when reading those files.  This has 
 been fixed.</p> 
 
 <p>An error could occur when encountering a <a href="ACL2____REDUNDANT.html">redundant</a> <span class="tt"><a href="ACL2____DEFWARRANT.html">defwarrant</a></span> event while including a book.  This has been fixed, by arranging 
 that a <span class="v">defwarrant</span> event always expands to the same <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> 
 form.</p> 
 
 <h3>Changes at the System Level</h3> 
 
 <p>The <a href="ACL2____HONS-ENABLED.html">hons-enabled</a> features of ACL2 (<span class="tt"><a href="ACL2____HONS.html">hons</a></span>, <a href="ACL2____MEMOIZATION.html">memoization</a>, 
 and <a href="ACL2____FAST-ALISTS.html">fast-alists</a>) have been included in ACL2 builds by default since 
 Version 7.0 (January, 2015) and in all ACL2 builds since Version 7.2 (January, 
 2016).  Now, essentially all support for building ACL2 without these features 
 has been removed.  The function <span class="v">(hons-enabledp state)</span> and the feature 
 <span class="v">:hons</span> both remain, but are always true and are deprecated, scheduled for 
 removal very soon after the next release.  The feature <span class="v">:acl2-mv-as-values</span> 
 was always true when feature <span class="v">:hons</span> was present, hence was always true; so 
 it has been removed (and <span class="v">#-acl2-mv-as-values</span> code has been 
 eliminated).</p> 
 
 <h3>EMACS Support</h3> 
 
 <p>It is now possible to have more than one <a href="ACL2____ACL2-DOC.html">ACL2-doc</a> buffer. 
 A new buffer is created by using <span class="v">Shift-&lt;Return&gt;</span> to follow a 
 link.  Commands that are naturally specific to a given buffer 
 (such as searching and going back) are buffer-local.  Thanks to 
 Mayank Manjrekar for the idea and for supplying an implementation 
 (including documentation), which has been incorporated into the <a href="ACL2____ACL2-DOC.html">ACL2-doc</a> source file, <span class="v">emacs/acl2-doc.el</span>.</p> 
 
 <p>A bug has been fixed in <a href="ACL2____ACL2-DOC.html">ACL2-doc</a> that would cause an error 
 when attempting to bring up the acl2-only manual.</p> 
 
 <p>The key binding Control-TAB has been removed for the <a href="ACL2____ACL2-DOC.html">ACL2-doc</a> 
 browser, to avoid conflict with other uses of that key.  Thanks to Alessandro 
 Coglio for the idea.</p> 
 
 <h3>Experimental Versions</h3> 
 
 
</body>
</html>
