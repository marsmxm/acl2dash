<html>
<head>
<meta charset="UTF-8">
<title>4v-sexpr-vars</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____4V-SEXPR-VARS">Click for 4v-sexpr-vars in the Full Manual</a></h3>

<p>Collect the set of variables in an s-expression.</p><p><span class="tt">(4v-sexpr-vars x)</span> is one way to produce a list of all the 
variables that occur in the sexpr <span class="v">x</span>.</p> 
 
<p><font color="#ff0000">WARNING</font>: Variable collection is surprisingly 
difficult to do efficiently, and is also <b>often unnecessary</b>.</p> 
 
<p>Before deciding to collect variables, it may be worth considering whether 
you really need to compute the <i>exact</i> set of variables for a sexpr.  It 
is often possible to efficiently overapproximate the set of all variables, 
e.g., if you have just carried out an <a href="ACL2____ESIM.html">esim</a> run, the variables you 
assigned to the input and state bits is probably readily available.</p> 
 
<p>You can often use overapproximations in scenarios such as</p> 
 
<ul> 
 <li>evaluating sexprs with <a href="ACL2____4V-SEXPR-EVAL.html">4v-sexpr-eval</a>,</li> 
 <li>substituting into sexprs with <a href="ACL2____4V-SEXPR-RESTRICT.html">4v-sexpr-restrict</a>, or</li> 
 <li>converting sexprs into faigs with <a href="ACL2____4V-SEXPR-TO-FAIG.html">4v-sexpr-to-faig</a>,</li> 
</ul> 
 
<p>because in these cases it is perfectly fine for the alists to include 
extraneous bindings for variables that aren't in the sexpr.</p> 
 
<p>Depending on your application, <a href="ACL2____4V-SEXPR-VARS-1PASS.html">4v-sexpr-vars-1pass</a> may be a more 
efficient way to collect variables than <span class="v">4v-sexpr-vars</span>.</p> 
 
<p>The basic approach taken by <span class="v">4v-sexpr-vars</span> is to</p> 
 
<ul> 
 
<li>
<a href="ACL2____MEMOIZE.html">memoize</a> the entire computation to avoid revisiting shared 
subexpressions,</li> 
 
<li>produce honsed, ordered variable lists at each node so that merging is 
linear, and</li> 
 
<li>memoize the unioning operation <a href="ACL2____HONS-ALPHORDER-MERGE.html">hons-alphorder-merge</a> to avoid 
recomputing the same unions.</li> 
 
</ul> 
 
<p>This might be a reasonable strategy when you care about the precise set of 
variables for a large number of closely-related sexprs.  However, it is <b>very 
memory intensive</b>, and can be very slow unless you are really getting a lot 
of reuse out of the variable sets being computed.  Moreover, computing the 
precise set of variables for every subexpression may be far more work than you 
really need to do, so <a href="ACL2____4V-SEXPR-VARS-1PASS.html">4v-sexpr-vars-1pass</a> might be more appropriate.</p> 
 
<p>See also <a href="ACL2____4V-NSEXPR-VARS.html">4v-nsexpr-vars</a>, which only works when the sexprs involved 
have natural-numbered variables, but can use a sparse bitset representation 
that generally performs very well.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>4v-sexpr-vars</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> 4v-sexpr-vars (x)
       (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard t))
       (<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP____ATOM.html">atom</a> x)
           (<a href="COMMON-LISP____AND.html">and</a> x
                (<a href="ACL2____MBE.html">mbe</a> :logic (<a href="SET____INSERT.html">set::insert</a> x nil)
                     :exec (<a href="ACL2____HONS.html">hons</a> x nil)))
           (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> (<a href="COMMON-LISP____CDR.html">cdr</a> x))))</pre> 
<p><b>Function: </b>4v-sexpr-vars-list</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 4v-sexpr-vars-list (x)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard t))
 (<a href="COMMON-LISP____IF.html">if</a>
   (<a href="COMMON-LISP____ATOM.html">atom</a> x)
   nil
   (<a href="ACL2____MBE.html">mbe</a> :logic (<a href="SET____UNION.html">set::union</a> (<a href="ACL2____4V-SEXPR-VARS.html">4v-sexpr-vars</a> (<a href="COMMON-LISP____CAR.html">car</a> x))
                           (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> (<a href="COMMON-LISP____CDR.html">cdr</a> x)))
        :exec (<a href="ACL2____HONS-ALPHORDER-MERGE.html">hons-alphorder-merge</a> (<a href="ACL2____4V-SEXPR-VARS.html">4v-sexpr-vars</a> (<a href="COMMON-LISP____CAR.html">car</a> x))
                                    (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> (<a href="COMMON-LISP____CDR.html">cdr</a> x))))))</pre> 
<p><b>Theorem: </b>atom-listp-4v-sexpr-vars</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> atom-listp-4v-sexpr-vars
        (<a href="ACL2____ATOM-LISTP.html">atom-listp</a> (<a href="ACL2____4V-SEXPR-VARS.html">4v-sexpr-vars</a> x)))</pre> 
<p><b>Theorem: </b>atom-listp-4v-sexpr-vars-list</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> atom-listp-4v-sexpr-vars-list
        (<a href="ACL2____ATOM-LISTP.html">atom-listp</a> (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> x)))</pre> 
<p><b>Theorem: </b>true-listp-4v-sexpr-vars</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> true-listp-4v-sexpr-vars
        (<a href="ACL2____TRUE-LISTP.html">true-listp</a> (<a href="ACL2____4V-SEXPR-VARS.html">4v-sexpr-vars</a> x))
        :rule-classes (:rewrite :type-prescription))</pre> 
<p><b>Theorem: </b>true-listp-4v-sexpr-vars-list</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> true-listp-4v-sexpr-vars-list
        (<a href="ACL2____TRUE-LISTP.html">true-listp</a> (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> x))
        :rule-classes (:rewrite :type-prescription))</pre> 
<p><b>Theorem: </b>setp-4v-sexpr-vars</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> setp-4v-sexpr-vars
        (<a href="SET____SETP.html">set::setp</a> (<a href="ACL2____4V-SEXPR-VARS.html">4v-sexpr-vars</a> x)))</pre> 
<p><b>Theorem: </b>setp-4v-sexpr-vars-list</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> setp-4v-sexpr-vars-list
        (<a href="SET____SETP.html">set::setp</a> (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> x)))</pre> 
<p><b>Function: </b>4v-sexpr-vars-memoize-condition</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> 4v-sexpr-vars-memoize-condition (x)
       (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> x)
                (<a href="ACL2____XARGS.html">xargs</a> :guard 't))
       (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____CONSP.html">consp</a> x) (<a href="COMMON-LISP____CONSP.html">consp</a> (<a href="COMMON-LISP____CDR.html">cdr</a> x))))</pre> 
<p><b>Theorem: </b>not-member-4v-sexpr-vars-lookup-when-not-member-vars-alist-vals</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 not-member-4v-sexpr-vars-lookup-when-not-member-vars-alist-vals
 (<a href="ACL2____IMPLIES.html">implies</a>
  (<a href="COMMON-LISP____NOT.html">not</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> k (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> (<a href="ACL2____ALIST-VALS.html">alist-vals</a> al))))
  (<a href="COMMON-LISP____NOT.html">not</a>
     (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> k
                   (<a href="ACL2____4V-SEXPR-VARS.html">4v-sexpr-vars</a> (<a href="COMMON-LISP____CDR.html">cdr</a> (<a href="ACL2____HONS-ASSOC-EQUAL.html">hons-assoc-equal</a> x al)))))))</pre> 
<p><b>Theorem: </b>4v-sexpr-vars-4v-sexpr-compose</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 4v-sexpr-vars-4v-sexpr-compose
 (<a href="ACL2____IMPLIES.html">implies</a>
      (<a href="COMMON-LISP____NOT.html">not</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> v (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> (<a href="ACL2____ALIST-VALS.html">alist-vals</a> al))))
      (<a href="COMMON-LISP____NOT.html">not</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> v
                         (<a href="ACL2____4V-SEXPR-VARS.html">4v-sexpr-vars</a> (<a href="ACL2____4V-SEXPR-COMPOSE.html">4v-sexpr-compose</a> x al))))))</pre> 
<p><b>Theorem: </b>4v-sexpr-vars-list-4v-sexpr-compose-list</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 4v-sexpr-vars-list-4v-sexpr-compose-list
 (<a href="ACL2____IMPLIES.html">implies</a>
     (<a href="COMMON-LISP____NOT.html">not</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> v (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> (<a href="ACL2____ALIST-VALS.html">alist-vals</a> al))))
     (<a href="COMMON-LISP____NOT.html">not</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a>
               v
               (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> (4v-sexpr-compose-list x al))))))</pre> 
<p><b>Theorem: </b>4v-sexpr-vars-4v-sexpr-restrict</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 4v-sexpr-vars-4v-sexpr-restrict
 (<a href="ACL2____IMPLIES.html">implies</a>
    (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____NOT.html">not</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> k (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> (<a href="ACL2____ALIST-VALS.html">alist-vals</a> al))))
         (<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> k (<a href="ACL2____4V-SEXPR-VARS.html">4v-sexpr-vars</a> x))
                   (<a href="COMMON-LISP____NOT.html">not</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> k (<a href="ACL2____ALIST-KEYS.html">alist-keys</a> al))))))
    (<a href="COMMON-LISP____NOT.html">not</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> k
                       (<a href="ACL2____4V-SEXPR-VARS.html">4v-sexpr-vars</a> (<a href="ACL2____4V-SEXPR-RESTRICT.html">4v-sexpr-restrict</a> x al))))))</pre> 
<p><b>Theorem: </b>4v-sexpr-vars-list-4v-sexpr-restrict-list</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 4v-sexpr-vars-list-4v-sexpr-restrict-list
 (<a href="ACL2____IMPLIES.html">implies</a>
    (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____NOT.html">not</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> k (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> (<a href="ACL2____ALIST-VALS.html">alist-vals</a> al))))
         (<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> k (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> x))
                   (<a href="COMMON-LISP____NOT.html">not</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> k (<a href="ACL2____ALIST-KEYS.html">alist-keys</a> al))))))
    (<a href="COMMON-LISP____NOT.html">not</a> (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a>
              k
              (<a href="ACL2____4V-SEXPR-VARS-LIST.html">4v-sexpr-vars-list</a> (<a href="ACL2____4V-SEXPR-RESTRICT-LIST.html">4v-sexpr-restrict-list</a> x al))))))</pre> 

</body>
</html>
