<html>
<head>
<meta charset="UTF-8">
<title>Set-rw-cache-state</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____SET-RW-CACHE-STATE">Click for Set-rw-cache-state in the Full Manual</a></h3>

<p>Set the default rw-cache-state</p><p>The ACL2 rewriter uses a data structure, called the 
 rw-cache (rewriter cache), to save failed attempts to apply conditional <a href="ACL2____REWRITE.html">rewrite</a> rules.  The regression suite has taken approximately 11% less time 
 with this mechanism.  The rw-cache is active by default but this event allows 
 it to be turned off or modified.  Note that this event is <a href="ACL2____LOCAL.html">local</a> to its 
 context (from <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> or <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span>).  For a non-local 
 version, use <a href="ACL2____SET-RW-CACHE-STATE_12.html">set-rw-cache-state!</a>.</p> 
 
 <pre class="code">Example forms:
(<a href="ACL2____SET-RW-CACHE-STATE.html">set-rw-cache-state</a> :atom)     ; default: rw-cache cleared for each literal
                               ;   (i.e., hypothesis or conclusion of a goal)
(<a href="ACL2____SET-RW-CACHE-STATE.html">set-rw-cache-state</a> nil)       ; rw-cache is inactive
(<a href="ACL2____SET-RW-CACHE-STATE.html">set-rw-cache-state</a> t)         ; rw-cache persists beyond each literal
(<a href="ACL2____SET-RW-CACHE-STATE.html">set-rw-cache-state</a> :disabled) ; rw-cache is inactive, but the rw-cache-state
                               ;   transitions to state t after
                               ;   simplification takes place

General Form:
(<a href="ACL2____SET-RW-CACHE-STATE.html">set-rw-cache-state</a> val)</pre> 
 
 <p>where <span class="v">val</span> evaluates to one of the four values shown in ``Example 
 forms'' above.  The default is <span class="v">:atom</span>, which enables the rw-cache but 
 clears it before rewriting a hypothesis or conclusion of any goal.  The value 
 <span class="v">t</span> is provides more aggressive use of the rw-cache, basically preserving 
 the rw-cache when there is a single subgoal.  The value <span class="v">:disabled</span> is the 
 same as <span class="v">t</span>, except that the rw-cache is initially inactive and only 
 becomes active when some simplification has taken place.  We have seen a few 
 cases where value <span class="v">t</span> will make a proof fail but <span class="v">:disabled</span> does 
 not.</p> 
 
 <p>The following example illustrates the rw-cache in action.  You will see a 
 break during evaluation of the <span class="tt"><a href="ACL2____THM.html">thm</a></span> form.  Type <span class="v">:eval</span> and you will 
 see a failed rewriting attempt.  Type <span class="v">:go</span> to continue, and at the next 
 break type <span class="v">:eval</span> again.  This time you will see the same failed rewriting 
 attempt, but this time labeled with a notation saying that the failure was 
 cached earlier, which indicates that this time the rewriter did not even 
 attempt to prove the hypothesis of the <a href="ACL2____REWRITE.html">rewrite</a> rule <span class="v">f1-&gt;f2</span>.</p> 
 
 <pre class="code">(<a href="ACL2____DEFSTUB.html">defstub</a> f1 (x) t)
(<a href="ACL2____DEFSTUB.html">defstub</a> f2 (x) t)
(<a href="ACL2____DEFAXIOM.html">defaxiom</a> f1-&gt;f2
         (<a href="ACL2____IMPLIES.html">implies</a> (f1 x) (<a href="COMMON-LISP____EQUAL.html">equal</a> (f2 x) t)))
:brr t
:monitor (:rewrite f1-&gt;f2) t
(<a href="ACL2____THM.html">thm</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="COMMON-LISP____CAR.html">car</a> (f2 a)) (<a href="COMMON-LISP____CDR.html">cdr</a> (f2 a))))</pre> 
 
 <p>Note: This is an event!  It does not print the usual event <a href="ACL2____SUMMARY.html">summary</a> 
 but nevertheless changes the ACL2 logical <a href="ACL2____WORLD.html">world</a> and is so recorded.  It 
 is <span class="tt"><a href="ACL2____LOCAL.html">local</a></span> to the book or <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> form in which it 
 occurs (see <a href="ACL2____SET-RW-CACHE-STATE_12.html">set-rw-cache-state!</a> for a corresponding non-<span class="tt"><a href="ACL2____LOCAL.html">local</a></span> 
 event).</p> 
 
 <p>We also note that rw-cache-state changes may also be caused at the subgoal 
 level; see <a href="ACL2____HINTS.html">hints</a>.</p> 
 
 <p>We welcome you to experiment with different rw-cache states.  If the more 
 aggressive values of <span class="v">t</span> and <span class="v">:disabled</span> cause proofs to fail, then you 
 can revert to the default of <span class="v">:atom</span> or even turn off the rw-cache using 
 <span class="v">(<a href="ACL2____SET-RW-CACHE-STATE.html">set-rw-cache-state</a> nil)</span>.  We don't expect users to need a deep knowledge 
 of the rw-cache in order to do such experiments, but readers interested in 
 details of the rw-cache implementation are invited to read the ``Essay on 
 Rw-cache'' in the ACL2 source code.</p>
</body>
</html>
