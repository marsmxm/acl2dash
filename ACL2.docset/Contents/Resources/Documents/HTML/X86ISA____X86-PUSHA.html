<html>
<head>
<meta charset="UTF-8">
<title>X86-pusha</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=X86ISA____X86-PUSHA">Click for X86-pusha in the Full Manual</a></h3>

<p>PUSHA/PUSHAD: 60</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(x86-pusha proc-mode start-rip temp-rip 
           prefixes rex-byte opcode modr/m sib x86) 
 
  → 
x86</pre></dt>
<dt>Returns</dt>
<dd>
<span class="tt">x86</span> — <font color="#606060">Type <span class="v">(x86p x86)</span>, given <span class="v">(x86p x86)</span>.</font>
</dd> 
 
</dl></div> 
<p> 
   In 64-bit mode, this instruction is invalid; it throws a #UD exception. 
   </p> 
   <p> 
   Note that the stack pointer is read twice: 
   via  <span class="tt"><a href="X86ISA____READ-_A2SP.html">read-*sp</a></span> and via <span class="tt"><a href="X86ISA____RGFI-SIZE.html">rgfi-size</a></span>. 
   The former is used as the address to write into the stack, 
   while the latter is used as (part of) the data to write into the stack. 
   In principle, the sizes of these two stack pointers may differ: 
   the former's size is determined solely by CS.D, 
   while the latter's size is also influenced 
   by the operand size override prefix. 
   It seems odd that the two sizes would differ, though. 
   </p> 
   <p> 
   We use some simple and repetitive code to write the registers into the stack. 
   It may be possible to optimize it by pushing all the registers in one shot. 
   </p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>x86-pusha</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 x86-pusha
 (proc-mode start-rip temp-rip
            prefixes rex-byte opcode modr/m sib x86)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :stobjs (x86)))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____TYPE.html">type</a> (integer 0 4) proc-mode)
          (<a href="COMMON-LISP____TYPE.html">type</a> (signed-byte 48) start-rip)
          (<a href="COMMON-LISP____TYPE.html">type</a> (signed-byte 48) temp-rip)
          (<a href="COMMON-LISP____TYPE.html">type</a> (unsigned-byte 52) prefixes)
          (<a href="COMMON-LISP____TYPE.html">type</a> (unsigned-byte 8) rex-byte)
          (<a href="COMMON-LISP____TYPE.html">type</a> (unsigned-byte 8) opcode)
          (<a href="COMMON-LISP____TYPE.html">type</a> (unsigned-byte 8) modr/m)
          (<a href="COMMON-LISP____TYPE.html">type</a> (unsigned-byte 8) sib))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> proc-mode start-rip temp-rip
                     prefixes rex-byte opcode modr/m sib))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="X86ISA____PREFIXES-P.html">prefixes-p</a> prefixes)
                             (<a href="X86ISA____MODR_F2M-P.html">modr/m-p</a> modr/m)
                             (<a href="X86ISA____SIB-P.html">sib-p</a> sib)
                             (<a href="X86ISA____RIP-GUARD-OKP.html">rip-guard-okp</a> proc-mode temp-rip)
                             (<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> proc-mode 0)))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'x86-pusha))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
     ((?ctx 'x86-pusha))
     (<a href="ACL2____B_A2.html">b*</a> (((<a href="COMMON-LISP____THE.html">the</a> (integer 2 4) operand-size)
           (<a href="X86ISA____SELECT-OPERAND-SIZE.html">select-operand-size</a> proc-mode
                                nil 0 nil prefixes nil nil nil x86))
          (rsp (<a href="X86ISA____READ-_A2SP.html">read-*sp</a> proc-mode x86))
          (eax/ax (<a href="X86ISA____RGFI-SIZE.html">rgfi-size</a> operand-size 0 0 x86))
          (ecx/cx (<a href="X86ISA____RGFI-SIZE.html">rgfi-size</a> operand-size 1 0 x86))
          (edx/dx (<a href="X86ISA____RGFI-SIZE.html">rgfi-size</a> operand-size 2 0 x86))
          (ebx/bx (<a href="X86ISA____RGFI-SIZE.html">rgfi-size</a> operand-size 3 0 x86))
          (esp/sp (<a href="X86ISA____RGFI-SIZE.html">rgfi-size</a> operand-size 4 0 x86))
          (ebp/bp (<a href="X86ISA____RGFI-SIZE.html">rgfi-size</a> operand-size 5 0 x86))
          (esi/si (<a href="X86ISA____RGFI-SIZE.html">rgfi-size</a> operand-size 6 0 x86))
          (edi/di (<a href="X86ISA____RGFI-SIZE.html">rgfi-size</a> operand-size 7 0 x86))
          (check-alignment? (<a href="X86ISA____ALIGNMENT-CHECKING-ENABLED-P.html">alignment-checking-enabled-p</a> x86))
          ((<a href="ACL2____MV.html">mv</a> flg rsp)
           (<a href="X86ISA____ADD-TO-_A2SP.html">add-to-*sp</a> proc-mode rsp (<a href="COMMON-LISP____-.html">-</a> operand-size)
                       x86))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg x86)
           (wme-size-opt proc-mode operand-size
                         rsp 2 eax/ax check-alignment? x86
                         :mem-ptr? nil))
          ((when flg)
           (<a href="COMMON-LISP____COND.html">cond</a> ((<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____CONSP.html">consp</a> flg)
                       (<a href="COMMON-LISP____EQL.html">eql</a> (<a href="COMMON-LISP____CAR.html">car</a> flg) :non-canonical-address))
                  (!!fault-fresh :ss 0 :push flg))
                 ((<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____CONSP.html">consp</a> flg)
                       (<a href="COMMON-LISP____EQL.html">eql</a> (<a href="COMMON-LISP____CAR.html">car</a> flg)
                            :unaligned-linear-address))
                  (!!fault-fresh :ac 0 :push flg))
                 (t (!!fault-fresh flg))))
          (check-alignment? nil)
          ((<a href="ACL2____MV.html">mv</a> flg rsp)
           (<a href="X86ISA____ADD-TO-_A2SP.html">add-to-*sp</a> proc-mode rsp (<a href="COMMON-LISP____-.html">-</a> operand-size)
                       x86))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg x86)
           (wme-size-opt proc-mode operand-size
                         rsp 2 ecx/cx check-alignment? x86
                         :mem-ptr? nil))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg rsp)
           (<a href="X86ISA____ADD-TO-_A2SP.html">add-to-*sp</a> proc-mode rsp (<a href="COMMON-LISP____-.html">-</a> operand-size)
                       x86))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg x86)
           (wme-size-opt proc-mode operand-size
                         rsp 2 edx/dx check-alignment? x86
                         :mem-ptr? nil))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg rsp)
           (<a href="X86ISA____ADD-TO-_A2SP.html">add-to-*sp</a> proc-mode rsp (<a href="COMMON-LISP____-.html">-</a> operand-size)
                       x86))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg x86)
           (wme-size-opt proc-mode operand-size
                         rsp 2 ebx/bx check-alignment? x86
                         :mem-ptr? nil))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg rsp)
           (<a href="X86ISA____ADD-TO-_A2SP.html">add-to-*sp</a> proc-mode rsp (<a href="COMMON-LISP____-.html">-</a> operand-size)
                       x86))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg x86)
           (wme-size-opt proc-mode operand-size
                         rsp 2 esp/sp check-alignment? x86
                         :mem-ptr? nil))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg rsp)
           (<a href="X86ISA____ADD-TO-_A2SP.html">add-to-*sp</a> proc-mode rsp (<a href="COMMON-LISP____-.html">-</a> operand-size)
                       x86))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg x86)
           (wme-size-opt proc-mode operand-size
                         rsp 2 ebp/bp check-alignment? x86
                         :mem-ptr? nil))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg rsp)
           (<a href="X86ISA____ADD-TO-_A2SP.html">add-to-*sp</a> proc-mode rsp (<a href="COMMON-LISP____-.html">-</a> operand-size)
                       x86))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg x86)
           (wme-size-opt proc-mode operand-size
                         rsp 2 esi/si check-alignment? x86
                         :mem-ptr? nil))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg rsp)
           (<a href="X86ISA____ADD-TO-_A2SP.html">add-to-*sp</a> proc-mode rsp (<a href="COMMON-LISP____-.html">-</a> operand-size)
                       x86))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          ((<a href="ACL2____MV.html">mv</a> flg x86)
           (wme-size-opt proc-mode operand-size
                         rsp 2 edi/di check-alignment? x86
                         :mem-ptr? nil))
          ((when flg)
           (!!fault-fresh :ss 0 :push flg))
          (x86 (<a href="X86ISA____WRITE-_A2SP.html">write-*sp</a> proc-mode rsp x86))
          (x86 (<a href="X86ISA____WRITE-_A2IP.html">write-*ip</a> proc-mode temp-rip x86)))
         x86))))</pre> 
<p><b>Theorem: </b>x86p-of-x86-pusha</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 x86p-of-x86-pusha
 (<a href="ACL2____IMPLIES.html">implies</a> (x86p x86)
          (<a href="ACL2____B_A2.html">b*</a> ((x86 (<a href="X86ISA____X86-PUSHA.html">x86-pusha</a> proc-mode start-rip temp-rip prefixes
                               rex-byte opcode modr/m sib x86)))
              (x86p x86)))
 :rule-classes :rewrite)</pre> 

</body>
</html>
