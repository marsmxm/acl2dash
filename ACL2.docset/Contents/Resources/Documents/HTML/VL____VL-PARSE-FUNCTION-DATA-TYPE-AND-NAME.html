<html>
<head>
<meta charset="UTF-8">
<title>Vl-parse-function-data-type-and-name</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=VL____VL-PARSE-FUNCTION-DATA-TYPE-AND-NAME">Click for Vl-parse-function-data-type-and-name in the Full Manual</a></h3>

<p>Matches <span class="v">function_data_type_or_implicit identifier</span>.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(vl-parse-function-data-type-and-name void-allowed-p 
                                      &amp;key (tokstream 'tokstream) 
                                      (config 'config)) 
 
  → 
(mv errmsg? value new-tokstream)</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">config</span> — <font color="#606060">Guard <span class="v">(<a href="VL____VL-LOADCONFIG-P.html">vl-loadconfig-p</a> config)</span>.</font>
</dd> 
 
</dl></div> 
<p>This matches the part of a function body consisting of:</p> 
 
<pre class="code">function_data_type_or_implicit
  [ interface_identifier '.' | class_scope ] identifier</pre> 
 
<p>Except that we're going to ignore the interface_identifier and class_scope 
part.</p> 
 
<p>The following grammar rules are relevant:</p> 
 
<pre class="code">function_data_type_or_implicit ::= data_type_or_void
                                 | implicit_data_type

data_type_or_void ::= data_type | 'void'

implicit_data_type ::= [ signing ] { packed_dimension }</pre> 
 
<p>So really what we're parsing is:</p> 
 
<pre class="code">  'void' identifier
| data_type identifier
| [ signing ] { packed_dimension } identifier.</pre> 
 
<p>This requires backtracking because if an identifier is first, we don't know 
if we're in the data type or implicit case.  The way we resolve this is to 
first try the datatype case.  If that works, it's definitely the right one, 
because in all cases our final identifier is going to be followed by some 
punctuation, and so if we parse both a data type and an identifier, we know the 
third option wouldn't have worked (we would've just gotten an identifier and 
then a semicolon or left-paren).</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>vl-parse-function-data-type-and-name-fn</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 vl-parse-function-data-type-and-name-fn
 (void-allowed-p tokstream config)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :stobjs (tokstream)))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="VL____VL-LOADCONFIG-P.html">vl-loadconfig-p</a> config)))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> config))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'vl-parse-function-data-type-and-name))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
   (((when (<a href="COMMON-LISP____AND.html">and</a> void-allowed-p
                (<a href="VL____VL-IS-TOKEN_F3.html">vl-is-token?</a> :vl-kwd-void)))
     (<a href="VL____SEQ.html">seq</a> tokstream (:= (<a href="VL____VL-MATCH.html">vl-match</a>))
          (name := (<a href="VL____VL-MATCH-TOKEN.html">vl-match-token</a> :vl-idtoken))
          (return (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="VL____MAKE-VL-DATATYPE-OR-IMPLICIT.html">make-vl-datatype-or-implicit</a>
                             :type (<a href="VL____MAKE-VL-CORETYPE.html">make-vl-coretype</a> :name :vl-void)
                             :implicitp nil)
                        name))))
    (backup (<a href="VL____VL-TOKSTREAM-SAVE.html">vl-tokstream-save</a>))
    ((<a href="ACL2____MV.html">mv</a> err1 val tokstream)
     (<a href="VL____SEQ.html">seq</a>
         tokstream (<a href="COMMON-LISP____TYPE.html">type</a> := (<a href="VL____VL-PARSE-DATATYPE.html">vl-parse-datatype</a>))
         (name := (<a href="VL____VL-MATCH-TOKEN.html">vl-match-token</a> :vl-idtoken))
         (return (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="VL____MAKE-VL-DATATYPE-OR-IMPLICIT.html">make-vl-datatype-or-implicit</a> :type type
                                                     :implicitp nil)
                       name))))
    ((unless err1) (<a href="ACL2____MV.html">mv</a> nil val tokstream))
    (pos1 (<a href="VL____VL-TOKSTREAM-_E3POSITION.html">vl-tokstream-&gt;position</a>))
    (tokstream (<a href="VL____VL-TOKSTREAM-RESTORE.html">vl-tokstream-restore</a> backup))
    ((<a href="ACL2____MV.html">mv</a> err2 val tokstream)
     (<a href="VL____SEQ.html">seq</a>
      tokstream
      (when (<a href="VL____VL-IS-SOME-TOKEN_F3.html">vl-is-some-token?</a> '(:vl-kwd-signed :vl-kwd-unsigned))
            (signing := (<a href="VL____VL-MATCH.html">vl-match</a>)))
      (pdims := (<a href="VL____VL-PARSE-0_B2-PACKED-DIMENSIONS.html">vl-parse-0+-packed-dimensions</a>))
      (name := (<a href="VL____VL-MATCH-TOKEN.html">vl-match-token</a> :vl-idtoken))
      (return
       (<a href="COMMON-LISP____CONS.html">cons</a>
          (<a href="VL____MAKE-VL-DATATYPE-OR-IMPLICIT.html">make-vl-datatype-or-implicit</a>
               :type (<a href="VL____MAKE-VL-CORETYPE.html">make-vl-coretype</a>
                          :name :vl-logic
                          :signedp (<a href="COMMON-LISP____AND.html">and</a> signing
                                        (<a href="COMMON-LISP____EQ.html">eq</a> (<a href="VL____VL-TOKEN-_E3TYPE.html">vl-token-&gt;type</a> signing)
                                            :vl-kwd-signed))
                          :pdims pdims)
               :implicitp t)
          name))))
    ((unless err2) (<a href="ACL2____MV.html">mv</a> nil val tokstream))
    (pos2 (<a href="VL____VL-TOKSTREAM-_E3POSITION.html">vl-tokstream-&gt;position</a>))
    ((<a href="ACL2____MV.html">mv</a> pos err)
     (<a href="VL____VL-CHOOSE-PARSE-ERROR.html">vl-choose-parse-error</a> pos1 err1 pos2 err2))
    (tokstream (vl-tokstream-update-position pos)))
   (<a href="ACL2____MV.html">mv</a> err nil tokstream))))</pre> 
<p><b>Theorem: </b>vl-parse-function-data-type-and-name-fails-gracefully</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 vl-parse-function-data-type-and-name-fails-gracefully
 (<a href="ACL2____IMPLIES.html">implies</a>
  (<a href="ACL2____MV-NTH.html">mv-nth</a> 0
          (<a href="VL____VL-PARSE-FUNCTION-DATA-TYPE-AND-NAME.html">vl-parse-function-data-type-and-name</a> void-allowed-p))
  (<a href="COMMON-LISP____NOT.html">not</a>
   (<a href="ACL2____MV-NTH.html">mv-nth</a> 1
           (<a href="VL____VL-PARSE-FUNCTION-DATA-TYPE-AND-NAME.html">vl-parse-function-data-type-and-name</a> void-allowed-p)))))</pre> 
<p><b>Theorem: </b>vl-warning-p-of-vl-parse-function-data-type-and-name</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 vl-warning-p-of-vl-parse-function-data-type-and-name
 (<a href="ACL2____IFF.html">iff</a>
  (<a href="VL____VL-WARNING-P.html">vl-warning-p</a>
     (<a href="ACL2____MV-NTH.html">mv-nth</a> 0
             (<a href="VL____VL-PARSE-FUNCTION-DATA-TYPE-AND-NAME.html">vl-parse-function-data-type-and-name</a> void-allowed-p)))
  (<a href="ACL2____MV-NTH.html">mv-nth</a> 0
          (<a href="VL____VL-PARSE-FUNCTION-DATA-TYPE-AND-NAME.html">vl-parse-function-data-type-and-name</a> void-allowed-p))))</pre> 
<p><b>Theorem: </b>vl-parse-function-data-type-and-name-result</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 vl-parse-function-data-type-and-name-result
 (<a href="ACL2____IMPLIES.html">implies</a>
  (<a href="COMMON-LISP____AND.html">and</a>
   (<a href="COMMON-LISP____NOT.html">not</a>
     (<a href="ACL2____MV-NTH.html">mv-nth</a> 0
             (<a href="VL____VL-PARSE-FUNCTION-DATA-TYPE-AND-NAME.html">vl-parse-function-data-type-and-name</a> void-allowed-p)))
   (<a href="COMMON-LISP____AND.html">and</a> t))
  (<a href="COMMON-LISP____AND.html">and</a>
   (<a href="COMMON-LISP____CONSP.html">consp</a>
     (<a href="ACL2____MV-NTH.html">mv-nth</a> 1
             (<a href="VL____VL-PARSE-FUNCTION-DATA-TYPE-AND-NAME.html">vl-parse-function-data-type-and-name</a> void-allowed-p)))
   (<a href="VL____VL-DATATYPE-OR-IMPLICIT-P.html">vl-datatype-or-implicit-p</a>
    (<a href="COMMON-LISP____CAR.html">car</a>
       (<a href="ACL2____MV-NTH.html">mv-nth</a>
            1
            (<a href="VL____VL-PARSE-FUNCTION-DATA-TYPE-AND-NAME.html">vl-parse-function-data-type-and-name</a> void-allowed-p))))
   (<a href="VL____VL-IDTOKEN-P.html">vl-idtoken-p</a>
    (<a href="COMMON-LISP____CDR.html">cdr</a>
     (<a href="ACL2____MV-NTH.html">mv-nth</a>
         1
         (<a href="VL____VL-PARSE-FUNCTION-DATA-TYPE-AND-NAME.html">vl-parse-function-data-type-and-name</a> void-allowed-p)))))))</pre> 
<p><b>Theorem: </b>vl-parse-function-data-type-and-name-count-strong</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 vl-parse-function-data-type-and-name-count-strong
 (<a href="COMMON-LISP____AND.html">and</a>
  (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a>
   (vl-tokstream-measure
     :tokstream
     (<a href="ACL2____MV-NTH.html">mv-nth</a> 2
             (<a href="VL____VL-PARSE-FUNCTION-DATA-TYPE-AND-NAME.html">vl-parse-function-data-type-and-name</a> void-allowed-p)))
   (vl-tokstream-measure))
  (<a href="ACL2____IMPLIES.html">implies</a>
   (<a href="COMMON-LISP____NOT.html">not</a>
     (<a href="ACL2____MV-NTH.html">mv-nth</a> 0
             (<a href="VL____VL-PARSE-FUNCTION-DATA-TYPE-AND-NAME.html">vl-parse-function-data-type-and-name</a> void-allowed-p)))
   (<a href="COMMON-LISP_____C3.html">&lt;</a>
    (vl-tokstream-measure
     :tokstream
     (<a href="ACL2____MV-NTH.html">mv-nth</a> 2
             (<a href="VL____VL-PARSE-FUNCTION-DATA-TYPE-AND-NAME.html">vl-parse-function-data-type-and-name</a> void-allowed-p)))
    (vl-tokstream-measure))))
 :rule-classes ((:rewrite) (:linear)))</pre> 

</body>
</html>
