<html>
<head>
<meta charset="UTF-8">
<title>Tree-to-string</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=XDOC____TREE-TO-STRING">Click for Tree-to-string in the Full Manual</a></h3>

<p>Turn a XDOC tree into the string it represents.</p><p>An XDOC tree is turned into a string as follows. 
      A leaf tree is already a string and is left unchanged. 
      For a non-leaf tree, the subtrees are recursively turned into strings 
      and concatenated; 
      then the resulting string is surrounded by text 
      determined by the root of the non-leaf tree. 
      If the root represents a tree concatenation, 
      no surrounding text is actually added. 
      If the root represents a preprocessor directive, 
      the surrounding text <span class="v">"@(...)"</span> creates the directive. 
      If the root represents an XML tag, 
      surrounding text <span class="v">"&lt;tag ... attribute=\"value\" ...&gt;...&lt;/tag&gt;"</span> 
      creates the XML tag; 
      the values of the tag's attributes (if present) 
      are obtained by recursively turning 
      the subtrees in the alist into strings.</p> 
   <p>As noted <a href="STR____CONCATENATION.html">here</a>, 
      string concatenation is slow in ACL2 in general. 
      The current implementation of this function 
      uses straighforward string concatenation, 
      but this could be optimized in the future, 
      if concatenating strings turns out to be too slow 
      in the actual usage of these XDOC constructors.</p> 
   <p>Note that the <span class="tt"><a href="COMMON-LISP____SYMBOL-NAME.html">symbol-name</a></span> of a keyword tag 
      consists of uppercase letters. 
      We use <span class="tt"><a href="XDOC____STRING-DOWNCASE_42.html">string-downcase$</a></span> 
      to produce lowercase tags and directives. 
      We expect that this function will never throw an error 
      with the tags and directives supported.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>tree-to-string</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 tree-to-string (tree)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="XDOC____TREEP.html">treep</a> tree)))
 (<a href="COMMON-LISP____COND.html">cond</a>
     ((<a href="COMMON-LISP____ATOM.html">atom</a> tree)
      (<a href="COMMON-LISP____IF.html">if</a> (<a href="ACL2____MBT.html">mbt</a> (<a href="COMMON-LISP____STRINGP.html">stringp</a> tree)) tree ""))
     (t (<a href="COMMON-LISP____LET.html">let</a> ((subtrees-string (tree-list-to-string (<a href="COMMON-LISP____CDR.html">cdr</a> tree))))
             (<a href="ACL2____MV-LET.html">mv-let</a> (left-string right-string)
                     (keyword-or-tree-tag-to-strings (<a href="COMMON-LISP____CAR.html">car</a> tree))
                     (<a href="COMMON-LISP____CONCATENATE.html">concatenate</a> 'string
                                  left-string
                                  subtrees-string right-string))))))</pre> 
<p><b>Function: </b>tree-list-to-string</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> tree-list-to-string (<a href="XDOC____TREES.html">trees</a>)
       (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (tree-listp trees)))
       (<a href="COMMON-LISP____COND.html">cond</a> ((<a href="COMMON-LISP____ENDP.html">endp</a> trees) "")
             (t (<a href="COMMON-LISP____CONCATENATE.html">concatenate</a> 'string
                             (<a href="XDOC____TREE-TO-STRING.html">tree-to-string</a> (<a href="COMMON-LISP____CAR.html">car</a> trees))
                             (tree-list-to-string (<a href="COMMON-LISP____CDR.html">cdr</a> trees))))))</pre> 
<p><b>Function: </b>keyword-or-tree-tag-to-strings</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 keyword-or-tree-tag-to-strings
 (keyword/tag)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____OR.html">or</a> (<a href="COMMON-LISP____KEYWORDP.html">keywordp</a> keyword/tag)
                            (tree-tagp keyword/tag))))
 (<a href="COMMON-LISP____COND.html">cond</a>
  ((<a href="COMMON-LISP____EQ.html">eq</a> keyword/tag :&amp;&amp;) (<a href="ACL2____MV.html">mv</a> "" ""))
  ((<a href="ACL2____MEMBER-EQ.html">member-eq</a> keyword/tag
              '(:|@''| :@{} :|@``| :@$$ :@[]))
   (<a href="COMMON-LISP____LET_A2.html">let*</a> ((left-char (<a href="COMMON-LISP____CHAR.html">char</a> (<a href="COMMON-LISP____SYMBOL-NAME.html">symbol-name</a> keyword/tag) 1))
          (right-char (<a href="COMMON-LISP____CHAR.html">char</a> (<a href="COMMON-LISP____SYMBOL-NAME.html">symbol-name</a> keyword/tag) 2))
          (left-chars (<a href="COMMON-LISP____LIST.html">list</a> #\@ #\( left-char))
          (right-chars (<a href="COMMON-LISP____LIST.html">list</a> right-char #\)))
          (left-string (<a href="COMMON-LISP____COERCE.html">coerce</a> left-chars 'string))
          (right-string (<a href="COMMON-LISP____COERCE.html">coerce</a> right-chars 'string)))
         (<a href="ACL2____MV.html">mv</a> left-string right-string)))
  ((<a href="COMMON-LISP____ATOM.html">atom</a> keyword/tag)
   (<a href="COMMON-LISP____LET.html">let</a>
    ((keyword-chars (<a href="COMMON-LISP____COERCE.html">coerce</a> (<a href="COMMON-LISP____SYMBOL-NAME.html">symbol-name</a> keyword/tag)
                            'list)))
    (<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____CONSP.html">consp</a> keyword-chars)
             (<a href="COMMON-LISP____EQL.html">eql</a> (<a href="COMMON-LISP____CAR.html">car</a> keyword-chars) #\@))
        (<a href="COMMON-LISP____LET_A2.html">let*</a> ((keyword-string (<a href="COMMON-LISP____COERCE.html">coerce</a> (<a href="COMMON-LISP____CDR.html">cdr</a> keyword-chars) 'string))
               (keyword-string (<a href="XDOC____STRING-DOWNCASE_42.html">string-downcase$</a> keyword-string))
               (left-string (<a href="COMMON-LISP____CONCATENATE.html">concatenate</a> 'string
                                         "@(" keyword-string " "))
               (right-string ")"))
              (<a href="ACL2____MV.html">mv</a> left-string right-string))
        (<a href="ACL2____PROG2_42.html">prog2$</a> (<a href="ACL2____ER.html">er</a> hard? 'tree-to-string
                    "Cannot process XDOC tree with root ~x0."
                    keyword/tag)
                (<a href="ACL2____MV.html">mv</a> "" "")))))
  (t
   (<a href="COMMON-LISP____LET_A2.html">let*</a>
      ((<a href="COMMON-LISP____KEYWORD.html">keyword</a> (<a href="COMMON-LISP____CAR.html">car</a> keyword/tag))
       (keyword-chars (<a href="COMMON-LISP____COERCE.html">coerce</a> (<a href="COMMON-LISP____SYMBOL-NAME.html">symbol-name</a> keyword) 'list))
       (keyword-string (<a href="COMMON-LISP____COERCE.html">coerce</a> keyword-chars 'string))
       (keyword-string (<a href="XDOC____STRING-DOWNCASE_42.html">string-downcase$</a> keyword-string))
       (attributes (<a href="COMMON-LISP____CDR.html">cdr</a> keyword/tag))
       (attributes-string (keyword-tree-alist-to-string attributes))
       (left-string
            (<a href="COMMON-LISP____CONCATENATE.html">concatenate</a> 'string
                         "&lt;"
                         keyword-string attributes-string "&gt;"))
       (right-string (<a href="COMMON-LISP____CONCATENATE.html">concatenate</a> 'string
                                  "&lt;/" keyword-string "&gt;")))
      (<a href="ACL2____MV.html">mv</a> left-string right-string)))))</pre> 
<p><b>Function: </b>keyword-tree-alist-to-string</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 keyword-tree-alist-to-string
 (attributes)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (keyword-tree-alistp attributes)))
 (<a href="COMMON-LISP____COND.html">cond</a>
   ((<a href="COMMON-LISP____ENDP.html">endp</a> attributes) "")
   (t (<a href="COMMON-LISP____LET_A2.html">let*</a> ((attribute (<a href="COMMON-LISP____CAR.html">car</a> attributes))
             (<a href="COMMON-LISP____KEYWORD.html">keyword</a> (<a href="COMMON-LISP____CAR.html">car</a> attribute))
             (tree (<a href="COMMON-LISP____CDR.html">cdr</a> attribute))
             (keyword-chars (<a href="COMMON-LISP____COERCE.html">coerce</a> (<a href="COMMON-LISP____SYMBOL-NAME.html">symbol-name</a> keyword) 'list))
             (keyword-string (<a href="COMMON-LISP____COERCE.html">coerce</a> keyword-chars 'string))
             (keyword-string (<a href="XDOC____STRING-DOWNCASE_42.html">string-downcase$</a> keyword-string))
             (tree-string (<a href="XDOC____TREE-TO-STRING.html">tree-to-string</a> tree))
             (attribute-string
                  (<a href="COMMON-LISP____CONCATENATE.html">concatenate</a> 'string
                               " "
                               keyword-string "=\"" tree-string "\""))
             (rest-attributes (<a href="COMMON-LISP____CDR.html">cdr</a> attributes))
             (rest-attribute-string
                  (keyword-tree-alist-to-string rest-attributes)))
            (<a href="COMMON-LISP____CONCATENATE.html">concatenate</a> 'string
                         attribute-string
                         rest-attribute-string)))))</pre> 
<p><b>Theorem: </b>stringp-of-tree-to-string</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> stringp-of-tree-to-string
        (<a href="COMMON-LISP____STRINGP.html">stringp</a> (<a href="XDOC____TREE-TO-STRING.html">tree-to-string</a> tree)))</pre> 
<p><b>Theorem: </b>stringp-of-tree-list-to-string</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> stringp-of-tree-list-to-string
        (<a href="COMMON-LISP____STRINGP.html">stringp</a> (tree-list-to-string trees)))</pre> 
<p><b>Theorem: </b>stringp-of-mv-nth-0-keyword-or-tree-tag-to-strings</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 stringp-of-mv-nth-0-keyword-or-tree-tag-to-strings
 (<a href="ACL2____IMPLIES.html">implies</a>
   (<a href="COMMON-LISP____OR.html">or</a> (<a href="COMMON-LISP____KEYWORDP.html">keywordp</a> keyword/tag)
       (tree-tagp keyword/tag))
   (<a href="COMMON-LISP____STRINGP.html">stringp</a> (<a href="ACL2____MV-NTH.html">mv-nth</a> 0
                    (keyword-or-tree-tag-to-strings keyword/tag)))))</pre> 
<p><b>Theorem: </b>stringp-of-mv-nth-1-keyword-or-tree-tag-to-strings</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
    stringp-of-mv-nth-1-keyword-or-tree-tag-to-strings
    (<a href="COMMON-LISP____STRINGP.html">stringp</a> (<a href="ACL2____MV-NTH.html">mv-nth</a> 1
                     (keyword-or-tree-tag-to-strings keyword/tag))))</pre> 
<p><b>Theorem: </b>stringp-of-keyword-tree-alist-to-string</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> stringp-of-keyword-tree-alist-to-string
        (<a href="COMMON-LISP____STRINGP.html">stringp</a> (keyword-tree-alist-to-string attributes)))</pre> 

</body>
</html>
