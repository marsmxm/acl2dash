<html>
<head>
<meta charset="UTF-8">
<title>Atj-gen-shallow-main-class</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=JAVA____ATJ-GEN-SHALLOW-MAIN-CLASS">Click for Atj-gen-shallow-main-class in the Full Manual</a></h3>

<p>Generate the main (i.e. non-test) Java class declaration, 
          in the shallow embedding approach.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(atj-gen-shallow-main-class pkgs fns-to-translate call-graph 
                            guards$ java-class$ verbose$ wrld) 
 
  → 
(mv class pkg-class-names fn-method-names)</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">pkgs</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____STRING-LISTP.html">string-listp</a> pkgs)</span>.</font>
</dd> 
  <dd>
<span class="tt">fns-to-translate</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> fns-to-translate)</span>.</font>
</dd> 
  <dd>
<span class="tt">call-graph</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____SYMBOL-SYMBOLLIST-ALISTP.html">symbol-symbollist-alistp</a> call-graph)</span>.</font>
</dd> 
  <dd>
<span class="tt">guards$</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____BOOLEANP.html">booleanp</a> guards$)</span>.</font>
</dd> 
  <dd>
<span class="tt">java-class$</span> — <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____STRINGP.html">stringp</a> java-class$)</span>.</font>
</dd> 
  <dd>
<span class="tt">verbose$</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____BOOLEANP.html">booleanp</a> verbose$)</span>.</font>
</dd> 
  <dd>
<span class="tt">wrld</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____PLIST-WORLDP.html">plist-worldp</a> wrld)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">class</span> — <font color="#606060">Type <span class="v">(<a href="JAVA____JCLASSP.html">jclassp</a> class)</span>.</font>
</dd> 
<dd>
<span class="tt">pkg-class-names</span> — <font color="#606060">Type <span class="v">(<a href="ACL2____STRING-STRING-ALISTP.html">string-string-alistp</a> pkg-class-names)</span>, given <span class="v">(<a href="ACL2____STRING-LISTP.html">string-listp</a> pkgs)</span>.</font>
</dd> 
<dd>
<span class="tt">fn-method-names</span> — <font color="#606060">Type <span class="v">(<a href="ACL2____SYMBOL-STRING-ALISTP.html">symbol-string-alistp</a> fn-method-names)</span>, given <span class="v">(<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> fns-to-translate)</span>.</font>
</dd> 
 
</dl></div> 
<p>This is a public class. 
     [JLS:7.6] says that a Java implementation may require 
     public classes to be in files with the same names (plus extension). 
     The code that we generate satisfies this requirement.</p><p>The class contains the static initializer, 
     the initialization method, 
     the classes that contain methods for the ACL2 functions, 
     the <span class="tt"><a href="ACL2____MV.html">mv</a></span> classes, and the fields for quoted constants, and 
     the methods to convert between lists and primitive arrays.</p><p>It is critical that the static initializer 
     comes textually before the fields for the quoted constants, 
     so that the ACL2 environment is initialized 
     before the field initializers, which construct ACL2 values, are executed; 
     [JLS:12.4.1] says that the class initialization code 
     is executed in textual order.</p><p>If <span class="v">:guards</span> is <span class="v">t</span>, we exclude the ACL2 functions 
     that model Java primitive and primitive array operations 
     from the list of functions to be translated to Java. 
     We organize the resulting functions by packages, 
     and we proceed to generate the Java nested classes.</p><p>We also return the alist from ACL2 package names to Java class names 
     and the alist from ACL2 function symbols to Java method names, 
     which must be eventually passed to the functions that generate 
     the Java test class.</p><p>We initialize the symbols of the <span class="tt"><a href="JAVA____ATJ-QCONSTANTS.html">atj-qconstants</a></span> structure 
     with <span class="v">t</span> and <span class="v">nil</span>, 
     because their Java representations are sometimes generated 
     even when these two symbols are not used in any of the ACL2 functions 
     that are translated to Java.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>atj-gen-shallow-main-class</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 atj-gen-shallow-main-class
 (pkgs fns-to-translate call-graph
       guards$ java-class$ verbose$ wrld)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____STRING-LISTP.html">string-listp</a> pkgs)
                             (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> fns-to-translate)
                             (<a href="ACL2____SYMBOL-SYMBOLLIST-ALISTP.html">symbol-symbollist-alistp</a> call-graph)
                             (<a href="ACL2____BOOLEANP.html">booleanp</a> guards$)
                             (<a href="COMMON-LISP____STRINGP.html">stringp</a> java-class$)
                             (<a href="ACL2____BOOLEANP.html">booleanp</a> verbose$)
                             (<a href="ACL2____PLIST-WORLDP.html">plist-worldp</a> wrld))))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="ACL2____NO-DUPLICATESP-EQUAL.html">no-duplicatesp-equal</a> pkgs)))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'atj-gen-shallow-main-class))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
   (((unless (<a href="ACL2____NO-DUPLICATESP-EQ.html">no-duplicatesp-eq</a> fns-to-translate))
     (<a href="ACL2____RAISE.html">raise</a>
      "Internal error: ~
                the list ~x0 of function names has duplicates."
      fns-to-translate)
     (<a href="ACL2____MV.html">mv</a> (<a href="ACL2____EC-CALL.html">ec-call</a> (<a href="JAVA____JCLASS-FIX.html">jclass-fix</a> :irrelevant))
         nil nil))
    (jprimarr-write-methods nil)
    (jprimarr-conv-methods
       (<a href="JAVA____ATJ-GEN-SHALLOW-ALL-JPRIMARR-CONV-METHODS.html">atj-gen-shallow-all-jprimarr-conv-methods</a> fns-to-translate))
    (fns (<a href="COMMON-LISP____IF.html">if</a> guards$
             (<a href="ACL2____SET-DIFFERENCE-EQ.html">set-difference-eq</a>
                  fns-to-translate
                  (<a href="ACL2____UNION-EQ.html">union-eq</a> *atj-jprim-fns* *atj-jprimarr-fns*))
             fns-to-translate))
    (mv-typess (<a href="JAVA____ATJ-ALL-MV-OUTPUT-TYPES.html">atj-all-mv-output-types</a> fns guards$ wrld))
    (pkg-class-names (<a href="JAVA____ATJ-PKGS-TO-CLASSES.html">atj-pkgs-to-classes</a> pkgs java-class$))
    (fn-method-names (<a href="JAVA____ATJ-FNS-TO-METHODS.html">atj-fns-to-methods</a> fns))
    (fns-by-pkg (<a href="ACL2____ORGANIZE-SYMBOLS-BY-PKG.html">organize-symbols-by-pkg</a> fns))
    (qconsts (<a href="JAVA____MAKE-ATJ-QCONSTANTS.html">make-atj-qconstants</a> :integers nil
                                  :rationals nil
                                  :numbers nil
                                  :chars nil
                                  :strings nil
                                  :symbols (<a href="COMMON-LISP____LIST.html">list</a> t nil)
                                  :pairs nil
                                  :next-index 1))
    (fns-that-may-throw
       (<a href="JAVA____ATJ-SHALLOW-FNS-THAT-MAY-THROW.html">atj-shallow-fns-that-may-throw</a> fns-to-translate call-graph))
    ((<a href="ACL2____MV.html">mv</a> methods-by-pkg qconsts mv-typess)
     (<a href="JAVA____ATJ-GEN-SHALLOW-ALL-PKG-METHODS.html">atj-gen-shallow-all-pkg-methods</a>
          pkgs fns-by-pkg fns fns-that-may-throw
          qconsts pkg-class-names fn-method-names
          mv-typess guards$ verbose$ wrld))
    ((unless (<a href="JAVA____ATJ-GEN-SHALLOW-MV-CLASSES-GUARD.html">atj-gen-shallow-mv-classes-guard</a> mv-typess))
     (<a href="ACL2____RAISE.html">raise</a>
      "Internal error: ~
                not all lists of types in ~x0 have length 2 or more."
      mv-typess)
     (<a href="ACL2____MV.html">mv</a> (<a href="ACL2____EC-CALL.html">ec-call</a> (<a href="JAVA____JCLASS-FIX.html">jclass-fix</a> :irrelevant))
         nil nil))
    (mv-classes (<a href="JAVA____ATJ-GEN-SHALLOW-MV-CLASSES.html">atj-gen-shallow-mv-classes</a> mv-typess))
    ((<a href="JAVA____ATJ-QCONSTANTS.html">atj-qconstants</a> qconsts) qconsts)
    (qsymbols qconsts.symbols)
    (qsymbols-by-pkg (<a href="ACL2____ORGANIZE-SYMBOLS-BY-PKG.html">organize-symbols-by-pkg</a> qsymbols))
    (fields-by-pkg (<a href="JAVA____ATJ-GEN-SHALLOW-ALL-PKG-FIELDS.html">atj-gen-shallow-all-pkg-fields</a>
                        pkgs qsymbols
                        qsymbols-by-pkg methods-by-pkg))
    ((run-when verbose$)
     (<a href="ACL2____CW.html">cw</a> "~%Generate the Java classes for the ACL2 packages:~%"))
    (pkg-classes
      (<a href="JAVA____ATJ-GEN-SHALLOW-PKG-CLASSES.html">atj-gen-shallow-pkg-classes</a> pkgs fields-by-pkg methods-by-pkg
                                   pkg-class-names verbose$))
    ((run-when verbose$)
     (<a href="ACL2____CW.html">cw</a> "~%Generate the main Java class.~%"))
    (qinteger-fields
         (<a href="JAVA____ATJ-GEN-SHALLOW-NUMBER-FIELDS.html">atj-gen-shallow-number-fields</a> qconsts.integers))
    (qrational-fields
         (<a href="JAVA____ATJ-GEN-SHALLOW-NUMBER-FIELDS.html">atj-gen-shallow-number-fields</a> qconsts.rationals))
    (qnumber-fields (<a href="JAVA____ATJ-GEN-SHALLOW-NUMBER-FIELDS.html">atj-gen-shallow-number-fields</a> qconsts.numbers))
    (qchar-fields (<a href="JAVA____ATJ-GEN-SHALLOW-CHAR-FIELDS.html">atj-gen-shallow-char-fields</a> qconsts.chars))
    (qstring-fields (<a href="JAVA____ATJ-GEN-SHALLOW-STRING-FIELDS.html">atj-gen-shallow-string-fields</a> qconsts.strings))
    (qcons-fields
         (<a href="JAVA____ATJ-GEN-SHALLOW-CONS-FIELDS.html">atj-gen-shallow-cons-fields</a> (<a href="ACL2____STRIP-CARS.html">strip-cars</a> qconsts.pairs)
                                      qconsts.pairs))
    (all-qconst-fields (<a href="COMMON-LISP____APPEND.html">append</a> qinteger-fields qrational-fields
                               qnumber-fields qchar-fields
                               qstring-fields qcons-fields))
    (all-qconst-fields (<a href="JAVA____MERGESORT-JFIELDS.html">mergesort-jfields</a> all-qconst-fields))
    (static-init (<a href="JAVA____ATJ-GEN-STATIC-INITIALIZER.html">atj-gen-static-initializer</a> java-class$))
    (init-method (<a href="JAVA____ATJ-GEN-INIT-METHOD.html">atj-gen-init-method</a>))
    (body-class
     (<a href="COMMON-LISP____APPEND.html">append</a>
        (<a href="COMMON-LISP____LIST.html">list</a> (<a href="JAVA____JCBODY-ELEMENT-INIT.html">jcbody-element-init</a> static-init))
        (<a href="COMMON-LISP____LIST.html">list</a> (<a href="JAVA____JCBODY-ELEMENT-MEMBER.html">jcbody-element-member</a> (<a href="JAVA____JCMEMBER-METHOD.html">jcmember-method</a> init-method)))
        (<a href="JAVA____JCLASSES-TO-JCBODY-ELEMENTS.html">jclasses-to-jcbody-elements</a> pkg-classes)
        (<a href="JAVA____JFIELDS-TO-JCBODY-ELEMENTS.html">jfields-to-jcbody-elements</a> all-qconst-fields)
        (<a href="JAVA____JCLASSES-TO-JCBODY-ELEMENTS.html">jclasses-to-jcbody-elements</a> mv-classes)
        (<a href="JAVA____JMETHODS-TO-JCBODY-ELEMENTS.html">jmethods-to-jcbody-elements</a> jprimarr-write-methods)
        (<a href="JAVA____JMETHODS-TO-JCBODY-ELEMENTS.html">jmethods-to-jcbody-elements</a> jprimarr-conv-methods))))
   (<a href="ACL2____MV.html">mv</a> (<a href="JAVA____MAKE-JCLASS.html">make-jclass</a> :access (<a href="JAVA____JACCESS-PUBLIC.html">jaccess-public</a>)
                    :abstract? nil
                    :static? nil
                    :final? nil
                    :strictfp? nil
                    :name java-class$
                    :superclass? nil
                    :superinterfaces nil
                    :body body-class)
       pkg-class-names fn-method-names))))</pre> 
<p><b>Theorem: </b>jclassp-of-atj-gen-shallow-main-class.class</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 jclassp-of-atj-gen-shallow-main-class.class
 (<a href="ACL2____B_A2.html">b*</a>
  (((<a href="ACL2____MV.html">mv</a> common-lisp::?class
        ?pkg-class-names ?fn-method-names)
    (<a href="JAVA____ATJ-GEN-SHALLOW-MAIN-CLASS.html">atj-gen-shallow-main-class</a> pkgs fns-to-translate call-graph
                                guards$ java-class$ verbose$ wrld)))
  (<a href="JAVA____JCLASSP.html">jclassp</a> class))
 :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>string-string-alistp-of-atj-gen-shallow-main-class.pkg-class-names</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
  string-string-alistp-of-atj-gen-shallow-main-class.pkg-class-names
  (<a href="ACL2____IMPLIES.html">implies</a> (<a href="ACL2____STRING-LISTP.html">string-listp</a> pkgs)
           (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> common-lisp::?class
                     ?pkg-class-names ?fn-method-names)
                 (<a href="JAVA____ATJ-GEN-SHALLOW-MAIN-CLASS.html">atj-gen-shallow-main-class</a>
                      pkgs fns-to-translate call-graph
                      guards$ java-class$ verbose$ wrld)))
               (<a href="ACL2____STRING-STRING-ALISTP.html">string-string-alistp</a> pkg-class-names)))
  :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>symbol-string-alistp-of-atj-gen-shallow-main-class.fn-method-names</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
  symbol-string-alistp-of-atj-gen-shallow-main-class.fn-method-names
  (<a href="ACL2____IMPLIES.html">implies</a> (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> fns-to-translate)
           (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> common-lisp::?class
                     ?pkg-class-names ?fn-method-names)
                 (<a href="JAVA____ATJ-GEN-SHALLOW-MAIN-CLASS.html">atj-gen-shallow-main-class</a>
                      pkgs fns-to-translate call-graph
                      guards$ java-class$ verbose$ wrld)))
               (<a href="ACL2____SYMBOL-STRING-ALISTP.html">symbol-string-alistp</a> fn-method-names)))
  :rule-classes :rewrite)</pre> 

</body>
</html>
