<html>
<head>
<meta charset="UTF-8">
<title>Sneaky-mutate</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____SNEAKY-MUTATE">Click for Sneaky-mutate in the Full Manual</a></h3>

<p>Low-level way to modify the sneaky store.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(sneaky-mutate fnname get-keys user-arg) → *</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">fnname</span> — The true mutator function to invoke.<br>    <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> fnname)</span>.</font>
</dd> 
  <dd>
<span class="tt">get-keys</span> — The keys whose values will be retrieved and passed 
                         to <span class="v">fnname</span> as its first argument.<br>    <font color="#606060">Guard <span class="v">(<a href="ACL2____TRUE-LISTP.html">true-listp</a> get-keys)</span>.</font>
</dd> 
  <dd>
<span class="tt">user-arg</span> — Arbitrary additional information to pass to the 
                         <span class="v">fnname</span> as its second argument.</dd> 
 
</dl></div> 
<p><b>Warning</b>: this is a very low-level function.  Most of the 
time you will want to use higher-level functions like <a href="ACL2____SNEAKY-SAVE.html">sneaky-save</a>, <a href="ACL2____SNEAKY-PUSH.html">sneaky-push</a>, and <a href="ACL2____SNEAKY-INCF.html">sneaky-incf</a> instead.</p> 
 
<p>In the ACL2 logic, this function simply returns <span class="v">nil</span>.  Under the hood, 
it can cause (logically invisible) side-effects, typically modifying the hidden 
"sneaky store."</p> 
 
<p>The particular details of these side-effects depend upon the <span class="v">fnname</span> 
argument passed in.  As an example, the definition of <a href="ACL2____SNEAKY-PUSH.html">sneaky-push</a> is the 
following:</p> 
 
<pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> sneaky-push (<a href="ACL2____NAME.html">name</a> new-elem)
  (<a href="ACL2____SNEAKY-MUTATE.html">sneaky-mutate</a> 'sneaky-push-mutator (<a href="COMMON-LISP____LIST.html">list</a> name) (<a href="COMMON-LISP____CONS.html">cons</a> name new-elem)))</pre> 
 
<p>The symbol <span class="v">sneaky-push-mutator</span> refers to the following function:</p> 
 
<pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> sneaky-push-mutator (stored-vals name-elem-pair)
  (<a href="COMMON-LISP____LIST.html">list</a> (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CAR.html">car</a> name-elem-pair)
              (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CDR.html">cdr</a> name-elem-pair) (<a href="COMMON-LISP____CAR.html">car</a> stored-vals)))))</pre> 
 
<p>What is going on here?  <span class="v">Sneaky-push</span> accesses a value stored under the 
name <span class="v">name</span>, and re-stores it with <span class="v">new-elem</span> consed onto it.  How does 
this occur?  A call of</p> 
 
<pre class="code">(<a href="ACL2____SNEAKY-MUTATE.html">sneaky-mutate</a> fnname get-keys user-arg)</pre> 
 
<p>calls the function <span class="v">f</span> named by <span class="v">fnname</span>, in this case 
<span class="v">sneaky-push-mutator</span>.  <span class="v">f</span> must always have two arguments:</p> 
 
<ol> 
 
<li>The list of values currently associated with <span class="v">get-keys</span>.  That is, 
    <span class="v">sneaky-mutate</span> will look up each key in <span class="v">get-keys</span> and will 
    send the resulting values to <span class="v">fnname</span>.</li> 
 
<li>An arbitrary additional argument, provided by <span class="v">user-arg</span>.</li> 
 
</ol> 
 
<p>So in the case of <span class="v">sneaky-push</span>, the two arguments passed to 
<span class="v">sneaky-push-mutator</span> are:</p> 
 
<ol> 
 
<li>A list containing the stored value that was previously associated with 
    <span class="v">name</span>, and</li> 
 
<li>The cons of <span class="v">name</span> itself onto <span class="v">new-elem</span>.</li> 
 
</ol> 
 
<p><span class="v">f</span> must return a single value, which should be an association list. 
This alist will be used to update the hidden "sneaky store." In particular, 
the store will be modified by assigning each key in the alist to its 
corresponding value.</p> 
 
<p>In the case of <span class="v">sneaky-push</span>, the stored value associated with <span class="v">name</span> 
is changed to be the cons of <span class="v">new-elem</span> onto the previous stored value; that 
is, <span class="v">name</span> gets <span class="v">new-elem</span> pushed onto it.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>sneaky-mutate</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
  sneaky-mutate (fnname get-keys user-arg)
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> fnname)
                              (<a href="ACL2____TRUE-LISTP.html">true-listp</a> get-keys))))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> fnname get-keys user-arg))
  (<a href="COMMON-LISP____LET.html">let</a> ((__function__ 'sneaky-mutate))
       (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
       (<a href="ACL2____PROGN_42.html">progn$</a> (<a href="ACL2____RAISE.html">raise</a> "Under-the-hood definition not yet installed")
               nil)))</pre> 

</body>
</html>
