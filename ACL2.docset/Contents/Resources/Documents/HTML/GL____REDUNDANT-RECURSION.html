<html>
<head>
<meta charset="UTF-8">
<title>Redundant-recursion</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=GL____REDUNDANT-RECURSION">Click for Redundant-recursion in the Full Manual</a></h3>

<p></p> 
 
<p>Here is a way to write a list-filtering function.</p> 
 
<pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> filter1 (x)
  (<a href="COMMON-LISP____COND.html">cond</a> ((<a href="COMMON-LISP____ATOM.html">atom</a> x)
         nil)
        ((element-okp (<a href="COMMON-LISP____CAR.html">car</a> x))               ;; keep it
         (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CAR.html">car</a> x) (filter1 (<a href="COMMON-LISP____CDR.html">cdr</a> x))))
        (t                                   ;; skip it
         (filter1 (<a href="COMMON-LISP____CDR.html">cdr</a> x)))))</pre> 
 
<p>This definition can be inefficient for symbolic execution.  Suppose we are 
symbolically executing <span class="v">filter1</span>, and the <span class="v">element-okp</span> check has 
produced a symbolic object that can take both <span class="v">nil</span> and non-<span class="v">nil</span> values. 
Then, we proceed by symbolically executing both the keep- and skip-branches, 
and construct a <span class="v">:g-ite</span> form for the result.  Since we have to evaluate the 
recursive call twice, this execution becomes exponential in the length of 
<span class="v">x</span>.</p> 
 
<p>We can avoid this blow-up by consolidating the recursive calls, as 
follows.</p> 
 
<pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> filter2 (x)
  (<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP____ATOM.html">atom</a> x)
      nil
    (<a href="COMMON-LISP____LET.html">let</a> ((<a href="COMMON-LISP____REST.html">rest</a> (filter2 (<a href="COMMON-LISP____CDR.html">cdr</a> x))))
      (<a href="COMMON-LISP____IF.html">if</a> (element-okp (<a href="COMMON-LISP____CAR.html">car</a> x))
          (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CAR.html">car</a> x) rest)
        rest))))</pre> 
 
<p>Of course, <span class="v">filter1</span> is probably slightly better for concrete execution 
since it has a tail call in at least some cases.  If we do not want to change 
the definition of <span class="v">filter1</span>, we can simply tell GL to use the <span class="v">filter2</span> 
definition instead, as described in the next section.</p>
</body>
</html>
