<html>
<head>
<meta charset="UTF-8">
<title>Current-package</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____CURRENT-PACKAGE">Click for Current-package in the Full Manual</a></h3>

<p>The package used for reading and printing</p><p><span class="v">Current-package</span> is an <span class="tt"><a href="ACL2____LD.html">ld</a></span> special (see <a href="ACL2____LD.html">ld</a>).  The 
 accessor is <span class="v">(<a href="ACL2____CURRENT-PACKAGE.html">current-package</a> state)</span> and the updater is 
 <span class="v">(set-current-package val state)</span>, or more conventionally, <span class="v">(<a href="COMMON-LISP____IN-PACKAGE.html">in-package</a>
 val)</span>.  The value of <span class="v">current-package</span> is actually the string that names 
 the package.  (Common Lisp's ``package'' objects do not exist in ACL2.)  The 
 current package must be known to ACL2, i.e., it must be one of the initial 
 packages or a package defined with <span class="tt"><a href="ACL2____DEFPKG.html">defpkg</a></span> by the user.</p> 
 
 <p>When printing symbols, the package prefix is displayed if it is not the 
 <span class="v">current-package</span> and may be optionally displayed otherwise.  Thus, if 
 <span class="v">current-package</span> is <span class="v">"ACL2"</span> then the symbol <span class="v">'ACL2::SYMB</span> may be 
 printed as <span class="v">SYMB</span> or <span class="v">ACL2::SYMB</span>, while <span class="v">'MY-PKG::SYMB</span> must be 
 printed as <span class="v">MY-PKG::SYMB</span>.  But if <span class="v">current-package</span> is <span class="v">"MY-PKG"</span> 
 then the former symbol must be printed as <span class="v">ACL2::SYMB</span> while the latter may 
 be printed as <span class="v">SYMB</span>.</p> 
 
 <p>In Common Lisp, <span class="v">current-package</span> also affects how objects are read from 
 character streams.  Roughly speaking, read and print are inverses if the 
 <span class="v">current-package</span> is fixed, so reading from a stream produced by printing 
 an object must produce an equal object.</p> 
 
 <p>In ACL2, the situation is more complicated because we never read objects 
 from character streams, we only read them from object ``streams'' (channels). 
 Logically speaking, the objects in such a channel are fixed regardless of the 
 setting of <span class="v">current-package</span>.  However, our host file systems do not 
 support the idea of Lisp object files and instead only support character 
 files.  So when you open an object input channel to a given (character file) 
 we must somehow convert it to a list of ACL2 objects.  This is done by a 
 <i>deus ex machina</i> (``a person or thing that appears or is introduced 
 suddenly and unexpectedly and provides a contrived solution to an apparently 
 insoluble difficulty,'' Webster's Ninth New Collegiate Dictionary).  Roughly 
 speaking, the <i>deus ex machina</i> determines what sequence of calls to 
 <span class="v">read-object</span> will occur in the future and what the <span class="v">current-package</span> 
 will be during each of those calls, and then produces a channel containing the 
 sequence of objects produced by an analogous sequence of Common Lisp reads 
 with <span class="v">*current-package*</span> bound appropriately for each.</p> 
 
 <p>A simple rule suffices to make sane file <a href="ACL2____IO.html">io</a> possible: before you 
 read an object from an object channel to a file created by printing to a 
 character channel, make sure the <span class="v">current-package</span> at read-time is the same 
 as it was at print-time.</p>
</body>
</html>
