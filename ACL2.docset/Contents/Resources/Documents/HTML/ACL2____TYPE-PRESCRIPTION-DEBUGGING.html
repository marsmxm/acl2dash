<html>
<head>
<meta charset="UTF-8">
<title>Type-prescription-debugging</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____TYPE-PRESCRIPTION-DEBUGGING">Click for Type-prescription-debugging in the Full Manual</a></h3>

<p>Improve a built-in <a href="ACL2____TYPE-PRESCRIPTION.html">type-prescription</a> rule</p><p>A <a href="ACL2____TYPE-PRESCRIPTION.html">type-prescription</a> rule is introduced automatically when a 
 function is defined (see <a href="COMMON-LISP____DEFUN.html">defun</a>).  However, that rule might not be what 
 you expect.  In this topic we explore how you might be able to improve that 
 rule, by way of an example.</p> 
 
 <p>First consider the following definition.</p> 
 
 <pre class="code">ACL2 !&gt;(<a href="COMMON-LISP____DEFUN.html">defun</a> f (x) (<a href="ACL2____ALISTP.html">alistp</a> x))

Since F is non-recursive, its admission is trivial.  We observe that
the type of F is described by the theorem
(<a href="COMMON-LISP____OR.html">OR</a> (<a href="COMMON-LISP____EQUAL.html">EQUAL</a> (F X) T) (<a href="COMMON-LISP____EQUAL.html">EQUAL</a> (F X) NIL)).  We used the :type-prescription
rule ALISTP.

Summary
Form:  ( DEFUN F ...)
Rules: ((:TYPE-PRESCRIPTION ALISTP))
Time:  0.01 seconds (prove: 0.00, print: 0.00, other: 0.00)
 F
ACL2 !&gt;</pre> 
 
 <p>Notice in particular the phrase, ``We used the :type-prescription rule 
 ALISTP,'' and the corresponding <a href="ACL2____RUNE.html">rune</a> <span class="v">(:TYPE-PRESCRIPTION ALISTP)</span> 
 in the list of rules printed in the <a href="ACL2____SUMMARY.html">summary</a>.  These are telling us that 
 ACL2 used the indicated rule during the process of computing a 
 <a href="ACL2____TYPE-PRESCRIPTION.html">type-prescription</a> rule for <span class="v">f</span>.</p> 
 
 <p>Now suppose that in a different session we instead proceed as follows.</p> 
 
 <pre class="code">ACL2 !&gt;(<a href="ACL2____IN-THEORY.html">in-theory</a> (<a href="ACL2____DISABLE.html">disable</a> (:type-prescription alistp)))

Summary
Form:  ( IN-THEORY (<a href="ACL2____DISABLE.html">DISABLE</a> ...))
Rules: NIL
Time:  0.01 seconds (prove: 0.00, print: 0.00, other: 0.01)
 (:NUMBER-OF-ENABLED-RUNES 3298)
ACL2 !&gt;(<a href="COMMON-LISP____DEFUN.html">defun</a> f (x) (<a href="ACL2____ALISTP.html">alistp</a> x))

Since F is non-recursive, its admission is trivial.  We could deduce
no constraints on the type of F.

Summary
Form:  ( DEFUN F ...)
Rules: NIL
Time:  0.00 seconds (prove: 0.00, print: 0.00, other: 0.00)
 F
ACL2 !&gt;</pre> 
 
 <p>Notice that this time ``We could deduce no constraints on the type of F,'' 
 because in this context, <a href="ACL2____TYPE-SET.html">type-set</a> reasoning does not see that the body 
 of <span class="v">f</span> is a Boolean, because <span class="v">(:type-prescription alistp)</span> has been 
 <a href="ACL2____DISABLE.html">disable</a>d.  Thus, the ``Rules'' field of the summary is empty this 
 time.</p> 
 
 <p>Consider the following story.  On Monday, you run the first session, and a 
 subsequent proof uses <a href="ACL2____TYPE-SET.html">type-set</a> reasoning to conclude that <span class="v">(f x)</span> is 
 Boolean, even after you <a href="ACL2____DISABLE.html">disable</a> the <a href="ACL2____DEFINITION.html">definition</a> of <span class="v">f</span>.  Then 
 on Tuesday, you run the second session, and are surprised to find that ACL2 no 
 longer reasons (during that same subsequent proof attempt) that <span class="v">(f x)</span> is 
 Boolean.  You want to debug this problem, so you look back in the log where 
 you defined <span class="v">f</span>, and you see the ``deduce no constraints'' message â€” 
 but then you look further back, at Monday's log, where you find the definition 
 of <span class="v">f</span> ``used the :type-prescription rule ALISTP'' to conclude that ``the 
 type of F is described by the theorem (OR (EQUAL (F X) T) (EQUAL (F X) 
 NIL))''.  The mention of ALISTP in that definition's output from Monday, 
 together with the corresponding mention of <span class="v">(:TYPE-PRESCRIPTION ALISTP)</span> in 
 the ``Rules'' field of the summary, leads you to resolve the issue as follows. 
 On Monday, when <span class="v">(:TYPE-PRESCRIPTION ALISTP)</span> was <a href="ACL2____ENABLE.html">enable</a>d, ACL2 used 
 type-set reasoning to conclude that the body of <span class="v">f</span> is Boolean, but on 
 Tuesday, <span class="v">(:TYPE-PRESCRIPTION ALISTP)</span> was disabled at that point and hence 
 the body of <span class="v">f</span> was not known to be Boolean by type-set reasoning.  Hence 
 on Tuesday, no Boolean type-prescription rule was stored for <span class="v">f</span> at 
 definition time, which is why the subsequent proof attempt failed to use such 
 a rule.  So you avoid disabling <span class="v">(:TYPE-PRESCRIPTION ALISTP)</span> until after 
 submitting the <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span> for <span class="v">f</span>, and now ACL2's type reasoning knows 
 that <span class="v">f</span> returns a Boolean.</p>
</body>
</html>
