<html>
<head>
<meta charset="UTF-8">
<title>Atj-gen-shallow-synonym-method</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=JAVA____ATJ-GEN-SHALLOW-SYNONYM-METHOD">Click for Atj-gen-shallow-synonym-method in the Full Manual</a></h3>

<p>Generate a Java method with the given types 
          for an ACL2 function synonym.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(atj-gen-shallow-synonym-method 
     fn fns-that-may-throw fn-type 
     pkg-class-names fn-method-names wrld) 
 
  → 
method</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">fn</span> — <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> fn)</span>.</font>
</dd> 
  <dd>
<span class="tt">fns-that-may-throw</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> fns-that-may-throw)</span>.</font>
</dd> 
  <dd>
<span class="tt">fn-type</span> — <font color="#606060">Guard <span class="v">(<a href="JAVA____ATJ-FUNCTION-TYPE-P.html">atj-function-type-p</a> fn-type)</span>.</font>
</dd> 
  <dd>
<span class="tt">pkg-class-names</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____STRING-STRING-ALISTP.html">string-string-alistp</a> pkg-class-names)</span>.</font>
</dd> 
  <dd>
<span class="tt">fn-method-names</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____SYMBOL-STRING-ALISTP.html">symbol-string-alistp</a> fn-method-names)</span>.</font>
</dd> 
  <dd>
<span class="tt">wrld</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____PLIST-WORLDP.html">plist-worldp</a> wrld)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">method</span> — <font color="#606060">Type <span class="v">(<a href="JAVA____JMETHODP.html">jmethodp</a> method)</span>.</font>
</dd> 
 
</dl></div> 
<p>This is used to mimic, as far as name references are concerned, 
     the importing of a function symbol in a package.</p><p>For instance, 
     the built-in <span class="tt"><a href="COMMON-LISP____CONS.html">cons</a></span> is in the <span class="v">"COMMON-LISP"</span> package 
     (i.e. that is its <span class="tt"><a href="ACL2____SYMBOL-PACKAGE-NAME.html">symbol-package-name</a></span>), 
     but that symbol is imported by the <span class="v">"ACL2"</span> package, 
     making it referenceable as <span class="v">acl2::cons</span> 
     besides the ``canonical'' <span class="v">common-lisp::cons</span>. 
     In particular, in the <span class="v">"ACL2"</span> package 
     it can be referenced as just <span class="v">cons</span>, 
     which makes ACL2 code much more readable.</p><p>In the shallow embedding, 
     we translate these two ACL2 packages to two different Java classes, 
     and the method that corresponds to <span class="tt"><a href="COMMON-LISP____CONS.html">cons</a></span> 
     is declared in the class for <span class="v">"COMMON-LISP"</span>, 
     where the method can be referenced by simple name, 
     without qualifying it with the class name. 
     But in classes for other packages, e.g. the class for <span class="v">"ACL2"</span>, 
     it would have to be qualified.</p><p>To avoid this verbosity, 
     we generate a ``synonym'' of the method for <span class="tt"><a href="COMMON-LISP____CONS.html">cons</a></span> 
     in each class of a package that imports <span class="tt"><a href="COMMON-LISP____CONS.html">cons</a></span>, 
     e.g. in the class for <span class="v">"ACL2"</span>. 
     This function generates this synonym method, 
     which is just defined to call the method 
     in the class of its proper package. 
     This makes the generated Java code much more readable. 
     It is hoped that the JVM JIT may optimize the indirection away.</p><p>The <span class="v">fn</span> parameter is the name of the ACL2 function in question, 
     e.g. <span class="tt"><a href="COMMON-LISP____CONS.html">cons</a></span> in the example above.</p><p>We pass the <span class="tt"><a href="ACL2____SYMBOL-PACKAGE-NAME.html">symbol-package-name</a></span> of <span class="v">fn</span> 
     to <span class="tt"><a href="JAVA____ATJ-GEN-SHALLOW-FNNAME.html">atj-gen-shallow-fnname</a></span> 
     to ensure that the result is the simple name of the method, 
     which goes into the generated method declaration.</p><p>Recall that, for each ACL2 function, 
     we generate as many overloaded Java methods 
     as the number of primary and secondary types of the function. 
     Accordingly, we must generate 
     the same number of overloaded methods for the function synonyms. 
     This function generates the overloaded method 
     for the function type passed as argument.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>atj-gen-shallow-synonym-method</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 atj-gen-shallow-synonym-method
 (fn fns-that-may-throw fn-type
     pkg-class-names fn-method-names wrld)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> fn)
                             (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> fns-that-may-throw)
                             (<a href="JAVA____ATJ-FUNCTION-TYPE-P.html">atj-function-type-p</a> fn-type)
                             (<a href="ACL2____STRING-STRING-ALISTP.html">string-string-alistp</a> pkg-class-names)
                             (<a href="ACL2____SYMBOL-STRING-ALISTP.html">symbol-string-alistp</a> fn-method-names)
                             (<a href="ACL2____PLIST-WORLDP.html">plist-worldp</a> wrld))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'atj-gen-shallow-synonym-method))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
   ((in-types (<a href="JAVA____ATJ-FUNCTION-TYPE-_E3INPUTS.html">atj-function-type-&gt;inputs</a> fn-type))
    (out-types (<a href="JAVA____ATJ-FUNCTION-TYPE-_E3OUTPUTS.html">atj-function-type-&gt;outputs</a> fn-type))
    ((unless (<a href="COMMON-LISP____CONSP.html">consp</a> out-types))
     (<a href="ACL2____RAISE.html">raise</a>
      "Internal error: ~
                the function ~x0 has no output types ~x1."
      fn out-types)
     (<a href="ACL2____EC-CALL.html">ec-call</a> (<a href="JAVA____JMETHOD-FIX.html">jmethod-fix</a> :irrelevant)))
    (out-jtype (<a href="JAVA____ATJ-GEN-SHALLOW-JTYPE.html">atj-gen-shallow-jtype</a> out-types))
    (fn-pkg (<a href="ACL2____SYMBOL-PACKAGE-NAME.html">symbol-package-name</a> fn))
    (method-name (<a href="JAVA____ATJ-GEN-SHALLOW-FNNAME.html">atj-gen-shallow-fnname</a>
                      fn
                      pkg-class-names fn-method-names fn-pkg))
    (method-param-names
         (<a href="JAVA____ATJ-GEN-SHALLOW-SYNONYM-METHOD-PARAMS.html">atj-gen-shallow-synonym-method-params</a> (<a href="ACL2____ARITY_B2.html">arity+</a> fn wrld)))
    ((unless (<a href="COMMON-LISP_____D3.html">=</a> (<a href="ACL2____LEN.html">len</a> method-param-names)
                (<a href="ACL2____LEN.html">len</a> in-types)))
     (<a href="ACL2____RAISE.html">raise</a>
      "Internal error: ~
                the number ~x0 of input types of ~x1 ~
                differs from the arity ~x2 of ~x1."
      (<a href="ACL2____LEN.html">len</a> in-types)
      fn (<a href="ACL2____LEN.html">len</a> method-param-names))
     (<a href="ACL2____EC-CALL.html">ec-call</a> (<a href="JAVA____JMETHOD-FIX.html">jmethod-fix</a> :irrelevant)))
    (method-params
        (<a href="JAVA____ATJ-GEN-PARAMLIST.html">atj-gen-paramlist</a> method-param-names
                           (<a href="JAVA____ATJ-TYPE-LIST-TO-JITYPE-LIST.html">atj-type-list-to-jitype-list</a> in-types)))
    (class (<a href="JAVA____ATJ-GET-PKG-CLASS-NAME.html">atj-get-pkg-class-name</a> fn-pkg pkg-class-names))
    (method-body
         (<a href="JAVA____JBLOCK-RETURN.html">jblock-return</a>
              (<a href="JAVA____JEXPR-SMETHOD.html">jexpr-smethod</a> (<a href="JAVA____JTYPE-CLASS.html">jtype-class</a> class)
                             method-name
                             (<a href="JAVA____JEXPR-NAME-LIST.html">jexpr-name-list</a> method-param-names))))
    (throws (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____MEMBER-EQ.html">member-eq</a> fn fns-that-may-throw)
                 (<a href="COMMON-LISP____LIST.html">list</a> *aij-class-undef-pkg-exc*))))
   (<a href="JAVA____MAKE-JMETHOD.html">make-jmethod</a> :access (<a href="JAVA____JACCESS-PUBLIC.html">jaccess-public</a>)
                 :abstract? nil
                 :static? t
                 :final? nil
                 :synchronized? nil
                 :native? nil
                 :strictfp? nil
                 :result (<a href="JAVA____JRESULT-TYPE.html">jresult-type</a> out-jtype)
                 :name method-name
                 :params method-params
                 :throws throws
                 :body method-body))))</pre> 
<p><b>Theorem: </b>jmethodp-of-atj-gen-shallow-synonym-method</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> jmethodp-of-atj-gen-shallow-synonym-method
        (<a href="ACL2____B_A2.html">b*</a> ((method (<a href="JAVA____ATJ-GEN-SHALLOW-SYNONYM-METHOD.html">atj-gen-shallow-synonym-method</a>
                          fn fns-that-may-throw fn-type
                          pkg-class-names fn-method-names wrld)))
            (<a href="JAVA____JMETHODP.html">jmethodp</a> method))
        :rule-classes :rewrite)</pre> 

</body>
</html>
