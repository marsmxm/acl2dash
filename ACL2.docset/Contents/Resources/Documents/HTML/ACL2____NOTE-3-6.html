<html>
<head>
<meta charset="UTF-8">
<title>Note-3-6</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____NOTE-3-6">Click for Note-3-6 in the Full Manual</a></h3>

<p>ACL2 Version  3.6 (August, 2009) Notes</p><p>NOTE!  New users can ignore these release notes, because the <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> has been updated to reflect all changes that are recorded 
 here.</p> 
 
 <p>Below we roughly organize the changes since Version 3.5 into the following 
 categories of changes: existing features, new features, heuristic 
 improvements, bug fixes, distributed books, Emacs support, and experimental 
 <a href="ACL2____HONS-AND-MEMOIZATION.html">hons-and-memoization</a> version.  Each change is described in just one 
 category, though of course many changes could be placed in more than one 
 category.</p> 
 
 <p>Note that (starting with ACL2 Version 3.5) LispWorks is no longer supported 
 as a platform for ACL2, as the LispWorks compiler could not handle the ACL2 
 sources; see comments in the ACL2 sources about ``function size'' being ``too 
 large''.</p> 
 
 <p><b>CHANGES TO EXISTING FEATURES</b></p> 
 
 <p>In the <span class="tt"><a href="ACL2____XARGS.html">xargs</a></span> <span class="tt"><a href="COMMON-LISP____DECLARE.html">declare</a></span> form, the function symbol (or symbols, 
 plural, in the case of <span class="tt"><a href="ACL2____MUTUAL-RECURSION.html">mutual-recursion</a></span>) being defined may now be used 
 in the specified <span class="v">:measure</span> and <span class="v">:</span><span class="tt"><a href="ACL2____GUARD.html">guard</a></span> terms.  Note that, the 
 definition(s) of the new symbol(s) are still not used in the termination 
 proof.  Thanks to Daron Vroon for discussions leading to this addition for the 
 measure and to Dave Greve for requesting such an enhancement for the 
 guard.</p> 
 
 <p>Processing of the <span class="v">:guard-hints</span> in an <span class="tt"><a href="ACL2____XARGS.html">xargs</a></span> <span class="tt"><a href="COMMON-LISP____DECLARE.html">declare</a></span> 
 form is now delayed until the start of <a href="ACL2____GUARD.html">guard</a> verification.  As a 
 result, the function symbol(s) being defined may now be used as one might 
 expect in such hints, for example in an <span class="v">:in-theory</span> form.  Thanks to Jared 
 Davis for suggesting that we make such an improvement and providing an 
 example.</p> 
 
 <p>Made a low-level change to <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> in support of the ACL2s 
 utility ``<span class="v">dynamic-make-event</span>''.  Thanks to Peter Dillinger for explaining 
 the issue leading to this change.</p> 
 
 <p>Modified the failure message printed when a measure conjecture fails to be 
 proved, to indicate whether or not the hint <span class="v">:ruler-extenders :all</span> would 
 create a different measure conjecture.  Thanks to Peter Dillinger for 
 suggesting such a modification.</p> 
 
 <p>A call of <span class="tt"><a href="ACL2____ADD-DEFAULT-HINTS.html">add-default-hints</a></span> had added hints to the end of the 
 current list of default hints.  Now, it adds them to the beginning of that 
 list, so that they are tried first.  However, <span class="tt"><a href="ACL2____ADD-DEFAULT-HINTS.html">add-default-hints</a></span> now 
 takes a keyword argument, <span class="v">:at-end</span>.  If that argument is supplied and 
 evaluates to other than <span class="v">nil</span>, then the previous behavior occurs.</p> 
 
 <p>When <span class="tt"><a href="ACL2____SAVE-EXEC.html">save-exec</a></span> is used to save ACL2 images, the build dates are now 
 printed on separate lines at startup and in the executable script.  Thanks To 
 Bob Boyer for requesting some newlines.</p> 
 
 <p><span class="tt"><a href="ACL2____FORWARD-CHAINING.html">Forward-chaining</a></span> rules are now generated so that every <span class="tt"><a href="COMMON-LISP____LET.html">let</a></span> 
 (also <span class="tt"><a href="COMMON-LISP____LET_A2.html">let*</a></span> and <span class="tt"><a href="COMMON-LISP____LAMBDA.html">lambda</a></span>) expression is expanded away, as is 
 every call of a so-called ``guard holder'' (<span class="tt"><a href="ACL2____MUST-BE-EQUAL.html">must-be-equal</a></span>, <span class="tt"><a href="ACL2____PROG2_42.html">prog2$</a></span>, <span class="tt"><a href="ACL2____EC-CALL.html">ec-call</a></span>, <span class="tt"><a href="COMMON-LISP____THE.html">the</a></span>).  These were formerly only expanded 
 away in the conclusion.  Thanks to Konrad Slind for a helpful email leading to 
 this change.</p> 
 
 <p><span class="tt"><a href="ACL2____CURRENT-THEORY.html">Current-theory</a></span> now causes a hard error when applied to a name not 
 found in the current ACL2 logical <a href="ACL2____WORLD.html">world</a>, rather than simply returning 
 <span class="v">nil</span>.</p> 
 
 <p>When the underlying Common Lisp is GCL, ACL2 no longer uses the <span class="v">#n=</span> 
 reader macro when writing out certain files, including <a href="ACL2____CERTIFICATE.html">certificate</a> 
 files.  In all other Lisps, it now uses the <span class="v">#n=</span> ``print-circle'' feature 
 not only for <a href="ACL2____CERTIFICATE.html">certificate</a> files and ``<span class="v">expansion.lsp</span>'' files written 
 for example in support of <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span>, but also for files written in 
 support of <span class="v">:</span><span class="tt"><a href="ACL2____COMP.html">comp</a></span>.  This is all managed with new <a href="ACL2____STATE.html">state</a> 
 global variable <span class="v">print-circle-files</span>; see <a href="ACL2____PRINT-CONTROL.html">print-control</a>.  Thanks to 
 Dave Greve for pointing out that GCL is limited by default to 1024 indices for 
 <span class="v">#n=</span>.</p> 
 
 <p><b>NEW FEATURES</b></p> 
 
 <p>A documentation topic explains in some detail how <a href="ACL2____HINTS.html">hints</a> work with 
 the ACL2 proof ``waterfall'': see <a href="ACL2____HINTS-AND-THE-WATERFALL.html">hints-and-the-waterfall</a>.  This topic 
 may be useful to those who write computed hints (see <a href="ACL2____COMPUTED-HINTS.html">computed-hints</a>) or 
 other advanced hints.</p> 
 
 <p>Added a new hint keyword, <span class="v">:no-thanks</span>, that avoids printing the usual 
 ``Thanks'' message for <a href="ACL2____HINTS.html">hints</a>.  Thanks to Peter Dillinger for requesting 
 this feature.</p> 
 
 <p>Added a new hint keyword, <span class="v">:backtrack</span>, that checks the goals produced 
 by processing a goal, and can cause the goal to be re-processed using a new 
 hint.  See <a href="ACL2____HINTS.html">hints</a>.  Thanks to Pete Manolios for a conversation that led 
 to the idea of this hint.</p> 
 
 <p>Added a new class of hints, <a href="ACL2____OVERRIDE-HINTS.html">override-hints</a>, that is similar to <a href="ACL2____DEFAULT-HINTS.html">default-hints</a>, except that override-hints are always applied, even if the 
 user has supplied a hint explicitly for the goal.  See <a href="ACL2____OVERRIDE-HINTS.html">override-hints</a>. 
 Thanks to Pete Manolios and Harsh Raju Chamarthi for useful discussions on 
 this topic, including its application to testing.</p> 
 
 <p>When a goal ready to be pushed for proof by induction is given the new hint 
 ``<span class="v">:do-not-induct :otf</span>'', it is indeed pushed for proof by induction, 
 rather than causing immediate failure as in the case of the hint 
 ``<span class="v">:do-not-induct t</span>''.  Instead, the proof fails when the goal is later 
 picked to be proved by induction.  Thanks to Peter Dillinger for discussions 
 leading to this feature.</p> 
 
 <p>Related to computed hints only: Each history entry in the list stored in 
 variable <span class="v">HIST</span> (see <a href="ACL2____COMPUTED-HINTS.html">computed-hints</a>) now has a <span class="v">:CLAUSE</span> field, 
 which provides access to a goal's parent, parent's parent, and so on (within 
 the same induction and forcing round only).</p> 
 
 <p>It is now possible to inhibit warnings produced by <span class="tt"><a href="ACL2____IN-THEORY.html">in-theory</a></span> <a href="ACL2____EVENTS.html">events</a> and <a href="ACL2____HINTS.html">hints</a> that occur when certain built-in definitions and 
 executable-counterparts are disabled: just evaluate <span class="v">(<a href="ACL2____ASSIGN.html">assign</a>
 verbose-theory-warning nil)</span>.  Thanks to Jared Davis (and probably others in 
 the past) for requesting such a mechanism.</p> 
 
 <p><b>HEURISTIC IMPROVEMENTS</b></p> 
 
 <p>A source function (<span class="v">linearize-lst</span>) was replaced by tail-recursive code, 
 which can avoid a stack overflow.  Thanks to Dave Greve for sending a helpful 
 example.</p> 
 
 <p>The heuristics for limiting <a href="ACL2____FORWARD-CHAINING.html">forward-chaining</a> have been slightly 
 relaxed, to allow derivations based on the occurrence of all arguments of the 
 forward-chaining rule's conclusion in the goal (after stripping leading calls 
 of <span class="v">NOT</span>).  Thanks to Dave Greve for contributing this improvement and 
 providing a motivating example.</p> 
 
 <p>We simplified induction schemes by eliminating each hypothesis of the form 
 <span class="v">(<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> term (<a href="COMMON-LISP____QUOTE.html">quote</a> const)))</span> for which some other hypothesis in the 
 same case equates term with some (presumably other) quoted constant.  Thanks 
 to Dave Greve for requesting an improvement of this sort.</p> 
 
 <p><b>BUG FIXES</b></p> 
 
 <p>Fixed a soundness bug related to redundancy of <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> events 
 (see <a href="ACL2____REDUNDANT-EVENTS.html">redundant-events</a>) and <a href="ACL2____RULER-EXTENDERS.html">ruler-extenders</a>.  A proof of <span class="v">nil</span> 
 in ACL2 Version 3.5 appears in a comment in <span class="v">(<a href="ACL2____DEFLABEL.html">deflabel</a> note-3-6 ...)</span> in 
 the ACL2 source code.  The fix is to insist that in order for one <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> event to be redundant with another, they must be evaluated with 
 the same <a href="ACL2____DEFAULT-RULER-EXTENDERS.html">default-ruler-extenders</a>.  Analogous to this issue of <a href="ACL2____DEFAULT-RULER-EXTENDERS.html">default-ruler-extenders</a> for <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span>s is an issue of the <a href="ACL2____DEFAULT-VERIFY-GUARDS-EAGERNESS.html">default-verify-guards-eagerness</a>, which has similarly been fixed.</p> 
 
 <p>Fixed soundness bugs related to the handling of <a href="ACL2____SUBVERSIVE-RECURSIONS.html">subversive-recursions</a> for <a href="ACL2____CONSTRAINT.html">constraint</a>s.  Proofs of <span class="v">nil</span> in ACL2 
 Version 3.5 appear in a comment in <span class="v">(<a href="ACL2____DEFLABEL.html">deflabel</a> note-3-6 ...)</span> in the ACL2 
 source code.</p> 
 
 <p>Fixed a bug that could cause the following error during calls of <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span> in the presence of calls of <span class="tt"><a href="ACL2____SKIP-PROOFS.html">skip-proofs</a></span> in the book:</p> 
 
 <pre class="code">ACL2 Warning [Skip-proofs] in

HARD ACL2 ERROR in FMT0: Illegal Fmt Syntax.  The tilde-@ directive at
position 0 of the string below is illegal because its variable evaluated
to 0, which is neither a string nor a list.

"~@0"</pre> 
 
 <p>Thanks to Dave Greve for reporting this bug and making available a very 
 helpful test case.</p> 
 
 <p>The <span class="v">:corollary</span> of a rule (see <a href="ACL2____RULE-CLASSES.html">rule-classes</a>) failed to use the 
 <span class="tt"><a href="ACL2____DEFAULT-HINTS.html">default-hints</a></span> of the logical <a href="ACL2____WORLD.html">world</a>.  This has been fixed.</p> 
 
 <p>(CCL only) We removed a call, for CCL 1.3 (and beyond) only, of foreign 
 function <span class="v">sync</span> in the closing of output channels.  Thanks to Daron Vroon 
 for reporting issues with such a call on a non-Intel platform.</p> 
 
 <p>Fixed a bug in reporting failures when monitoring rewrite rules with free 
 variables in the hypotheses, that could cause a hard Lisp error (from which 
 ACL2 continues, however).  Thanks to Eric Smith for sending a very helpful 
 example with his bug report.</p> 
 
 <p>Fixed the handling of <span class="v">:induct</span> <a href="ACL2____HINTS.html">hints</a>, which had thrown away hint 
 information from parent goals.  For example, the <span class="tt"><a href="ACL2____THM.html">thm</a></span> form below failed 
 to prove even though the second hint is in some sense superfluous; induction 
 occurs automatically at <span class="v">"Goal'"</span> even without the hint on that.  The 
 failure was due to discarding the hint information on <span class="v">"Goal"</span>.</p> 
 
 <pre class="code">(<a href="ACL2____IN-THEORY.html">in-theory</a> (<a href="ACL2____DISABLE.html">disable</a> append))
(<a href="ACL2____THM.html">thm</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="COMMON-LISP____CDR.html">cdr</a> (<a href="COMMON-LISP____CONS.html">cons</a> a (<a href="COMMON-LISP____APPEND.html">append</a> (<a href="COMMON-LISP____APPEND.html">append</a> x y) z))) (<a href="COMMON-LISP____APPEND.html">append</a> x y z))
     :hints
     (("Goal" :in-theory (<a href="ACL2____ENABLE.html">enable</a> append))
      ("Goal'" :induct t) ; failed unless this line is commented out
      ))</pre> 
 
 <p>Fixed a bug in the <span class="tt"><a href="ACL2____ARGS.html">args</a></span> command that was failing to show the 
 formals of primitives (built-in functions like <span class="v">consp</span> that do not come 
 with explicit definitions).  Thanks to John Cowles for pointing out this bug. 
 (At a lower level, the bug was that primitives failed to have <span class="v">'stobjs-in</span> 
 or <span class="v">'stobjs-out</span> properties.)</p> 
 
 <p>Fixed bugs in the utility supporting moving directories of certified books, 
 sometimes used in Debian builds (as described in source function 
 <span class="v">make-certificate-file</span>).  Thanks to Alan Dunn for pointing out such a bug, 
 in paths associated with <span class="tt"><a href="ACL2____DEFPKG.html">defpkg</a></span> events in <a href="ACL2____PORTCULLIS.html">portcullis</a> commands 
 in <a href="ACL2____CERTIFICATE.html">certificate</a>s (which are used for error reporting).  There were also 
 bugs, now fixed, that prevented renaming some book paths.  Please note that 
 this mechanism is not guaranteed to be sound; in particular, it can probably 
 misbehave when macros are used to generate portcullis events.  However, it 
 seems likely that such issues will be very rare.</p> 
 
 <p>Eliminated warnings that could arise when tracing a function with <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span>.  Now, when <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span> is applied to a function without option 
 <span class="v">:native</span>, that function's declarations and documentation are 
 discarded.</p> 
 
 <p>Fixed a bug that could cause a failure when building an executable image 
 using SBCL as the underlying Common Lisp.  Thanks to Jun Sawada for reporting 
 this failure.  We made a similar fix for CMUCL.</p> 
 
 <p>Fixed a bug in <span class="tt"><a href="ACL2____SAVE-EXEC.html">save-exec</a></span> in the case that an absolute pathname is 
 supplied.  Thanks to Jared Davis for bringing this bug to our attention.</p> 
 
 <p>Fixed a bug in the use of <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span> with the <span class="v">:native</span> and 
 <span class="v">:multiplicity</span> options that caused hard errors for some underlying 
 Lisps.</p> 
 
 <p>Fixed a bug in the interaction of <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span> and <span class="v">:</span><span class="tt"><a href="ACL2____COMP.html">comp</a></span>, 
 which caused error as <span class="tt"><a href="ACL2____COMP.html">comp</a></span> tried to re-trace functions that it 
 temporarily untraced.</p> 
 
 <p><b>NEW AND UPDATED BOOKS AND RELATED INFRASTRUCTURE</b></p> 
 
 <p>See <a href="https://code.google.com/p/acl2-books/wiki/ReleaseVersionNumbers" target="_blank"><nobr>ReleaseVersionNumbers<img src="../Icon_External_Link.png" title="External link to https://code.google.com/p/acl2-books/wiki/ReleaseVersionNumbers"></nobr></a> 
 for a list of books in Version 3.6 of ACL2 but not Version 3.5.  For 
 <i>changes</i> to existing books rather than <i>additions</i>, see the <a href="http://code.google.com/p/acl2-books/source/list" target="_blank"><nobr>log entries<img src="../Icon_External_Link.png" title="External link to http://code.google.com/p/acl2-books/source/list"></nobr></a> 
 starting with revision r286 up through revision r329.</p> 
 
 <p>It is no longer required to specify a value for environment (or `make') 
 variable <span class="v">ACL2_SYSTEM_BOOKS</span> when running `make' in the distributed book 
 directory, even when that directory is not under the directory containing the 
 ACL2 executable.  Thanks to Peter Dillinger for providing this improvement, by 
 modifying <span class="v">books/Makefile-generic</span> and, as needed, distributed book 
 Makefiles.</p> 
 
 <p>Thanks to Peter Dillinger, some books in support of the ACL2 Sedan (ACL2s) 
 are more easily available for ACL2 users who do not use ACL2s.  See <a href="ACL2____ACL2-SEDAN.html">ACL2-sedan</a>.</p> 
 
 <p><b>EMACS SUPPORT</b></p> 
 
 <p>If the following form is evaluated before the load of 
 <span class="v">emacs/emacs-acl2.el</span>, then variables are now set to reflect the directory 
 containing that file.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____IF.html">if</a> (boundp '*acl2-sources-dir*)
    (makunbound '*acl2-sources-dir*))</pre> 
 
 <p>Fixed info-dir-entry line in generated info file (by patching 
 <span class="v">doc/write-acl2-texinfo.lisp</span>).  Thanks to Alan Dunn for providing this 
 patch.</p> 
 
 <p><b>EXPERIMENTAL HONS VERSION</b></p> 
 
 <p>Bob Boyer and others have contributed numerous changes for the experimental 
 ``<span class="v">hons</span>'' version of ACL2 (see <a href="ACL2____HONS-AND-MEMOIZATION.html">hons-and-memoization</a>).  A number of 
 these have been crafted to work specifically with CCL (Clozure Common Lisp, 
 formerly OpenMCL), which is now required as the underlying Lisp for the 
 ``<span class="v">hons</span>'' version of ACL2.</p> 
 
 <p>A heuristic (source function <span class="v">too-many-ifs</span> has been made more scalable 
 (for the non-HONS version as well, in fact), but with no functional change. 
 Thanks to Jared Davis for noticing performance issues and suggesting 
 fixes.</p> 
 
 <p>Other changes including the following, quoting Bob Boyer:</p> 
 
 <blockquote>
<p>The CCL CASE macro now does better than a dumb linear search in 
 some CASEes.</p> 
 
 <p>SH and CSH are functions to talk to the underlying Gnu-Linux from CCL. 
 Good for repeated calling when you simply cannot afford the copying cost of a 
 FORK because you are using, say, a dozen gigabytes.</p> 
 
 <p>Added CCL compiler-macros for IF and OR, to support some 'coverage' 
 analysis, cf. IF-REPORT, extending the profiling.</p> 
 
 <p>Introduced the type 'mfixnum' so that things like counting honses and 
 counting calls to memoized or profiled functions can run fast in CCL 64 bits 
 and yet still run at all under 32 bits.</p> 
 
 <p>Moved all HONSes to CCL's newish static space, which permits the address of 
 a cons to be used as a hash key, as in most Lisps.  (CCL moves most conses and 
 most everything when it does a compacting-gc.)</p> 
 
 <p>Quite a few changes in the memoize-fn reporting.</p> 
 
 <p>Added a timer facility, cf. call-with-timeout.  Good for running under 
 throttle some gross thoughts like 'Is it true that you can't fit 12 pigeons 
 into 11 holes' on some propositional calculus systems/functions.</p> 
 
 <p>Added rwx-size, pid-owner-cmdlines, rss, and proc-stat to help see what is 
 really going on virtually in Gnu-Linux.</p> 
 
 <p>Fixed at least one bug in compact-print-file and helped make its 
 integration into ACL2's read-object$ a little more sound.  Still worried some 
 about *print-readably* vs. readtable-case.  Does anyone else stay awake late 
 at night worrying about readtable-case?</p> 
 
 <p>Revised how the *watch-dog-process* interrupts the main process for the 
 thousandth time, cf. watch.  Haven't changed it in weeks, which means that (a) 
 it is getting tolerable or (b) I've run out of gas.</p>
</blockquote>
</body>
</html>
