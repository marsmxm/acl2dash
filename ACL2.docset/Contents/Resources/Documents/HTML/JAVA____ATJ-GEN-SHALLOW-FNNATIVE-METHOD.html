<html>
<head>
<meta charset="UTF-8">
<title>Atj-gen-shallow-fnnative-method</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=JAVA____ATJ-GEN-SHALLOW-FNNATIVE-METHOD">Click for Atj-gen-shallow-fnnative-method in the Full Manual</a></h3>

<p>Generate a Java method with the given types 
          for an ACL2 function that is natively implemented in AIJ.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(atj-gen-shallow-fnnative-method 
     fn 
     fns-that-may-throw fn-type method-name 
     method-param-names method-body) 
 
   
method</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">fn</span>  <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> fn)</span>.</font>
</dd> 
  <dd>
<span class="tt">fns-that-may-throw</span>  <font color="#606060">Guard <span class="v">(<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> fns-that-may-throw)</span>.</font>
</dd> 
  <dd>
<span class="tt">fn-type</span>  <font color="#606060">Guard <span class="v">(<a href="JAVA____ATJ-FUNCTION-TYPE-P.html">atj-function-type-p</a> fn-type)</span>.</font>
</dd> 
  <dd>
<span class="tt">method-name</span>  <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____STRINGP.html">stringp</a> method-name)</span>.</font>
</dd> 
  <dd>
<span class="tt">method-param-names</span>  <font color="#606060">Guard <span class="v">(<a href="ACL2____STRING-LISTP.html">string-listp</a> method-param-names)</span>.</font>
</dd> 
  <dd>
<span class="tt">method-body</span>  <font color="#606060">Guard <span class="v">(<a href="JAVA____JBLOCKP.html">jblockp</a> method-body)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">method</span>  <font color="#606060">Type <span class="v">(<a href="JAVA____JMETHODP.html">jmethodp</a> method)</span>.</font>
</dd> 
 
</dl></div> 
<p>AIJ's <span class="v">Acl2NativeFunction</span> class provides native Java implementations 
     of certain ACL2 functions, as public static Java methods. 
     Thus, in the shallow embedding approach, 
     we could translate references to these ACL2 functions 
     to the names of those public static Java methods. 
     However, for greater uniformity and readability, 
     we generate wrapper Java methods 
     for these natively implemented ACL2 functions. 
     The names of these methods are constructed in the same way as 
     the Java methods for the non-natively implemented ACL2 functions. 
     These methods reside in the Java classes generated for 
     the ACL2 packages of the ACL2 functions.</p><p>For each of these natively implemented ACL2 functions, 
     <span class="v">Acl2NativeFunction</span> has a corresponding Java method 
     that takes <span class="v">Acl2Value</span> objects as arguments. 
     For some of these functions, 
     <span class="v">Acl2NativeFunction</span> also has overloaded Java methods 
     that take argument objects of narrower types 
     that correspond to the primary and (if present) secondary ATJ types 
     associated to the ACL2 function via the macros 
     <span class="tt"><a href="JAVA____ATJ-MAIN-FUNCTION-TYPE.html">atj-main-function-type</a></span> and 
     <span class="tt"><a href="JAVA____ATJ-OTHER-FUNCTION-TYPE.html">atj-other-function-type</a></span>.</p><p>For the natively implemented functions that return booleans, 
     <span class="v">Acl2NativeFunction</span> also has Java methods that return 
     the primitive Java type <span class="v">boolean</span> instead of <span class="v">Acl2Symbol</span>; 
     these are not overloaded, they have different names 
     (that end with <span class="v">Boolean</span>). 
     These <span class="v">boolean</span>-returning methods are 
     alternatives to the <span class="v">Acl2Symbol</span>-returning ones, 
     which are selected when <span class="v">:guards</span> is <span class="v">t</span>; 
     see <span class="tt"><a href="JAVA____ATJ-FNNATIVE-METHOD-NAME.html">atj-fnnative-method-name</a></span>.</p><p>We generate a wrapper method for each such overloaded method 
     (or its <span class="v">boolean</span>-returning alternative; see above): 
     the argument and return types of the wrapper method 
     are the same as the ones of the wrapped method in <span class="v">Acl2NativeFunction</span>. 
     This function generates one of these methods, 
     as determined by the function type supplied as input. 
     The types are the only thing that varies across the wrapper methods: 
     their names, bodies, and other attributes are all the same; 
     thus, these are calculated once and passed as inputs to this function. 
     Note that the bodies of the wrapper methods automatically call 
     different methods in <span class="v">Acl2NativeFunction</span> based on the types; 
     the called methods are resolved by the Java compiler.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>atj-gen-shallow-fnnative-method</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 atj-gen-shallow-fnnative-method
 (fn fns-that-may-throw fn-type method-name
     method-param-names method-body)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> fn)
                             (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> fns-that-may-throw)
                             (<a href="JAVA____ATJ-FUNCTION-TYPE-P.html">atj-function-type-p</a> fn-type)
                             (<a href="COMMON-LISP____STRINGP.html">stringp</a> method-name)
                             (<a href="ACL2____STRING-LISTP.html">string-listp</a> method-param-names)
                             (<a href="JAVA____JBLOCKP.html">jblockp</a> method-body))))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="JAVA____AIJ-NATIVEP.html">aij-nativep</a> fn)))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'atj-gen-shallow-fnnative-method))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
   ((in-types (<a href="JAVA____ATJ-FUNCTION-TYPE-_E3INPUTS.html">atj-function-type-&gt;inputs</a> fn-type))
    (out-types (<a href="JAVA____ATJ-FUNCTION-TYPE-_E3OUTPUTS.html">atj-function-type-&gt;outputs</a> fn-type))
    ((unless (<a href="COMMON-LISP____CONSP.html">consp</a> out-types))
     (<a href="ACL2____RAISE.html">raise</a>
      "Internal error: ~
                the function ~x0 has no output types ~x1."
      fn out-types)
     (<a href="ACL2____EC-CALL.html">ec-call</a> (<a href="JAVA____JMETHOD-FIX.html">jmethod-fix</a> :irrelevant)))
    (out-jtype (<a href="JAVA____ATJ-GEN-SHALLOW-JTYPE.html">atj-gen-shallow-jtype</a> out-types))
    ((unless (<a href="COMMON-LISP_____D3.html">=</a> (<a href="ACL2____LEN.html">len</a> in-types)
                (<a href="ACL2____LEN.html">len</a> method-param-names)))
     (<a href="ACL2____RAISE.html">raise</a>
      "Internal error: ~
                the number ~x0 of input types for ~x1 ~
                differs from the number ~x2 of calculated method arguments."
      (<a href="ACL2____LEN.html">len</a> in-types)
      fn (<a href="ACL2____LEN.html">len</a> method-param-names))
     (<a href="ACL2____EC-CALL.html">ec-call</a> (<a href="JAVA____JMETHOD-FIX.html">jmethod-fix</a> :irrelevant)))
    (throws (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____MEMBER-EQ.html">member-eq</a> fn fns-that-may-throw)
                 (<a href="COMMON-LISP____LIST.html">list</a> *aij-class-undef-pkg-exc*))))
   (<a href="JAVA____MAKE-JMETHOD.html">make-jmethod</a>
        :access (<a href="JAVA____JACCESS-PUBLIC.html">jaccess-public</a>)
        :abstract? nil
        :static? t
        :final? nil
        :synchronized? nil
        :native? nil
        :strictfp? nil
        :result (<a href="JAVA____JRESULT-TYPE.html">jresult-type</a> out-jtype)
        :name method-name
        :params
        (<a href="JAVA____ATJ-GEN-PARAMLIST.html">atj-gen-paramlist</a> method-param-names
                           (<a href="JAVA____ATJ-TYPE-LIST-TO-JITYPE-LIST.html">atj-type-list-to-jitype-list</a> in-types))
        :throws throws
        :body method-body))))</pre> 
<p><b>Theorem: </b>jmethodp-of-atj-gen-shallow-fnnative-method</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> jmethodp-of-atj-gen-shallow-fnnative-method
        (<a href="ACL2____B_A2.html">b*</a> ((method (<a href="JAVA____ATJ-GEN-SHALLOW-FNNATIVE-METHOD.html">atj-gen-shallow-fnnative-method</a>
                          fn
                          fns-that-may-throw fn-type method-name
                          method-param-names method-body)))
            (<a href="JAVA____JMETHODP.html">jmethodp</a> method))
        :rule-classes :rewrite)</pre> 

</body>
</html>
