<html>
<head>
<meta charset="UTF-8">
<title>Origexprs</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=VL2014____ORIGEXPRS">Click for Origexprs in the Full Manual</a></h3>

<p>Add <span class="v">VL_ORIG_EXPR</span> annotations to some expressions.</p><p>In this transformation, we annotate many expressions with their 
<span class="v">VL_ORIG_EXPR</span> attribute (see <a href="VL2014____VL-ATTS-P.html">vl-atts-p</a>).  The idea is to associate 
each expression with its "original version," as it was read from the source 
file, before any simplification has taken place.</p> 
 
<p>Why do we want to do this?  Transformations like <a href="VL2014____OPREWRITE.html">oprewrite</a> can, for 
instance, simplify expressions such as <span class="v">a == b</span> into <span class="v">&amp;(a ~^ b)</span>, and 
these reduced expressions may not correspond to anything the logic designer 
actually wrote in the source file.  So, if we want to print an error message or 
warning about this expression, we would prefer to write it as <span class="v">a == b</span> 
instead.  By saving the original version of the expression as an attribute, we 
can easily remember where the expression came from.</p> 
 
<p>The core function, <a href="VL2014____VL-EXPR-ORIGEXPRS.html">vl-expr-origexprs</a>, is rather cute.  As we 
encounter each expression, say <span class="v">x</span>, we just cons together a new expression 
with the same fields, except that we add an <span class="v">VL_ORIG_EXPR</span> attribute whose 
value is <span class="v">x</span> itself.  This is really quite fast, and we do not need to do 
any pretty-printing ahead of time.</p> 
 
<p>In error messages, we typically use this attribute implicitly, by calling 
<a href="VL2014____VL-PPS-ORIGEXPR.html">vl-pps-origexpr</a>.</p>
</body>
</html>
