<html>
<head>
<meta charset="UTF-8">
<title>Fast-alists</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____FAST-ALISTS">Click for Fast-alists in the Full Manual</a></h3>

<p>Alists with hidden hash tables for faster execution</p><p>The implementation of fast alists is, in many ways, similar to that 
 of ACL2 arrays.  Logically, <span class="tt"><a href="ACL2____HONS-ACONS.html">hons-acons</a></span> is just like <span class="v">acons</span>, and 
 <span class="tt"><a href="ACL2____HONS-GET.html">hons-get</a></span> is similar to <span class="tt"><a href="ACL2____ASSOC-EQUAL.html">assoc-equal</a></span>.  But under the hood, hash 
 tables are associated with these alists, and, when a certain <b>discipline</b> 
 is followed, these functions execute with hash table speeds.</p> 
 
 <p>What is this discipline?  Each <span class="v">hons-acons</span> operation "steals" the 
 hash table associated with the alist that is being extended.  Because of this, 
 one must be very conscious of which object is the most recent extension of an 
 alist and use that extension exclusively.</p> 
 
 <p>The only penalty for a failure to keep track of the most recent extension 
 is a loss of execution speed, not of correctness, and perhaps the annoyance of 
 some <span class="tt"><a href="ACL2____SLOW-ALIST-WARNING.html">slow-alist-warning</a></span>s.</p> 
 
 <p>Maintaining discipline may require careful passing of a fast alist up and 
 down through function calls, as with any single threaded object in an 
 applicative setting, but there is <b>no syntactic enforcement</b> that insists 
 you only use the most recent extension of an alist as there is for single 
 threaded objects (<span class="tt"><a href="ACL2____STOBJ.html">stobj</a></span>s).  Also, even with perfectly proper code, 
 discipline can sometimes be lost due to user interrupts and aborts.</p> 
 
 <p>Performance Notes</p> 
 
 <p>See <a href="ACL2____HONS-ACONS.html">hons-acons</a> for how the final <span class="tt"><a href="COMMON-LISP____CDR.html">cdr</a></span> of a fast alist can be 
 used as a size hint or as a name for reports printed by calling <span class="tt"><a href="ACL2____FAST-ALIST-SUMMARY.html">fast-alist-summary</a></span>.</p> 
 
 <p>The keys of fast alists are always <a href="ACL2____NORMED.html">normed</a>.  Why?  In Common Lisp, 
 equal-based hashing is relatively slow, so to allow the use of eql-based hash 
 tables, <span class="tt"><a href="ACL2____HONS-ACONS.html">hons-acons</a></span> and <span class="tt"><a href="ACL2____HONS-GET.html">hons-get</a></span> always <span class="tt"><a href="ACL2____HONS-COPY.html">hons-copy</a></span> the 
 keys involved.</p> 
 
 <p>Since alist keys are frequently atoms, this norming activity may often be 
 so fast that you do not need to think about it.  But if you are going to use 
 large structures as the keys for your fast alist, this overhead can be 
 significant, and you may want to ensure that your keys are normed ahead of 
 time.</p> 
 
 <p>There is <b>no automatic mechanism</b> for reclaiming the hash tables that 
 are associated with alists.  Because of this, to avoid memory leaks, you 
 should call <span class="tt"><a href="ACL2____FAST-ALIST-FREE.html">fast-alist-free</a></span> to remove the hash table associated with 
 alists that will no longer be used.</p>
</body>
</html>
