<html>
<head>
<meta charset="UTF-8">
<title>Let</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=COMMON-LISP____LET">Click for Let in the Full Manual</a></h3>

<p>Binding of lexically scoped (local) variables</p><h3>Introduction</h3> 
 
 <p>Example</p> 
 
 <pre class="code">(<a href="COMMON-LISP____LET.html">let</a> ((x (<a href="COMMON-LISP_____A2.html">*</a> x x))
      (y (<a href="COMMON-LISP_____A2.html">*</a> 2 x)))
 (<a href="COMMON-LISP____LIST.html">list</a> x y))</pre> 
 
 <p>If the form above is executed in an environment in which <span class="v">x</span> has the 
 value <span class="v">-2</span>, then the result is <span class="v">'(4 -4)</span>.</p> 
 
 <p><span class="v">Let</span> expressions bind variables so that their ``local'' values, the 
 values they have when the ``body'' of the <span class="v">let</span> is evaluated, are possibly 
 different than their ``global'' values, the values they have in the context in 
 which the <span class="v">let</span> expression appears.  In the <span class="v">let</span> expression above, the 
 local variables bound by the <span class="v">let</span> are <span class="v">x</span> and <span class="v">y</span>.  They are locally 
 bound to the values delivered by the two forms <span class="v">(<a href="COMMON-LISP_____A2.html">*</a> x x)</span> and <span class="v">(<a href="COMMON-LISP_____A2.html">*</a> 2 x)</span>, 
 respectively, that appear in the ``bindings'' of the <span class="v">let</span>.  The body of 
 the <span class="v">let</span> is <span class="v">(<a href="COMMON-LISP____LIST.html">list</a> x y)</span>.</p> 
 
 <p>Suppose that the <span class="v">let</span> expression above occurs in a context in which 
 <span class="v">x</span> has the value <span class="v">-2</span>.  (The global value of <span class="v">y</span> is irrelevant to 
 this example.)  For example, one might imagine that the <span class="v">let</span> form above 
 occurs as the body of some function, <span class="v">fn</span>, with the formal parameter <span class="v">x</span> 
 and we are evaluating <span class="v">(fn -2)</span>.</p> 
 
 <p>To evaluate the <span class="v">let</span> above in a context in which <span class="v">x</span> is <span class="v">-2</span>, we 
 first evaluate the two forms specifying the local values of the variables. 
 Thus, <span class="v">(<a href="COMMON-LISP_____A2.html">*</a> x x)</span> is evaluated and produces <span class="v">4</span> (because <span class="v">x</span> is 
 <span class="v">-2</span>) and <span class="v">(<a href="COMMON-LISP_____A2.html">*</a> 2 x)</span> is evaluated and produces <span class="v">-4</span> (because <span class="v">x</span> is 
 <span class="v">-2</span>).  Then <span class="v">x</span> and <span class="v">y</span> are bound to these values and the body of 
 the <span class="v">let</span> is evaluated.  Thus, when the body, <span class="v">(<a href="COMMON-LISP____LIST.html">list</a> x y)</span> is evaluated, 
 <span class="v">x</span> is <span class="v">4</span> and <span class="v">y</span> is <span class="v">-4</span>.  Thus, the body produces <span class="v">'(4
 -4)</span>.</p> 
 
 <p>Note that the binding of <span class="v">y</span>, which is written after the binding of 
 <span class="v">x</span> and which mentions <span class="v">x</span>, nevertheless uses the global value of 
 <span class="v">x</span>, not the new local value.  That is, the local variables of the <span class="v">let</span> 
 are bound ``in parallel'' rather than ``sequentially.'' In contrast, if 
 the example <span class="v">let*</span> form:</p> 
 
 <pre class="code">(<a href="COMMON-LISP____LET_A2.html">let*</a> ((x (<a href="COMMON-LISP_____A2.html">*</a> x x))
       (y (<a href="COMMON-LISP_____A2.html">*</a> 2 x)))
 (<a href="COMMON-LISP____LIST.html">list</a> x y))</pre> 
 
 <p>is evaluated when the global value of <span class="v">x</span> is <span class="v">-2</span>, then the result is 
 <span class="v">'(4 8)</span>, because the local value of <span class="v">y</span> is computed after <span class="v">x</span> has 
 been bound to <span class="v">4</span>.  <span class="tt"><a href="COMMON-LISP____LET_A2.html">Let*</a></span> binds its local variables 
 ``sequentially.''</p> 
 
 <p>General <span class="v">let</span> forms</p> 
 <pre class="code">(<a href="COMMON-LISP____LET.html">let</a> ((var1 term1) ... (varn termn)) body)
and
(<a href="COMMON-LISP____LET.html">let</a> ((var1 term1) ... (varn termn))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> ...) ... (<a href="COMMON-LISP____DECLARE.html">declare</a> ...)
 body)</pre> 
 
 <p>where the <span class="v">vari</span> are distinct variables, the <span class="v">termi</span> are terms 
 involving only variables bound in the environment containing the <span class="v">let</span>, and 
 <span class="v">body</span> is a term involving only the <span class="v">vari</span> plus the variables bound in 
 the environment containing the <span class="v">let</span>.  Each <span class="v">vari</span> must be used in 
 <span class="v">body</span> or else <a href="COMMON-LISP____DECLARE.html">declare</a>d ignored.  In ACL2 the only <span class="tt"><a href="COMMON-LISP____DECLARE.html">declare</a></span> 
forms allowed for a <span class="v">let</span> form are  <span class="v">ignore</span>, <span class="v">ignorable</span>, and 
<span class="v">type</span>.  See <a href="COMMON-LISP____DECLARE.html">declare</a>.</p> 
 
 <p>A <span class="v">let</span> form is evaluated by first evaluating each of the <span class="v">termi</span>, 
 obtaining for each a <span class="v">vali</span>.  Then, each <span class="v">vari</span> is bound to the 
 corresponding <span class="v">vali</span> and <span class="v">body</span> is evaluated.</p> 
 
 <p>Actually, <span class="v">let</span> forms are just abbreviations for certain uses of 
 <span class="v">lambda</span> notation.  In particular</p> 
 
 <pre class="code">(<a href="COMMON-LISP____LET.html">let</a> ((var1 term1) ... (varn termn)) (<a href="COMMON-LISP____DECLARE.html">declare</a> ...) body)</pre> 
 
 <p>is equivalent to</p> 
 
 <pre class="code">((<a href="COMMON-LISP____LAMBDA.html">lambda</a> (var1 ... varn)
   (<a href="COMMON-LISP____DECLARE.html">declare</a> ...)
   body)
 term1 ... termn).</pre> 
 
 <p><span class="tt"><a href="COMMON-LISP____LET_A2.html">Let*</a></span> forms are used when it is desired to bind the <span class="v">vari</span> 
 sequentially, i.e., when the local values of preceding <span class="v">varj</span> are to be 
 used in the computation of the local value for <span class="v">vari</span>.</p> 
 
 <p>General <span class="v">let*</span> forms:</p> 
 <pre class="code">(<a href="COMMON-LISP____LET_A2.html">let*</a> ((var1 term1) ... (varn termn)) body)
and
(<a href="COMMON-LISP____LET_A2.html">let*</a> ((var1 term1) ... (varn termn))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORE.html">ignore</a> x1 ... xm))
 body)</pre> 
 
 <p>where the <span class="v">vari</span> are variables (not necessarily distinct), the 
 <span class="v">termi</span> are terms involving only variables bound in the environment 
 containing the <span class="tt"><a href="COMMON-LISP____LET_A2.html">let*</a></span> and those <span class="v">varj</span> such that <span class="v">j&lt;i</span>, and 
 <span class="v">body</span> is a term involving only the <span class="v">vari</span> plus the variables bound in 
 the environment containing the <span class="tt"><a href="COMMON-LISP____LET_A2.html">let*</a></span>.  Each <span class="v">vari</span> must be used 
 either in some subsequent <span class="v">termj</span> or in <span class="v">body</span>, except that in the 
 second form above we make an exception when <span class="v">vari</span> is among the <span class="v">xk</span>, in 
 which case <span class="v">vari</span> must not be thus used.  Note that <span class="tt"><a href="COMMON-LISP____LET_A2.html">let*</a></span> does not 
 permit the inclusion of any <span class="tt"><a href="COMMON-LISP____DECLARE.html">declare</a></span> forms other than one as shown 
 above.  In the second general form above, every <span class="v">xk</span> must be among the 
 <span class="v">vari</span>, and furthermore, <span class="v">xk</span> may not equal <span class="v">vari</span> and <span class="v">varj</span> for 
 distinct <span class="v">i</span>, <span class="v">j</span>.</p> 
 
 <p>The first <span class="tt"><a href="COMMON-LISP____LET_A2.html">let*</a></span> above is equivalent to</p> 
 
 <pre class="code">(<a href="COMMON-LISP____LET.html">let</a> ((var1 term1))
 ...
 (<a href="COMMON-LISP____LET.html">let</a> ((varn termn)) body)...)</pre> 
 
 <p>Thus, the <span class="v">termi</span> are evaluated successively and after each evaluation 
 the corresponding <span class="v">vari</span> is bound to the value of <span class="v">termi</span>.  The second 
 <span class="tt"><a href="COMMON-LISP____LET_A2.html">let*</a></span> is similarly expanded, except that each for each <span class="v">vari</span> that 
 is among the <span class="v">(x1 ... xm)</span>, the form <span class="v">(<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORE.html">ignore</a> vari))</span> is 
 inserted immediately after <span class="v">((vari termi))</span>.</p> 
 
 <p>Each <span class="v">(vari termi)</span> pair in a <span class="v">let</span> or <span class="tt"><a href="COMMON-LISP____LET_A2.html">let*</a></span> form is called a 
 ``binding'' of <span class="v">vari</span> and the <span class="v">vari</span> are called the ``local variables'' 
 of the <span class="v">let</span> or <span class="tt"><a href="COMMON-LISP____LET_A2.html">let*</a></span>.  The common use of <span class="v">let</span> and <span class="tt"><a href="COMMON-LISP____LET_A2.html">let*</a></span> 
 is to save the values of certain expressions (the <span class="v">termi</span>) so that they may 
 be referenced several times in the body without suggesting their 
 recomputation.</p> 
 
 <p><span class="v">Let</span> is part of Common Lisp.  See any Common Lisp documentation for 
 more information.</p>
</body>
</html>
