<html>
<head>
<meta charset="UTF-8">
<title>Write-object</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=C____WRITE-OBJECT">Click for Write-object in the Full Manual</a></h3>

<p>Write an object in the computation state.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(write-object objdes val compst) → new-compst</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">objdes</span> — <font color="#606060">Guard <span class="v">(<a href="C____OBJDESIGNP.html">objdesignp</a> objdes)</span>.</font>
</dd> 
  <dd>
<span class="tt">val</span> — <font color="#606060">Guard <span class="v">(<a href="C____VALUEP.html">valuep</a> val)</span>.</font>
</dd> 
  <dd>
<span class="tt">compst</span> — <font color="#606060">Guard <span class="v">(<a href="C____COMPUSTATEP.html">compustatep</a> compst)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">new-compst</span> — <font color="#606060">Type <span class="v">(<a href="C____COMPUSTATE-RESULTP.html">compustate-resultp</a> new-compst)</span>.</font>
</dd> 
 
</dl></div> 
<p>If the object designator is an address, 
     we check whether the heap has an object at the address, 
     of the same type as the new object 
     (note that, for arrays, the type includes the number of elements). 
     If this checks succeed, we overwrite the object in the heap.</p><p>Otherwise, 
     we retrieve the super-object, 
     and we update its element or member, 
     provided that the super-object is of the right kind. 
     Then we recursively write the updated super-object.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>write-object</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 write-object (objdes val compst)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="C____OBJDESIGNP.html">objdesignp</a> objdes)
                             (<a href="C____VALUEP.html">valuep</a> val)
                             (<a href="C____COMPUSTATEP.html">compustatep</a> compst))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'write-object))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="C____OBJDESIGN-CASE.html">objdesign-case</a>
      objdes
      :address (<a href="ACL2____B_A2.html">b*</a> ((addr objdes.get)
                    (<a href="C____HEAP.html">heap</a> (<a href="C____COMPUSTATE-_E3HEAP.html">compustate-&gt;heap</a> compst))
                    (addr+obj (<a href="OMAP____IN.html">omap::in</a> addr heap))
                    ((unless (<a href="COMMON-LISP____CONSP.html">consp</a> addr+obj))
                     (<a href="C____ERROR.html">error</a> (<a href="COMMON-LISP____LIST.html">list</a> :address-not-found addr)))
                    (obj (<a href="COMMON-LISP____CDR.html">cdr</a> addr+obj))
                    ((unless (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="C____TYPE-OF-VALUE.html">type-of-value</a> val)
                                    (<a href="C____TYPE-OF-VALUE.html">type-of-value</a> obj)))
                     (<a href="C____ERROR.html">error</a> (<a href="COMMON-LISP____LIST.html">list</a> :write-object-mistype
                                  :old (<a href="C____TYPE-OF-VALUE.html">type-of-value</a> obj)
                                  :new (<a href="C____TYPE-OF-VALUE.html">type-of-value</a> val))))
                    (new-heap (<a href="OMAP____UPDATE.html">omap::update</a> addr (<a href="C____VALUE-FIX.html">value-fix</a> val)
                                            heap))
                    (new-compst (<a href="C____CHANGE-COMPUSTATE.html">change-compustate</a> compst
                                                   :heap new-heap)))
                   new-compst)
      :element
      (<a href="ACL2____B_A2.html">b*</a> ((super (<a href="C____READ-OBJECT.html">read-object</a> objdes.super compst))
           ((when (<a href="C____ERRORP.html">errorp</a> super)) super)
           ((unless (<a href="C____VALUE-CASE.html">value-case</a> super :array))
            (<a href="C____ERROR.html">error</a> (<a href="COMMON-LISP____LIST.html">list</a> :objdesign-mismatch (<a href="C____OBJDESIGN-FIX.html">objdesign-fix</a> objdes)
                         :required :array
                         :supplied super)))
           (new-super (<a href="C____VALUE-ARRAY-WRITE.html">value-array-write</a> objdes.index val super))
           ((when (<a href="C____ERRORP.html">errorp</a> new-super)) new-super))
          (<a href="C____WRITE-OBJECT.html">write-object</a> objdes.super new-super compst))
      :member
      (<a href="ACL2____B_A2.html">b*</a> ((super (<a href="C____READ-OBJECT.html">read-object</a> objdes.super compst))
           ((when (<a href="C____ERRORP.html">errorp</a> super)) super)
           ((unless (<a href="C____VALUE-CASE.html">value-case</a> super :struct))
            (<a href="C____ERROR.html">error</a> (<a href="COMMON-LISP____LIST.html">list</a> :objdesign-mismatch (<a href="C____OBJDESIGN-FIX.html">objdesign-fix</a> objdes)
                         :required :struct
                         :supplied super)))
           (new-super (<a href="C____VALUE-STRUCT-WRITE.html">value-struct-write</a> objdes.name val super))
           ((when (<a href="C____ERRORP.html">errorp</a> new-super)) new-super))
          (<a href="C____WRITE-OBJECT.html">write-object</a> objdes.super new-super compst)))))</pre> 
<p><b>Theorem: </b>compustate-resultp-of-write-object</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> compustate-resultp-of-write-object
        (<a href="ACL2____B_A2.html">b*</a> ((new-compst (<a href="C____WRITE-OBJECT.html">write-object</a> objdes val compst)))
            (<a href="C____COMPUSTATE-RESULTP.html">compustate-resultp</a> new-compst))
        :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>compustate-frames-number-of-write-object</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> compustate-frames-number-of-write-object
        (<a href="ACL2____B_A2.html">b*</a> ((?new-compst (<a href="C____WRITE-OBJECT.html">write-object</a> objdes val compst)))
            (<a href="ACL2____IMPLIES.html">implies</a> (<a href="C____COMPUSTATEP.html">compustatep</a> new-compst)
                     (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="C____COMPUSTATE-FRAMES-NUMBER.html">compustate-frames-number</a> new-compst)
                            (<a href="C____COMPUSTATE-FRAMES-NUMBER.html">compustate-frames-number</a> compst)))))</pre> 
<p><b>Theorem: </b>compustate-scopes-numbers-of-write-object</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> compustate-scopes-numbers-of-write-object
        (<a href="ACL2____B_A2.html">b*</a> ((?new-compst (<a href="C____WRITE-OBJECT.html">write-object</a> objdes val compst)))
            (<a href="ACL2____IMPLIES.html">implies</a> (<a href="C____COMPUSTATEP.html">compustatep</a> new-compst)
                     (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="C____COMPUSTATE-SCOPES-NUMBERS.html">compustate-scopes-numbers</a> new-compst)
                            (<a href="C____COMPUSTATE-SCOPES-NUMBERS.html">compustate-scopes-numbers</a> compst)))))</pre> 
<p><b>Theorem: </b>write-object-of-objdesign-fix-objdes</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> write-object-of-objdesign-fix-objdes
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="C____WRITE-OBJECT.html">write-object</a> (<a href="C____OBJDESIGN-FIX.html">objdesign-fix</a> objdes)
                             val compst)
               (<a href="C____WRITE-OBJECT.html">write-object</a> objdes val compst)))</pre> 
<p><b>Theorem: </b>write-object-objdesign-equiv-congruence-on-objdes</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> write-object-objdesign-equiv-congruence-on-objdes
        (<a href="ACL2____IMPLIES.html">implies</a> (<a href="C____OBJDESIGN-EQUIV.html">objdesign-equiv</a> objdes objdes-equiv)
                 (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="C____WRITE-OBJECT.html">write-object</a> objdes val compst)
                        (<a href="C____WRITE-OBJECT.html">write-object</a> objdes-equiv val compst)))
        :rule-classes :congruence)</pre> 
<p><b>Theorem: </b>write-object-of-value-fix-val</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> write-object-of-value-fix-val
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="C____WRITE-OBJECT.html">write-object</a> objdes (<a href="C____VALUE-FIX.html">value-fix</a> val)
                             compst)
               (<a href="C____WRITE-OBJECT.html">write-object</a> objdes val compst)))</pre> 
<p><b>Theorem: </b>write-object-value-equiv-congruence-on-val</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> write-object-value-equiv-congruence-on-val
        (<a href="ACL2____IMPLIES.html">implies</a> (<a href="C____VALUE-EQUIV.html">value-equiv</a> val val-equiv)
                 (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="C____WRITE-OBJECT.html">write-object</a> objdes val compst)
                        (<a href="C____WRITE-OBJECT.html">write-object</a> objdes val-equiv compst)))
        :rule-classes :congruence)</pre> 
<p><b>Theorem: </b>write-object-of-compustate-fix-compst</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> write-object-of-compustate-fix-compst
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="C____WRITE-OBJECT.html">write-object</a> objdes val (<a href="C____COMPUSTATE-FIX.html">compustate-fix</a> compst))
               (<a href="C____WRITE-OBJECT.html">write-object</a> objdes val compst)))</pre> 
<p><b>Theorem: </b>write-object-compustate-equiv-congruence-on-compst</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> write-object-compustate-equiv-congruence-on-compst
        (<a href="ACL2____IMPLIES.html">implies</a> (<a href="C____COMPUSTATE-EQUIV.html">compustate-equiv</a> compst compst-equiv)
                 (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="C____WRITE-OBJECT.html">write-object</a> objdes val compst)
                        (<a href="C____WRITE-OBJECT.html">write-object</a> objdes val compst-equiv)))
        :rule-classes :congruence)</pre> 

</body>
</html>
