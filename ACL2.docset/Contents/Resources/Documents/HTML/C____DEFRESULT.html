<html>
<head>
<meta charset="UTF-8">
<title>Defresult</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=C____DEFRESULT">Click for Defresult in the Full Manual</a></h3>

<p>Introduce a fixtype of result types.</p><p>This is a flat sum of the specified fixtype 
     and the error fixtype. 
     Thus, the specified fixtype must be disjoint from the error fixtype, 
     which is easily satisfied if values of the specified fixtype 
     do not start with <span class="v">:error</span>.</p><p>We also generate a theorem to conclude that a value is of the original type 
     when it is of the new type and not an error. 
     We disable it by default so that 
     we do not always backchain to the result type 
     when trying to prove the base type, 
     in contexts where the result type is not used at all.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>defresult-fn</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 defresult-fn
 (<a href="C____TYPE.html">type</a> desc name enable wrld)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="ACL2____PLIST-WORLDP.html">plist-worldp</a> wrld)))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'defresult-fn))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
   ((fty-table (fty::get-fixtypes-alist wrld))
    (fty-info (fty::find-fixtype type fty-table))
    (<a href="C____TYPEP.html">typep</a> (fty::fixtype-&gt;pred fty-info))
    (name (<a href="COMMON-LISP____OR.html">or</a> name type))
    (name-result (<a href="ACL2____ADD-SUFFIX.html">add-suffix</a> name "-RESULT"))
    (name-resultp (<a href="ACL2____ADD-SUFFIX.html">add-suffix</a> name "-RESULTP"))
    (short (<a href="STR____CAT.html">str::cat</a> "Fixtype of " desc " and errors."))
    (typep-when-name-resultp-and-not-errorp
         (<a href="ACL2____PACKN-POS.html">packn-pos</a> (<a href="COMMON-LISP____LIST.html">list</a> typep '-when-
                          name-resultp '-and-not-errorp)
                    name)))
   (<a href="COMMON-LISP____CONS.html">cons</a>
    'encapsulate
    (<a href="COMMON-LISP____CONS.html">cons</a>
     'nil
     (<a href="COMMON-LISP____CONS.html">cons</a>
      (<a href="COMMON-LISP____CONS.html">cons</a>
       'fty::defflatsum
       (<a href="COMMON-LISP____CONS.html">cons</a>
        name-result
        (<a href="COMMON-LISP____CONS.html">cons</a>
         ':short
         (<a href="COMMON-LISP____CONS.html">cons</a>
          short
          (<a href="COMMON-LISP____CONS.html">cons</a>
           (<a href="COMMON-LISP____CONS.html">cons</a> ':ok (<a href="COMMON-LISP____CONS.html">cons</a> type 'nil))
           (<a href="COMMON-LISP____CONS.html">cons</a>
            '(:err error)
            (<a href="COMMON-LISP____CONS.html">cons</a>
             ':pred
             (<a href="COMMON-LISP____CONS.html">cons</a>
              name-resultp
              (<a href="COMMON-LISP____AND.html">and</a>
               enable
               (<a href="COMMON-LISP____CONS.html">cons</a>
                ':prepwork
                (<a href="COMMON-LISP____CONS.html">cons</a>
                 (<a href="COMMON-LISP____CONS.html">cons</a>
                  (<a href="COMMON-LISP____CONS.html">cons</a>
                   'defrulel
                   (<a href="COMMON-LISP____CONS.html">cons</a>
                    'disjoint
                    (<a href="COMMON-LISP____CONS.html">cons</a>
                     (<a href="COMMON-LISP____CONS.html">cons</a>
                      'implies
                      (<a href="COMMON-LISP____CONS.html">cons</a>
                          '(<a href="C____ERRORP.html">errorp</a> x)
                          (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CONS.html">cons</a> 'not
                                      (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CONS.html">cons</a> typep '(x)) 'nil))
                                'nil)))
                     (<a href="COMMON-LISP____CONS.html">cons</a> ':enable (<a href="COMMON-LISP____CONS.html">cons</a> enable 'nil)))))
                  'nil)
                 'nil)))))))))))
      (<a href="COMMON-LISP____CONS.html">cons</a>
       (<a href="COMMON-LISP____CONS.html">cons</a>
        'defruled
        (<a href="COMMON-LISP____CONS.html">cons</a> typep-when-name-resultp-and-not-errorp
              (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CONS.html">cons</a> 'implies
                          (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CONS.html">cons</a> 'and
                                      (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CONS.html">cons</a> name-resultp '(x))
                                            '((<a href="COMMON-LISP____NOT.html">not</a> (<a href="C____ERRORP.html">errorp</a> x)))))
                                (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CONS.html">cons</a> typep '(x)) 'nil)))
                    (<a href="COMMON-LISP____CONS.html">cons</a> ':enable
                          (<a href="COMMON-LISP____CONS.html">cons</a> name-resultp 'nil)))))
       'nil)))))))</pre> 

</body>
</html>
