<html>
<head>
<meta charset="UTF-8">
<title>File-kind</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=OSLIB____FILE-KIND">Click for File-kind in the Full Manual</a></h3>

<p>See what kind of file a path refers to.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(file-kind path &amp;key (follow-symlinks 't) (state 'state)) 
   
(mv err ans new-state)</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">path</span>  The path to test.<br><font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____STRINGP.html">stringp</a> path)</span>.</font>
</dd> 
  <dd>
<span class="tt">follow-symlinks</span>  <font color="#606060">Guard <span class="v">(<a href="ACL2____BOOLEANP.html">booleanp</a> follow-symlinks)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">err</span>  NIL on success, or an error <a href="ACL2____MSG.html">msg</a> on failure.</dd> 
<dd>
<span class="tt">ans</span>  On success: the kind of file.<br><font color="#606060">Type <span class="v">(<a href="OSLIB____FILE-KIND-P.html">file-kind-p</a> ans)</span>.</font>
</dd> 
<dd>
<span class="tt">new-state</span>  <font color="#606060">Type <span class="v">(state-p1 new-state)</span>, given <span class="v">(<a href="ACL2____FORCE.html">force</a> (state-p1 state))</span>.</font>
</dd> 
 
</dl></div> 
<p>We check whether <span class="v">path</span> exists.  If so, we determine what kind 
of file it is.</p> 
 
<p>This is complicated by symbolic links.  You can control how symlinks are 
handled using <span class="v">:follow-symlinks</span>.</p> 
 
<p>By default, <span class="v">:follow-symlinks</span> is <span class="v">t</span>.  In this case, the idea is to 
tell you what kind of file is ultimately pointed to after resolving all the 
symlinks.  Since we are following all links, we will never return 
<span class="v">:symbolic-link</span> in this case.  However, we may return 
<span class="v">:broken-symbolic-link</span> if there is a problem following the symlinks.</p> 
 
<p>For finer-grained handling of symlinks, you can set <span class="v">:follow-symlinks</span> to 
<span class="v">nil</span>.  In this case, we return <span class="v">:symbolic-link</span> for all symbolic links, 
no matter whether they are valid or broken.  Unless you're doing something very 
fancy with symlinks, this is almost surely not what you want.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>file-kind-fn</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> file-kind-fn
       (path follow-symlinks state)
       (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :stobjs (<a href="ACL2____STATE.html">state</a>)))
       (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____STRINGP.html">stringp</a> path)
                                   (<a href="ACL2____BOOLEANP.html">booleanp</a> follow-symlinks))))
       (<a href="COMMON-LISP____LET.html">let</a> ((__function__ 'file-kind))
            (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
            (<a href="ACL2____B_A2.html">b*</a> ((<a href="COMMON-LISP____-.html">-</a> (<a href="ACL2____RAISE.html">raise</a> "Raw Lisp definition not installed?"))
                 ((<a href="ACL2____MV.html">mv</a> &amp; err state)
                  (<a href="ACL2____READ-ACL2-ORACLE.html">read-acl2-oracle</a> state))
                 ((<a href="ACL2____MV.html">mv</a> &amp; ans state)
                  (<a href="ACL2____READ-ACL2-ORACLE.html">read-acl2-oracle</a> state)))
                (<a href="ACL2____MV.html">mv</a> err (<a href="COMMON-LISP____IF.html">if</a> (<a href="OSLIB____FILE-KIND-P.html">file-kind-p</a> ans) ans nil)
                    state))))</pre> 
<p><b>Theorem: </b>file-kind-p-of-file-kind.ans</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> file-kind-p-of-file-kind.ans
        (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?err ?ans ?new-state)
              (file-kind-fn path follow-symlinks state)))
            (<a href="OSLIB____FILE-KIND-P.html">file-kind-p</a> ans))
        :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>state-p1-of-file-kind.new-state</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> state-p1-of-file-kind.new-state
        (<a href="ACL2____IMPLIES.html">implies</a> (<a href="ACL2____FORCE.html">force</a> (state-p1 state))
                 (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?err ?ans ?new-state)
                       (file-kind-fn path follow-symlinks state)))
                     (state-p1 new-state)))
        :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>type-of-file-kind.ans</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> type-of-file-kind.ans
        (<a href="COMMON-LISP____LET.html">let</a> ((ans (<a href="ACL2____MV-NTH.html">mv-nth</a> 1 (<a href="OSLIB____FILE-KIND.html">file-kind</a> path))))
             (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> ans) (<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> ans t))))
        :rule-classes :type-prescription)</pre> 
<p><b>Theorem: </b>w-state-of-file-kind</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> w-state-of-file-kind
        (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?err ?ans ?new-state)
              (file-kind-fn path follow-symlinks state)))
            (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ACL2____W.html">w</a> new-state) (<a href="ACL2____W.html">w</a> state))))</pre> 

</body>
</html>
