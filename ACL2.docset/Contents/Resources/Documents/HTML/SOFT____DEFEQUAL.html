<html>
<head>
<meta charset="UTF-8">
<title>Defequal</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=SOFT____DEFEQUAL">Click for Defequal in the Full Manual</a></h3>

<p>Introduce an equality between functions.</p><h3>Introduction</h3><p>In a first-order language like the one of ACL2, 
      a second-order equality (i.e. an equality between two functions) 
      cannot be expressed directly as a second-order assertion of the form</p><pre class="code">(<a href="COMMON-LISP____EQUAL.html">equal</a> f g)</pre><p>but it can be expressed as a first-order assertion of the form</p><pre class="code">(<a href="ACL2____FORALL.html">forall</a> (x1 ... xn) (<a href="COMMON-LISP____EQUAL.html">equal</a> (f x1 ... xn) (g x1 ... xn)))</pre><p>This macro generates such expression of equality, 
      as a <span class="tt"><a href="SOFT____DEFUN-SK2.html">defun-sk2</a></span>, 
      which already includes a rewrite rule from <span class="v">f</span> to <span class="v">g</span>; 
      the macro also generates an rewrite rule from <span class="v">g</span> to <span class="v">f</span>. 
      It also generates a theory invariant 
      preventing both rewrite rules from being simultaneously enabled.</p><p>Thus, this macro automates the boilerplate of function equalities, 
      and provides some support for reasoning about them. 
      This macro may be extended with additional reasoning support.</p><h3>General Form</h3><pre class="code">(<a href="SOFT____DEFEQUAL.html">defequal</a> name
          :left ...                  ; no default
          :right ...                 ; no default
          :vars ...                  ; default :auto
          :enable ...                ; default nil
          :verify-guards ...         ; default t
          :left-to-right-name ...    ; default :auto
          :left-to-right-enable ...  ; default nil
          :right-to-left-name ...    ; default :auto
          :right-to-left-enable ...  ; default nil
          :print ...                 ; default :result
          :show-only ...             ; default nil
  )</pre><h3>Inputs</h3><p><span class="v">name</span></p><blockquote>
<p>Specifies the name of the generated function.</p>
<p>It must be a symbol.</p>
<p>In the rest of this documentation page, 
       let <span class="v">name</span> be the name of this function.</p>
</blockquote><p><span class="v">:left</span> — no default<br><span class="v">:right</span> — no default</p><blockquote>
<p>Specify the functions to use as 
       the left-hand and right-hand sides of the equality.</p>
<p>Each must be an existing function symbol. 
       It may be a SOFT function variable, 
       a SOFT second-order function, 
       a regular first-order function, 
       etc.</p>
<p>The two functions must have the same arity, 
       which must not be 0.</p>
<p>At least one of the two functions must 
       be a function variable or a second-order function.</p>
<p>If the <span class="v">:verify-guards</span> input (see below) is <span class="v">t</span>, 
       the two functions must have guard <span class="v">t</span> and be guard-verified. 
       Support for more general guards may be added in the future.</p>
<p>In the rest of this documentation page, 
       let <span class="v">left</span> and <span class="v">right</span> be the names of these functions, 
       and let <span class="v">n</span> be their arity.</p>
</blockquote><p><span class="v">:vars</span> — default <span class="v">:auto</span></p><blockquote>
<p>Specifies the variables to use in the quantification.</p>
<p>It must be one of the following:</p>
<ul>
<li>A list of distinct symbols that are legal variables. 
        Its length must be <span class="v">n</span>.</li>
<li>
<span class="v">:auto</span>, to use the list of symbols <span class="v">(x1 ... xn)</span>, 
        all in the same package as <span class="v">name</span>.</li>
</ul>
<p>In the rest of this documentation page, 
       let <span class="v">x1</span>, ..., <span class="v">xn</span> be these variables.</p>
</blockquote><p><span class="v">:enable</span> — default <span class="v">nil</span>.</p><blockquote>
<p>Specifies whether <span class="v">name</span> should be enabled.</p>
<p>It must be one of the following:</p>
<ul>
<li>
<span class="v">t</span>, to enable it.</li>
<li>
<span class="v">nil</span>, to disable it.</li>
</ul>
</blockquote><p><span class="v">:verify-guards</span> — default <span class="v">t</span>.</p><blockquote>
<p>Specifies whether <span class="v">name</span> should be guard-verified.</p>
<p>It must be one of the following:</p>
<ul>
<li>
<span class="v">t</span>, to guard-verify it.</li>
<li>
<span class="v">nil</span>, to not guard-verify it.</li>
</ul>
<p>Unless both <span class="v">left</span> and <span class="v">right</span> have guard <span class="v">t</span>, 
       this should be set to <span class="v">nil</span>.</p>
</blockquote><p><span class="v">:left-to-right-name</span> — default <span class="v">:auto</span></p><blockquote>
<p>Specifies the name of the theorem 
       that rewrites <span class="v">left</span> to <span class="v">right</span>.</p>
<p>It must be one of the following:</p>
<ul>
<li>
<span class="v">:auto</span>, to use the name obtained by concatenating 
        the name of <span class="v">left</span>, `<span class="v">-to-</span>', and the name of <span class="v">right</span>, 
        in the same package as <span class="v">name</span>.</li>
<li>Any other symbol, to use as the name of the theorem.</li>
</ul>
<p>In the rest of this documentation page, 
       let <span class="v">left-to-right</span> be the name of this theorem.</p>
</blockquote><p><span class="v">:left-to-right-enable</span> — default <span class="v">nil</span>.</p><blockquote>
<p>Specifies whether <span class="v">left-to-right</span> should be enabled.</p>
<p>It must be one of the following:</p>
<ul>
<li>
<span class="v">t</span>, to enable it.</li>
<li>
<span class="v">nil</span>, to disable it.</li>
</ul>
<p>If this is <span class="v">t</span>, <span class="v">:right-to-left-enable</span> must be <span class="v">nil</span>.</p>
</blockquote><p><span class="v">:right-to-left-name</span> — default <span class="v">:auto</span></p><blockquote>
<p>Specifies the name of the theorem 
       that rewrites <span class="v">left</span> to <span class="v">right</span>.</p>
<p>It must be one of the following:</p>
<ul>
<li>
<span class="v">:auto</span>, to use the name obtained by concatenating 
        the name of <span class="v">left</span>, `<span class="v">-to-</span>', and the name of <span class="v">right</span>, 
        in the same package as <span class="v">name</span>.</li>
<li>Any other symbol, to use as the name of the theorem.</li>
</ul>
<p>In the rest of this documentation page, 
       let <span class="v">right-to-left</span> be the name of this theorem.</p>
</blockquote><p><span class="v">:right-to-left-enable</span> — default <span class="v">nil</span>.</p><blockquote>
<p>Specifies whether <span class="v">right-to-left</span> should be enabled.</p>
<p>It must be one of the following:</p>
<ul>
<li>
<span class="v">t</span>, to enable it.</li>
<li>
<span class="v">nil</span>, to disable it.</li>
</ul>
<p>If this is <span class="v">t</span>, <span class="v">:left-to-right-enable</span> must be <span class="v">nil</span>.</p>
</blockquote><p><span class="v">:print</span> — default <span class="v">:result</span></p><blockquote>
<p>Specifies what is printed on the screen 
        (see <a href="ACL2____EVENT-MACRO-SCREEN-PRINTING.html">ACL2::event-macro-screen-printing</a>).</p>
<p>It must be one of the following:</p>
<ul>
<li>
<span class="v">nil</span>, to print nothing (not even error output).</li>
<li>
<span class="v">:error</span>, to print only error output (if any).</li>
<li>
<span class="v">:result</span>, to print, besides any error output, 
         also the <a href="ACL2____EVENT-MACRO-RESULTS.html">results</a> of <span class="v">defequal</span>. 
         This is the default value of the <span class="v">:print</span> input.</li>
<li>
<span class="v">:info</span>, to print, 
         besides any error output and the results, 
         also some additional information about 
         the internal operations of <span class="v">defequal</span>.</li>
<li>
<span class="v">:all</span>, to print, 
         besides any error output, 
         the results, 
         and the additional information, 
         also ACL2's output in response to all the submitted events.</li>
</ul>
<p>If the call of <span class="v">defequal</span> is redundant, 
        an indication to that effect is printed on the screen, 
        unless <span class="v">:print</span> is <span class="v">nil</span>.</p>
</blockquote><p><span class="v">:show-only</span> — default <span class="v">nil</span></p><blockquote>
<p>Determines whether the event expansion of <span class="v">defequal</span> is submitted to ACL2 or just printed on the screen:</p>
<ul>
<li>
<span class="v">nil</span>, to submit it.</li>
<li>
<span class="v">t</span>, to just print it. 
          In this case: 
          the event expansion is printed even if <span class="v">:print</span> is <span class="v">nil</span> 
          (because the user has explicitly asked to show the event expansion); 
          the resulting events are not re-printed separately 
          (other than their appearance in the printed event expansion) 
          even if <span class="v">:print</span> is <span class="v">:result</span> or <span class="v">:info</span> or <span class="v">:all</span>; 
          no ACL2 output is printed for the event expansion 
          even if <span class="v">:print</span> is <span class="v">:all</span> 
          (because the event expansion is not submitted). 
          If the call of <span class="v">defequal</span> is redundant 
          (as defined in the `Redundancy' section), the event expansion generated by the existing call 
          is printed.</li>
</ul>
</blockquote><h3>Generated Events</h3><p><span class="v">name</span></p><blockquote>
<p>Function that expresses the equality of <span class="v">left</span> and <span class="v">right</span>:</p>
<pre class="code">(<a href="SOFT____DEFUN-SK2.html">defun-sk2</a> name ()
  (<a href="ACL2____FORALL.html">forall</a> (x1 ... xn)
          (<a href="COMMON-LISP____EQUAL.html">equal</a> (left x1 ... xn)
                 (right x1 ... xn)))
  :rewrite :direct
  :thm-name left-to-right)</pre>
<p>Note the generation of <span class="v">left-to-right</span> as a direct rewrite rule. 
       See next item.</p>
</blockquote><p><span class="v">left-to-right</span></p><blockquote>
<p>Theorem that rewrites <span class="v">left</span> to <span class="v">right</span>:</p>
<pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> left-to-right
  (<a href="ACL2____IMPLIES.html">implies</a> (name)
           (<a href="COMMON-LISP____EQUAL.html">equal</a> (left x1 ... xn)
                  (right x1 ... xn))))</pre>
<p>This is generated by the <span class="tt"><a href="SOFT____DEFUN-SK2.html">defun-sk2</a></span>. 
       See previous item.</p>
</blockquote><p><span class="v">right-to-left</span></p><blockquote>
<p>Theorem that rewrites <span class="v">right</span> to <span class="v">left</span>:</p>
<pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> right-to-left
  (<a href="ACL2____IMPLIES.html">implies</a> (name)
           (<a href="COMMON-LISP____EQUAL.html">equal</a> (right x1 ... xn)
                  (left x1 ... xn))))</pre>
<p>This is generated by the <span class="tt"><a href="SOFT____DEFUN-SK2.html">defun-sk2</a></span>. 
       See previous item.</p>
</blockquote><h3>Redundancy</h3><p>A call of <span class="v">defequal</span> is redundant if and only if 
         it is identical to a previous successful call of <span class="v">defequal</span> whose <span class="v">:show-only</span> input is not <span class="v">t</span>, 
         except that the two calls may differ in 
         their <span class="v">:print</span> and <span class="v">:show-only</span> inputs. 
         These inputs do not affect the generated events, 
         and thus they are ignored for the purpose of redundancy.</p><p>A call of <span class="v">defequal</span> whose <span class="v">:show-only</span> input is <span class="v">t</span> 
         does not generate any event. 
         Thus, no successive call may be redundant with such a call.</p>
</body>
</html>
