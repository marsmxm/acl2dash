<html>
<head>
<meta charset="UTF-8">
<title>Initialize-event-user</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____INITIALIZE-EVENT-USER">Click for Initialize-event-user in the Full Manual</a></h3>

<p>User-supplied code to initiate <a href="ACL2____EVENTS.html">events</a></p><p>This utility is intended for system hackers, not standard ACL2 
 users.</p> 
 
 <p>See <a href="ACL2____FINALIZE-EVENT-USER.html">finalize-event-user</a> to see how to supply code to be run at the 
 end of <a href="ACL2____EVENTS.html">events</a>.  We assume familiarity with <span class="v">finalize-event-user</span>; 
 here we focus on how to supply code for the beginning as well as the end of 
 events.</p> 
 
 <p>As with <a href="ACL2____FINALIZE-EVENT-USER.html">finalize-event-user</a>, you attach your own function of 
 argument list <span class="v">(<a href="ACL2____CTX.html">ctx</a> qbody state)</span> to <span class="v">initialize-event-user</span>.  (See 
 <a href="ACL2____FINALIZE-EVENT-USER.html">finalize-event-user</a> for discussion of <span class="v">ctx</span> and <span class="v">body</span>.)  The 
 attachment should return <span class="v">state</span> and have a trivial guard, requiring 
 (implicitly) only that <span class="v">state</span> satisfies <span class="v">state-p</span> unless you use trust 
 tags to avoid that requirement.  For example:</p> 
 
 <pre class="code">(<a href="ACL2____DEFATTACH-SYSTEM.html">defattach-system</a> initialize-event-user initialize-event-user-test)</pre> 
 
 <p>Why would you want to do this?  Presumably you are building a system on top 
 of ACL2 and you want to track your own data.  For example, suppose you want to 
 save the time in some <a href="ACL2____STATE.html">state</a> global variable, <span class="v">my-time</span>.  You could 
 do the following.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> my-init (<a href="ACL2____CTX.html">ctx</a> body state)
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :stobjs state
                  :guard-hints
                  (("Goal" :in-theory (<a href="ACL2____ENABLE.html">enable</a> read-run-time))))
           (<a href="COMMON-LISP____IGNORE.html">ignore</a> ctx body))
  (<a href="ACL2____MV-LET.html">mv-let</a> (seconds state)
          (<a href="ACL2____READ-RUN-TIME.html">read-run-time</a> state)
          (<a href="ACL2____F-PUT-GLOBAL.html">f-put-global</a> 'start-time seconds state)))

(<a href="COMMON-LISP____DEFUN.html">defun</a> my-final (<a href="ACL2____CTX.html">ctx</a> body state)
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :stobjs state
                  :guard-hints
                  (("Goal" :in-theory (<a href="ACL2____ENABLE.html">enable</a> read-run-time))))
           (<a href="COMMON-LISP____IGNORE.html">ignore</a> ctx body))
  (<a href="ACL2____MV-LET.html">mv-let</a> (seconds state)
          (<a href="ACL2____READ-RUN-TIME.html">read-run-time</a> state)
          (<a href="ACL2____PROG2_42.html">prog2$</a> (<a href="COMMON-LISP____IF.html">if</a> (boundp-global 'start-time state)
                      (<a href="ACL2____CW.html">cw</a> "Time: ~x0 seconds~%"
                          (<a href="COMMON-LISP____-.html">-</a> seconds (<a href="ACL2____FIX.html">fix</a> (<a href="ACL2_____04.html">@</a> start-time))))
                    (<a href="ACL2____CW.html">cw</a> "BIG SURPRISE!~%"))
                  (<a href="ACL2____F-PUT-GLOBAL.html">f-put-global</a> 'end-time seconds state))))

(<a href="ACL2____DEFATTACH-SYSTEM.html">defattach-system</a> initialize-event-user my-init)
(<a href="ACL2____DEFATTACH-SYSTEM.html">defattach-system</a> finalize-event-user my-final)</pre> 
 
 <p>Here is an abbreviated log, showing the time being printed at the end.</p> 
 
 <pre class="code">ACL2 !&gt;(<a href="ACL2____THM.html">thm</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="COMMON-LISP____APPEND.html">append</a> (<a href="COMMON-LISP____APPEND.html">append</a> x y) x y x y x y x y)
                   (<a href="COMMON-LISP____APPEND.html">append</a> x y x y x y x y x y)))

*1 (<a href="COMMON-LISP____THE.html">the</a> initial Goal, a key checkpoint) is pushed for proof by induction.
....
ACL2 Error in ( THM ...):  See :DOC failure.

******** FAILED ********
Time: 869/100 seconds
ACL2 !&gt;</pre>
</body>
</html>
