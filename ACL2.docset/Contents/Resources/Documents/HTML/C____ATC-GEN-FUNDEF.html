<html>
<head>
<meta charset="UTF-8">
<title>Atc-gen-fundef</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=C____ATC-GEN-FUNDEF">Click for Atc-gen-fundef in the Full Manual</a></h3>

<p>Generate a C function definition 
          from a non-recursive ACL2 function, with accompanying theorems.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(atc-gen-fundef fn prec-fns prec-tags 
                proofs prog-const init-fun-env-thm 
                fn-thms print names-to-avoid ctx state) 
 
  → 
(mv erp val state)</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">fn</span> — <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> fn)</span>.</font>
</dd> 
  <dd>
<span class="tt">prec-fns</span> — <font color="#606060">Guard <span class="v">(<a href="C____ATC-SYMBOL-FNINFO-ALISTP.html">atc-symbol-fninfo-alistp</a> prec-fns)</span>.</font>
</dd> 
  <dd>
<span class="tt">prec-tags</span> — <font color="#606060">Guard <span class="v">(<a href="C____ATC-STRING-TAGINFO-ALISTP.html">atc-string-taginfo-alistp</a> prec-tags)</span>.</font>
</dd> 
  <dd>
<span class="tt">proofs</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____BOOLEANP.html">booleanp</a> proofs)</span>.</font>
</dd> 
  <dd>
<span class="tt">prog-const</span> — <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> prog-const)</span>.</font>
</dd> 
  <dd>
<span class="tt">init-fun-env-thm</span> — <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> init-fun-env-thm)</span>.</font>
</dd> 
  <dd>
<span class="tt">fn-thms</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> fn-thms)</span>.</font>
</dd> 
  <dd>
<span class="tt">print</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____EVMAC-INPUT-PRINT-P.html">evmac-input-print-p</a> print)</span>.</font>
</dd> 
  <dd>
<span class="tt">names-to-avoid</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> names-to-avoid)</span>.</font>
</dd> 
  <dd>
<span class="tt">ctx</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____CTXP.html">ctxp</a> ctx)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">val</span> — A <span class="v">(tuple (<a href="C____FUNDEF.html">fundef</a> fundefp)
                                 (local-events pseudo-event-form-listp)
                                 (exported-events pseudo-event-form-listp)
                                 (updated-prec-fns atc-symbol-fninfo-alistp)
                                 (updated-names-to-avoid symbol-listp)
                                 val)</span>.</dd> 
 
</dl></div> 
<p>We return local and exported events for the theorems about 
     the correctness of the C function definition.</p><p>We extend the alist <span class="v">prec-fns</span> with information about the function.</p><p>We use the type of the value returned by the statement for the body 
     as the result type of the C function.</p><p>For the limit, we need 1 to go from <span class="tt"><a href="C____EXEC-FUN.html">exec-fun</a></span> to <span class="tt"><a href="C____EXEC-STMT.html">exec-stmt</a></span>, 
     another 1 from there to <span class="tt"><a href="C____EXEC-BLOCK-ITEM-LIST.html">exec-block-item-list</a></span> 
     in the <span class="v">:compound</span> case, 
     and then we use the limit for the block.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>atc-gen-fundef</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 atc-gen-fundef
 (fn prec-fns prec-tags
     proofs prog-const init-fun-env-thm
     fn-thms print names-to-avoid ctx state)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :stobjs (<a href="ACL2____STATE.html">state</a>)))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> fn)
                             (<a href="C____ATC-SYMBOL-FNINFO-ALISTP.html">atc-symbol-fninfo-alistp</a> prec-fns)
                             (<a href="C____ATC-STRING-TAGINFO-ALISTP.html">atc-string-taginfo-alistp</a> prec-tags)
                             (<a href="ACL2____BOOLEANP.html">booleanp</a> proofs)
                             (<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> prog-const)
                             (<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> init-fun-env-thm)
                             (<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> fn-thms)
                             (<a href="ACL2____EVMAC-INPUT-PRINT-P.html">evmac-input-print-p</a> print)
                             (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> names-to-avoid)
                             (<a href="ACL2____CTXP.html">ctxp</a> ctx))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'atc-gen-fundef))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
   ((name (<a href="COMMON-LISP____SYMBOL-NAME.html">symbol-name</a> fn))
    ((unless (<a href="C____IDENT-STRINGP.html">ident-stringp</a> name))
     (<a href="ACL2____ER-SOFT_B2.html">er-soft+</a>
      ctx t nil
      "The symbol name ~s0 of the function ~x1 ~
                   must be a portable ASCII C identifier, but it is not."
      name fn))
    ((<a href="ACL2____MV.html">mv</a> okp conflicting-fn)
     (<a href="C____ATC-CHECK-NEW-FUNCTION-NAME.html">atc-check-new-function-name</a> name prec-fns))
    ((when (<a href="COMMON-LISP____NOT.html">not</a> okp))
     (<a href="ACL2____ER-SOFT_B2.html">er-soft+</a>
      ctx t nil
      "The symbol name ~s0 of the function ~x1 ~
                   must be distinct from the symbol names of ~
                   the oher ACL2 functions translated to C functions, ~
                   but the function ~x2 has the same symbol name."
      name fn conflicting-fn))
    (wrld (<a href="ACL2____W.html">w</a> state))
    ((<a href="ACL2____ER.html">er</a> typed-formals)
     (<a href="C____ATC-TYPED-FORMALS.html">atc-typed-formals</a> fn prec-tags ctx state))
    ((<a href="ACL2____ER.html">er</a> params)
     (<a href="C____ATC-GEN-PARAM-DECLON-LIST.html">atc-gen-param-declon-list</a> typed-formals fn ctx state))
    (body (<a href="ACL2____UBODY_B2.html">ubody+</a> fn wrld))
    ((<a href="ACL2____ER.html">er</a> affect)
     (<a href="C____ATC-FIND-AFFECTED.html">atc-find-affected</a> fn
                        body typed-formals prec-fns ctx state))
    ((<a href="ACL2____ER.html">er</a> (<a href="COMMON-LISP____LIST.html">list</a> items type limit))
     (<a href="C____ATC-GEN-STMT.html">atc-gen-stmt</a> body nil (<a href="COMMON-LISP____LIST.html">list</a> typed-formals)
                   nil affect
                   fn prec-fns prec-tags proofs ctx state))
    ((when (<a href="COMMON-LISP____AND.html">and</a> (<a href="C____TYPE-CASE.html">type-case</a> type :void)
                (<a href="COMMON-LISP____NOT.html">not</a> affect)))
     (<a href="ACL2____VALUE.html">acl2::value</a>
      (<a href="ACL2____RAISE.html">raise</a>
       "Internal error: ~
                 the function ~x0 returns void and affects no variables."
       fn)))
    ((unless (<a href="COMMON-LISP____OR.html">or</a> (<a href="C____TYPE-INTEGERP.html">type-integerp</a> type)
                 (<a href="C____TYPE-CASE.html">type-case</a> type :void)))
     (<a href="ACL2____VALUE.html">acl2::value</a>
      (<a href="ACL2____RAISE.html">raise</a>
       "Internal error: ~
                 the function ~x0 has return type ~x1."
       fn type)))
    (id (<a href="C____MAKE-IDENT.html">make-ident</a> :name name))
    ((<a href="ACL2____MV.html">mv</a> tyspec &amp;)
     (<a href="C____IDENT_B2TYPE-TO-TYSPEC_B2DECLOR.html">ident+type-to-tyspec+declor</a> id type))
    (<a href="C____FUNDEF.html">fundef</a>
         (<a href="C____MAKE-FUNDEF.html">make-fundef</a> :tyspec tyspec
                      :declor (<a href="C____MAKE-FUN-DECLOR-BASE.html">make-fun-declor-base</a> :name id
                                                    :params params)
                      :body items))
    (finfo (<a href="C____FUN-INFO-FROM-FUNDEF.html">fun-info-from-fundef</a> fundef))
    (limit (<a href="COMMON-LISP____CONS.html">cons</a> 'binary-+
                 (<a href="COMMON-LISP____CONS.html">cons</a> ''2 (<a href="COMMON-LISP____CONS.html">cons</a> limit 'nil))))
    ((<a href="ACL2____MV.html">mv</a> local-events exported-events
         fn-fun-env-thm fn-result-thm
         fn-correct-thm names-to-avoid)
     (<a href="COMMON-LISP____IF.html">if</a>
      proofs
      (<a href="ACL2____B_A2.html">b*</a>
       (((<a href="ACL2____MV.html">mv</a> fn-fun-env-events
             fn-fun-env-thm names-to-avoid)
         (<a href="C____ATC-GEN-CFUN-FUN-ENV-THM.html">atc-gen-cfun-fun-env-thm</a>
              fn prog-const finfo
              init-fun-env-thm names-to-avoid wrld))
        ((<a href="ACL2____MV.html">mv</a> fn-result-events
             fn-result-thm names-to-avoid)
         (<a href="C____ATC-GEN-FN-RESULT-THM.html">atc-gen-fn-result-thm</a>
              fn type affect typed-formals
              prec-fns prec-tags names-to-avoid wrld))
        ((<a href="ACL2____MV.html">mv</a> fn-correct-local-events
             fn-correct-exported-events
             fn-correct-thm)
         (<a href="C____ATC-GEN-CFUN-CORRECT-THM.html">atc-gen-cfun-correct-thm</a>
              fn typed-formals type
              affect prec-fns prec-tags prog-const
              fn-thms fn-fun-env-thm limit wrld))
        (progress-start?
         (<a href="COMMON-LISP____AND.html">and</a>
             (<a href="ACL2____EVMAC-INPUT-PRINT-_E3_D3.html">evmac-input-print-&gt;=</a> print :info)
             (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CONS.html">cons</a> 'cw-event
                         (<a href="COMMON-LISP____CONS.html">cons</a> '"~%Generating the proofs for ~x0..."
                               (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CONS.html">cons</a> 'quote (<a href="COMMON-LISP____CONS.html">cons</a> fn 'nil))
                                     'nil)))
                   'nil)))
        (progress-end? (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____EVMAC-INPUT-PRINT-_E3_D3.html">evmac-input-print-&gt;=</a> print :info)
                            '((<a href="ACL2____CW-EVENT.html">cw-event</a> " done.~%"))))
        (local-events
             (<a href="COMMON-LISP____APPEND.html">append</a> progress-start?
                     fn-fun-env-events fn-result-events
                     fn-correct-local-events progress-end?))
        (exported-events fn-correct-exported-events))
       (<a href="ACL2____MV.html">mv</a> local-events exported-events
           fn-fun-env-thm fn-result-thm
           fn-correct-thm names-to-avoid))
      (<a href="ACL2____MV.html">mv</a> nil nil nil nil nil names-to-avoid)))
    (info (<a href="C____MAKE-ATC-FN-INFO.html">make-atc-fn-info</a> :out-type type
                            :in-types (<a href="ACL2____STRIP-CDRS.html">strip-cdrs</a> typed-formals)
                            :loop? nil
                            :affect affect
                            :result-thm fn-result-thm
                            :correct-thm fn-correct-thm
                            :measure-nat-thm nil
                            :fun-env-thm fn-fun-env-thm
                            :limit limit)))
   (<a href="ACL2____VALUE.html">acl2::value</a> (<a href="COMMON-LISP____LIST.html">list</a> fundef local-events
                      exported-events (<a href="COMMON-LISP____ACONS.html">acons</a> fn info prec-fns)
                      names-to-avoid)))))</pre> 

</body>
</html>
