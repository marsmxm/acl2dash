<html>
<head>
<meta charset="UTF-8">
<title>ACL2-pc::apply-linear</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2-PC____APPLY-LINEAR">Click for ACL2-pc::apply-linear in the Full Manual</a></h3>

<p>(primitive) 
apply a linear rule</p><pre class="code">Examples:
(apply-linear foo)
   -- apply the linear rule `foo'
(apply-linear (:linear foo))
   -- same as above
(apply-linear 2)
   -- apply the second linear rule, as displayed by show-linears
rewrite
   -- apply the first rewrite rule, as displayed by show-rewrites
(apply-linear foo ((y 7)))
   -- apply the linear rule foo with the substitution
      that associates 7 to the ``free variable'' y
(apply-linear foo ((x 2) (y 3)) t)
   -- apply the linear rule foo by substituting 2 and 3 for free
      variables x and y, respectively, and also binding all other
      free variables possible by using the current context
      (hypotheses and governors)

General Form:
(apply-linear &amp;optional rule-id substitution instantiate-free)</pre> 
 
 <p>Add a new top-level hypothesis by applying a <a href="ACL2____LINEAR.html">linear</a> rule to the 
 current subterm.  The new hypothesis will be created according to the 
 information provided by the <span class="v">show-linears</span> (<span class="v">sls</span>) command.</p> 
 
 <p>A short name for this command is <span class="v">al</span>.</p> 
 
 <p>We assume familiarity with the interactive <a href="ACL2____PROOF-BUILDER.html">proof-builder</a>'s 
 <span class="v">rewrite</span> (<span class="v">r</span>) command (see <a href="ACL2-PC____REWRITE.html">ACL2-pc::rewrite</a>).  In brief, the 
 <span class="v">apply-linear</span> command is an analogue of the <span class="v">rewrite</span> command, but for 
 <a href="ACL2____LINEAR.html">linear</a> rules in place of <a href="ACL2____REWRITE.html">rewrite</a> rules.  There is a significant 
 difference: for the <span class="v">apply-linear</span> command, instead of rewriting the 
 current subterm as is done by the <span class="v">rewrite</span> command, the conclusion of the 
 applicable linear rule, suitably instantiated, is added as a new (and last) 
 top-level hypothesis of the goal.  There is another significant difference: 
 the automatic application of <a href="ACL2____LINEAR.html">linear</a> rules in the theorem prover is 
 somewhat more complex than the automatic application of <a href="ACL2____REWRITE.html">rewrite</a> rules, 
 so the <span class="v">apply-linear</span> command may not correspond as closely to the prover's 
 automatic use of a linear rule as the <span class="v">rewrite</span> command corresponds to the 
 prover's automatic use of a rewrite rule.</p> 
 
 <p>Below, we refer freely to the <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> for the interactive 
 proof-builder's <span class="v">rewrite</span> command (see <a href="ACL2-PC____REWRITE.html">ACL2-pc::rewrite</a>).</p> 
 
 <p>The <span class="v">rule-id</span> is treated just as it is by the <span class="v">rewrite</span> command.  If 
 <span class="v">rule-id</span> is a positive integer <span class="v">n</span>, then the <span class="v">n</span>th rule as displayed 
 by <span class="v">show-linears</span> is the one that is applied.  If <span class="v">rule-id</span> is <span class="v">nil</span> 
 or is not supplied, then it is treated as the number 1.  Otherwise, 
 <span class="v">rule-id</span> should be either a symbol or else a <span class="v">:linear</span> <a href="ACL2____RUNE.html">rune</a>.  If 
 a symbol is supplied, then any <a href="ACL2____LINEAR.html">linear</a> rule of that name may be 
 used.</p> 
 
 <p>Consider the following example.  Suppose that the current subterm is <span class="v">(<a href="COMMON-LISP_____C3.html">&lt;</a>
 (<a href="ACL2____G.html">g</a> (h y)) y)</span> and that <span class="v">foo</span> is the name of the following linear rule.</p> 
 
 <pre class="code">(<a href="ACL2____IMPLIES.html">implies</a> (<a href="ACL2____TRUE-LISTP.html">true-listp</a> x)
         (<a href="COMMON-LISP_____C3.html">&lt;</a> (<a href="ACL2____G.html">g</a> x) 15))</pre> 
 
 <p>Then the instruction <span class="v">(apply-linear foo)</span> applies <span class="v">foo</span> by adding a 
 new hypothesis <span class="v">(<a href="COMMON-LISP_____C3.html">&lt;</a> (<a href="ACL2____G.html">g</a> (h y)) 15)</span>.  In addition, a new goal with conclusion 
 <span class="v">(<a href="ACL2____TRUE-LISTP.html">true-listp</a> y)</span> is created unless the current context (top-level 
 hypotheses and governors) implies <span class="v">(<a href="ACL2____TRUE-LISTP.html">true-listp</a> y)</span> using only ``trivial 
 reasoning'', just as for the <span class="v">rewrite</span> command.</p> 
 
 <p>If the <span class="v">rule-id</span> argument is a number or is not supplied, then the 
 system will store an instruction of the form <span class="v">(apply-linear name ...)</span>, 
 where <span class="v">name</span> is the name of a <a href="ACL2____LINEAR.html">linear</a> rule; this is in order to make 
 it easier to replay instructions when there have been changes to the history. 
 Except: instead of the name (whether the name is supplied or calculated), the 
 system stores the <a href="ACL2____RUNE.html">rune</a> if there is any chance of ambiguity.  (Formally, 
 ``ambiguity'' here means that the rune being applied is of the form 
 <span class="v">(:rewrite name . index)</span>, where index is not <span class="v">nil</span>.)</p> 
 
 <p>Speaking in general, then, an <span class="v">apply-linear</span> instruction works as 
 follows.</p> 
 
 <p>First, a <a href="ACL2____LINEAR.html">linear</a> rule is selected according to the arguments of the 
 instruction.  The selection is made as explained under ``General Form'' 
 above.</p> 
 
 <p>Next, a trigger term of the rule (see <a href="ACL2____LINEAR.html">linear</a>) is matched with the 
 current subterm, i.e., a substitution <span class="v">unify-subst</span> is found such that if 
 one instantiates that trigger term of the rule with <span class="v">unify-subst</span>, then one 
 obtains the current subterm.  If this match fails, then the instruction 
 fails.</p> 
 
 <p>Next, an attempt is made to relieve (discharge) the hypotheses, possibly 
 handling free variables (see <a href="ACL2____FREE-VARIABLES.html">free-variables</a>), exactly as is done with 
 hypotheses when applying the interactive <a href="ACL2____PROOF-BUILDER.html">proof-builder</a> command, 
 <span class="v">rewrite</span> (<span class="v">r</span>).</p> 
 
 <p>Finally, the instruction is applied exactly as the <span class="v">rewrite</span> instruction 
 is applied, except instead of replacing the current subterm, the rule's 
 instantiated conclusion is added to the end of the list of top-level 
 hypotheses of the goal.</p> 
 
 <p>Note that as for the <span class="v">rewrite</span> command, the substitution argument should 
 be a list whose elements have the form <span class="v">(variable term)</span>, where <span class="v">term</span> 
 may contain abbreviations.</p>
</body>
</html>
