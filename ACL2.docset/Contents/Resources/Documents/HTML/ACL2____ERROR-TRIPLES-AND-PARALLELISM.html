<html>
<head>
<meta charset="UTF-8">
<title>Error-triples-and-parallelism</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____ERROR-TRIPLES-AND-PARALLELISM">Click for Error-triples-and-parallelism in the Full Manual</a></h3>

<p>How to avoid error triples in ACL2(p)</p><p>This <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> topic relates to the experimental 
 extension of ACL2 supporting parallel execution and proof; see <a href="ACL2____PARALLELISM.html">parallelism</a>.</p> 
 
 <p>ACL2 supports the use of error triples in many features; e.g., <span class="tt"><a href="ACL2____COMPUTED-HINTS.html">computed-hints</a></span>.  (For background on error triples, see <a href="ACL2____PROGRAMMING-WITH-STATE.html">programming-with-state</a>.)  However, ACL2(p) does not support the use of error 
 triples in some of these features (e.g., <span class="tt"><a href="ACL2____COMPUTED-HINTS.html">computed-hints</a></span>) while <a href="ACL2____WATERFALL-PARALLELISM.html">waterfall-parallelism</a> is enabled.</p> 
 
 <p>You may see an error message like the following when running ACL2(p) with 
 <a href="ACL2____WATERFALL-PARALLELISM.html">waterfall-parallelism</a> enabled:</p> 
 
 <pre class="code">ACL2 Error in ( THM ...):  Since we are translating a form in ACL2(p)
intended to be executed with waterfall parallelism enabled, the form
(MY-STATE-MODIFYING-COMPUTED-HINT ID STATE) was expected to represent
an ordinary value, not an error triple (<a href="ACL2____MV.html">mv</a> erp val state), as would
be acceptable in a serial execution of ACL2.  Therefore, the form returning
a tuple of the form (<a href="COMMON-LISP_____A2.html">*</a> * STATE) is an error.  See :DOC unsupported-
waterfall-parallelism-features and :DOC error-triples-and-parallelism
for further explanation.</pre> 
 
 <p>In this particular example, the cause of the error was trying to use a 
 computed hint that returned state, which is not allowed when executing the 
 waterfall in parallel (see <a href="ACL2____UNSUPPORTED-WATERFALL-PARALLELISM-FEATURES.html">unsupported-waterfall-parallelism-features</a> 
 for other related information).</p> 
 
 <p>Often, the only reason users need to return state is so they can perform 
 some output during the proof process.  In this case, we suggest using one of 
 the state-free output functions, like <span class="tt"><a href="ACL2____CW.html">cw</a></span> or <span class="tt"><a href="ACL2____OBSERVATION-CW.html">observation-cw</a></span>. 
 If the user is concerned about the interleaving of their output with other 
 output, these calls can be surrounded with the macro <span class="tt"><a href="ACL2____WITH-OUTPUT-LOCK.html">with-output-lock</a></span>.</p> 
 
 <p>Another frequent reason users return state is so they can cause a <span class="v">soft</span> 
 error and halt the proof process.  In this case, we suggest instead calling 
 <span class="tt"><a href="ACL2____ER.html">er</a></span> with the <span class="v">hard</span> or <span class="v">hard?</span> severity.  By using these 
 mechanisms, the user avoids modifying <span class="tt"><a href="ACL2____STATE.html">state</a></span>, a requirement for much of 
 the code written in ACL2(p).</p> 
 
 <p>You may encounter other similar error messages when using <a href="ACL2____COMPUTED-HINTS.html">computed-hints</a>, <a href="ACL2____CUSTOM-KEYWORD-HINTS.html">custom-keyword-hints</a>, or <a href="ACL2____OVERRIDE-HINTS.html">override-hints</a>. 
 Chances are that you are somehow returning an error triple when an ordinary 
 value is needed.  If this turns out not to be the case, please let the ACL2 
 implementors know.</p>
</body>
</html>
