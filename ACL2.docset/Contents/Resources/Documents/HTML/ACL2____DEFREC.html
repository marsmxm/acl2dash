<html>
<head>
<meta charset="UTF-8">
<title>Defrec</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____DEFREC">Click for Defrec in the Full Manual</a></h3>

<p>Introduce a record structure, like a <span class="v">struct</span> in C.</p><p>The <span class="v">defrec</span> macro is built into ACL2 and is frequently used in 
 the ACL2 sources to define basic kinds of structures.</p> 
 
 <h3>Better Alternatives to Defrec</h3> 
 
 <p>While <span class="v">defrec</span> may be a reasonable choice for writing <a href="ACL2____PROGRAM.html">program</a>-mode code, most users would likely be better served by using one of 
 the many, richer alternatives to <a href="ACL2____DEFREC.html">defrec</a> that are available in various 
 books.  See for instance macros such as:</p> 
 
 <ul> 
 <li>The <a href="STD____DEFAGGREGATE.html">std::defaggregate</a> macro from <a href="ACL2____STD_F2UTIL.html">std/util</a>,</li> 
 <li>The <a href="ACL2____DEFDATA.html">defdata</a> macro,</li> 
 <li>The <a href="FTY____DEFPROD.html">fty::defprod</a> macro from the <a href="ACL2____FTY.html">fty</a> library, and</li> 
 <li>The <span class="v">data-structures/structures</span> book.</li> 
 </ul> 
 
 <p>A major reason to favor these macros over <span class="v">defrec</span> is that they 
 introduce the constructors and accessors for the structure as proper 
 functions, rather than mere macros.  This is very helpful when you are trying 
 to use ACL2 to reason about code that works with structures.  For instance, it 
 means that your proof goals will involve terms like <span class="v">(employee-&gt;position
 x)</span> instead of <span class="v">(<a href="COMMON-LISP____CDDDR.html">cdddr</a> x)</span>.</p> 
 
 <p>Another reason is that <span class="v">defrec</span> does not support putting constraints on 
 the fields of your structure.  For instance, you might want to have an 
 <span class="v">employee</span> structure where the <span class="v">name</span> field is always a string.  You 
 can't do this with <span class="v">defrec</span>, but any of the above macros support it.</p> 
 
 <p>Some of the above macros also have other useful features, e.g., integration 
 with <a href="ACL2____B_A2.html">b*</a>, support for <a href="ACL2____XDOC.html">xdoc</a> documentation, and so forth.</p> 
 
 <h3>Usage</h3> 
 
 <p>A typical use of <span class="v">defrec</span> might look like this:</p> 
 
 <pre class="code">(<a href="ACL2____DEFREC.html">defrec</a> employee             ;; name of the structure
  (<a href="ACL2____NAME.html">name</a> salary . position)   ;; fields of the structure
  nil)                       ;; "cheap" flag</pre> 
 
 <p>This will result in the introduction of:</p> 
 
 <ul> 
 
 <li>A "weak" recognizer function, <span class="v">weak-employee-p</span>, which recognizes 
 cons structures that have the right shape.  We call the recognizer <i>weak</i> 
 because it doesn't impose any constraints on the fields, e.g., there is no 
 requirement that the <span class="v">name</span> of an employee must be a string or that the 
 <span class="v">salary</span> must be a number.</li> 
 
 <li>A <a href="ACL2____MAKE.html">make</a> macro that can be used like this: 
     <pre class="code">(<a href="ACL2____MAKE.html">make</a> employee :name "Jimmy"
               :salary 0
               :position "Unpaid Intern")</pre>
</li> 
 
 <li>A <a href="ACL2____CHANGE.html">change</a> macro that can be used like this: 
     <pre class="code">(<a href="COMMON-LISP____LET.html">let</a> ((jimmy (make-employee :name "Jimmy" ...)))
  (<a href="ACL2____CHANGE.html">change</a> employee jimmy :salary 300000
                         :position "Vice President"))</pre>
</li> 
 
 <li>Suitable <a href="ACL2____ACCESS.html">access</a> macros that can be used like this: 
     <pre class="code">(<a href="COMMON-LISP____LET.html">let</a> ((jimmy (make-employee :name "Jimmy" ...)))
  (<a href="ACL2____ACCESS.html">access</a> employee jimmy :name))</pre>
</li> 
 
 </ul>
</body>
</html>
