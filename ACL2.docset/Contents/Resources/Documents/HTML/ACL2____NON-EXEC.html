<html>
<head>
<meta charset="UTF-8">
<title>Non-exec</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____NON-EXEC">Click for Non-exec in the Full Manual</a></h3>

<p>Mark code as non-executable</p><p><span class="v">Non-exec</span> is a macro such that logically, <span class="v">(<a href="ACL2____NON-EXEC.html">non-exec</a> x)</span> is 
 equal to <span class="v">x</span>.  However, the argument to a call of <span class="v">non-exec</span> need not 
 obey the usual syntactic restrictions for executable code, and indeed, 
 evaluation of a call of <span class="v">non-exec</span> will result in an error.  Moreover, for 
 any form occurring in the body of a function (see <a href="COMMON-LISP____DEFUN.html">defun</a>) that is a call 
 of <span class="v">non-exec</span>, no guard proof obligations are generated for that form.</p> 
 
 <p>The following example, although rather contrived, illustrates the use of 
 <span class="v">non-exec</span>.  One can imagine a less contrived example that efficiently 
 computes return values for a small number of fixed inputs and, for other 
 inputs, returns something logically ``consistent'' with those return 
 values.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> double (x)
  (<a href="COMMON-LISP____CASE.html">case</a> x
    (1 2)
    (2 4)
    (3 6)
    (otherwise (<a href="ACL2____NON-EXEC.html">non-exec</a> (<a href="COMMON-LISP_____A2.html">*</a> 2 x)))))</pre> 
 
 <p>We can prove that <span class="v">double</span> is compliant with Common Lisp (see <a href="ACL2____GUARD.html">guard</a>) and that it always computes <span class="v">(<a href="COMMON-LISP_____A2.html">*</a> 2 x)</span>.</p> 
 
 <pre class="code">(<a href="ACL2____VERIFY-GUARDS.html">verify-guards</a> double)
(<a href="ACL2____THM.html">thm</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> (double x) (<a href="COMMON-LISP_____A2.html">*</a> 2 x)))</pre> 
 
 <p>We can evaluate double on the specified arguments.  But a call of 
 <span class="v">non-exec</span> results in an error message that reports the form that was 
 supplied to <span class="v">non-exec</span>.</p> 
 
 <pre class="code">ACL2 !&gt;(double 3)
6
ACL2 !&gt;(double 10)

ACL2 Error in TOP-LEVEL:  ACL2 has been instructed to cause an error
because of an attempt to evaluate the following form (see :DOC non-
exec):

  (<a href="COMMON-LISP_____A2.html">*</a> 2 X).

To debug see :DOC print-gv, see :DOC trace, and see :DOC wet.

ACL2 !&gt;</pre> 
 
 <p>During proofs, the error is silent; it is ``caught'' by the proof mechanism 
 and generally results in the introduction of a call of <span class="tt"><a href="ACL2____HIDE.html">hide</a></span> during a 
 proof.</p> 
 
 <p>Also see <a href="ACL2____DEFUN-NX.html">defun-nx</a> for a utility that makes every call of a function 
 non-executable, rather than a specified form.  The following examples contrast 
 <span class="v">non-exec</span> with <span class="tt"><a href="ACL2____DEFUN-NX.html">defun-nx</a></span>, in particular illustrating the role of 
 <span class="tt"><a href="ACL2____NON-EXEC.html">non-exec</a></span> in avoiding guard proof obligations.</p> 
 
 <pre class="code">; Guard verification fails:
(<a href="ACL2____DEFUN-NX.html">defun-nx</a> f1 (x)
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard t))
  (<a href="COMMON-LISP____CAR.html">car</a> x))

; Guard verification succeeds after changing the guard above:
(<a href="ACL2____DEFUN-NX.html">defun-nx</a> f1 (x)
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____CONSP.html">consp</a> x)))
  (<a href="COMMON-LISP____CAR.html">car</a> x))

; Guard verification succeeds:
(<a href="COMMON-LISP____DEFUN.html">defun</a> f2 (x)
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard t))
  (<a href="ACL2____NON-EXEC.html">non-exec</a> (<a href="COMMON-LISP____CAR.html">car</a> x)))

; Evaluating (g1) prints "Hello" before signaling an error.
(<a href="COMMON-LISP____DEFUN.html">defun</a> g1 ()
  (f1 (<a href="ACL2____CW.html">cw</a> "Hello")))

; Evaluating (g2) does not print before signaling an error.
(<a href="COMMON-LISP____DEFUN.html">defun</a> g2 ()
  (<a href="ACL2____NON-EXEC.html">non-exec</a> (<a href="ACL2____CW.html">cw</a> "Hello")))

; Evaluating (h1) gives a guard violation for taking reciprocal of 0.
(<a href="COMMON-LISP____DEFUN.html">defun</a> h1 ()
  (f1 (<a href="COMMON-LISP_____F2.html">/</a> 1 0)))

; Evaluating (h2) does not take a reciprocal, hence there is no guard
; violation for that; we just get the error expected from using non-exec.
(<a href="COMMON-LISP____DEFUN.html">defun</a> h2 ()
  (<a href="ACL2____NON-EXEC.html">non-exec</a> (<a href="COMMON-LISP_____F2.html">/</a> 0)))</pre>
</body>
</html>
