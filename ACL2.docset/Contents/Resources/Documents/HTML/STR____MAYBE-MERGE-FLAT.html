<html>
<head>
<meta charset="UTF-8">
<title>Maybe-merge-flat</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=STR____MAYBE-MERGE-FLAT">Click for Maybe-merge-flat in the Full Manual</a></h3>

<p>Basic merging of flat singleton objects into rows.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(maybe-merge-flat x rows width config) → new-rows</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">x</span> — Instruction for the car of the list.<br>    <font color="#606060">Guard <span class="v">(<a href="STR____PINST-P.html">pinst-p</a> x)</span>.</font>
</dd> 
  <dd>
<span class="tt">rows</span> — Instructions for the cdr of the list.<br>    <font color="#606060">Guard <span class="v">(<a href="STR____PINSTLIST-P.html">pinstlist-p</a> rows)</span>.</font>
</dd> 
  <dd>
<span class="tt">width</span> — Width we're trying to stay within.<br>    <font color="#606060">Guard <span class="v">(<a href="ACL2____NATP.html">natp</a> width)</span>.</font>
</dd> 
  <dd>
<span class="tt">config</span> — <font color="#606060">Guard <span class="v">(<a href="STR____PRINTCONFIG-P.html">printconfig-p</a> config)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">new-rows</span> — <font color="#606060">Type <span class="v">(<a href="STR____PINSTLIST-P.html">pinstlist-p</a> new-rows)</span>.</font>
</dd> 
 
</dl></div> 
 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>maybe-merge-flat</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 maybe-merge-flat (x rows width config)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="STR____PINST-P.html">pinst-p</a> x)
                             (<a href="STR____PINSTLIST-P.html">pinstlist-p</a> rows)
                             (<a href="ACL2____NATP.html">natp</a> width)
                             (<a href="STR____PRINTCONFIG-P.html">printconfig-p</a> config))))
 (<a href="COMMON-LISP____DECLARE.html">declare</a>
   (<a href="ACL2____XARGS.html">xargs</a>
        :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____EQ.html">eq</a> (<a href="STR____PINST-KIND.html">pinst-kind</a> x) :flat)
                    (<a href="COMMON-LISP____LET.html">let</a> ((what (<a href="STR____PFLAT-_E3WHAT.html">pflat-&gt;what</a> (<a href="STR____PINST-FLAT-_E3GUTS.html">pinst-flat-&gt;guts</a> x))))
                         (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____CONSP.html">consp</a> what) (<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____CDR.html">cdr</a> what))))
                    (<a href="COMMON-LISP____CONSP.html">consp</a> rows))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((acl2::__function__ 'maybe-merge-flat))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> acl2::__function__))
  (<a href="ACL2____B_A2.html">b*</a>
     ((x (<a href="STR____PINST-FIX.html">pinst-fix</a> x))
      (rows (<a href="STR____PINSTLIST-FIX.html">pinstlist-fix</a> rows))
      (row1 (<a href="COMMON-LISP____CAR.html">car</a> rows))
      ((unless (<a href="COMMON-LISP____EQ.html">eq</a> (<a href="STR____PINST-KIND.html">pinst-kind</a> row1) :flat))
       (<a href="COMMON-LISP____CONS.html">cons</a> x rows))
      (x.guts (<a href="STR____PINST-FLAT-_E3GUTS.html">pinst-flat-&gt;guts</a> x))
      (row1.guts (<a href="STR____PINST-FLAT-_E3GUTS.html">pinst-flat-&gt;guts</a> row1))
      ((<a href="COMMON-LISP____THE.html">the</a> unsigned-byte row1.width)
       (<a href="STR____PFLAT-_E3WIDTH.html">pflat-&gt;width</a> row1.guts))
      ((<a href="COMMON-LISP____THE.html">the</a> unsigned-byte x.width)
       (<a href="STR____PFLAT-_E3WIDTH.html">pflat-&gt;width</a> x.guts))
      ((<a href="COMMON-LISP____THE.html">the</a> unsigned-byte merged-width)
       (<a href="COMMON-LISP_____B2.html">+</a> 1
          (<a href="COMMON-LISP____THE.html">the</a> unsigned-byte (<a href="COMMON-LISP_____B2.html">+</a> x.width row1.width))))
      ((<a href="COMMON-LISP____THE.html">the</a> unsigned-byte flat-right-margin)
       (<a href="STR____PRINTCONFIG-_E3FLAT-RIGHT-MARGIN.html">printconfig-&gt;flat-right-margin</a> config))
      ((unless (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> merged-width flat-right-margin)
                    (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> merged-width width)))
       (<a href="COMMON-LISP____CONS.html">cons</a> x rows))
      (x.what (<a href="STR____PFLAT-_E3WHAT.html">pflat-&gt;what</a> x.guts))
      (row1.what (<a href="STR____PFLAT-_E3WHAT.html">pflat-&gt;what</a> row1.guts))
      (merged-guts (<a href="STR____MAKE-PFLAT.html">make-pflat</a> :width merged-width
                               :what (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CAR.html">car</a> x.what) row1.what)))
      (merged-inst (<a href="STR____MAKE-PINST-FLAT.html">make-pinst-flat</a> :guts merged-guts)))
     (<a href="COMMON-LISP____CONS.html">cons</a> merged-inst (<a href="COMMON-LISP____REST.html">rest</a> rows)))))</pre> 
<p><b>Theorem: </b>pinstlist-p-of-maybe-merge-flat</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> pinstlist-p-of-maybe-merge-flat
        (<a href="ACL2____B_A2.html">b*</a> ((new-rows (<a href="STR____MAYBE-MERGE-FLAT.html">maybe-merge-flat</a> x rows width config)))
            (<a href="STR____PINSTLIST-P.html">pinstlist-p</a> new-rows))
        :rule-classes :rewrite)</pre> 

</body>
</html>
