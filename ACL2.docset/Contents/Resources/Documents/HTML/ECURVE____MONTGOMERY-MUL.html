<html>
<head>
<meta charset="UTF-8">
<title>Montgomery-mul</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ECURVE____MONTGOMERY-MUL">Click for Montgomery-mul in the Full Manual</a></h3>

<p>Scalar multiplication in the Montgomery group.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(montgomery-mul scalar point curve) → point1</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">scalar</span> — <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____INTEGERP.html">integerp</a> scalar)</span>.</font>
</dd> 
  <dd>
<span class="tt">point</span> — <font color="#606060">Guard <span class="v">(<a href="ECURVE____POINTP.html">pointp</a> point)</span>.</font>
</dd> 
  <dd>
<span class="tt">curve</span> — <font color="#606060">Guard <span class="v">(<a href="ECURVE____MONTGOMERY-CURVEP.html">montgomery-curvep</a> curve)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">point1</span> — <font color="#606060">Type <span class="v">(<a href="ECURVE____POINTP.html">pointp</a> point1)</span>.</font>
</dd> 
 
</dl></div> 
<p>If the group were multiplicative, this would be exponentiation. 
     Since the Montgomery group is additive, 
     here we talk about scalar multiplication instead.</p><p>We first define the operation for non-negative scalars, 
     by simple recursion in the same manner as exponentiation: 
     multiplication by 0 yields the neutral element; 
     multiplication by a non-zero scalar yields the sum of the point and 
     the scalar multiplication by the scalar minus one. 
     Then we extend it to negative scalars, 
     by negating the result of multiplying by the negated scalar.</p><p>To verify the guards of the recursive auxiliary function, 
     we need to show that it returns a point on the curve, 
     which follows from closure. 
     However, to avoid putting the non-executable <span class="tt"><a href="ECURVE____MONTGOMERY-ADD-CLOSURE.html">montgomery-add-closure</a></span> 
     in the guard of this function and all its callers, 
     for now we check explicitly, in the function, 
     that the recursive call returns a point on the curve. 
     If it does not, we return an irrelevant point. 
     This lets us verify the guards. 
     Then we prove that, under the closure assumption, 
     multiplication always returns a point on the curve.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>montgomery-mul-nonneg</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> montgomery-mul-nonneg
       (scalar point curve)
       (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____NATP.html">natp</a> scalar)
                                   (<a href="ECURVE____POINTP.html">pointp</a> point)
                                   (<a href="ECURVE____MONTGOMERY-CURVEP.html">montgomery-curvep</a> curve))))
       (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="ECURVE____POINT-ON-MONTGOMERY-P.html">point-on-montgomery-p</a> point curve)))
       (<a href="COMMON-LISP____LET.html">let</a> ((acl2::__function__ 'montgomery-mul-nonneg))
            (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> acl2::__function__))
            (<a href="ACL2____B_A2.html">b*</a> (((when (<a href="ACL2____ZP.html">zp</a> scalar)) (<a href="ECURVE____MONTGOMERY-ZERO.html">montgomery-zero</a>))
                 (point1 (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> (<a href="COMMON-LISP____1-.html">1-</a> scalar)
                                                point curve))
                 ((unless (<a href="ECURVE____POINT-ON-MONTGOMERY-P.html">point-on-montgomery-p</a> point1 curve))
                  (<a href="ACL2____EC-CALL.html">ec-call</a> (<a href="ECURVE____POINT-FIX.html">point-fix</a> :irrelevant))))
                (<a href="ECURVE____MONTGOMERY-ADD.html">montgomery-add</a> point point1 curve))))</pre> 
<p><b>Theorem: </b>pointp-of-montgomery-mul-nonneg</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> pointp-of-montgomery-mul-nonneg
        (<a href="ACL2____B_A2.html">b*</a> ((point1 (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar point curve)))
            (<a href="ECURVE____POINTP.html">pointp</a> point1))
        :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>point-on-montgomery-p-of-montgomery-mul-nonneg</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 point-on-montgomery-p-of-montgomery-mul-nonneg
 (<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="ECURVE____MONTGOMERY-ADD-CLOSURE.html">montgomery-add-closure</a>)
               (<a href="ECURVE____POINT-ON-MONTGOMERY-P.html">point-on-montgomery-p</a> point curve))
          (<a href="ACL2____B_A2.html">b*</a> ((?point1 (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar point curve)))
              (<a href="ECURVE____POINT-ON-MONTGOMERY-P.html">point-on-montgomery-p</a> point1 curve))))</pre> 
<p><b>Theorem: </b>montgomery-mul-nonneg-of-0</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-nonneg-of-0
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> 0 point curve)
               (<a href="ECURVE____MONTGOMERY-ZERO.html">montgomery-zero</a>)))</pre> 
<p><b>Theorem: </b>montgomery-mul-nonneg-of-1</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-nonneg-of-1
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> 1 point curve)
               (<a href="ECURVE____POINT-FIX.html">point-fix</a> point)))</pre> 
<p><b>Theorem: </b>montgomery-mul-nonneg-of-zero</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-nonneg-of-zero
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar (<a href="ECURVE____MONTGOMERY-ZERO.html">montgomery-zero</a>)
                                      curve)
               (<a href="ECURVE____MONTGOMERY-ZERO.html">montgomery-zero</a>)))</pre> 
<p><b>Theorem: </b>montgomery-mul-nonneg-of-nfix-scalar</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-nonneg-of-nfix-scalar
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> (<a href="ACL2____NFIX.html">nfix</a> scalar)
                                      point curve)
               (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar point curve)))</pre> 
<p><b>Theorem: </b>montgomery-mul-nonneg-nat-equiv-congruence-on-scalar</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
  montgomery-mul-nonneg-nat-equiv-congruence-on-scalar
  (<a href="ACL2____IMPLIES.html">implies</a> (<a href="ACL2____NAT-EQUIV.html">nat-equiv</a> scalar scalar-equiv)
           (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar point curve)
                  (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar-equiv point curve)))
  :rule-classes :congruence)</pre> 
<p><b>Theorem: </b>montgomery-mul-nonneg-of-point-fix-point</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-nonneg-of-point-fix-point
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar (<a href="ECURVE____POINT-FIX.html">point-fix</a> point)
                                      curve)
               (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar point curve)))</pre> 
<p><b>Theorem: </b>montgomery-mul-nonneg-point-equiv-congruence-on-point</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
  montgomery-mul-nonneg-point-equiv-congruence-on-point
  (<a href="ACL2____IMPLIES.html">implies</a> (point-equiv point point-equiv)
           (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar point curve)
                  (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar point-equiv curve)))
  :rule-classes :congruence)</pre> 
<p><b>Theorem: </b>montgomery-mul-nonneg-of-montgomery-curve-fix-curve</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
   montgomery-mul-nonneg-of-montgomery-curve-fix-curve
   (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar
                                 point (<a href="ECURVE____MONTGOMERY-CURVE-FIX.html">montgomery-curve-fix</a> curve))
          (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar point curve)))</pre> 
<p><b>Theorem: </b>montgomery-mul-nonneg-montgomery-curve-equiv-congruence-on-curve</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
  montgomery-mul-nonneg-montgomery-curve-equiv-congruence-on-curve
  (<a href="ACL2____IMPLIES.html">implies</a> (<a href="ECURVE____MONTGOMERY-CURVE-EQUIV.html">montgomery-curve-equiv</a> curve curve-equiv)
           (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar point curve)
                  (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar point curve-equiv)))
  :rule-classes :congruence)</pre> 
<p><b>Function: </b>montgomery-mul</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> montgomery-mul (scalar point curve)
       (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____INTEGERP.html">integerp</a> scalar)
                                   (<a href="ECURVE____POINTP.html">pointp</a> point)
                                   (<a href="ECURVE____MONTGOMERY-CURVEP.html">montgomery-curvep</a> curve))))
       (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="ECURVE____POINT-ON-MONTGOMERY-P.html">point-on-montgomery-p</a> point curve)))
       (<a href="COMMON-LISP____LET.html">let</a> ((acl2::__function__ 'montgomery-mul))
            (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> acl2::__function__))
            (<a href="ACL2____B_A2.html">b*</a> ((scalar (<a href="ACL2____IFIX.html">ifix</a> scalar))
                 ((when (<a href="COMMON-LISP_____E3_D3.html">&gt;=</a> scalar 0))
                  (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> scalar point curve))
                 (point1 (<a href="ECURVE____MONTGOMERY-MUL-NONNEG.html">montgomery-mul-nonneg</a> (<a href="COMMON-LISP____-.html">-</a> scalar)
                                                point curve))
                 ((unless (<a href="ECURVE____POINT-ON-MONTGOMERY-P.html">point-on-montgomery-p</a> point1 curve))
                  (<a href="ACL2____EC-CALL.html">ec-call</a> (<a href="ECURVE____POINT-FIX.html">point-fix</a> :irrelevant))))
                (<a href="ECURVE____MONTGOMERY-NEG.html">montgomery-neg</a> point1 curve))))</pre> 
<p><b>Theorem: </b>pointp-of-montgomery-mul</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> pointp-of-montgomery-mul
        (<a href="ACL2____B_A2.html">b*</a> ((point1 (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar point curve)))
            (<a href="ECURVE____POINTP.html">pointp</a> point1))
        :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>point-on-montgomery-p-of-montgomery-mul</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> point-on-montgomery-p-of-montgomery-mul
        (<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="ECURVE____MONTGOMERY-ADD-CLOSURE.html">montgomery-add-closure</a>)
                      (<a href="ECURVE____POINT-ON-MONTGOMERY-P.html">point-on-montgomery-p</a> point curve))
                 (<a href="ACL2____B_A2.html">b*</a> ((?point1 (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar point curve)))
                     (<a href="ECURVE____POINT-ON-MONTGOMERY-P.html">point-on-montgomery-p</a> point1 curve))))</pre> 
<p><b>Theorem: </b>montgomery-mul-of-0</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-of-0
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> 0 point curve)
               (<a href="ECURVE____MONTGOMERY-ZERO.html">montgomery-zero</a>)))</pre> 
<p><b>Theorem: </b>montgomery-mul-of-1</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-of-1
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> 1 point curve)
               (<a href="ECURVE____POINT-FIX.html">point-fix</a> point)))</pre> 
<p><b>Theorem: </b>montgomery-mul-of-zero</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-of-zero
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar (<a href="ECURVE____MONTGOMERY-ZERO.html">montgomery-zero</a>)
                               curve)
               (<a href="ECURVE____MONTGOMERY-ZERO.html">montgomery-zero</a>)))</pre> 
<p><b>Theorem: </b>montgomery-mul-of-minus1</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-of-minus1
        (<a href="ACL2____IMPLIES.html">implies</a> (<a href="ECURVE____POINT-ON-MONTGOMERY-P.html">point-on-montgomery-p</a> point curve)
                 (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> -1 point curve)
                        (<a href="ECURVE____MONTGOMERY-NEG.html">montgomery-neg</a> point curve))))</pre> 
<p><b>Theorem: </b>montgomery-neg-of-mul</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 montgomery-neg-of-mul
 (<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="ECURVE____MONTGOMERY-ADD-CLOSURE.html">montgomery-add-closure</a>)
               (<a href="ECURVE____POINT-ON-MONTGOMERY-P.html">point-on-montgomery-p</a> point curve))
          (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-NEG.html">montgomery-neg</a> (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar point curve)
                                 curve)
                 (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> (<a href="COMMON-LISP____-.html">-</a> (<a href="ACL2____IFIX.html">ifix</a> scalar))
                                 point curve))))</pre> 
<p><b>Theorem: </b>montgomery-mul-of-ifix-scalar</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-of-ifix-scalar
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> (<a href="ACL2____IFIX.html">ifix</a> scalar)
                               point curve)
               (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar point curve)))</pre> 
<p><b>Theorem: </b>montgomery-mul-int-equiv-congruence-on-scalar</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-int-equiv-congruence-on-scalar
        (<a href="ACL2____IMPLIES.html">implies</a> (<a href="ACL2____INT-EQUIV.html">acl2::int-equiv</a> scalar scalar-equiv)
                 (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar point curve)
                        (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar-equiv point curve)))
        :rule-classes :congruence)</pre> 
<p><b>Theorem: </b>montgomery-mul-of-point-fix-point</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-of-point-fix-point
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar (<a href="ECURVE____POINT-FIX.html">point-fix</a> point)
                               curve)
               (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar point curve)))</pre> 
<p><b>Theorem: </b>montgomery-mul-point-equiv-congruence-on-point</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-point-equiv-congruence-on-point
        (<a href="ACL2____IMPLIES.html">implies</a> (point-equiv point point-equiv)
                 (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar point curve)
                        (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar point-equiv curve)))
        :rule-classes :congruence)</pre> 
<p><b>Theorem: </b>montgomery-mul-of-montgomery-curve-fix-curve</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-of-montgomery-curve-fix-curve
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar
                               point (<a href="ECURVE____MONTGOMERY-CURVE-FIX.html">montgomery-curve-fix</a> curve))
               (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar point curve)))</pre> 
<p><b>Theorem: </b>montgomery-mul-montgomery-curve-equiv-congruence-on-curve</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> montgomery-mul-montgomery-curve-equiv-congruence-on-curve
        (<a href="ACL2____IMPLIES.html">implies</a> (<a href="ECURVE____MONTGOMERY-CURVE-EQUIV.html">montgomery-curve-equiv</a> curve curve-equiv)
                 (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar point curve)
                        (<a href="ECURVE____MONTGOMERY-MUL.html">montgomery-mul</a> scalar point curve-equiv)))
        :rule-classes :congruence)</pre> 

</body>
</html>
