<html>
<head>
<meta charset="UTF-8">
<title>Save</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=XDOC____SAVE">Click for Save in the Full Manual</a></h3>

<p>Saves the XDOC database into files for web browsers, etc.</p><p>Once you have documented your books with <a href="ACL2____DEFXDOC.html">defxdoc</a>, you may 
wish to create a manual that can be viewed from a web browser or from the 
acl2-doc Emacs-based browser (see <a href="ACL2____ACL2-DOC.html">ACL2::ACL2-doc</a>).</p> 
 
<h4>Basic Example</h4> 
 
<pre class="code">;; my-manual.lisp - a book that creates a manual
(<a href="COMMON-LISP____IN-PACKAGE.html">in-package</a> "MYPKG")

(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "my-library1") ;; load books I want in the manual
(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "my-library2") ;; (documented with xdoc)

(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "xdoc/save" :dir :system)  ;; load xdoc::save

(<a href="ACL2____DEFXDOC.html">defxdoc</a> acl2::top           ;; create a "top" topic
  :short "My Manual"
  :long "&lt;p&gt;This manual explains how to use my books...&lt;/p&gt;")

(<a href="XDOC____SAVE.html">xdoc::save</a> "./mylib-manual" :error t)  ;; write the manual</pre> 
 
<p>Notes about this example:</p> 
 
<ul> 
 
<li>The <span class="v">xdoc::save</span> command will export all currently-loaded, documented 
topics.  Because of this, you can mostly control what goes into the manual 
<b>just by including books</b>, but see below for additional notes about how to 
control what goes in a manual.</li> 
 
<li>The <span class="v">save</span> command is a macro that expands into <a href="ACL2____EMBEDDED-EVENT-FORM.html">ACL2::embedded-event-form</a>s.  Typically, you just put it into a new book (e.g., 
<span class="v">my-manual.lisp</span> above) so that your manual will be regenerated as part of 
building your project.</li> 
 
<li>The <span class="v">save</span> requires certain <a href="ACL2____DEFTTAG.html">trust 
tags</a>.  You may need to enable trust tags in your build system to certify 
the <span class="v">my-manual</span> book.  For instance, <span class="v">cert.pl</span> users may need a 
<span class="v">.acl2</span> file with a line such as: 
 
<pre class="code">; cert-flags: ? t :ttags :all</pre>
</li> 
 
<li>After saving a manual, you should be able to view it by going to, e.g., 
<span class="v">mylib-manual/index.html</span> in your web browser.  If you want to share your 
manual with others, you should read about <a href="XDOC____DEPLOYING-MANUALS.html">deploying-manuals</a>.</li> 
 
</ul> 
 
 
<h4>General Form</h4> 
 
<pre class="code">(<a href="XDOC____SAVE.html">save</a> &lt;target-dir&gt;
      [:redef-okp  bool]               ;; default is nil
      [:zip-p      bool]               ;; default is t
      [:logo-image path]               ;; default is nil
      [:error      bool]               ;; default is nil
      [:broken-links-limit nil-or-nat] ;; default is nil
      )</pre> 
 
<p>The only (required) argument to the <span class="v">save</span> command is the name of a 
directory where the want the manual to go.  All arguments are evaluated. 
As might be expected:</p> 
 
<ul> 
 
<li>If the target directory does not exist, it will be created.</li> 
 
<li>If the target directory already exists, it <font color="#ff0000">will be 
overwritten</font>.</li> 
 
</ul> 
 
<h5>Option Summary</h5> 
 
<dl> 
 
<dt><span class="v">redef-okp</span></dt> 
 
<dd>By default, the <span class="v">save</span> command will complain if any topic is defined 
more than once.  This is often annoying when you are developing books, 
especially if your books are slow to certify and you don't want to have your 
build fail just because of a documentation problem.  So, if you want to 
suppress this error (and turn it into a printed warning), you can set 
<span class="v">:redef-okp t</span>.</dd> 
 
<dt><span class="v">zip-p</span></dt> 
 
<dd>To support the <a href="download/" target="_blank"><nobr>Download this Manual<img src="../Icon_External_Link.png" title="External link to download/"></nobr></a> 
feature (normally accessed from the toolbar button) the <span class="v">save</span> command will 
zip up the manual to create <span class="v">.tar.gz</span>, <span class="v">.tar.bz2</span>, and <span class="v">.zip</span> files. 
If you don't care about generating these files and want to avoid the time to 
build them, you can set <span class="v">:zip-p nil</span>.</dd> 
 
<dt><span class="v">:logo-image</span></dt> 
 
<dd>You can provide a custom image to use as the logo for the <a href="ACL2____TOP.html">top</a> topic. 
The path you provide should be relative to whatever book contains the <span class="v">save</span> 
command.</dd> 
 
<dt><span class="v">:error</span></dt> 
 
<dd>The value is <span class="v">t</span> or <span class="v">nil</span>, to indicate whether or not (respectively) 
to cause an error upon encountering a syntax error in xdoc source (marked with 
"xdoc error").</dd> 
 
<dt><span class="v">:broken-links-limit</span></dt> 
 
<dd>The value is <span class="v">nil</span> by default.  Otherwise, it is a natural number 
specifying the maximum allowed number of broken links; if the ``broken topic 
link'' report shows more broken links than that limit, an error occurs.</dd> 
 
</dl> 
 
 
<h3>Avoiding Unwanted Documentation</h3> 
 
<p>By default, the <span class="v">save</span> command will generate a manual that covers the 
documentation for all books that you have loaded.  This usually works well 
as long as you know all of the books that you need to include.</p> 
 
<p>One caveat is that <span class="v">xdoc/save</span> includes some supporting books that are, 
themselves, documented.  Accordingly, you may find that your manual includes 
documentation from libraries like <a href="ACL2____STD_F2STRINGS.html">ACL2::std/strings</a> and <a href="ACL2____OSLIB.html">ACL2::oslib</a> in your output even if you haven't loaded these libraries 
yourself.  If you really want precise control over what goes into your manual, 
then, you may want to do something like this:</p> 
 
<pre class="code">;; nothing-extra-manual.lisp - manual with nothing extra
(<a href="COMMON-LISP____IN-PACKAGE.html">in-package</a> "MYPKG")

(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "my-library1") ;; load books I want in the manual
(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "my-library2") ;; (documented with xdoc)

(<a href="ACL2____MAKE-EVENT.html">make-event</a> ;; save current documentation
 `(<a href="ACL2____DEFCONST.html">defconst</a> *just-my-documentation*
    ',(xdoc::get-xdoc-table (<a href="ACL2____W.html">w</a> state))))

(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "xdoc/save" :dir :system)

;; clobber any docs that were added due to xdoc/save
(<a href="ACL2____TABLE.html">table</a> xdoc::xdoc 'xdoc::doc *just-my-documentation*)

(<a href="ACL2____DEFXDOC.html">defxdoc</a> acl2::top           ;; create a "top" topic
  :short "My Manual"
  :long "&lt;p&gt;This manual explains how to use my books...&lt;/p&gt;")

(<a href="XDOC____SAVE.html">xdoc::save</a> "./mylib-manual" :error t)</pre>
</body>
</html>
