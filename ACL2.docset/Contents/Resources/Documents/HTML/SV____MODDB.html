<html>
<head>
<meta charset="UTF-8">
<title>Moddb</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=SV____MODDB">Click for Moddb in the Full Manual</a></h3>

<p>A database object that provides a unique numbering of all the wires in 
          a module hierarchy.</p><p>A moddb is a stobj that provides a fast method of enumerating wires 
and a compact, high-performance mapping between these indices and their 
names/declarations.  It is used in <a href="SV____SVEX-COMPILATION.html">svex-compilation</a> to avoid more memory 
hungry methods of mapping hierarchical wire names to values.</p> 
 
<p>A moddb is a nested stobj structure defined as follows:</p> 
 
<p><b>Definition: </b>moddb</p><pre class="code">(<a href="ACL2____DEFSTOBJ.html">defstobj</a> moddb
          (moddb-&gt;nmods1 :type (integer 0 *)
                         :initially 0)
          (moddb-&gt;mods :type (<a href="COMMON-LISP____ARRAY.html">array</a> elab-mod (0))
                       :resizable t)
          (moddb-&gt;modname-idxes :type (hash-table equal)))</pre> 
 
<p>where:</p> 
<ul> 
<li>
<span class="v">moddb-&gt;nmods</span> contains the number of modules in the database.</li> 
<li>
<span class="v">moddb-&gt;mods</span> is an array of <a href="SV____ELAB-MOD.html">elab-mod</a> structures, which we 
describe below, of which <span class="v">moddb-&gt;nmods</span> are valid.</li> 
<li>
<span class="v">moddb-&gt;modname-idxes</span> is a hash table mapping module names to indices.</li> 
</ul> 
 
<p>Together, <span class="v">moddb-&gt;mods</span> and <span class="v">moddb-&gt;modname-idxes</span> constitute a 
two-way mapping between module names and module indices.  It is a requirement 
of a well-formed moddb that both of the following hold:</p> 
 
<pre class="code">(<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____NATP.html">natp</a> i) (<a href="COMMON-LISP_____C3.html">&lt;</a> i (<a href="SV____MODDB-_E3NMODS.html">moddb-&gt;nmods</a> moddb)))
         (<a href="COMMON-LISP____EQUAL.html">equal</a> (moddb-&gt;modname-idxes-get
                 (elab-mod-&gt;name (moddb-&gt;modsi i moddb))
                 moddb)
                i))

(<a href="ACL2____IMPLIES.html">implies</a> (moddb-&gt;modname-idxes-get name moddb)
         (<a href="COMMON-LISP____EQUAL.html">equal</a> (elab-mod-&gt;name
                 (moddb-&gt;modsi
                  (moddb-&gt;modname-idxes-get name moddb)
                  moddb))
                name))</pre> 
 
<p>The <span class="v">moddb-&gt;mods</span> field is an array of <a href="SV____ELAB-MOD.html">elab-mod</a> stobjs.  Thus, a 
moddb is a nested stobj -- see <a href="ACL2____NESTED-STOBJS.html">ACL2::nested-stobjs</a>.  An elab-mod is an 
abstract stobj; more detailed documentation of its accessors/updaters is in 
<a href="SV____ELAB-MOD.html">elab-mod</a>.  Generally speaking, an elab-mod has a name, an array of 
wires, and an array of submodule instances, as well as a count of the total 
number of wires/instances in itself its instances.  For each submodule 
instance, it also has a wire offset and an instance offset, which say where 
that submodule instance falls in the module-wide ordering of wires and 
instances.</p> 
 
<h3>Usage</h3> 
 
<p>To create a moddb, users should always use <a href="SV____MODULE-_E3DB.html">module-&gt;db</a> to put the 
dependencies of some module in a <a href="SV____MODALIST.html">modalist</a> into the database.  Any other 
updates to a moddb require careful consideration of well-formedness 
invariants.</p>
</body>
</html>
