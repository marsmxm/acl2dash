<html>
<head>
<meta charset="UTF-8">
<title>Definterface-hmac</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=CRYPTO____DEFINTERFACE-HMAC">Click for Definterface-hmac in the Full Manual</a></h3>

<p>Introduce an <a href="CRYPTO____INTERFACES.html">interface</a> for a cryptographic 
           hash-based message authentication (HMAC) function.</p><h3>Introduction</h3><p>HMAC is specified in the <a href="https://tools.ietf.org/html/rfc2104" target="_blank"><nobr>RFC 2104 standard<img src="../Icon_External_Link.png" title="External link to https://tools.ietf.org/html/rfc2104"></nobr></a>. It is parameterized over a hash function, 
     i.e. there is an HMAC variant for each choice of the hash function.</p><p>This macro introduces a weakly constrained ACL2 function 
     for an HMAC function; 
     the underlying hash function is specified via a reference to 
     the name of an existing <span class="tt"><a href="CRYPTO____DEFINTERFACE-HASH.html">definterface-hash</a></span>. 
     The HMAC function 
     takes two byte lists as arguments (the key and the text), 
     and returns a byte list; 
     the use of bytes (vs. bits) is consistent with RFC 2104. 
     The guard of the function requires the arguments to be byte lists. 
     The function is constrained to fix its arguments to byte lists, 
     and to return a byte list whose size is 
     the output size of the hash function.</p><p>If the referenced hash function has no limit on its input size, 
     the HMAC function has no limit on the sizes of its inputs either. 
     Otherwise, limits are derived as follows, 
     and included in the guard of the generated constrained function. 
     RFC 2104 says that the key size 
     must not exceed the hash function's block size 
     in order for the key to be used ``directly'', 
     otherwise the key is hashed and its hash used: 
     either way, the key or its hash is padded to the block size. 
     RFC 2104 says that an inner hash is taken 
     of the concatenation of 
     (i) the (xor'd) padded key or key hash and (ii) the text, 
     whose total size must therefore not exceed 
     the hash function's maximum input size: 
     it follows that the size of the text must not exceed 
     the hash function's maximum input size dimished by 
     the hash function's block size. 
     Note that <span class="tt"><a href="CRYPTO____DEFINTERFACE-HASH.html">definterface-hash</a></span> has no information about 
     the hash function's block size, 
     which is therefore supplied directly to <span class="v">definterface-hmac</span>. 
     RFC 2104 then takes an outer hash of the concatenation of 
     the (xor'd) key and the inner hash output, 
     but that is always well below the hash function's input size limit.</p><p>This macro also introduces a few theorems 
     that follow from the constraints. 
     It also introduces an XDOC topic for the generated 
     function, constraints, and theorems.</p><h3>General Form</h3><pre class="code">(<a href="CRYPTO____DEFINTERFACE-HMAC.html">definterface-hmac</a> name
                   :hash ...
                   :block-size ...
                   :topic ...
                   :parents ...
                   :short ...
                   :long ...
  )</pre><h3>Inputs</h3><p><span class="v">name</span></p><blockquote><p>A symbol that names the HMAC function.</p></blockquote><p><span class="v">:hash</span></p><blockquote><p>The name of an existing <span class="tt"><a href="CRYPTO____DEFINTERFACE-HASH.html">definterface-hash</a></span>.</p></blockquote><p><span class="v">:block-size</span></p><blockquote><p>A constant expression whose value is a positive integer. 
      This is the hash function's block size in bytes. 
      This input must be present if the hash function 
      has an input size limit; 
      otherwise, this input must be absent.</p></blockquote><p><span class="v">:topic</span></p><blockquote>
<p>A symbol that names the generated XDOC topic 
      that surrounds the generated functions and theorems.</p>
<p>If not supplied, it defaults to <span class="v">name</span> followed by <span class="v">-interface</span>.</p>
</blockquote><p><span class="v">:parents</span><br><span class="v">:short</span><br><span class="v">:long</span></p><blockquote><p>These, if present, are added to 
      the XDOC topic generated for the fixtype.</p></blockquote><h3>Generated Events</h3><p><span class="v">name</span></p><blockquote>
<p>A constrained function that represents the HMAC function.</p>
<p>Its guard consists of <span class="tt"><a href="ACL2____BYTE-LISTP.html">byte-listp</a></span> for both arguments and, 
      if applicable, conditions on their lengths as explained above.</p>
<p>This function is constrained to:</p>
<ul>
<li>Return a <span class="tt"><a href="ACL2____BYTE-LISTP.html">byte-listp</a></span> 
       of length equal to the output size of the hash function.</li>
<li>Fix its inputs to <span class="tt"><a href="ACL2____BYTE-LISTP.html">byte-listp</a></span>.</li>
</ul>
<p>The following additional theorems are also generated:</p>
<ul>
<li>A type prescription rules saying that 
       the function returns a <span class="tt"><a href="ACL2____TRUE-LISTP.html">true-listp</a></span>.</li>
<li>A type prescription rule saying that 
       the function returns a <span class="tt"><a href="COMMON-LISP____CONSP.html">consp</a></span>.</li>
</ul>
</blockquote>
</body>
</html>
