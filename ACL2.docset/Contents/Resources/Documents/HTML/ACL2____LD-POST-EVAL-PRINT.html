<html>
<head>
<meta charset="UTF-8">
<title>Ld-post-eval-print</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____LD-POST-EVAL-PRINT">Click for Ld-post-eval-print in the Full Manual</a></h3>

<p>Determines whether and how <span class="tt"><a href="ACL2____LD.html">ld</a></span> prints the result of evaluation</p><p><span class="v">Ld-post-eval-print</span> is an <span class="tt"><a href="ACL2____LD.html">ld</a></span> special (see <a href="ACL2____LD.html">ld</a>). 
 The accessor is <span class="v">(<a href="ACL2____LD-POST-EVAL-PRINT.html">ld-post-eval-print</a> state)</span> and the updater is 
 <span class="v">(set-ld-post-eval-print val state)</span>.  <span class="v">Ld-post-eval-print</span> must be 
 either <span class="v">t</span>, <span class="v">nil</span>, or <span class="v">:command-conventions</span>.  The initial value of 
 <span class="v">ld-post-eval-print</span> is <span class="v">:command-conventions</span>.</p> 
 
 <p>The general-purpose ACL2 read-eval-print loop, <span class="tt"><a href="ACL2____LD.html">ld</a></span>, reads forms from 
 <span class="tt"><a href="ACL2____STANDARD-OI.html">standard-oi</a></span>, evaluates them and prints the result to <span class="tt"><a href="ACL2____STANDARD-CO.html">standard-co</a></span>.  Note that the ACL2 top-level loop (see <span class="tt"><a href="ACL2____LP.html">lp</a></span>) results from 
 an invocation of <span class="tt"><a href="ACL2____LD.html">ld</a></span>.</p> 
 
 <p>However, there are various flags that control <span class="tt"><a href="ACL2____LD.html">ld</a></span>'s behavior and 
 <span class="v">ld-post-eval-print</span> is one of them.  If this global variable is <span class="v">t</span>, 
 <span class="tt"><a href="ACL2____LD.html">ld</a></span> prints the result.  In the case of a form that produces a multiple 
 value, <span class="tt"><a href="ACL2____LD.html">ld</a></span> prints the list containing all the values (which, logically 
 speaking, is what the form returned).  If <span class="v">ld-post-eval-print</span> is <span class="v">nil</span>, 
 <span class="tt"><a href="ACL2____LD.html">ld</a></span> does not print the values.  This is most useful when <span class="tt"><a href="ACL2____LD.html">ld</a></span> is 
 used to load a previously processed file.</p> 
 
 <p>Finally, if <span class="v">ld-post-eval-print</span> is <span class="v">:command-conventions</span> and also 
 <span class="v">ld-error-triples</span> is <span class="v">t</span>, then <span class="tt"><a href="ACL2____LD.html">ld</a></span> prints the result but treats 
 ``error triples'' specially.  An ``error triple'' (see <a href="ACL2____ERROR-TRIPLE.html">error-triple</a>) 
 is a result, <span class="v">(<a href="ACL2____MV.html">mv</a> erp val state)</span>, that consists of two ordinary values and 
 <span class="tt"><a href="ACL2____STATE.html">state</a></span>.  Many ACL2 functions use such triples to signal errors.  The 
 convention is that if <span class="v">erp</span> (the first value) is <span class="v">nil</span>, then the 
 function is returning <span class="v">val</span> (the second value) as its conventional single 
 result and possibly side-effecting <a href="ACL2____STATE.html">state</a> (as with some output).  If 
 <span class="v">erp</span> is not <span class="v">nil</span>, then an error has been caused, <span class="v">val</span> is 
 irrelevant and the error message has been printed in the returned <a href="ACL2____STATE.html">state</a>.  Example ACL2 functions that follow this convention include <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span> and <span class="tt"><a href="COMMON-LISP____IN-PACKAGE.html">in-package</a></span>.  If such ``error producing'' functions are 
 evaluated while <span class="v">ld-post-eval-print</span> is set to <span class="v">t</span>, then you would see 
 them producing lists of length 3.  This is disconcerting to users accustomed 
 to Common Lisp (where these functions produce single results but sometimes 
 cause errors or side-effect <a href="ACL2____STATE.html">state</a>).  For more information about error 
 triples, see <a href="ACL2____PROGRAMMING-WITH-STATE.html">programming-with-state</a>.</p> 
 
 <p>When <span class="v">ld-post-eval-print</span> is <span class="v">:command-conventions</span> and a form 
 produces an error triple <span class="v">(<a href="ACL2____MV.html">mv</a> erp val state)</span> as its value, <span class="tt"><a href="ACL2____LD.html">ld</a></span> 
 prints nothing if <span class="v">erp</span> is non-<span class="v">nil</span> and otherwise <span class="tt"><a href="ACL2____LD.html">ld</a></span> prints 
 just <span class="v">val</span>.  Because it is a misrepresentation to suggest that just one 
 result was returned, <span class="tt"><a href="ACL2____LD.html">ld</a></span> prints the value of the global variable 
 <span class="v">'triple-print-prefix</span> before printing <span class="v">val</span>.  <span class="v">'triple-print-prefix</span> 
 is initially <span class="v">" "</span>, which means that when non-erroneous error triples are 
 being abbreviated to <span class="v">val</span>, <span class="v">val</span> appears one space off the left margin 
 instead of on the margin.</p> 
 
 <p>In addition, when <span class="v">ld-post-eval-print</span> is <span class="v">:command-conventions</span> and 
 the value component of an error triple is the keyword <span class="v">:invisible</span> then 
 <span class="tt"><a href="ACL2____LD.html">ld</a></span> prints nothing.  This is the way certain commands (e.g., 
 <span class="v">:</span><span class="tt"><a href="ACL2____PC.html">pc</a></span>) appear to return no value.</p> 
 
 <p>By printing nothing when an error has been signalled, <span class="tt"><a href="ACL2____LD.html">ld</a></span> makes it 
 appear that the error (whose message has already appeared in <a href="ACL2____STATE.html">state</a>) has 
 ``thrown'' the computation back to load without returning a value.  By 
 printing just <span class="v">val</span> otherwise, we suppress the fact that <a href="ACL2____STATE.html">state</a> has 
 possibly been changed.</p>
</body>
</html>
