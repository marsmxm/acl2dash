<html>
<head>
<meta charset="UTF-8">
<title>Def-1d-arr</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____DEF-1D-ARR">Click for Def-1d-arr in the Full Manual</a></h3>

<p>Defines a <a href="ACL2____ABSTRACT-STOBJ.html">abstract-stobj</a> that logically just appears to be a 
typed list but is implemented as an array.</p><p>Def-1d-arr produces an <a href="ACL2____ABSTRACT-STOBJ.html">abstract-stobj</a> and associated 
<span class="v">get</span>, <span class="v">set</span>, <span class="v">resize</span>, and <span class="v">length</span> functions.  Logically the 
stobj just looks like an (optionally) typed list.  But for execution, these 
functions are stobj array operations.</p> 
 
<p>How is this any better than just using <a href="ACL2____DEFSTOBJ.html">defstobj</a> to define a new stobj 
with an array field?  With a regular <span class="v">defstobj</span>, the stobj is logically 
viewed as a singleton list whose <span class="v">car</span> holds the contents.  With 
<span class="v">def-1d-arr</span> this extra layer goes away: the stobj itself, rather than its 
<span class="v">car</span>, looks like the list of elements.</p> 
 
<p>This difference is slight, but it can help to simplify reasoning, e.g., it 
can make <a href="ACL2____CONGRUENCE.html">congruence</a>-based reasoning via <a href="ACL2____EQUIVALENCE.html">equivalence</a> relations 
like <a href="ACL2____LIST-EQUIV.html">ACL2::list-equiv</a> and <a href="ACL2____SET-EQUIV.html">ACL2::set-equiv</a> easier to apply to your 
array, and can also make it easier to use proof strategies like <a href="ACL2____EQUAL-BY-NTHS.html">ACL2::equal-by-nths</a>.</p> 
 
<h3>Example</h3> 
 
<p>The following defines a bit array named <a href="ACL2____BITARR.html">bitarr</a>.</p> 
 
<pre class="code">(<a href="ACL2____DEF-1D-ARR.html">def-1d-arr</a> bitarr          ;; Stobj name
  :slotname    bit          ;; Base name for accessor functions
  :pred        bitp         ;; Element type (optional)
  :type-decl   bit          ;; Element type-spec (optional)
  :fix         bfix         ;; Element fixing function (optional)
  :default-val 0            ;; Element default value (for resizing)
  :parents (<a href="ACL2____STD_F2STOBJS.html">std/stobjs</a>))    ;; XDOC parent topics</pre> 
 
 
<h3>Keyword Options</h3> 
 
<dl> 
 
<dt>
<span class="v">:slotname</span> and <span class="v">:pkg-sym</span>
</dt> 
 
<dd>The <span class="v">:slotname</span> influences the names of the array get, set, length, and 
resize functions.  In the example above, using <span class="v">bit</span> results in functions 
named <span class="v">get-bit</span>, <span class="v">set-bit</span>, <span class="v">bits-length</span>, and <span class="v">resize-bits</span>. 
Default: <span class="v">&lt;arrname&gt;val</span>.</dd> 
 
<dd>The <span class="v">:pkg-sym</span>, if given, determines the package in which any newly 
created symbols will be interned.  It defaults to the array name.</dd> 
 
 
<dt><span class="v">:pred</span></dt> 
 
<dd>This can be used to restrict the types of elements that can be put into the 
array.  It impacts the array recognizer's definition and the guard of the array 
functions.  The default is <span class="v">nil</span>, meaning that there are no restrictions and 
any kind of element can be put into the array.</dd> 
 
 
<dt><span class="v">:default-val</span></dt> 
 
<dd>This gives the default array element for resizing, i.e., the 
<span class="v">:initially</span> argument to the underlying <a href="ACL2____STOBJ.html">stobj</a>.  This is often 
necessary when you provide a restricted <span class="v">:pred</span>, because the default value 
needs to satisfy the predicate.</dd> 
 
 
<dt><span class="v">:type-decl</span></dt> 
 
<dd>This provides a Common Lisp <a href="ACL2____TYPE-SPEC.html">ACL2::type-spec</a> declaration for the 
array element's type.  It primarily affects memory efficiency and performance. 
It must sensibly agree with the given <span class="v">pred</span>.</dd> 
 
 
<dt><span class="v">:fix</span></dt> 
 
<dd>Optional, requires a compatible <span class="v">:pred</span>.  This alters the logical 
definition of the getting function so that it always produces a result of the 
correct type.  For example, by using <span class="v">:fix bfix</span> above, <span class="v">get-bit</span> will be 
defined as <span class="v">(bit-fix (<a href="COMMON-LISP____NTH.html">nth</a> i bitarr))</span> instead of just a call of <a href="COMMON-LISP____NTH.html">nth</a>.</dd> 
 
<dt>
<span class="v">:parents</span>, <span class="v">:short</span>, <span class="v">:long</span>
</dt> 
 
<dd>These options are as in <a href="ACL2____DEFXDOC.html">defxdoc</a>.  Note that you typically don't need 
to give <span class="v">:short</span> or <span class="v">:long</span> descriptions because reasonable boilerplate 
documentation can be generated automatically.</dd> 
 
</dl>
</body>
</html>
