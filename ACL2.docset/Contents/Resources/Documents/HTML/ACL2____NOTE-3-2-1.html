<html>
<head>
<meta charset="UTF-8">
<title>Note-3-2-1</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____NOTE-3-2-1">Click for Note-3-2-1 in the Full Manual</a></h3>

<p>ACL2 Version  3.2.1 (June, 2007) Notes</p><p>NOTE!  New users can ignore these release notes, because the <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> has been updated to reflect all changes that are recorded 
 here.</p> 
 
 <p>(OpenMCL and multi-threaded SBCL only) Fixed a soundness bug in the 
 evaluation of <span class="tt"><a href="ACL2____MBE.html">mbe</a></span> forms in the presence of Lisp feature 
 <span class="v">:acl2-mv-as-values</span>.  Thanks to Sol Swords for reporting this problem and 
 sending a simple proof of <span class="v">nil</span> (which can be found in a comment in the 
 ACL2 sources, in <span class="v">(<a href="ACL2____DEFLABEL.html">deflabel</a> note-3-2-1 ...)</span>).</p> 
 
 <p>Added a new utility, <span class="tt"><a href="ACL2____DMR.html">dmr</a></span> (Dynamically Monitor Rewrites), for 
 watching the activity of the rewriter and some other proof processes.  See 
 <a href="ACL2____DMR.html">dmr</a>.  We thank Robert Krug for useful contributions.</p> 
 
 <p>Fixed a bug in evaluation of calls of <span class="tt"><a href="ACL2____WITH-PROVER-TIME-LIMIT.html">with-prover-time-limit</a></span>.</p> 
 
 <p>Fixed the writing of executable scripts when building ACL2, so that the 
 build-time value of environment variable <span class="v">ACL2_SYSTEM_BOOKS</span> is no longer 
 written there.  Thanks to Dave Greve for discussing this change.</p> 
 
 <p>Fixed bugs in <span class="v">:</span><span class="tt"><a href="ACL2____PL.html">pl</a></span> (which are similarly present in the <a href="ACL2____PROOF-BUILDER.html">proof-builder</a>'s <span class="v">sr</span> (<span class="v">show-rewrites</span>) command.  The first bug was 
 evident from the following forms sent by Robert Krug, which caused an 
 error.</p> 
 
 <pre class="code">(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "arithmetic-3/floor-mod/floor-mod" :dir :system)
:pl (<a href="COMMON-LISP____MOD.html">mod</a> (<a href="COMMON-LISP_____B2.html">+</a> 1 x) n)</pre> 
 
 <p>The second bug was due to a failure to take note of which rules are 
 disabled, and could be seen by executing the following (very slow!).</p> 
 
 <pre class="code">(<a href="ACL2____DEFSTUB.html">defstub</a> modulus () t)
(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "arithmetic-3/floor-mod/floor-mod" :dir :system)
:pl (<a href="COMMON-LISP____MOD.html">mod</a> (<a href="COMMON-LISP_____B2.html">+</a> x y) (modulus))</pre> 
 
 <p>Modified <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span> so that by default, all 
 executable-counterpart functions (sometimes called ``*1* functions'') are 
 compiled.  This is the behavior that was already supported with a 
 <span class="v">compile-flg</span> argument of <span class="v">:all</span>; the change is that argument <span class="v">t</span> now 
 has this behavior as well (and <span class="v">:all</span> is supported only for legacy 
 purposes).  A new value for <span class="v">compile-flg</span>, <span class="v">:raw</span>, gives the behavior 
 formerly produced by value <span class="v">t</span>, namely where executable-counterpart 
 functions are not compiled.  The above changes are irrelevant if compilation 
 is suppressed; see <a href="ACL2____COMPILATION.html">compilation</a>.  Finally, if environment variable 
 <span class="v">ACL2_COMPILE_FLG</span> is set, then after converting to upper-case this 
 environment variable's value of <span class="v">"T"</span>, <span class="v">"NIL"</span>, or <span class="v">":RAW"</span> 
 will determine the value of the optional <span class="v">compile-flg</span> argument to be 
 <span class="v">t</span>, <span class="v">nil</span>, or <span class="v">:raw</span>, respectively, when this argument is not 
 explicitly supplied.</p> 
 
 <p>Modified <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> so that <span class="v">:comp</span> argument now acts like 
 <span class="v">:comp!</span>, i.e., compiling a file that includes the file together with all 
 executable counterpart (so-called ``*1*'') functions.  A new argument, 
 <span class="v">:comp-raw</span>, has the behavior that <span class="v">:comp</span> had formerly, i.e., compiling 
 the actual book only.</p> 
 
 <p>The function <span class="tt"><a href="ACL2____NONNEGATIVE-INTEGER-QUOTIENT.html">nonnegative-integer-quotient</a></span> is now computed in raw 
 Lisp by calling <span class="tt"><a href="COMMON-LISP____FLOOR.html">floor</a></span> on its arguments.  This change was suggested by 
 Peter Dillinger, in order to avoid stack overflows such as reported by Daron 
 Vroon.  A new book, <span class="v">books/misc/misc2/misc.lisp</span>, contains a proof of 
 equivalence of <span class="tt"><a href="ACL2____NONNEGATIVE-INTEGER-QUOTIENT.html">nonnegative-integer-quotient</a></span> and <span class="tt"><a href="COMMON-LISP____FLOOR.html">floor</a></span>, and 
 serves as a repository for other miscellaneous proofs, including those 
 justifying ACL2 modifications such as this one.</p> 
 
 <p>Enhanced <span class="tt"><a href="ACL2____ACCUMULATED-PERSISTENCE.html">accumulated-persistence</a></span> to break down results by useful 
 vs.  useless rule applications.  In particular, this provides information 
 about which rules were ever applied successfully, as requested by Bill 
 Young.</p> 
 
 <p>Added coverage of <span class="v">:</span><span class="tt"><a href="ACL2____META.html">meta</a></span> rules to the <span class="tt"><a href="ACL2____ACCUMULATED-PERSISTENCE.html">accumulated-persistence</a></span> statistics.</p> 
 
 <p>Fixed a bug that was causing a <span class="v">:</span><span class="tt"><a href="ACL2____CLAUSE-PROCESSOR.html">clause-processor</a></span> hint to fire 
 on a subgoal of the goal to which it was attached, when the original 
 application didn't change the clause.  Thanks to Dave Greve for pointing out 
 this bug and providing a useful example.</p> 
 
 <p>Fixed a bug in handling of computed <a href="ACL2____HINTS.html">hints</a> related to the 
 <span class="v">stable-under-simplificationp</span> parameter (see <a href="ACL2____COMPUTED-HINTS.html">computed-hints</a>). 
 There were actually two bugs.  A minor but confusing bug was that the same 
 goal was printed twice upon application of such a hint.  The major bug was 
 that <span class="v">:use</span> <a href="ACL2____HINTS.html">hints</a> (as well as other ``top'' hints: <span class="v">:by</span>, 
 <span class="v">:cases</span>, and <span class="v">:clause-processor</span>) were not being applied properly. 
 Thanks to Jared Davis for sending an example some time ago that showed the 
 duplicate printing, and to Dave Greve for sending an example showing 
 mis-application of <span class="v">:</span><span class="tt"><a href="ACL2____CLAUSE-PROCESSOR.html">clause-processor</a></span> <a href="ACL2____HINTS.html">hints</a>.  Note that you 
 may find that existing computed hints using the 
 <span class="v">stable-under-simplificationp</span> parameter no longer have the same behavior; 
 see a comment about computed hints in <span class="v">note-3-2-1</span>, ACL2 source file 
 <span class="v">ld.lisp</span>, for an example of how you might want to fix such computed 
 hints.</p> 
 
 <p>David Russinoff has contributed an updated version of 
 <span class="v">books/quadratic-reciprocity/</span> including minor modifications of the 
 treatment of prime numbers and a proof that there exist infinitely many 
 primes.  Thanks to David for contributing this work, and to Jose Luis 
 Ruiz-Reina for posing the challenge.</p> 
 
 <p>Reduced the sizes of some <a href="ACL2____CERTIFICATE.html">certificate</a> (<span class="v">.cert</span>) files by relaxing 
 the test that allows original <span class="tt"><a href="ACL2____DEFPKG.html">defpkg</a></span> <a href="ACL2____EVENTS.html">events</a> to be placed there, 
 rather than evaluating the import list term into an explicit list of 
 symbols.</p> 
 
 <p>Improved execution efficiency slightly for function <span class="v">rcdp</span> in file 
 <span class="v">books/misc/records.lisp</span>, by using <span class="tt"><a href="ACL2____MBE.html">mbe</a></span> to introduce a 
 tail-recursive body.</p> 
 
 <p>The executable script generated by <span class="tt"><a href="ACL2____SAVE-EXEC.html">save-exec</a></span> (and by the normal 
 build process) now includes a time stamp as a comment.  Thanks to Jared Davis 
 for suggesting this change in order to support his use of <span class="v">omake</span>.  In the 
 process, we also arranged that the startup banner for an executable created by 
 <span class="tt"><a href="ACL2____SAVE-EXEC.html">save-exec</a></span> shows all of the build (save) times, not just the one for 
 the original image.</p> 
 
 <p>Sped up most redundant <span class="tt"><a href="ACL2____DEFPKG.html">defpkg</a></span> <a href="ACL2____EVENTS.html">events</a> by avoiding evaluation 
 and sorting of the imports list in the case of identical event forms.  And, 
 for <span class="tt"><a href="ACL2____DEFPKG.html">defpkg</a></span> events that are not redundant, sped up their processing in 
 Allegro CL (and perhaps other Lisps, but apparently not GCL) by using our own 
 <span class="v">import</span> function.</p> 
 
 <p>Modified <span class="tt"><a href="ACL2____ADD-INCLUDE-BOOK-DIR.html">add-include-book-dir</a></span> so that it refuses to associate a 
 keyword with a different directory string than one it is already bound to. 
 See <a href="ACL2____DELETE-INCLUDE-BOOK-DIR.html">delete-include-book-dir</a> for how to remove the existing binding 
 first.  Thanks to Robert Krug for pointing out that without this change, one 
 can find it difficult to debug a failure due to rebinding a keyword with 
 <span class="tt"><a href="ACL2____ADD-INCLUDE-BOOK-DIR.html">add-include-book-dir</a></span>.</p> 
 
 <p>Added a new value for the <span class="v">:do-not-induct</span> hint (see <a href="ACL2____HINTS.html">hints</a>), 
 <span class="v">:otf-flg-override</span>, which causes ACL2 to ignore the <span class="v">:</span><span class="tt"><a href="ACL2____OTF-FLG.html">otf-flg</a></span> 
 when considering whether to abort the proof because of a <span class="v">:do-not-induct</span> 
 hint.  Thanks to Daron Vroon for suggesting such an addition.</p> 
 
 <p>Modified the printing of messages for entering and exiting raw mode (see 
 <a href="ACL2____SET-RAW-MODE.html">set-raw-mode</a>), so that in particular they are inhibited during <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> or whenever <span class="v">observation</span>s are inhibited (see <a href="ACL2____SET-INHIBIT-OUTPUT-LST.html">set-inhibit-output-lst</a>).  Thanks to Peter Dillinger for suggesting such a 
 change.</p> 
 
 <p>(For system hackers only.)  The handling of <a href="ACL2____EVENTS.html">events</a> of the form 
 <span class="v">(<a href="ACL2____PROGN_12.html">progn!</a> (<a href="ACL2____STATE-GLOBAL-LET_A2.html">state-global-let*</a> ...))</span> had a bug that was causing bindings to 
 be evaluated twice.  Moreover, the use of system function <span class="tt"><a href="ACL2____STATE-GLOBAL-LET_A2.html">state-global-let*</a></span> is suspect in raw Lisp.  We have eliminated special 
 treatment of <span class="v">state-global-let*</span> by <span class="v">progn!</span> in favor of a new keyword 
 argument, <span class="v">state-global-bindings</span>, that provides the intended 
 functionality.  See <a href="ACL2____PROGN_12.html">progn!</a>.  Moreover, special handling that allowed 
 <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> forms under <span class="v">state-global-let*</span> has been removed; the 
 desired effect can be obtained using (progn! :state-global-bindings ...). 
 Thanks to Peter Dillinger for pointing out the above bug and collaborating on 
 these changes.</p> 
 
 <p>Incorporated backward-compatible enhancements to 
 <span class="v">books/misc/expander.lisp</span> from Daron Vroon (documented near the top of 
 that file).</p> 
 
 <p>The specification of <span class="v">:backchain-limit-lst</span> had required that only a 
 single (<span class="v">:</span><span class="tt"><a href="ACL2____REWRITE.html">rewrite</a></span>, <span class="v">:</span><span class="tt"><a href="ACL2____LINEAR.html">linear</a></span>, or <span class="v">:</span><span class="tt"><a href="ACL2____META.html">meta</a></span>) 
 rule be generated.  We have weakened this restriction to allow more than one 
 rule provided that each rule has the same list of hypotheses.  For example, 
 the rule class <span class="v">(:rewrite :backchain-limit-lst 1)</span> is now legal for the 
 corollary formula <span class="v">(<a href="ACL2____IMPLIES.html">implies</a> (f x) (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____G.html">g</a> x) (h x)))</span>, where this was not 
 formerly the case.  Thanks to Dave Greve for bringing this issue to our 
 attention.</p>
</body>
</html>
