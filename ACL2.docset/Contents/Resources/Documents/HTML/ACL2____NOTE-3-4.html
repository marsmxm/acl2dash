<html>
<head>
<meta charset="UTF-8">
<title>Note-3-4</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____NOTE-3-4">Click for Note-3-4 in the Full Manual</a></h3>

<p>ACL2 Version  3.4 (August, 2008) Notes</p><p>NOTE!  New users can ignore these release notes, because the <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> has been updated to reflect all changes that are recorded 
 here.</p> 
 
 <p>Below we roughly organize the changes since Version 3.3 into changes to 
 existing features, new features, bug fixes, new and updated books, and Emacs 
 support.  Each change is described just once, though of course many changes 
 could be placed in more than one category.</p> 
 
 <p><b>CHANGES TO EXISTING FEATURES</b></p> 
 
 <p>Fixed a long-standing potential infinite loop in the rewriter.  Thanks to 
 Sol Swords for sending a concise example illustrating the looping behavior. 
 (Those interested in details are welcome to look at the comment about loop 
 behavior in source function <span class="v">rewrite-equal</span>.)</p> 
 
 <p>Incorporated a slight strengthening of non-linear arithmetic contributed by 
 Robert Krug (thanks, Robert).  With non-linear arithmetic enabled, the problem 
 was essentially that ACL2 made the following ``optimization'': given 
 inequalities <span class="v">(<a href="COMMON-LISP_____C3.html">&lt;</a> a u)</span> and <span class="v">(<a href="COMMON-LISP_____C3.html">&lt;</a> b v)</span>, for positive rational constants 
 <span class="v">a</span> and <span class="v">b</span> terms <span class="v">u</span> and <span class="v">v</span> of which at least one is known to be 
 rational, infer <span class="v">(<a href="COMMON-LISP_____C3.html">&lt;</a> (<a href="COMMON-LISP_____A2.html">*</a> a b) (<a href="COMMON-LISP_____A2.html">*</a> u v))</span>.  Without this optimization, however, 
 ACL2 now infers the stronger inequality obtained by direct multiplication of 
 the two given inequalities.  To see the effect of this change, submit the 
 event <span class="v">(<a href="ACL2____SET-NON-LINEARP.html">set-non-linearp</a> t)</span> followed by:</p> 
 
 <pre class="code">(<a href="ACL2____THM.html">thm</a> (<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____RATIONALP.html">rationalp</a> x) (<a href="COMMON-LISP_____C3.html">&lt;</a> 3 x)
                   (<a href="COMMON-LISP____RATIONALP.html">rationalp</a> y) (<a href="COMMON-LISP_____C3.html">&lt;</a> 4 y))
              (<a href="COMMON-LISP_____C3.html">&lt;</a> 0 (<a href="COMMON-LISP_____B2.html">+</a> 12 (<a href="COMMON-LISP_____A2.html">*</a> -4 x) (<a href="COMMON-LISP_____A2.html">*</a> -3 y) (<a href="COMMON-LISP_____A2.html">*</a> x y)))))</pre> 
 
 <p>The utility <span class="tt"><a href="ACL2____SET-CHECKPOINT-SUMMARY-LIMIT.html">set-checkpoint-summary-limit</a></span> has been modified in 
 several ways: it now takes a single argument (no longer takes <span class="tt"><a href="ACL2____STATE.html">state</a></span> as 
 an argument); a natural number <span class="v">n</span> abbreviates the pair <span class="v">(n . n)</span>; the 
 argument is no longer evaluated, but it still optionally may be quoted; and a 
 new value, <span class="v">t</span>, suppresses all printing of the checkpoint summary.  Thanks 
 to Jared Davis for suggesting most of these improvements.</p> 
 
 <p>There was formerly a restriction on <span class="tt"><a href="ACL2____MBE.html">mbe</a></span> that the <span class="v">:exec</span> 
 argument may not contain a call of <span class="tt"><a href="ACL2____MBE.html">mbe</a></span>.  This restriction has been 
 removed, thanks to a request from Jared Davis and Sol Swords.  Thanks also to 
 Sandip Ray, who pointed out that this restriction may have been in place in 
 order that <span class="tt"><a href="ACL2____DEFEXEC.html">defexec</a></span> can guarantee termination using the <span class="v">:exec</span> 
 code; its <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> has therefore been updated to clarify this 
 situation.</p> 
 
 <p>Rules of class <span class="v">:</span><span class="tt"><a href="ACL2____REWRITE.html">rewrite</a></span> are now stored by performing certain 
 logical simplifications on the left side of the conclusion: <span class="v">(<a href="ACL2____PROG2_42.html">prog2$</a> X Y)</span> 
 is replaced by <span class="v">Y</span>, <span class="v">(<a href="ACL2____MBE.html">mbe</a> :logic X :exec Y)</span> is replaced by <span class="v">X</span> (more 
 precisely, the analogous change is made to the generated call of <span class="tt"><a href="ACL2____MUST-BE-EQUAL.html">must-be-equal</a></span>); and <span class="v">(<a href="COMMON-LISP____THE.html">the</a> TYPE X)</span> is replaced by <span class="v">X</span> (again, the 
 change is actually made on the macroexpanded form).  Thanks to Jared Davis and 
 Sol Swords for requesting this change.  An analogous change has also been made 
 for rules of class <span class="v">:</span><span class="tt"><a href="ACL2____FORWARD-CHAINING.html">forward-chaining</a></span>.</p> 
 
 <p>The <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span> utility has been reimplemented to work independently of 
 the underlying Lisp trace.  It thus works the same for every host Lisp, except 
 as provided by an interface to the underlying host Lisp trace (the 
 <span class="v">:native</span> option).  Note that the host Lisp trace continues to be modified 
 for GCL, Allegro CL, and CCL (OpenMCL); see <a href="COMMON-LISP____TRACE.html">trace</a>.  See <a href="ACL2____TRACE_42.html">trace$</a> 
 for updated detailed documentation on tracing options, many of which are new, 
 for example an <span class="v">:evisc-tuple</span> option that can be set to <span class="v">:no-print</span> if 
 you want the function traced without the usual entry and exit printing.  The 
 previous <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span> had some issues, including the following, which have 
 all been fixed.  Thanks to Peter Dillinger for assistance in determining 
 desired functionality of the new <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span> and for helping to test 
 it.</p> 
 
 <blockquote> 
 
 <p>Recursive calls were not always shown in the trace for two reasons.  (1) 
 Compiler inlining could prevent recursive calls from being shown in the trace, 
 in particular in CCL (OpenMCL).  Thanks to Jared Davis and Warren Hunt for 
 pointing out this issue and requesting a fix, and to Bob Boyer and Gary Byers 
 for relevant helpful discussions.  (2) ACL2's algorithm for producing 
 executable counterparts prevented tracing of recursive calls even after 
 <span class="v">(<a href="ACL2____SET-GUARD-CHECKING.html">set-guard-checking</a> :none)</span>.  Thanks to Peter Dillinger for requesting a 
 fix.</p> 
 
 <p>It was possible to exploit a bug in the interaction of multiple values and 
 trace to prove a contradiction.  An example is in a comment in <span class="v">(<a href="ACL2____DEFLABEL.html">deflabel</a>
 note-3-4 ...)</span> in the ACL2 source code.</p> 
 
 <p>Certain large structures could cause expensive computations for printing 
 even when a <span class="v">:cond</span> condition was specified and evaluated to <span class="v">nil</span>.</p> 
 
 <p><span class="tt"><a href="ACL2____TRACE_12.html">Trace!</a></span> now suppresses printing of the event summary, and returns 
 the value that would be returned (if there is an active trust tag) by the 
 corresponding call of <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span>.</p> 
 
 <p>Some bugs have been fixed in the underlying native trace installed by ACL2 
 for GCL, Allegro CL, and CCL (OpenMCL), including the following.  In GCL it 
 had been impossible to use the variable <span class="v">ARGLIST</span> in a <span class="v">:cond</span> 
 expression.  In Allegro CL and CCL, a <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span> bug mishandled tracing 
 non-ACL2 functions when directives such as <span class="v">:entry</span> and <span class="v">:exit</span> were 
 supplied.  GCL trace now hides the world even when tracing non-ACL2 functions. 
 Tracing in CCL no longer causes a Lisp error when untracing a traced function 
 defined outside the ACL2 loop; for example <span class="v">(<a href="ACL2____TRACE_42.html">trace$</a> len1)</span> followed by 
 <span class="v">(<a href="ACL2____UNTRACE_42.html">untrace$</a> len1)</span> no longer causes an error.</p>
</blockquote> 
 
 <p>The macro <span class="v">wet</span> has been changed, for the better we think.  see <a href="ACL2____WET.html">wet</a>.</p> 
 
 <p>The generation of goals for <a href="ACL2____FORCING-ROUND.html">forcing-round</a>s has been changed to avoid 
 dropping assumptions formerly deemed ``irrelevant''.  (A simple example may be 
 found in a comment in source function <span class="v">unencumber-assumption</span>, source file 
 <span class="v">prove.lisp</span>.)  Thanks to Jared Davis for sending us an example that led us 
 to make this change.</p> 
 
 <p>Modified the implementation of <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> so that in the <a href="ACL2____CERTIFICATE.html">certificate</a> of a book, <span class="tt"><a href="ACL2____LOCAL.html">local</a></span> events arising from <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> 
 forms are elided.  For example, if <span class="v">(<a href="ACL2____MAKE-EVENT.html">make-event</a> &lt;form&gt;)</span> expands to 
 <span class="v">(<a href="ACL2____LOCAL.html">local</a> &lt;expanded-form&gt;)</span>, then where the latter had been stored in the 
 certificate, now instead <span class="v">(<a href="ACL2____LOCAL.html">local</a> (<a href="ACL2____VALUE-TRIPLE.html">value-triple</a> :ELIDED))</span> will be stored. 
 Thanks to Eric Smith for requesting this improvement.  He has reported that a 
 preliminary version of this improvement shrunk a couple of his <span class="v">.cert</span> 
 files from perhaps 40MB each to about 140K each.</p> 
 
 <p>Now, a <span class="tt"><a href="ACL2____TABLE.html">table</a></span> event that sets the entire table, <span class="v">(<a href="ACL2____TABLE.html">table</a> tbl nil
 alist :clear)</span>, is redundant (see <a href="ACL2____REDUNDANT-EVENTS.html">redundant-events</a>) when the supplied 
 <span class="v">alist</span> is equal to the current value of the table.  Thanks to Peter 
 Dillinger for requesting this change.</p> 
 
 <p>The event constructor <span class="tt"><a href="ACL2____PROGN_12.html">progn!</a></span> now returns the value that is returned 
 by evaluation of its final form if no error occurs, except that it still 
 returns <span class="v">nil</span> if the that final evaluation leaves ACL2 in raw-mode.</p> 
 
 <p><span class="v">:</span><span class="tt"><a href="ACL2____PSO.html">Pso</a></span> and <span class="v">:</span><span class="tt"><a href="ACL2____PSOG.html">psog</a></span> have been improved so that they 
 show the key checkpoint summary at the end of a failed proof.  (For a 
 discussion of key checkpoints, see <a href="ACL2____SET-GAG-MODE.html">set-gag-mode</a>.)  As a result, a call 
 of <span class="tt"><a href="ACL2____SET-CHECKPOINT-SUMMARY-LIMIT.html">set-checkpoint-summary-limit</a></span> now affects subsequent evaluation of 
 <span class="v">:</span><span class="tt"><a href="ACL2____PSO.html">pso</a></span> and <span class="v">:</span><span class="tt"><a href="ACL2____PSOG.html">psog</a></span>.  In particular, you no longer need 
 to reconstruct a proof (by calling <span class="tt"><a href="ACL2____THM.html">thm</a></span> or <span class="tt"><a href="ACL2____DEFTHM.html">defthm</a></span>) in order to 
 see key checkpoints that were omitted due to the limit; just call <span class="tt"><a href="ACL2____SET-CHECKPOINT-SUMMARY-LIMIT.html">set-checkpoint-summary-limit</a></span> and then run <span class="v">:pso</span> or <span class="v">:psog</span>.</p> 
 
 <p>The <a href="ACL2____PROOF-BUILDER.html">proof-builder</a> behaves a little differently under <a href="ACL2____GAG-MODE.html">gag-mode</a>.  Now, proof-builder commands that call the theorem prover to create 
 new proof-builder goals, such as <span class="v">bash</span> and <span class="v">induct</span> (see <a href="ACL2____PROOF-BUILDER-COMMANDS.html">proof-builder-commands</a>), will show key checkpoints when in <a href="ACL2____GAG-MODE.html">gag-mode</a>. 
 As before, proof-builder commands <span class="v">pso</span> and <span class="v">pso!</span> (and now, also 
 <span class="v">psog</span>)  see <a href="ACL2____PSO.html">pso</a>, see <a href="ACL2____PSOG.html">psog</a>, and see <a href="ACL2____PSO_12.html">pso!</a> 
  can then show the unedited proof log.  However, unlike proof attempts 
 done in the ACL2 loop, such proof attempts will not show a summary of key 
 checkpoints at the end, because from a prover perspective, all such goals were 
 considered to be temporarily ``proved'' by giving them ``byes'', to be 
 dispatched by later proof-builder commands.</p> 
 
 <p>A little-known feature had been that a <a href="ACL2____MEASURE.html">measure</a> of <span class="v">0</span> was treated 
 as though no measure was given.  This has been changed so that now, a <a href="ACL2____MEASURE.html">measure</a> of <span class="v">nil</span> is treated as though no measure was given.</p> 
 
 <p>Expanded <span class="v">*acl2-exports*</span> to include every documented symbol whose name 
 starts with <span class="v">"SET-"</span>.  Thanks to Jared Davis for remarking that <span class="tt"><a href="ACL2____SET-DEBUGGER-ENABLE.html">set-debugger-enable</a></span> was omitted from <span class="v">*acl2-exports*</span>, which led to this 
 change.</p> 
 
 <p>The <a href="COMMON-LISP____TRACE.html">trace</a> mechanism has been improved so that the <span class="v">:native</span> and 
 <span class="v">:multiplicity</span> options can be used together for Lisps that support the 
 trace <span class="v">:exit</span> keyword.  These Lisps include GCL and Allegro CL, whose 
 native trace utilities have been modified for ACL2.  For SBCL and CCL 
 (OpenMCL), which use the built-in Lisp mechanism for returning multiple values 
 in ACL2 (see <a href="ACL2____MV.html">mv</a>), the use of <span class="v">:multiplicity</span> with <span class="v">:native</span> 
 remains unnecessary and will be ignored.  In support of this change, the 
 modification of native Allegro CL tracing for ACL2 was fixed to handle 
 <span class="v">:exit</span> forms correctly that involve <span class="tt"><a href="ACL2____MV.html">mv</a></span>.</p> 
 
 <p><b>NEW FEATURES</b></p> 
 
 <p>The command <span class="v">:</span><span class="tt"><a href="ACL2____REDEF_12.html">redef!</a></span> is just like <span class="v">:</span><span class="tt"><a href="ACL2____REDEF.html">redef</a></span>, but 
 prints a warning rather than doing a query.  The old version of <span class="v">:redef!</span> 
 was for system hackers and has been renamed to <span class="v">:</span><span class="tt"><a href="ACL2____REDEF_B2.html">redef+</a></span>.</p> 
 
 <p>Introduced a new utility for evaluating a function call using the so-called 
 executable counterpart  that is, executing the call in the logic rather 
 than in raw Lisp.  See <a href="ACL2____EC-CALL.html">ec-call</a>.  Thanks to Sol Swords for requesting 
 this utility and participating in its high-level design.</p> 
 
 <p>See <a href="ACL2____PRINT-GV.html">print-gv</a> for a new utility that assists with debugging guard 
 violations. Thanks to Jared Davis for requesting more tool assistance for 
 debugging guard violations.</p> 
 
 <p>Improved the guard violation error message to show the positions of the 
 formals, following to a suggestion of Peter Dillinger.</p> 
 
 <p>Added new <span class="tt"><a href="ACL2____GUARD-DEBUG.html">guard-debug</a></span> capability to assist in debugging failed 
 attempts at <a href="ACL2____GUARD.html">guard</a> verification.  See <a href="ACL2____GUARD-DEBUG.html">guard-debug</a>.  Thanks to 
 Jared Davis for requesting a tool to assist in such debugging and to him, 
 Robert Krug, and Sandip Ray for useful discussions.</p> 
 
 <p>New utilities provide the formula to be proved by <span class="tt"><a href="ACL2____VERIFY-GUARDS.html">verify-guards</a></span>. 
 See <a href="ACL2____VERIFY-GUARDS-FORMULA.html">verify-guards-formula</a> and see <a href="ACL2____GUARD-OBLIGATION.html">guard-obligation</a>, Thanks to 
 Mark Reitblatt for making a request leading to these utilities.  These 
 utilities can be applied to a term, not just an event name; thanks to Peter 
 Dillinger for correspondence that led to this extension.</p> 
 
 <p>A new utility causes runes to be printed as lists in proof output from 
 simplification, as is done already in proof summaries.  See <a href="ACL2____SET-RAW-PROOF-FORMAT.html">set-raw-proof-format</a>.  Thanks to Jared Davis for requesting this utility.</p> 
 
 <p>An experimental capability allows for parallel evaluation.  See <a href="ACL2____PARALLELISM.html">parallelism</a>.  Thanks to David Rager for providing an initial implementation 
 of this capability.</p> 
 
 <p>Defined <span class="tt"><a href="ACL2____XOR.html">xor</a></span> in analogy to <span class="tt"><a href="ACL2____IFF.html">iff</a></span>.  Thanks to Bob Boyer, Warren 
 Hunt, and Sol Swords for providing this definition.</p> 
 
 <p>Improved distributed file <span class="v">doc/write-acl2-html.lisp</span> so that it can now 
 be used to build HTML documentation files for <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> strings in 
 user <a href="ACL2____BOOKS.html">books</a>.  See the comment in the definition of macro 
 <span class="v">acl2::write-html-file</span> at the end of that file.  Thanks to Dave Greve and 
 John Powell for requesting this improvement.</p> 
 
 <p>It is now possible to specify <span class="v">:</span><span class="tt"><a href="ACL2____HINTS.html">hints</a></span> for non-recursive 
 function definitions (which can be useful when definitions are automatically 
 generated).  See <a href="ACL2____SET-BOGUS-DEFUN-HINTS-OK.html">set-bogus-defun-hints-ok</a>.  Thanks to Sol Swords for 
 requesting such a capability.</p> 
 
 <p>Keyword argument <span class="v">:dir</span> is now supported for <span class="tt"><a href="ACL2____REBUILD.html">rebuild</a></span> just as it 
 has been for <span class="tt"><a href="ACL2____LD.html">ld</a></span>.</p> 
 
 <p>We relaxed the criteria for functional substitutions, so that a function 
 symbol can be bound to a macro symbol that corresponds to a function symbol in 
 the sense of <span class="tt"><a href="ACL2____MACRO-ALIASES-TABLE.html">macro-aliases-table</a></span>.  So for example, a functional 
 substitution can now contain the doublet <span class="v">(f +)</span>, where previously it would 
 have been required instead to contain <span class="v">(f binary-+)</span>.</p> 
 
 <p>We now allow arbitrary packages in raw mode (see <a href="ACL2____SET-RAW-MODE.html">set-raw-mode</a>) 
  thanks to Jared Davis for requesting this enhancement  and more 
 than that, we allow arbitrary Common Lisp in raw mode.  Note however that for 
 arbitrary packages, you need to be in raw mode when the input is read, not 
 just when the input form is evaluated.</p> 
 
 <p>Two new keywords are supported by the <span class="tt"><a href="ACL2____WITH-OUTPUT.html">with-output</a></span> macro.  A 
 <span class="v">:gag-mode</span> keyword argument suppresses some prover output as is done by 
 <span class="tt"><a href="ACL2____SET-GAG-MODE.html">set-gag-mode</a></span>.  Thanks to Jared Davis for asking for a convenient way 
 to set <a href="ACL2____GAG-MODE.html">gag-mode</a> inside a book, in particular perhaps for a single 
 theorem; this keyword provides that capability.  A <span class="v">:stack</span> keyword allows 
 sub-<a href="ACL2____EVENTS.html">events</a> of <span class="tt"><a href="COMMON-LISP____PROGN.html">progn</a></span> or <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> to ``pop'' the 
 effect of a superior <span class="tt"><a href="ACL2____WITH-OUTPUT.html">with-output</a></span> call.  Thanks to Peter Dillinger for 
 requesting such a feature.  See <a href="ACL2____WITH-OUTPUT.html">with-output</a>.</p> 
 
 <p>The command <span class="tt"><a href="ACL2____GOOD-BYE.html">good-bye</a></span> and its aliases <span class="tt"><a href="ACL2____EXIT.html">exit</a></span> and <span class="tt"><a href="ACL2____QUIT.html">quit</a></span> 
 now all take an optional status argument, which provides the Unix exit status 
 for the underlying process.  Thanks to Florian Haftmann for sending a query to 
 the ACL2 email list that led to this enhancement.</p> 
 
 <p>Keyword commands now work for macros whose argument lists have lambda list 
 keywords.  For a macro with a <span class="v">lambda</span> list keyword in its argument list, 
 the corresponding keyword command reads only the minimum number of required 
 arguments.  See <a href="ACL2____KEYWORD-COMMANDS.html">keyword-commands</a>.</p> 
 
 <p>It is now legal to <span class="tt"><a href="COMMON-LISP____DECLARE.html">declare</a></span> variables <span class="v">ignorable</span> in <span class="tt"><a href="COMMON-LISP____LET_A2.html">let*</a></span> 
 forms, as in <span class="v">(<a href="COMMON-LISP____LET_A2.html">let*</a> ((x (<a href="COMMON-LISP_____B2.html">+</a> a b)) ...) (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> x)) ...)</span>. 
 Thanks to Jared Davis for requesting this enhancement.</p> 
 
 <p>Added a warning when more than one hint is supplied explicitly for the same 
 goal.  It continues to be the case that only the first hint applicable to a 
 given goal will be applied, as specified in the user-supplied list of 
 <span class="v">:hints</span> followed by the <span class="tt"><a href="ACL2____DEFAULT-HINTS-TABLE.html">default-hints-table</a></span>.  Thanks to Mark 
 Reitblatt for sending a question that led both to adding this clarification to 
 the <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> and to adding this warning.</p> 
 
 <p>You may now use <span class="tt"><a href="ACL2____SET-NON-LINEAR.html">set-non-linear</a></span>, <span class="tt"><a href="ACL2____SET-LET_A2-ABSTRACTION.html">set-let*-abstraction</a></span>, 
 <span class="v">set-tainted-ok</span>, and <span class="tt"><a href="ACL2____SET-LD-SKIP-PROOFS.html">set-ld-skip-proofs</a></span> in place of their versions 
 ending in ``<span class="v">p</span>''.  Thanks to Jared Davis for suggesting consideration of 
 such a change.  All ``<span class="v">set-</span>'' utilities now have a version without the 
 final ``<span class="v">p</span>'' (and most do not have a version with the final 
 ``<span class="v">p</span>'').</p> 
 
 <p>Added a "Loop-Stopper" warning when a <span class="v">:</span><span class="tt"><a href="ACL2____REWRITE.html">rewrite</a></span> rule is 
 specified with a <span class="v">:</span><span class="tt"><a href="ACL2____LOOP-STOPPER.html">loop-stopper</a></span> field that contains illegal 
 entries that will be ignored.  Thanks to Jared Davis for recommending such a 
 warning.</p> 
 
 <p>Added a substantial documentation topic that provides a beginner's guide to 
 the use of quantification with <span class="tt"><a href="ACL2____DEFUN-SK.html">defun-sk</a></span> in ACL2.  Thanks to Sandip Ray 
 for contributing this guide, to which we have made only very small 
 modifications.  See <a href="ACL2____QUANTIFIER-TUTORIAL.html">quantifier-tutorial</a>.</p> 
 
 <p><span class="tt"><a href="ACL2____DEFUN-SK.html">Defun-sk</a></span> now allows the keyword option <span class="v">:strengthen t</span>, which 
 will generate the extra constraint that is generated for the corresponding 
 <span class="v">defchoose</span> event; see <a href="ACL2____DEFCHOOSE.html">defchoose</a>.  Thanks to Dave Greve for 
 suggesting this feature.</p> 
 
 <p><b>BUG FIXES</b></p> 
 
 <p>Fixed a soundness bug related to the use of <span class="tt"><a href="ACL2____MBE.html">mbe</a></span> inside <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> events.  An example proof of <span class="v">nil</span> (before the fix) is in a 
 comment in <span class="v">(<a href="ACL2____DEFLABEL.html">deflabel</a> note-3-4 ...)</span> in the ACL2 source code.  We therefore 
 no longer allow calls of <span class="tt"><a href="ACL2____MBE.html">mbe</a></span> inside <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> events that 
 have non-empty <a href="ACL2____SIGNATURE.html">signature</a>s.</p> 
 
 <p>Fixed a bug related to the definition of a function supporting the macro 
 <span class="tt"><a href="ACL2____VALUE-TRIPLE.html">value-triple</a></span>.  Although this bug was very unlikely to affect any user, 
 it could be carefully exploited to make ACL2 unsound:</p> 
 
 <pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> fact
  (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="COMMON-LISP____CAADR.html">caadr</a> (<a href="COMMON-LISP____CADDR.html">caddr</a> (value-triple-fn '(foo 3) nil nil)))
         'value) ; but it's state-global-let* in the logic
  :rule-classes nil)
(<a href="ACL2____DEFTHM.html">defthm</a> contradiction
  nil
  :hints (("Goal" :use fact :in-theory (<a href="ACL2____DISABLE.html">disable</a> (value-triple-fn))))
  :rule-classes nil)</pre> 
 
 <p>Non-<span class="tt"><a href="ACL2____LOCAL.html">local</a></span> definitions of functions or macros are no longer 
 considered redundant with built-ins when the built-ins have special raw Lisp 
 code, because ACL2 was unsound without this restriction!  A comment about 
 redundant definitions in source function <span class="v">chk-acceptable-defuns</span> shows how 
 one could prove <span class="v">nil</span> without this new restriction.  Note that system 
 utility <span class="v">:</span><span class="tt"><a href="ACL2____REDEF_B2.html">redef+</a></span> removes this restriction.</p> 
 
 <p>Although ACL2 already prohibited the use of certain built-in <span class="v">:</span><span class="tt"><a href="ACL2____PROGRAM.html">program</a></span> mode functions for <span class="tt"><a href="ACL2____VERIFY-TERMINATION.html">verify-termination</a></span> and during 
 macroexpansion, we have computed a much more complete list of functions that 
 need such restrictions, the value of constant 
 <span class="v">*primitive-program-fns-with-raw-code*</span>.  [This constant was renamed 
 <span class="v">*initial-program-fns-with-raw-code*</span> after Version  8.0.]</p> 
 
 <p>Modified what is printed when a proof fails, to indicate more clearly which 
 event failed.</p> 
 
 <p>Fixed a problem with <span class="tt"><a href="ACL2____DMR.html">dmr</a></span> in CCL (OpenMCL) that was causing a raw 
 Lisp break after an interrupt in some cases.  Thanks to Gary Byers for a 
 suggestion leading to this fix.</p> 
 
 <p>Fixed bugs in <a href="ACL2____PROOF-BUILDER.html">proof-builder</a> code for dealing with free variables in 
 hypotheses.</p> 
 
 <p>Upon an abort, the printing of <span class="tt"><a href="ACL2____PSTACK.html">pstack</a></span> and <a href="ACL2____GAG-MODE.html">gag-mode</a> summary 
 information for other than GCL was avoided when inside a call of <span class="tt"><a href="ACL2____LD.html">ld</a></span>. 
 This has been fixed.</p> 
 
 <p>(Windows only) Fixed bugs for ACL2 built on SBCL on Windows, including one 
 that prevented <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> parameters <span class="v">:dir :system</span> from working, 
 and one that prevented certain compilation.  Thanks to Peter Dillinger for 
 bringing these to our attention and supplying a fix for the second.  Thanks 
 also to Andrew Gacek for bringing <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> issues to our 
 attention.  Also, fixed writing of file <span class="v">saved_acl2</span> at build time so that 
 for Windows, Unix-style pathnames are used.</p> 
 
 <p>Fixed a hard Lisp error that could occur with keywords as <span class="tt"><a href="ACL2____TABLE.html">table</a></span> 
 names, e.g., <span class="v">(<a href="ACL2____TABLE.html">table</a> :a :a nil :put)</span>.  Thanks to Dave Greve for bringing 
 this problem to our attention and providing this example.</p> 
 
 <p>Fixed handling of <span class="v">:OR</span> <a href="ACL2____HINTS.html">hints</a> so that proof attempts under an 
 <span class="v">:OR</span> hint do not abort (reverting to induction on the original input 
 conjecture) prematurely.  Thanks to Robert Krug for pointing out this problem 
 and pointing to a possible initial fix.</p> 
 
 <p>(SBCL and CLISP only) It is now possible to read symbols in the 
 <span class="v">"COMMON-LISP"</span> package inside the ACL2 command loop (see <a href="ACL2____LP.html">lp</a>). 
 This could cause a raw Lisp error in previous versions of ACL2 whose host 
 Common Lisp was SBCL or CLISP.  Thanks to Peter Dillinger for bringing this 
 issue to our attention.</p> 
 
 <p>Fixed a bug that was preventing certain <a href="ACL2____HINTS.html">hints</a>, such as <span class="v">:do-not</span> 
 hints, from being used after the application of an <span class="v">:or</span> hint.  Thanks to 
 Robert Krug for bringing this bug to our attention.</p> 
 
 <p>(Hons version only) Fixed a bug in the interaction of <span class="tt"><a href="ACL2____MEMOIZE.html">memoize</a></span> 
 (<span class="tt"><a href="ACL2____HONS.html">hons</a></span> version only) with event processing, specifically in interaction 
 with failures inside a call of <span class="tt"><a href="COMMON-LISP____PROGN.html">progn</a></span> or <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span>.  Thanks 
 to Jared Davis for bringing this bug to our attention and sending an example. 
 A simplified example may be found in a comment in source function 
 <span class="v">table-cltl-cmd</span>, source file <span class="v">history-management.lisp</span>; search for 
 ``Version_3.3'' there.</p> 
 
 <p>Fixed <span class="tt"><a href="ACL2____CW-GSTACK.html">cw-gstack</a></span> so that its <span class="v">:evisc-tuple</span> is applied to the top 
 clause, instead of using <span class="v">(4 5 nil nil)</span> in all cases.  If no 
 <span class="v">:evisc-tuple</span> is supplied then <span class="v">(term-evisc-tuple t state)</span> is used for 
 the top clause, as it is already used for the rest of the stack.</p> 
 
 <p>Fixed a bug in the interaction of <a href="ACL2____PROOF-TREE.html">proof-tree</a>s with <span class="v">:induct</span> hint 
 value <span class="v">:otf-flg-override</span>.  Thanks to Peter Dillinger for reporting this 
 bug and sending an example that evokes it.</p> 
 
 <p>Fixed bugs in <span class="v">:</span><span class="tt"><a href="ACL2____PR.html">pr</a></span> and <span class="tt"><a href="ACL2____FIND-RULES-OF-RUNE.html">find-rules-of-rune</a></span> for the case 
 of rule class <span class="v">:</span><span class="tt"><a href="ACL2____ELIM.html">elim</a></span>.  Thanks to Robert Krug and Jared Davis for 
 bringing these related bugs to our attention.</p> 
 
 <p>Improved failure messages so that the key checkpoints are printed only once 
 when there is a proof failure.  Formerly, a proof failure would cause the key 
 checkpoints to be printed for every <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> or <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span> superior to the proof attempt.</p> 
 
 <p>Fixed a bug in generation of <a href="ACL2____GUARD.html">guard</a>s for calls of <span class="tt"><a href="ACL2____PKG-WITNESS.html">pkg-witness</a></span>.  Thanks to Mark Reitblatt for sending an example showing this 
 bug.  The bug can be in play when you see the message: ``HARD ACL2 ERROR in 
 MAKE-LAMBDA-APPLICATION: Unexpected unbound vars ("")''.  A distillation of 
 Mark's example that causes this hard error is as follows.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> foo (x)
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard t))
  (<a href="COMMON-LISP____LET.html">let</a> ((y x)) (<a href="ACL2____PKG-WITNESS.html">pkg-witness</a> y)))</pre> 
 
 <p>The <span class="tt"><a href="COMMON-LISP____COND.html">cond</a></span> macro now accepts test/value pairs of the form <span class="v">(T
 val)</span> in other than the last position, such as the first such pair in 
 <span class="v">(<a href="COMMON-LISP____COND.html">cond</a> (t 1) (nil 2) (t 3))</span>.  Thanks to Jared Davis for sending this 
 example and pointing out that ACL2 was sometimes printing goals that have such 
 a form, and hence cannot be submitted back to ACL2.  A few macros 
 corresponding to <span class="tt"><a href="COMMON-LISP____COND.html">cond</a></span> in some books under <span class="v">books/rtl</span> and 
 <span class="v">books/bdd</span> were similarly modified.  (A second change will probably not be 
 noticeable, because it doesn't affect the final result: singleton <span class="tt"><a href="COMMON-LISP____COND.html">cond</a></span> 
 clauses now generate a call of <span class="tt"><a href="COMMON-LISP____OR.html">or</a></span> in a single step of macroexpansion, 
 not of <span class="tt"><a href="COMMON-LISP____IF.html">if</a></span>.  For example, <span class="v">(<a href="COMMON-LISP____COND.html">cond</a> (a) (b x) (t y))</span> now expands to 
 <span class="v">(<a href="COMMON-LISP____OR.html">OR</a> A (<a href="COMMON-LISP____IF.html">IF</a> B X Y))</span> instead of <span class="v">(<a href="COMMON-LISP____IF.html">IF</a> A A (<a href="COMMON-LISP____IF.html">IF</a> B X Y))</span>.  See the source 
 code for <span class="v">cond-macro</span> for a comment about this change.)</p> 
 
 <p>Fixed a bug in the interaction of <a href="ACL2____PROOF-BUILDER.html">proof-builder</a> command <span class="v">DV</span>, 
 including numeric (``diving'') commands, with the <span class="tt"><a href="ACL2____ADD-BINOP.html">add-binop</a></span> event. 
 Specifically, if you executed <span class="v">(<a href="ACL2____ADD-BINOP.html">add-binop</a> mac fn)</span> with <span class="v">fn</span> having 
 arity other than 2, a <a href="ACL2____PROOF-BUILDER.html">proof-builder</a> command such as 3 or <span class="v">(dv 3)</span> at 
 a call of <span class="v">mac</span> could have the wrong effect.  We also fixed a bug in diving 
 with <span class="v">DV</span> into certain <span class="v">AND</span> and <span class="v">OR</span> calls.  Thanks for Mark 
 Reitblatt for bringing these problems to our attention with helpful 
 examples.</p> 
 
 <p>Fixed a couple of bugs that were causing an error, ``HARD ACL2 ERROR in 
 RENEW-NAME/OVERWRITE''.  Thanks to Sol Swords for bringing the first of these 
 bugs to our attention.</p> 
 
 <p>Fixed a bug that could cause <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span> to fail in certain cases 
 where there are <span class="tt"><a href="ACL2____LOCAL.html">local</a></span> <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> forms.</p> 
 
 <p>Fixed a bug in <span class="tt"><a href="ACL2____START-PROOF-TREE.html">start-proof-tree</a></span> that could cause Lisp to hang or 
 produce an error.  Thanks to Carl Eastlund for sending an example to bring 
 this bug to our attention.</p> 
 
 <p>Fixed a bug in the proof output, which was failing to report cases where 
 the current goal simplifies to itself or to a set including itself (see <a href="ACL2____SPECIOUS-SIMPLIFICATION.html">specious-simplification</a>).</p> 
 
 <p>Fixed a bug in <span class="tt"><a href="ACL2____WITH-PROVER-TIME-LIMIT.html">with-prover-time-limit</a></span> that was causing a raw Lisp 
 error for a bad first argument.  Thanks to Peter Dillinger for pointing out 
 this bug.</p> 
 
 <p>The following was claimed in <span class="v">:doc</span> <span class="tt"><a href="ACL2____NOTE-3-3.html">note-3-3</a></span>, but was not fixed 
 until the present release:<br> 
 
 Distributed directory <span class="v">doc/HTML/</span> now again includes installation 
 instructions, in <span class="v">doc/HTML/installation/installation.html</span>.</p> 
 
 <p>In certain Common Lisp implementations  CCL (OpenMCL) and LispWorks, 
 at least  an interrupt could leave you in a break such that quitting 
 the break would not show the usual summary of key checkpoints.  This has been 
 fixed.</p> 
 
 <p><b>NEW AND UPDATED BOOKS</b></p> 
 
 <p>Updated <span class="v">books/clause-processors/SULFA/</span> with a new version from Erik 
 Reeber; thanks, Erik.</p> 
 
 <p>Added new books directory <span class="v">tools/</span> from Sol Swords.  See 
 <span class="v">books/tools/Readme.lsp</span> for a summary of what these books provide.</p> 
 
 <p>The distributed book <span class="v">books/misc/file-io.lisp</span> includes a new utility, 
 <span class="v">write-list!</span>, which is like <span class="v">write-list</span> except that it calls <span class="tt"><a href="ACL2____OPEN-OUTPUT-CHANNEL_12.html">open-output-channel!</a></span> instead of <span class="tt"><a href="ACL2____OPEN-OUTPUT-CHANNEL.html">open-output-channel</a></span>.  Thanks to 
 Sandip Ray for requesting this utility and assisting with its 
 implementation.</p> 
 
 <p>Added <span class="v">record-update</span> macro supplied by Sandip Ray to distributed book 
 <span class="v">books/misc/records.lisp</span>.</p> 
 
 <p>Sandip Ray has contributed books that prove soundness and completeness of 
 different proof strategies used in sequential program verification. 
 Distributed directory <span class="v">books/proofstyles/</span> has three new directories 
 comprising that contribution: <span class="v">soundness/</span>, <span class="v">completeness/</span>, and 
 <span class="v">counterexamples/</span>.  The existing <span class="v">books/proofstyles/</span> directory has 
 been moved to its subdirectory <span class="v">invclock/</span>.</p> 
 
 <p>Jared Davis has contributed a profiling utility for ACL2 built on CCL 
 (OpenMCL).  See <span class="v">books/misc/oprof.lisp</span>.  Thanks, Jared.</p> 
 
 <p>ACL2 utilities <span class="tt"><a href="ACL2____GETPROP.html">getprop</a></span> and <span class="tt"><a href="ACL2____PUTPROP.html">putprop</a></span> take advantage of 
 under-the-hood Lisp (hashed) property lists.  The new book 
 <span class="v">books/misc/getprop.lisp</span> contains an example showing how this works.</p> 
 
 <p>Added the following new book directories: <span class="v">books/paco/</span>, which includes 
 a small ACL2-like prover; and <span class="v">books/models/jvm/m5</span>, which contains the 
 definition of one of the more elaborate JVM models, M5, along with other files 
 including JVM program correctness proofs.  See files <span class="v">Readme.lsp</span> in these 
 directories, and file <span class="v">README</span> in the latter.</p> 
 
 <p>Added <i>books</i> about sorting in <span class="v">books/sorting</span>.  See 
 <span class="v">Readme.lsp</span> in that directory for documentation.</p> 
 
 <p>Added book <span class="v">books/misc/computed-hint-rewrite.lisp</span> to provide an 
 interface to the rewriter for use in computed hints.  Thanks to Jared Davis 
 for requesting this feature.</p> 
 
 <p>Jared Davis has provided a pseudorandom number generator, in 
 <span class="v">books/misc/random.lisp</span>.</p> 
 
 <p>Robert Krug has contributed a new library, <span class="v">books/arithmetic-4/</span>, for 
 reasoning about arithmetic.  He characterizes it as being more powerful than 
 its predecessor, <span class="v">books/arithmetic-3/</span>, and without its predecessor's 
 rewriting loops, but significantly slower than its predecessor on some 
 theorems.</p> 
 
 <p>Incorporated changes from Peter Dillinger to verify guards for functions in 
 <span class="v">books/ordinals/lexicographic-ordering.lisp</span> (and one in 
 <span class="v">ordinal-definitions.lisp</span> in that directory).</p> 
 
 <p>A new directory, <span class="v">books/hacking/</span>, contains a library for those who wish 
 to use trust tags to modify or extend core ACL2 behavior.  Thanks to Peter 
 Dillinger for contributing this library.  Obsolete version 
 <span class="v">books/misc/hacker.lisp</span> has been deleted.  Workshop contribution 
 <span class="v">books/workshops/2007/dillinger-et-al/code/</span> is still included with the 
 workshops/ tar file, but should be considered deprecated.</p> 
 
 <p>In <span class="v">books/make-event/assert.lisp</span>, changed <span class="v">assert!</span> and 
 <span class="v">assert!-stobj</span> to return <span class="v">(<a href="ACL2____VALUE-TRIPLE.html">value-triple</a> :success)</span> upon success instead 
 of <span class="v">(<a href="ACL2____VALUE-TRIPLE.html">value-triple</a> nil)</span>, following a suggestion from Jared Davis.</p> 
 
 <p><b>EMACS SUPPORT</b></p> 
 
 <p>Changed <span class="v">emacs/emacs-acl2.el</span> so that the fill column default (for the 
 right margin) is only set (still to 79) in lisp-mode.</p> 
 
 <p>Modified Emacs support in file <span class="v">emacs/emacs-acl2.el</span> so that names of 
 events are highlighted just as <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span> has been highlighted when it is 
 called.  Search in the above file for <span class="v">font-lock-add-keywords</span> for 
 instructions on how to eliminate this change.</p> 
 
 <p>The name of the temporary file used by some Emacs utilities defined in file 
 <span class="v">emacs/emacs-acl2.el</span> has been changed to have extension <span class="v">.lsp</span> instead 
 of <span class="v">.lisp</span>; thus it is now <span class="v">temp-emacs-file.lsp</span>.  Also, `make' commands 
 to `clean' books will delete such files (specifically, 
 <span class="v">books/Makefile-generic</span> has been changed to delete 
 <span class="v">temp-emacs-file.lsp</span>).</p>
</body>
</html>
