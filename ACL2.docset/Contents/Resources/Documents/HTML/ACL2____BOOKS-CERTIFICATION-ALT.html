<html>
<head>
<meta charset="UTF-8">
<title>Books-certification-alt</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____BOOKS-CERTIFICATION-ALT">Click for Books-certification-alt in the Full Manual</a></h3>

<p>Alternate instructions for certifying the <a href="ACL2____COMMUNITY-BOOKS.html">community-books</a>, 
 from the perspective of the <span class="v">acl2-sources</span> directory.</p><p>WARNING: Parts of this documentation are probably obsolete, but parts 
 are still relevant.  See <a href="ACL2____BOOKS-CERTIFICATION.html">books-certification</a> as the primary source of 
 information on how to certify the <a href="ACL2____COMMUNITY-BOOKS.html">community-books</a>.</p> 
 
 <p>For background on the ACL2 community books, see <a href="ACL2____COMMUNITY-BOOKS.html">community-books</a>. 
 Here we explain how to certify those books, or some of those books, with ACL2. 
 We thank Bishop Brock, Jared Davis, and Sol Swords for their substantial 
 contributions to this methodology.  See <span class="v">books/GNUmakefile</span>, in the 
 community books, for more about ``Credits and History'', and for additional 
 technical details not covered in this topic.</p> 
 
 <p>For more information about installing ACL2, see the <a href="http://www.cs.utexas.edu/users/moore/acl2/v8-5/HTML/installation/installation.html" target="_blank"><nobr>ACL2 installation instructions<img src="../Icon_External_Link.png" title="External link to http://www.cs.utexas.edu/users/moore/acl2/v8-5/HTML/installation/installation.html"></nobr></a>.  For information 
 about so-called ``classic ACL2 `make'-based certification'', which provides 
 support for certifying directories of books but may disappear in a future ACL2 
 release, see <a href="ACL2____BOOKS-CERTIFICATION-CLASSIC.html">books-certification-classic</a>.</p> 
 
 <p><b>The Basics</b></p> 
 
 <p>We make the following assumptions.</p> 
 
 <ul> 
  <li>Gnu `make' is available on your system via the `make' command 
 (rather than some other flavor of `make').  (Execute `<span class="v">make --version</span> to 
 verify this.)</li> 
 
  <li>You have built or obtained an ACL2 executable.</li> 
 
  <li>The ACL2 <a href="ACL2____COMMUNITY-BOOKS.html">community-books</a> are installed in the <span class="v">books/</span> 
 subdirectory of your ACL2 distribution, as is the case when you have followed 
 the standard installation instructions.</li> </ul> 
 
 <div class="box"><p>Note: All commands shown below are issued in the top-level (ACL2 
 sources) directory of your ACL2 distribution.</p></div> 
 
 <p>By default the ACL2 executable is file <span class="v">saved_acl2</span> in your ACL2 
 sources directory, and you can issue the following command to the shell in 
 order to do a ``regression run'' that certifies all of the community books 
 using that executable.</p> 
 
 <pre class="code">make regression</pre> 
 
 <p>Better yet, save a log file in case there are problems, for example as 
 follows.</p> 
 
 <pre class="code">(<a href="ACL2____MAKE.html">make</a> regression) &gt;&amp; make-regression.log</pre> 
 
 <p>or perhaps better yet:</p> 
 
 <pre class="code">(time nice make regression) &gt;&amp; make-regression.log</pre> 
 
 <p>For the sake of brevity, below we'll skip mentioning any of `<span class="v">time</span>', 
 `<span class="v">nice</span>', or `<span class="v">&gt;&amp; make-regression.log</span>'.  But saving a log file, in 
 particular, is useful in case you encounter problems to report.</p> 
 
 <p>If you fetched the community books using git, then you will have a 
 directories such <span class="v">books/workshops/</span> that is not necessary for certifying 
 the most widely-included books.  You can certify just such books as 
 follows.</p> 
 
 <pre class="code">(time nice make basic) &gt;&amp; make-basic.log</pre> 
 
 <p>Whether you use target `<span class="v">regression</span>' or target `<span class="v">basic</span>', then for 
 each book <span class="v">foo.lisp</span> whose certification is attempted, a file 
 <span class="v">foo.cert.out</span> in the same directory will contain the output from the 
 book's certification attempt.</p> 
 
 <p>A regression run may take a few hours, but if you have a multiprocessing 
 computer, you can speed it up by certifying some books in parallel, by 
 providing a value for `make' option <span class="v">-j</span>.  For example, if you have 8 
 hardware threads then you might want to issue the following command.</p> 
 
 <pre class="code">make regression -j 8</pre> 
 
 <p><b>Specifying the ACL2 Executable</b></p> 
 
 <p>If your ACL2 executable is not file <span class="v">saved_acl2</span> in the ACL2 sources 
 directory, then you will need to specify that executable.  You can do that by 
 setting variable <span class="v">ACL2</span>, either as an environment variable or, as displayed 
 below, as a `make' variable.  Either way, you will need to avoid relative 
 pathnames.  For example, the first two forms below are legal, but the third is 
 not, assuming that <span class="v">my-acl2</span> is on your <span class="v">PATH</span> in a Unix-like 
 environment (e.g., linux or MacOS) and that <span class="v">my-saved_acl2</span> is just a 
 pathname relative to your ACL2 sources directory, which is not on your 
 path.</p> 
 
 <pre class="code">make regression -j 8 ACL2=my-acl2
make regression -j 8 ACL2=/u/smith/bin/acl2
# The following only works if my-saved_acl2 is on your path (see above).
make regression -j 8 ACL2=my-saved_acl2</pre> 
 
 <p><b>Cleaning</b></p> 
 
 <p>You can delete files generated by book certification (including <span class="v">.cert</span> 
 files, <span class="v">.out</span> files, compiled files, and more) by issuing the following 
 command (again, in your ACL2 sources directory).</p> 
 
 <pre class="code">make clean-books</pre> 
 
 <p>Alternatively, if you want to cause such deletion and then do a regression, 
 simply replace the `<span class="v">regression</span>' target by `<span class="v">regression-fresh</span>.</p> 
 
 <p>If however you only want to clean up generated files residing under a given 
 directory (or its subdirectories, and recursively), you can issue the 
 following command while standing in that directory, where <span class="v">DIR</span> is a 
 pathname of your <span class="v">books</span> directory.</p> 
 
 <pre class="code">DIR/clean.pl</pre> 
 
 <p>For example, to clean up generated files under <span class="v">books/arithmetic</span>, you 
 could do the following.</p> 
 
 <pre class="code">cd books/arithmetic
../clean.pl
cd - # to return to the ACL2 sources directory, if you wish to do so</pre> 
 
 <p><b>Restricting to Specific Directories and Books</b></p> 
 
 <p>You can specify which books you want certified by using any or all of the 
 variables <span class="v">EXCLUDED_PREFIXES</span>, <span class="v">ACL2_BOOK_CERTS</span>, or 
 <span class="v">ACL2_BOOK_DIRS</span>.  First, the set of desired <span class="v">.cert</span> files is restricted 
 to those that do not start with any string that is one of the words in the 
 value of <span class="v">EXCLUDED_PREFIXES</span>.  Then <span class="v">ACL2_BOOK_CERTS</span> and 
 <span class="v">ACL2_BOOK_DIRS</span>, if supplied, specify which books should be certified, as 
 illustrated by the following example.</p> 
 
 <pre class="code">make -j 8 regression-fresh \
 ACL2_BOOK_DIRS="symbolic paco" \
 ACL2_BOOK_CERTS=" \
  workshops/2006/cowles-gamboa-euclid/Euclid/ed6a.cert \
  workshops/2006/cowles-gamboa-euclid/Euclid/ed4bb.cert \
  "</pre> 
 
 <p>Then all book in directories <span class="v">symbolic</span> and <span class="v">paco</span> will be certified, 
 as will the books <span class="v">workshops/2006/cowles-gamboa-euclid/Euclid/ed6a.lisp</span> 
 and <span class="v">workshops/2006/cowles-gamboa-euclid/Euclid/ed4bb.lisp</span>.  Note that all 
 pathnames should be relative to your community books directory; in particular, 
 they should not be absolute pathnames.  Also notice the <span class="v">.cert</span> extension 
 used in files supplied for <span class="v">ACL2_BOOK_CERTS</span>.</p> 
 
 <p>Alternatively, you may wish to invoke <span class="v">books/cert.pl</span> while standing in 
 a directory under which you want to certify books.  This will certify not only 
 those books, but all supporting books — even those not under the current 
 directory — that do not have up-to-date <span class="v">.cert</span> files.  The following 
 is a simple command to invoke that will certify all books in the current 
 directory, where if the <span class="v">books/</span> directory is not on your path, you will 
 need to provide a suitable filename, e.g. <span class="v">../../cert.pl</span> or 
 <span class="v">~/acl2/books/cert.pl</span>.</p> 
 
 <pre class="code">cert.pl -j 4 *.lisp</pre> 
 
 <p>Here is a more complex command, which illustrates a way to certify books in 
 subdirectories (as well as the current directory), the use of provisional 
 certification (see <a href="ACL2____PROVISIONAL-CERTIFICATION.html">provisional-certification</a>), and `make'-level 
 parallelism (in this case specifying four parallel processes).</p> 
 
 <pre class="code">cert.pl --pcert-all -j 4 `find . -name '*.lisp'`</pre> 
 
 <p>Note that with this approach, unlike classic ACL2 `make'-based 
 certification (see <a href="ACL2____BOOKS-CERTIFICATION-CLASSIC.html">books-certification-classic</a>, out-of-date <span class="v">.cert</span> 
 files that are not under the current directory will also be built.  For 
 documentation of <span class="v">cert.pl</span> invoke:</p> 
 
 <pre class="code">cert.pl -h</pre> 
 
 <p>See the top of <span class="v">cert.pl</span> for authorship and copyright information.</p> 
 
 <p>Finally, we give a brief summary of how to use so-called ``classic ACL2 
 `make'-based certification'' for community books; see <a href="ACL2____BOOKS-CERTIFICATION-CLASSIC.html">books-certification-classic</a> for details.  Note that support for this approach 
 might be eliminated in a future ACL2 release.  We welcome comments from the 
 ACL2 community about whether or not that would be a good thing to do.  See the 
 discussion above about <span class="v">ACL2_BOOK_DIRS</span> for the ``modern'' way to 
 accomplish the same thing.</p> 
 
 <p>Many community book directories have a <span class="v">Makefile</span>.  If you modify books 
 only in such a directory, you can recertify by standing in that directory and 
 issuing a `make' command.  This command can optionally specify an ACL2 
 executable as well as parallelism, for example as follows, where the first 
 line (<span class="v">make clean</span>) is optional.</p> 
 
 <pre class="code">make clean
(time nice make -j 8 ACL2=my-acl2)</pre> 
 
 <p><b>ACL2 Customization Files</b></p> 
 
 <p>By default, your acl2-customization file (see <a href="ACL2____ACL2-CUSTOMIZATION.html">ACL2-customization</a>) is 
 ignored by all flavors of ``<span class="v">make regression</span>''.  However, you can specify 
 the use of an acl2-customization file by setting the value of environment 
 variable <span class="v">ACL2_CUSTOMIZATION</span> to the empty string, indicating a default 
 such file, or to the desired absolute pathname.  For example:</p> 
 
 <pre class="code">make regression ACL2_CUSTOMIZATION=''
make regression ACL2_CUSTOMIZATION='~/acl2-customization.lisp'</pre> 
 
 <p><b>Regressions for Variants of ACL2</b></p> 
 
 <p>The discussion above also pertains to using ACL2(p) (see <a href="ACL2____PARALLEL.html">parallel</a>) 
 or ACL2(r) (see <a href="COMMON-LISP____REAL.html">real</a>), in which case the default is <span class="v">saved_acl2p</span> or 
 <span class="v">saved_acl2r</span> respectively, rather than <span class="v">saved_acl2</span>.  However, we 
 recommend that you use ACL2, not ACL2(p), for your regression.  Then you can 
 use ACL2(p) for your own proof developments.  However, if you want to use 
 ACL2(p) or for your regression, see <a href="ACL2____WATERFALL-PARALLELISM-FOR-BOOK-CERTIFICATION.html">waterfall-parallelism-for-book-certification</a>.</p> 
 
 <p><b>Provisional Certification</b></p> 
 
 <p>To use provisional certification (see <a href="ACL2____PROVISIONAL-CERTIFICATION.html">provisional-certification</a>), 
 supply <span class="v">ACL2_PCERT=t</span> with your `make' command.  Here is an example.</p> 
 
 <pre class="code">time nice make regression -j 4 ACL2_BOOK_DIRS=deduction ACL2_PCERT=t</pre> 
 
 <p><b>Miscellany</b></p> 
 
 <p>Other control of the certification process may be found by perusing 
 community books file <span class="v">books/make_cert</span>.  In particular, the <span class="v">INHIBIT</span> 
 variable may be set to a call of <span class="tt"><a href="ACL2____SET-INHIBIT-OUTPUT-LST.html">set-inhibit-output-lst</a></span>, for example 
 as follows to obtain the output one would get by default in an (interactive) 
 ACL2 session.</p> 
 
 <pre class="code">time nice make regression -j 4 ACL2_BOOK_DIRS=arithmetic \
  INHIBIT='(<a href="ACL2____SET-INHIBIT-OUTPUT-LST.html">set-inhibit-output-lst</a> proof-tree)'</pre> 
 
 <p><b>Troubleshooting</b></p> 
 
 <p>If you run into problems, you can get help by joining the <span class="v">acl2-help</span> 
 email list (follow the link from the ACL2 home page) and sending a message to 
 that list.  Also consider trying another version of GNU `make'; for example, 
 we have found that versions 3.81 and 3.82 sometimes cause errors on Linux 
 where version 3.80 does not.  Note however that Version 3.80 does not print 
 certain informational messages that are printed by later versions.</p>
</body>
</html>
