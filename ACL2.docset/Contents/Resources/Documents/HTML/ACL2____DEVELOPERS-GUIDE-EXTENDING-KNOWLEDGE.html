<html>
<head>
<meta charset="UTF-8">
<title>Developers-guide-extending-knowledge</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____DEVELOPERS-GUIDE-EXTENDING-KNOWLEDGE">Click for Developers-guide-extending-knowledge in the Full Manual</a></h3>

<p>Illustration using tracing, comments and Essays to explore ACL2 behaviors</p><p>This topic grew out of a discussion on the acl2-devel mailing list 
 in which some relevant background had already been presented.  It illustrates 
 how one might go about learning about specific features of ACL2, in this case 
 aspects of the <a href="ACL2____TAU-SYSTEM.html">tau-system</a>.</p> 
 
 <p>First,</p> 
 
 <pre class="code">(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> ``tau/bounders/elementary-bounders'' :dir :system)</pre> 
 
 <p>and</p> 
 
 <pre class="code">(<a href="ACL2____TRACE_42.html">trace$</a> tau-term)</pre> 
 
 <p>and then submit the non-theorem:</p> 
 
 <pre class="code">(<a href="ACL2____THM.html">thm</a> (<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____NATP.html">natp</a> x)(<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> 0 x) (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> x 15))
              (<a href="COMMON-LISP____EQUAL.html">equal</a> xxx (<a href="COMMON-LISP_____B2.html">+</a> 3 x))))</pre> 
 
 <p>The objective is to see what the tau of <span class="v">(<a href="COMMON-LISP_____B2.html">+</a> 3 x)</span> is, under the 
 assumptions <span class="v">(<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____NATP.html">natp</a> x) (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> 0 x) (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> x 15))</span>.  The idea is to attempt to 
 prove a non-theorem that lists the assumptions being made and then to see how 
 the ACL2 source function, <span class="v">tau-term</span>, is called on the term in question and 
 what <span class="v">tau-term</span> returns.  (We assume here the somehow we know that 
 <span class="v">tau-term</span> is relevant, perhaps by querying the acl2-devel mailing list.) 
 First let's consider what it returns because that gives us a chance to see a 
 tau object.  Then we'll explore how <span class="v">tau-term</span> was called.</p> 
 
 <p>If you search the failed proof for the first call of <span class="v">tau-term</span> on 
 <span class="v">(<a href="ACL2____BINARY-_B2.html">binary-+</a> '3 x)</span> — which is the translated form of <span class="v">(<a href="COMMON-LISP_____B2.html">+</a> 3 x)</span> (see 
 <a href="ACL2____TERM.html">term</a>) — and look at what that call returns, you see:</p> 
 
 <pre class="code">&lt;2 (TAU-TERM ((NIL)
              (<a href="COMMON-LISP____INTEGERP.html">INTEGERP</a> (NIL . 3) NIL . 18)
              ((166 . FILE-CLOCK-P)
               (155 . 32-BIT-INTEGERP)
               (20 . O-FINP)
               (19 . POSP)
               (17 . NATP)
               (9 . EQLABLEP)
               (5 . RATIONALP)
               (4 . INTEGERP)
               (0 . ACL2-NUMBERP))
              (192 . BAD-ATOM)
              (182 . ZPF)
              (176 . WRITABLE-FILE-LISTP1)
              (173 . READ-FILE-LISTP1)
              (170 . WRITTEN-FILE)
              (167 . READABLE-FILE)
              (163 . OPEN-CHANNEL1)
              (137 . KEYWORDP)
              (129 . LOWER-CASE-P)
              (128 . UPPER-CASE-P)
              (127 . ALPHA-CHAR-P)
              (124 . STANDARD-CHAR-P)
              (118 . IMPROPER-CONSP)
              (117 . PROPER-CONSP)
              (104 . WEAK-ABSSTOBJ-INFO-P)
              (72 . WEAK-CURRENT-LITERAL-P)
              (34 . WEAK-IO-RECORD-P)
              (31 . BOOLEANP)
              (27 . MINUSP)
              (18 . BITP)
              (16 . ZIP)
              (15 . ZP)
              (7 . SYMBOLP)
              (6 . STRINGP)
              (3 . CONSP)
              (2 . COMPLEX-RATIONALP)
              (1 . CHARACTERP))
             ...)</pre> 
 
 <p>The <span class="v">...</span> above is the second returned value of <span class="v">tau-term</span>, which is 
 the ``tau completion alist'', an efficiency hack that we'll ignore here.  The 
 first result returned is the tau of <span class="v">(<a href="COMMON-LISP_____B2.html">+</a> 3 x)</span> under our assumptions.</p> 
 
 <p>You can decode it with <span class="v">(decode-tau &lt;tau&gt; &lt;term&gt;)</span> where <span class="v">&lt;tau&gt;</span> is a 
 tau and <span class="v">&lt;term&gt;</span> is a term that allegedly has that tau (i.e., has that 
 ``type'').</p> 
 
 <pre class="code">(decode-tau '((NIL)
              (<a href="COMMON-LISP____INTEGERP.html">INTEGERP</a> (NIL . 3) NIL . 18)
              ((166 . FILE-CLOCK-P)
               (155 . 32-BIT-INTEGERP)
               (20 . O-FINP)
               (19 . POSP)
               (17 . NATP)
               (9 . EQLABLEP)
               (5 . RATIONALP)
               (4 . INTEGERP)
               (0 . ACL2-NUMBERP))
              (192 . BAD-ATOM)
              (182 . ZPF)
              (176 . WRITABLE-FILE-LISTP1)
              (173 . READ-FILE-LISTP1)
              (170 . WRITTEN-FILE)
              (167 . READABLE-FILE)
              (163 . OPEN-CHANNEL1)
              (137 . KEYWORDP)
              (129 . LOWER-CASE-P)
              (128 . UPPER-CASE-P)
              (127 . ALPHA-CHAR-P)
              (124 . STANDARD-CHAR-P)
              (118 . IMPROPER-CONSP)
              (117 . PROPER-CONSP)
              (104 . WEAK-ABSSTOBJ-INFO-P)
              (72 . WEAK-CURRENT-LITERAL-P)
              (34 . WEAK-IO-RECORD-P)
              (31 . BOOLEANP)
              (27 . MINUSP)
              (18 . BITP)
              (16 . ZIP)
              (15 . ZP)
              (7 . SYMBOLP)
              (6 . STRINGP)
              (3 . CONSP)
              (2 . COMPLEX-RATIONALP)
              (1 . CHARACTERP))
            '(<a href="ACL2____BINARY-_B2.html">binary-+</a> '3 x))</pre> 
 
 <p>If <span class="v">(tau-term &lt;term&gt; ...&lt;assumptions&gt;...)</span> returns <span class="v">&lt;tau&gt;</span>, then 
 <span class="v">(decode-tau &lt;tau&gt; &lt;term&gt;)</span> prints out everything the tau system can deduce 
 about <span class="v">&lt;term&gt;</span> under those <span class="v">&lt;assumptions&gt;</span>.  It's a way of asking ``what 
 does this <span class="v">&lt;tau&gt;</span> mean?''  The answer is shown below, where the three 
 important facts have been indicated:</p> 
 
 <pre class="code">(<a href="COMMON-LISP____AND.html">AND</a> (<a href="ACL2____ACL2-NUMBERP.html">ACL2-NUMBERP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X))
     (<a href="COMMON-LISP____INTEGERP.html">INTEGERP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X))                 ; &lt;---
     (<a href="COMMON-LISP____RATIONALP.html">RATIONALP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X))
     (<a href="ACL2____EQLABLEP.html">EQLABLEP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X))
     (<a href="ACL2____NATP.html">NATP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X))
     (<a href="ACL2____POSP.html">POSP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X))
     (<a href="ACL2____O-FINP.html">O-FINP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X))
     (32-BIT-INTEGERP (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X))
     (FILE-CLOCK-P (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X))
     (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> 3 (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X))                     ; &lt;---
     (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X) 18)                    ; &lt;---
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="COMMON-LISP____CHARACTERP.html">CHARACTERP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="ACL2____COMPLEX-RATIONALP.html">COMPLEX-RATIONALP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="COMMON-LISP____CONSP.html">CONSP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="COMMON-LISP____STRINGP.html">STRINGP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="COMMON-LISP____SYMBOLP.html">SYMBOLP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="ACL2____ZP.html">ZP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="ACL2____ZIP.html">ZIP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="ACL2____BITP.html">BITP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="COMMON-LISP____MINUSP.html">MINUSP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="ACL2____BOOLEANP.html">BOOLEANP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (WEAK-IO-RECORD-P (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (WEAK-CURRENT-LITERAL-P (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (WEAK-ABSSTOBJ-INFO-P (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="ACL2____PROPER-CONSP.html">PROPER-CONSP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="ACL2____IMPROPER-CONSP.html">IMPROPER-CONSP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="COMMON-LISP____STANDARD-CHAR-P.html">STANDARD-CHAR-P</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="COMMON-LISP____ALPHA-CHAR-P.html">ALPHA-CHAR-P</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="COMMON-LISP____UPPER-CASE-P.html">UPPER-CASE-P</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="COMMON-LISP____LOWER-CASE-P.html">LOWER-CASE-P</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="COMMON-LISP____KEYWORDP.html">KEYWORDP</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (OPEN-CHANNEL1 (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (READABLE-FILE (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (WRITTEN-FILE (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (READ-FILE-LISTP1 (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (WRITABLE-FILE-LISTP1 (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (<a href="ACL2____ZPF.html">ZPF</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)))
     (<a href="COMMON-LISP____NOT.html">NOT</a> (BAD-ATOM (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X))))</pre> 
 
 <p>Another way of thinking about a tau, <span class="v">&lt;tau&gt;</span>, is that it is a reasonably 
 fast and compact encoding of a predicate,</p> 
 
 <pre class="code">`(<a href="COMMON-LISP____LAMBDA.html">lambda</a> (zzz) ,(decode-tau &lt;tau&gt; 'zzz))</pre> 
 
 <p>Of course, a tau is very redundant.  There is no reason to say that 
 something's NOT a bad-atom if you say it IS a NATP!  But by encoding 
 everything the tau system knows about a term it's easy to answer questions 
 about what we know.</p> 
 
 <p>Now, going back to that call of <span class="v">tau-term</span> on <span class="v">(<a href="ACL2____BINARY-_B2.html">binary-+</a> '3 x)</span> in 
 the trace, it was:</p> 
 
 <pre class="code">(TAU-TERM '(<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X)
          &lt;tau-alist&gt;
          '(((<a href="COMMON-LISP____EQUAL.html">EQUAL</a> (<a href="ACL2____BINARY-_B2.html">BINARY-+</a> '3 X) XXX)              ; type-alist
             128
             (LEMMA (:FAKE-RUNE-FOR-TYPE-SET NIL)))
            ((<a href="COMMON-LISP_____C3.html">&lt;</a> '15 X) 128)
            ((<a href="COMMON-LISP_____C3.html">&lt;</a> X '0) 128)
            (X 7)
            (X 23))
          '(((0 (((((X . -1)) NIL) 15 &lt;= T)))         ; linear pot list
             X (((((X . 1)) NIL) 0 &lt;= T))))
          &lt;ens&gt;
          &lt;w&gt;
          &lt;calist&gt;)</pre> 
 
 <p>Let's assume that we already know about the <a href="ACL2____TYPE-ALIST.html">type-alist</a> and the 
 linear pot (see <a href="ACL2____LINEAR-ARITHMETIC.html">linear-arithmetic</a>); they're set up when 
 <span class="v">tau-clausep</span> is called, by assuming all the literals of the clause false 
 and doing the initialization of the linear data base.</p> 
 
 <p>The <span class="v">&lt;tau-alist&gt;</span> basically repeats as much of that information as 
 possible in terms of tau.  That is, it records the known tau of various terms 
 computed so far by <span class="v">tau-clause1p</span>.  It starts as <span class="v">nil</span> in 
 <span class="v">tau-clausep</span>.</p> 
 
 <p>When playing with <span class="v">tau-term</span>, it is OK to just set <span class="v">tau-alist</span> to 
 <span class="v">nil</span>.  If a term is on the <span class="v">tau-alist</span> and you ask for its tau, 
 <span class="v">tau-term</span> just returns the tau in the alist.  But if the term isn't on the 
 alist, <span class="v">tau-term</span> computes it.  So generally speaking, the <span class="v">tau-alist</span> 
 just saves time.  Since the tau system is complicated it could be that putting 
 an entry on the alist that tau can compute will cause <span class="v">tau-term</span> to compute 
 a stronger tau for that term, but this is unlikley.  In any case, a good 
 approximation and a perfectly sound way to use tau is to just set 
 <span class="v">tau-alist</span> to <span class="v">nil</span>!</p> 
 
 <p>It is also acceptable to use <span class="v">nil</span> for <span class="v">&lt;calist&gt;</span> in calls of 
 <span class="v">tau-term</span>.</p> 
 
 <p>The general lesson here is simple: if you want to try to understand some 
 part of the prover, <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span> it and give the prover a formula that will 
 exercise the part in question and look at how it's called and what it 
 returns.</p> 
 
 <p>Of course, you can also read the comments!  There is a good essay on the 
 tau system that is well worth reading if you're interested.</p> 
 
 <pre class="code">; Essay on the Tau System

; This essay touches on a wide variety of topics in the design of the tau
; system.  It is consequently divided into many subsections with the following
; headers.  We recommend scanning this list for subsections of interest; an
; introduction to tau is provided by the first six or so, in order.

; On Tau-Like Terms
; On the Name ``tau''
; On Some Basic Ideas
; On Tau Recognizers -- Part 1
; On the Tau Database and General Design
; On Tau Recognizers -- Part 2
; On Tau Intervals and &lt; versus &lt;=
; On the Tau Data Structure
; On the Built-in Tau and the Abuse of Tau Representation
; On the Additional Restrictions on Tau Fields
; On the Use of ENS by Function Evaluation in the Tau System
; On the Most Basic Implications of Being in an Interval
; On Firing Signature Rules
; On Comparing Bounds
; On the Proof of Correctness of upper-bound-&lt;
; On the Near-Subset Relation for Intervals
; On the Tau Database
; On Closing the Database under Conjunctive Rules
; On Converting Theorems in the World to Tau Rules
; On Tau-Like Terms
; On Loops in Relieving Dependent Hyps in Tau Signature Rules
; On the Tau Msgp Protocol
; On Removal of Ancestor Literals -- The Satriani Hack Prequel
; On the Motivation for Tau-Subrs
; On the Tau Completion Alist (calist)
; On Disjoining Tau
; On the Role of Rewriting in Tau
; On Tau-Clause -- Using Tau to Prove or Mangle Clauses
; On Tau Debugging Features</pre> 
 
 <p>NEXT SECTION: <a href="ACL2____DEVELOPERS-GUIDE-BUILD.html">developers-guide-build</a></p>
</body>
</html>
