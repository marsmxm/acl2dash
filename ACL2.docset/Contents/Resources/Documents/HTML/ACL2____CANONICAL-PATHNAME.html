<html>
<head>
<meta charset="UTF-8">
<title>Canonical-pathname</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____CANONICAL-PATHNAME">Click for Canonical-pathname in the Full Manual</a></h3>

<p>The true absolute filename, with soft links resolved</p><p>For the name <span class="v">fname</span> of a file, the form <span class="v">(<a href="ACL2____CANONICAL-PATHNAME.html">Canonical-pathname</a>
 fname nil state)</span> evaluates to a Unix-style absolute filename representing 
 the same file as <span class="v">fname</span>, but generally without any use of soft links in 
 the name.  (Below, we explain the qualifier ``generally''.)  If however the 
 file indicated by <span class="v">fname</span> does not exist, <span class="v">(<a href="ACL2____CANONICAL-PATHNAME.html">canonical-pathname</a> fname nil
 state)</span> is <span class="v">nil</span>.  Thus, <span class="v">canonical-pathname</span> can be used as one would 
 use the raw Lisp function <span class="v">probe-file</span>.</p> 
 
 <p>The specification of <span class="v">(<a href="ACL2____CANONICAL-PATHNAME.html">Canonical-pathname</a> fname dir-p state)</span> when 
 <span class="v">dir-p</span> is not <span class="v">nil</span> is similar, except that if the specified file 
 exists but is not a directory, then the result is <span class="v">nil</span>.</p> 
 
 <p>The function <span class="v">canonical-pathname</span> has a guard of <span class="v">t</span>, though the 
 second argument must be the ACL2 <span class="tt"><a href="ACL2____STATE.html">state</a></span>.  This function is introduced 
 with the following properties.</p> 
 
 <pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> canonical-pathname-is-idempotent
  (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ACL2____CANONICAL-PATHNAME.html">canonical-pathname</a> (<a href="ACL2____CANONICAL-PATHNAME.html">canonical-pathname</a> x dir-p state) dir-p state)
         (<a href="ACL2____CANONICAL-PATHNAME.html">canonical-pathname</a> x dir-p state)))
(<a href="ACL2____DEFTHM.html">defthm</a> canonical-pathname-type
  (<a href="COMMON-LISP____OR.html">or</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ACL2____CANONICAL-PATHNAME.html">canonical-pathname</a> x dir-p state) nil)
      (<a href="COMMON-LISP____STRINGP.html">stringp</a> (<a href="ACL2____CANONICAL-PATHNAME.html">canonical-pathname</a> x dir-p state)))
  :rule-classes :type-prescription)</pre> 
 
 <p>We use the qualifier ``generally'', above, because there is no guarantee 
 that the filename will be canonical without soft links, though we expect this 
 to be true in practice.  ACL2 attempts to compute the desired result and then 
 checks that the input and result have the same Common Lisp ``<span class="v">truename</span>''. 
 This check is expected to succeed, but if it fails then the input string is 
 returned unchanged, and to be conservative, the value returned is <span class="v">nil</span> in 
 this case if <span class="v">dir-p</span> is true.</p>
</body>
</html>
