<html>
<head>
<meta charset="UTF-8">
<title>Vl-parse-expr-from-str</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=VL2014____VL-PARSE-EXPR-FROM-STR">Click for Vl-parse-expr-from-str in the Full Manual</a></h3>

<p>Try to parse a Verilog expression from an ACL2 string.</p><p>It is occasionally convenient to parse Verilog expressions from 
strings, for instance in <a href="ACL2____SYMBOLIC-TEST-VECTORS.html">ACL2::symbolic-test-vectors</a> we want to let the 
user write Verilog-style hierarchical identifiers to describe the wires they 
are interested in.</p> 
 
<p><span class="tt">(vl-parse-expr-from-str str)</span> returns a <a href="VL2014____VL-EXPR-P.html">vl-expr-p</a> or <span class="v">nil</span> to 
signal failure.</p> 
 
<p>We expect that <span class="v">str</span> contains <b>exactly one</b> Verilog expression.  We 
will fail if this isn't the case, or if any part of the lexing/parsing process 
fails or produces warnings.  In these cases we will print warning messages to 
standard output, but there's no programmatic way to extract the warnings.</p> 
 
<p>We have arbitrarily decided not to preprocess the string.  This means you 
can't use <span class="v">`ifdef</span> stuff or <span class="v">`defines</span>.  However, comments and whitespace 
are tolerated and ignored.</p> 
 
<p>We don't transform the expression at all.  This means, for instance, that if 
you parse an expression like "foo[3-1:0]" then it'll still have the subtract 
there.  Furthermore, we don't know what module the expression belongs in, so it 
won't be sized, may refer to invalid wires, etc.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>vl-parse-expr-from-str</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 vl-parse-expr-from-str (str)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____STRINGP.html">stringp</a> str)))
 (<a href="ACL2____B_A2.html">b*</a>
  ((echars (<a href="VL2014____VL-ECHARLIST-FROM-STR.html">vl-echarlist-from-str</a> str))
   ((<a href="ACL2____MV.html">mv</a> successp tokens warnings)
    (<a href="VL2014____VL-LEX.html">vl-lex</a> echars
            :config *vl-default-loadconfig*
            :warnings nil))
   ((unless successp)
    (<a href="ACL2____CW.html">cw</a> "; vl-parse-expr-from-str: Lexing failed for ~s0.~%"
        str))
   ((when warnings)
    (<a href="VL2014____VL-CW-PS-SEQ.html">vl-cw-ps-seq</a>
         (<a href="VL2014____VL-PRINTLN.html">vl-println</a> "Warnings from VL-PARSE-EXPR-FROM-STR:")
         (<a href="VL2014____VL-PRINT-WARNINGS.html">vl-print-warnings</a> warnings))
    (<a href="ACL2____CW.html">cw</a> "; vl-parse-expr-from-str: Lexer warnings for ~s0.~%"
        str))
   ((<a href="ACL2____MV.html">mv</a> tokens ?cmap)
    (<a href="VL2014____VL-KILL-WHITESPACE-AND-COMMENTS.html">vl-kill-whitespace-and-comments</a> tokens))
   (pstate (<a href="VL2014____MAKE-VL-PARSESTATE.html">make-vl-parsestate</a> :warnings nil))
   ((local-stobjs tokstream)
    (<a href="ACL2____MV.html">mv</a> val tokstream))
   (tokstream (vl-tokstream-update-tokens tokens))
   (tokstream (vl-tokstream-update-pstate pstate))
   ((<a href="ACL2____MV.html">mv</a> err val tokstream)
    (<a href="VL2014____VL-PARSE-EXPRESSION.html">vl-parse-expression</a> :config *vl-default-loadconfig*))
   ((when err)
    (vl-report-parse-error err tokens)
    (<a href="ACL2____CW.html">cw</a> "; vl-parse-expr-from-str: Parsing failed for ~s0.~%"
        str)
    (<a href="ACL2____MV.html">mv</a> nil tokstream))
   ((<a href="VL2014____VL-PARSESTATE.html">vl-parsestate</a> pstate)
    (<a href="VL2014____VL-TOKSTREAM-_E3PSTATE.html">vl-tokstream-&gt;pstate</a>))
   ((when pstate.warnings)
    (<a href="VL2014____VL-CW-PS-SEQ.html">vl-cw-ps-seq</a>
         (<a href="VL2014____VL-PRINTLN.html">vl-println</a> "Warnings from VL-PARSE-EXPR-FROM-STR:")
         (<a href="VL2014____VL-PRINT-WARNINGS.html">vl-print-warnings</a> pstate.warnings))
    (<a href="ACL2____CW.html">cw</a> "; vl-parse-expr-from-str: Parser warnings for ~s0."
        str)
    (<a href="ACL2____MV.html">mv</a> nil tokstream))
   ((when (<a href="VL2014____VL-TOKSTREAM-_E3TOKENS.html">vl-tokstream-&gt;tokens</a>))
    (<a href="ACL2____CW.html">cw</a>
     "; vl-parse-expr-from-str: Content remains after parsing an ~
                 expression from the string.~% ~
                 - Original string: ~s0~% ~
                 - First expr: ~s1~% ~
                 - Remaining after parse: ~s2~%"
     str (<a href="VL2014____VL-PPS-EXPR.html">vl-pps-expr</a> val)
     (<a href="VL2014____VL-TOKENLIST-_E3STRING-WITH-SPACES.html">vl-tokenlist-&gt;string-with-spaces</a> (<a href="VL2014____VL-TOKSTREAM-_E3TOKENS.html">vl-tokstream-&gt;tokens</a>)))
    (<a href="ACL2____MV.html">mv</a> nil tokstream)))
  (<a href="ACL2____MV.html">mv</a> val tokstream)))</pre> 
<p><b>Theorem: </b>vl-expr-p-of-vl-parse-expr-from-string</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> vl-expr-p-of-vl-parse-expr-from-string
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="VL2014____VL-EXPR-P.html">vl-expr-p</a> (<a href="VL2014____VL-PARSE-EXPR-FROM-STR.html">vl-parse-expr-from-str</a> str))
               (<a href="COMMON-LISP____IF.html">if</a> (<a href="VL2014____VL-PARSE-EXPR-FROM-STR.html">vl-parse-expr-from-str</a> str)
                   t nil)))</pre> 

</body>
</html>
