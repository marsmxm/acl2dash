<html>
<head>
<meta charset="UTF-8">
<title>Atj-tutorial-background</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=JAVA____ATJ-TUTORIAL-BACKGROUND">Click for Atj-tutorial-background in the Full Manual</a></h3>

<p>ATJ tutorial: Background on the Evaluation Semantics of ACL2.</p><p>In the context of translating from the ACL2 language 
    to Java or any other programming language, 
    it is important to consider not only ACL2's logical semantics, 
    but also ACL2's evaluation semantics. 
    This tutorial page provides some background 
    on ACL2's evaluation semantics. 
    This tutorial page may be perhaps skipped at first reading, 
    especially if the reader is already deeply familiar 
    with ACL2's evaluation semantics; 
    but some of the concepts described in this page 
    are referenced in subsequent pages, 
    so the reader may need to come back to this page 
    if those concepts are not clear.</p><h5>Logical Semantics and Evaluation Semantics</h5><p>ACL2 has a precisely defined <a href="http://www.cs.utexas.edu/users/moore/publications/km97a.pdf" target="_blank"><nobr>logical semantics<img src="../Icon_External_Link.png" title="External link to http://www.cs.utexas.edu/users/moore/publications/km97a.pdf"></nobr></a>, expressed in terms of syntax, axioms, and inference rules, 
    similarly to logic textbooks and other theorem provers. 
    This logical semantics applies to <a href="ACL2____LOGIC.html">logic</a>-mode functions, 
    not <a href="ACL2____PROGRAM.html">program</a>-mode functions. 
    <a href="ACL2____GUARD.html">Guard</a>s are not part of the logic, 
    but engender proof obligations in the logic 
    when guard verification is attempted.</p><p>ACL2 also has a documented <a href="ACL2____EVALUATION.html">evaluation semantics</a>, which could be formalized 
    in terms of syntax, values, states, steps, errors, etc., 
    as is customary for programming languages. 
    This evaluation semantics applies 
    to both logic-mode and program-mode functions. 
    Guards affect the evaluation semantics, 
    based on guard-checking settings. 
    Even non-executable functions 
    (e.g. introduced via <span class="tt"><a href="ACL2____DEFCHOOSE.html">defchoose</a></span> or <span class="tt"><a href="ACL2____DEFUN-NX.html">defun-nx</a></span>) 
    degenerately have an evaluation semantics, 
    because they do yield error results when called; 
    however, the following discussion focuses on executable functions.</p><h5>Logic-Mode, Program-Mode, and Primitive Functions</h5><p>Most logic-mode functions have definitions 
    that specify both their logical and their evaluation semantics: 
    for the former, the definitions are logically conservative axioms; 
    for the latter, the definitions provide ``instructions'' 
    for evaluating calls of the function. 
    For a defined logic-mode function, 
    the relationship between the two semantics is that, 
    roughly speaking, 
    evaluating a call of the function yields, in a finite number of steps, 
    the unique result value that, with the argument values, 
    satisfies the function's defining axiom; 
    the actual relationship is slightly more complicated, 
    as it may involve guard checking.</p><p>The <a href="ACL2____PRIMITIVE.html">primitive functions</a> are in logic mode and have no definitions; 
    they are all built-in. 
    Examples are 
    <span class="tt"><a href="COMMON-LISP____EQUAL.html">equal</a></span>, <span class="tt"><a href="COMMON-LISP____IF.html">if</a></span>, <span class="tt"><a href="COMMON-LISP____CONS.html">cons</a></span>, <span class="tt"><a href="COMMON-LISP____CAR.html">car</a></span>, and <span class="tt"><a href="ACL2____BINARY-_B2.html">binary-+</a></span>. 
    Their logical semantics is specified by axioms of the ACL2 logic. 
    Their evaluation semantics is specified by raw Lisp code (under the hood). 
    The relationship between the two semantics is as in the above paragraph, 
    with the slight complication that 
    <span class="tt"><a href="ACL2____PKG-WITNESS.html">pkg-witness</a></span> and <span class="tt"><a href="ACL2____PKG-IMPORTS.html">pkg-imports</a></span> 
    yield error results when called on unknown package names. 
    The evaluation of calls of <span class="tt"><a href="COMMON-LISP____IF.html">if</a></span> is non-strict, as is customary.</p><p>Most program-mode functions have definitions 
    that specify their evaluation semantics, 
    similarly to the non-primitive logic-mode functions discussed above. 
    Their definitions specify no logical semantics.</p><h5>Functions with Raw Lisp Code and Side Effects</h5><p>The logic-mode functions 
    listed in the global variable <span class="v">logic-fns-with-raw-code</span> 
    (whose content can be inspected 
    via <span class="v">(<a href="ACL2_____04.html">@</a> logic-fns-with-raw-code)</span> in an ACL2 shell; 
    see <span class="tt"><a href="ACL2_____04.html">@</a></span>) 
    have a logical semantics specified by their ACL2 definitions, 
    but an evaluation semantics specified by raw Lisp code. 
    (They are disjoint from the primitive functions, 
    which have no definitions.) 
    For some of these functions, e.g. <span class="tt"><a href="ACL2____LEN.html">len</a></span>, 
    the raw Lisp code just makes them run faster 
    but is otherwise functionally equivalent to the ACL2 definitions. 
    Others have side effects, 
    carried out by their raw Lisp code 
    but not reflected in their ACL2 definitions. 
    For example, <span class="tt"><a href="ACL2____HARD-ERROR.html">hard-error</a></span> prints a message on the screen 
    and immediately terminates execution, unwinding the call stack. 
    As another example, <span class="tt"><a href="ACL2____FMT-TO-COMMENT-WINDOW.html">fmt-to-comment-window</a></span> 
    prints a message on the screen, 
    returning <span class="v">nil</span> and continuing execution. 
    But the ACL2 definitions of both of these example functions 
    just return <span class="v">nil</span>.</p><p>The program-mode functions 
    listed in the global variable <span class="v">program-fns-with-raw-code</span> 
    have an evaluation semantics specified by raw Lisp code. 
    Their ACL2 definitions appear to have no actual use.</p><p>Since <a href="ACL2____STOBJ.html">stobjs</a> are destructively updated, 
    functions that manipulate stobjs may have side effects as well, 
    namely the destructive updates. 
    Because of single-threadedness, 
    these side effects are invisible 
    in the end-to-end input/output evaluation of these functions; 
    however, they may be visible 
    in some formulations of the evaluation semantics, 
    such as ones that comprehend interrupts, 
    for which updating a record field in place involves different steps 
    than constructing a new record value with a changed field. 
    The built-in <span class="tt"><a href="ACL2____STATE.html">state</a></span> stobj 
    is ``linked'' to external entities, 
    e.g. the file system of the underlying machine. 
    Thus, functions that manipulate <span class="tt"><a href="ACL2____STATE.html">state</a></span> 
    may have side effects on these external entities. 
    For example, <span class="tt"><a href="ACL2____PRINC_42.html">princ$</a></span> (a member of <span class="v">logic-fns-with-raw-code</span>) 
    writes to the stream associated with the output channel argument, 
    and affects the file system.</p><p>The fact that the side effects of the evaluation semantics 
    are not reflected in the logical semantics 
    is a design choice 
    that makes the language more practical for programming 
    while retaining the ability to prove theorems. 
    But when generating Java or other code, 
    these side effects should be taken into consideration: 
    for instance, 
    translating <span class="tt"><a href="ACL2____HARD-ERROR.html">hard-error</a></span> and <span class="tt"><a href="ACL2____FMT-TO-COMMENT-WINDOW.html">fmt-to-comment-window</a></span> 
    into Java code that returns (a representation of) <span class="v">nil</span>, 
    would be incorrect or at least undesired. 
    As an aside, 
    a similar issue applies to the use of <a href="APT____APT.html">APT transformations</a>: for instance, 
    using the <a href="https://arxiv.org/abs/1705.01228v1" target="_blank"><nobr>simplify<img src="../Icon_External_Link.png" title="External link to https://arxiv.org/abs/1705.01228v1"></nobr></a> transformation 
    to turn calls of <span class="tt"><a href="ACL2____HARD-ERROR.html">hard-error</a></span> into <span class="v">nil</span>, 
    while logically correct and within <span class="v">simplify</span>'s stipulations, 
    may be undesired or unexpected.</p><h5>Macros with Raw Lisp Code</h5><p>Macros are normally expanded 
    (the expansion being also according to ACL2's evaluation semantics), 
    and their expansion is then evaluated. 
    However, the macros listed in the global variable <span class="v">macros-with-raw-code</span> 
    have an evaluation semantics specified by raw Lisp code. 
    The evaluation semantics specified by their raw Lisp code 
    may be consistent with the evaluation semantics of their expansion or not, 
    due to side effects or apparent circularities. 
    For instance, the <span class="tt"><a href="COMMON-LISP____CONCATENATE.html">concatenate</a></span> macro has raw Lisp code, 
    which obviously terminates execution; 
    however, the expansion of <span class="tt"><a href="COMMON-LISP____CONCATENATE.html">concatenate</a></span> calls <span class="tt"><a href="ACL2____STRING-APPEND.html">string-append</a></span>, 
    whose <span class="v">:exec</span> part calls <span class="tt"><a href="COMMON-LISP____CONCATENATE.html">concatenate</a></span>, 
    and therefore execution may not terminate. 
    Thus, macros with raw Lisp code may also need to be taken into account 
    when translating ACL2 code to Java or other programming languages.</p><div class="box"></div><p><b>Previous:</b> <a href="JAVA____ATJ-TUTORIAL-MOTIVATION.html">Motivation for Generating Java Code from ACL2</a></p><p><b>Next:</b> <a href="JAVA____ATJ-TUTORIAL-AIJ.html">Relationship with AIJ</a></p>
</body>
</html>
