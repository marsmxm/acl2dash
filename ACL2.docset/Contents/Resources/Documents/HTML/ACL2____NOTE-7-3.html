<html>
<head>
<meta charset="UTF-8">
<title>Note-7-3</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____NOTE-7-3">Click for Note-7-3 in the Full Manual</a></h3>

<p>ACL2 Version  7.3 (December, 2016) Notes</p><p>NOTE!  New users can ignore these release notes, because the <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> has been updated to reflect all changes that are recorded 
 here.</p> 
 
 <p>Below we roughly organize the changes to ACL2 since Version 7.2 into the 
 following categories of changes: existing features, new features, heuristic 
 and efficiency improvements, bug fixes, changes at the system level, Emacs 
 support, and experimental versions.  Each change is described in just one 
 category, though of course many changes could be placed in more than one 
 category.</p> 
 
 <p>Note that only ACL2 system changes are listed below.  Changes to the <a href="ACL2____BOOKS.html">books</a> are no longer summarized in a documentation topic, but can be found by 
 browsing the <a href="https://github.com/acl2/acl2/" target="_blank"><nobr>ACL2+Books GitHub 
 repository<img src="../Icon_External_Link.png" title="External link to https://github.com/acl2/acl2/"></nobr></a>, in particular, the raw <a href="https://github.com/acl2/acl2/commits/master" target="_blank"><nobr>commit log<img src="../Icon_External_Link.png" title="External link to https://github.com/acl2/acl2/commits/master"></nobr></a>.</p> 
 
 <h3>Changes to Existing Features</h3> 
 
 <p>The name of ACL2's interactive goal manager has been changed from 
 ``proof-checker'' to ``(interactive) proof-builder''.  Thanks to several 
 people in the ACL2 community for feedback leading to this more descriptive 
 name.  In particular, we thank Stephen Westfold for noting that as a new user, 
 references in the <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> to ``proof-checker'' didn't help him to 
 realize that ACL2 has an interactive proof capability similar to what is found 
 in some other interactive theorem provers.</p> 
 
 <p>Now, <a href="ACL2____SET-RAW-WARNING-FORMAT.html">set-raw-warning-format</a> causes all warnings to be printed in a 
 raw format, not merely those warnings for which custom raw-warning-format code 
 has been developed.  Thanks to Shilpi Goel for recommending this 
 enhancement.</p> 
 
 <p>Utilities for formatted printing to strings no longer take an <span class="v">:</span><span class="tt"><a href="ACL2____IPRINT.html">iprint</a></span> keyword argument, and they never print using <a href="ACL2____IPRINTING.html">iprinting</a>.  See 
 <a href="ACL2____PRINTING-TO-STRINGS.html">printing-to-strings</a>.  The reason is that for each iprint index, <span class="v">i</span>, 
 that is bound during creation of the result string, that binding would 
 disappear after the string is returned; so it would be misleading or an error 
 to read <span class="v">#@i#</span> after that return.  For a similar reason, when raw Lisp 
 errors occur because variable <span class="v">*hard-error-is-error*</span> is non-<span class="v">nil</span> (see 
 <a href="ACL2____HARD-ERROR.html">hard-error</a>), iprinting is not used.</p> 
 
 <p>Any <span class="v">:</span><span class="tt"><a href="ACL2____MEASURE.html">measure</a></span> supplied in an <span class="tt"><a href="ACL2____XARGS.html">xargs</a></span> declaration of a 
 <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span> form must be a legal <a href="ACL2____TERM.html">term</a>.  Formerly, this requirement 
 only applied to <span class="v">:</span><span class="tt"><a href="ACL2____LOGIC.html">logic</a></span> mode definitions, but now it also applies 
 to <span class="v">:</span><span class="tt"><a href="ACL2____PROGRAM.html">program</a></span> mode definitions.  Thanks to Jared Davis for pointing 
 out that this restriction wasn't applied to <span class="v">:program</span> mode 
 definitions.</p> 
 
 <p>For a <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span> form, it is now illegal by default for a non-recursive 
 definition to have a <span class="v">:</span><span class="tt"><a href="ACL2____MEASURE.html">measure</a></span> in an <span class="tt"><a href="ACL2____XARGS.html">xargs</a></span> 
 declaration (other than <span class="v">:measure nil</span>, which means ``no measure'') unless 
 the definition is within a <span class="tt"><a href="ACL2____MUTUAL-RECURSION.html">mutual-recursion</a></span>.  Thanks to Eric Smith 
 for suggesting this restriction.  See <a href="ACL2____SET-BOGUS-MEASURE-OK.html">set-bogus-measure-ok</a> for a way to 
 avoid this new default behavior.</p> 
 
 <p>Several symbols have been added to the list <span class="tt"><a href="ACL2_____A2ACL2-EXPORTS_A2.html">*ACL2-exports*</a></span>.</p> 
 
 <p>It is now legal to specify a <span class="v">:clause-processor</span> hint using a symbol, 
 regardless of the signature of the relevant clause-processor function.  A 
 symbol had only been legal when that function took a single input.  Now, the 
 function may also take a hint argument followed by zero or more <span class="v">stobj</span> 
 arguments, in which case the hint is implicitly <span class="v">nil</span> and the stobjs are 
 passed appropriately.  See <a href="ACL2____CLAUSE-PROCESSOR.html">clause-processor</a>.  Thanks to Eric Smith for 
 requesting this enhancement.</p> 
 
 <p>By default, the checksum values in <a href="ACL2____CERTIFICATE.html">certificate</a> files for <a href="ACL2____BOOKS.html">books</a> have been replaced by a faster (though somewhat less secure) mechanism. 
 See <a href="ACL2____BOOK-HASH.html">book-hash</a> for an explanation, including a way to restore the use of 
 checksums.  (Our experiments in certifying all community <a href="ACL2____BOOKS.html">books</a> showed 
 about a 7% reduction in total time.  Speed-up for <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> may be 
 somewhat greater; for example, on a modern Macbook Pro the form</p> 
 
 <pre class="code">(<a href="ACL2____TIME_42.html">time$</a> (<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "centaur/vl/mlib/datatype-tools" :dir :system))</pre> 
 
 <p>took 21.67 seconds after certifying books in a default manner, but only 
 15.80 seconds after certifying books using <span class="v">ACL2_BOOK_HASH_ALISTP=t</span> 
 — a 27% reduction.)  Thanks to Bob Boyer for emphasizing slowdown from 
 checksum computation, to Jared Davis and Eric Smith for several helpful 
 emails, and to the ACL2 community in general for continuing to push for faster 
 evaluation of <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> calls.</p> 
 
 <p>The utility <span class="tt"><a href="ACL2____SHOW-ACCUMULATED-PERSISTENCE.html">show-accumulated-persistence</a></span> now prints results in base 
 10 with radix <span class="v">nil</span> (see <a href="ACL2____SET-PRINT-BASE.html">set-print-base</a> and <a href="ACL2____SET-PRINT-RADIX.html">set-print-radix</a>). 
 Thanks to Sol Swords for pointing out the odd printing that formerly could 
 result when evaluating <span class="v">(<a href="ACL2____SET-PRINT-BASE-RADIX.html">set-print-base-radix</a> 16 state)</span> before calling 
 <span class="v">show-accumulated-persistence</span>.</p> 
 
 <p>We have changed how ACL2 automatically computes <a href="ACL2____TYPE-PRESCRIPTION.html">type-prescription</a> 
 rules for <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span> forms — so-called ``runic type-prescriptions'' 
 — in the following cases:</p> 
 
 <ul> 
 
 <li>(1) when including a certified book; and</li> 
 
 <li>(2) in the second pass for a call of <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> or <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span>.</li> 
 
 </ul> 
 
 <p>For (1), ACL2 retrieves runic type-prescriptions from the book's <a href="ACL2____CERTIFICATE.html">certificate</a>.  For (2), ACL2 combines the runic type-prescription rule that is 
 computed as usual with the rule previously computed in the first pass. 
 Because of (1), the runic type-prescription rule for a function symbol 
 introduced by an included book is no longer sensitive to the current logical 
 <a href="ACL2____WORLD.html">world</a>; previously, for example, that rule could be different if one 
 first includes other books.  Also, some <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> calls may 
 complete more quickly because of (1); for example, we saw a reduction in time 
 of 4.7% for <span class="v">(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "doc/top" :dir :system)</span>.  Because of (2), 
 runic type-prescriptions may be stronger than was previously the case.  Thanks 
 to Jared Davis for suggesting this enhancement and for helpful discussions 
 during its development.  This change can be viewed as just one of the hundreds 
 of heuristic components of ACL2 that need not be understood in any detail by 
 users; that said, those who are curious about implementation details are 
 welcome to read the comment entitled ``Essay on Cert-data'' in the ACL2 source 
 code.</p> 
 
 <p>The utility <span class="tt"><a href="ACL2____SAVE-EXEC.html">save-exec</a></span> now causes an error if the directory of its 
 first argument does not exist; for example, <span class="v">(<a href="ACL2____SAVE-EXEC.html">save-exec</a>
 "subdir/my-acl2")</span> causes an error if there is no subdirectory 
 <span class="v">"subdir"</span> of the current directory.  Thanks to Jared Davis for pointing 
 out that some Lisps (in particular, CCL) would create a missing directory in 
 such a case, while others (in particular, SBCL) would not.</p> 
 
 <p>Slightly improved the printing of terms (the so-called ``<a href="ACL2____UNTRANSLATE.html">untranslate</a>'' utility) to avoid producing terms of the form <span class="v">(<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____NOT.html">not</a>
 u))</span> in some cases.  Thanks to Eric Smith for feedback leading to this 
 change.</p> 
 
 <p>The function being defined (or functions, plural, if using <span class="tt"><a href="ACL2____MUTUAL-RECURSION.html">mutual-recursion</a></span>) may now be among the declared <a href="ACL2____RULER-EXTENDERS.html">ruler-extenders</a>. 
 Thanks to Alessandro Coglio for an email that led us to make this change.</p> 
 
 <p>The utility <span class="v">:</span><span class="tt"><a href="ACL2____PSO.html">pso</a></span>, along with other proof-replay utilities 
 including <span class="tt"><a href="ACL2____PSOF.html">psof</a></span> and <span class="tt"><a href="ACL2____PSOG.html">psog</a></span>, now works with <span class="tt"><a href="ACL2____DEFTHMD.html">defthmd</a></span> and 
 <span class="tt"><a href="ACL2____DEFUND.html">defund</a></span>.  More generally, saved proofs are only wiped out by newer 
 proofs, not by other <a href="ACL2____EVENTS.html">events</a> such as <span class="tt"><a href="ACL2____IN-THEORY.html">in-theory</a></span> events.</p> 
 
 <p>The <span class="v">:exec</span> code in calls of <span class="tt"><a href="ACL2____MBE.html">mbe</a></span> no longer affects termination 
 proofs or induction schemes produced for function definitions.  This had 
 formerly only been the case for certain ``top-level'' calls in the 
 if-then-else structure of the definition's body.</p> 
 
 <p>The macro <span class="v">logicalp</span> is now deprecated, replaced by the function symbol 
 <span class="v">logicp</span>.  (For efficiency, <span class="v">logicp</span> is inlined in raw Lisp; 
 <span class="v">logicalp</span> is for now simply a macro abbreviating <span class="v">logicp</span>.)  Moreover, 
 these utilities no longer call the function <span class="v">symbol-class</span>.  (See <a href="ACL2____SYSTEM-UTILITIES.html">system-utilities</a> for discussion of such utilities.)  The latter change, which 
 avoids consideration of the <span class="tt">'theorem</span> property of a symbol, can be 
 helpful in proofs; indeed, this change simplifies reasoning about the new 
 function <span class="v">logic-fnsp</span> (see the ``Bug Fixes'' section below).</p> 
 
 <p>Several improvements have been made for utilities that show guard proof 
 obligations.</p> 
 
 <ul> 
 
 <li>The low-level system utility <span class="tt"><a href="ACL2____GUARD-OBLIGATION.html">guard-obligation</a></span> no longer returns 
 <span class="tt"><a href="ACL2____STATE.html">state</a></span>.  Thanks to Alessandro Coglio for requesting this 
 enhancement.</li> 
 
 <li>The utilities <span class="tt"><a href="ACL2____VERIFY-GUARDS-FORMULA.html">verify-guards-formula</a></span> and <span class="tt"><a href="ACL2____GUARD-OBLIGATION.html">guard-obligation</a></span> 
 take a new argument, <span class="v">rrp</span> (``return redundant p'').  When this argument 
 is ('nil'), which is the default for <span class="v">verify-guards-formula</span>, these 
 utilities will avoid returning the symbol <span class="v">'redundant</span> even in the case 
 that the given function symbol is already guard-verified.  Thanks to Eric 
 Smith for requesting this enhancement.</li> 
 
 <li>Documentation has been improved for utilities that show guard proof 
 obligations, in particular with the addition of a new topic, <a href="ACL2____GUARD-FORMULA-UTILITIES.html">guard-formula-utilities</a>, which explains their differences.</li> 
 
 <li>The utilities <span class="tt"><a href="ACL2____GUARD-THEOREM.html">guard-theorem</a></span> and <span class="tt"><a href="ACL2____GTHM.html">gthm</a></span> now do some 
 simplification of the guard theorem by default.  See <a href="ACL2____GUARD-THEOREM.html">guard-theorem</a> and 
 <a href="ACL2____GTHM.html">gthm</a>.  Thanks to Alessandro Coglio and Eric Smith for useful 
 discussions.</li> 
 
 <li>The utility <span class="tt"><a href="ACL2____GTHM.html">gthm</a></span> has two improvements: it takes a second optional 
 argument, <span class="v">guard-debug</span>; and it returns a single value (an untranslated 
 <a href="ACL2____TERM.html">term</a>), rather than an <a href="ACL2____ERROR-TRIPLE.html">error-triple</a> whose value component is that 
 untranslated term.  The function <span class="tt"><a href="ACL2____GUARD-THEOREM.html">guard-theorem</a></span> has been changed to 
 support the new optional argument.</li> 
 
 </ul> 
 
 <p>Some recursive, <a href="ACL2____LOGIC.html">logic</a>-mode built-in functions did not have proper 
 <a href="ACL2____MEASURE.html">measure</a>s stored in the ACL2 logical <a href="ACL2____WORLD.html">world</a>: specifically, those 
 whose suitability for logic mode is established in the community book 
 <span class="v">books/system/top.lisp</span> and the books included under that book.  This has 
 been fixed for all such functions except for the two 
 (<span class="v">merge-sort-term-order</span> and <span class="v">merge-term-order</span>) whose measures use 
 functions defined only in books, not in ACL2.  Thanks to Eric Smith for a 
 request leading to this enhancement.  (If you are interested in 
 implementation-level information about the mechanism tying books to 
 verification of termination and guards for built-in functions, see comments in 
 source-code constant <span class="v">*system-verify-guards-alist*</span>.)</p> 
 
 <p>The utilities <span class="tt"><a href="ACL2____PRINT-GV.html">print-gv</a></span> and <span class="tt"><a href="ACL2____SET-PRINT-GV-DEFAULTS.html">set-print-gv-defaults</a></span> now accept 
 a natural number for the keyword argument, <span class="v">:substitute</span>, so that only 
 certain large repeated terms cause the result to use <span class="tt"><a href="COMMON-LISP____FLET.html">flet</a></span>.  See <a href="ACL2____PRINT-GV.html">print-gv</a>.  Thanks to Eric Smith for suggesting such a change and helping to 
 design it.</p> 
 
 <p>ACL2 formerly caused a raw Lisp error when attempting to define a function 
 that was already defined in raw Lisp but not in ACL2.  Now an ordinary ACL2 
 error occurs instead.  Thanks to Eric Smith for a question leading to this 
 change.</p> 
 
 <p>Functions <span class="v">all-ffn-symbs</span> and <span class="v">all-ffn-symbs-lst</span> are now in <a href="ACL2____GUARD.html">guard</a>-verified <span class="v">:</span><span class="tt"><a href="ACL2____LOGIC.html">logic</a></span> mode.  Thanks to Eric Smith for a helpful 
 relevant conversation.  Several other functions are now in guard-verified 
 <span class="v">:logic</span> mode, thanks to discussions with Eric and also Alessandro Coglio, 
 including <span class="v">formalized-varlistp</span>, <span class="v">latest-body</span>, <span class="v">logical-namep</span>, 
 <span class="v">macro-args</span>, <span class="v">stobjs-out</span>, <span class="v">termify-clause-set</span>, 
 <span class="v">throw-nonexec-error-p</span>, and <span class="v">throw-nonexec-error-p1</span>.  For a complete 
 list, compare the old and new values of constant 
 <span class="v">*system-verify-guards-alist*</span>.</p> 
 
 <p>It had been necessary to evaluate <span class="v">(<a href="ACL2____SET-STATE-OK.html">set-state-ok</a> t)</span> in order to call 
 <span class="tt"><a href="ACL2____VERIFY-TERMINATION.html">verify-termination</a></span> on a <span class="v">:</span><span class="tt"><a href="ACL2____PROGRAM.html">program</a></span> mode function that takes 
 <span class="tt"><a href="ACL2____STATE.html">state</a></span> as a formal parameter but does not declare <span class="v">state</span> explicitly 
 as a <a href="ACL2____STOBJ.html">stobj</a>.  Thanks to Eric Smith for pointing out this issue.  Here is 
 an example that had failed but now succeeds.</p> 
 
 <pre class="code">(<a href="ACL2____SET-STATE-OK.html">set-state-ok</a> t)
(<a href="COMMON-LISP____DEFUN.html">defun</a> foo (<a href="ACL2____STATE.html">state</a>) (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :mode :program)) state)
(<a href="ACL2____SET-STATE-OK.html">set-state-ok</a> nil)
(<a href="ACL2____VERIFY-TERMINATION.html">verify-termination</a> foo) ; formerly failed</pre> 
 
 <p>To evaluate a form <span class="v">(<a href="ACL2____SET-IPRINT.html">set-iprint</a> t :hard-bound N)</span>, ACL2 will first 
 replace <span class="v">t</span> by <span class="v">:reset-enable</span>.  This behavior has been expanded to 
 apply to <span class="v">(<a href="ACL2____SET-IPRINT.html">set-iprint</a> nil :hard-bound N)</span> and <span class="v">(<a href="ACL2____SET-IPRINT.html">set-iprint</a> :same
 :hard-bound N)</span> as well: the first argument will be converted to <span class="v">:reset</span> 
 or <span class="v">:reset-enable</span>.  See <a href="ACL2____SET-IPRINT.html">set-iprint</a>.  This change fixes a bug in the 
 interaction between hard-bounds and rollovers.  For an example that formerly 
 exhibited this bug, see a comment about ``hard-bounds and rollovers'' in 
 <span class="v">(<a href="ACL2____DEFXDOC.html">defxdoc</a> note-7-3 ...)</span> in community book 
 <span class="v">books/system/doc/acl2-doc.lisp</span>.</p> 
 
 <p>The following improvements have been made to <span class="tt"><a href="ACL2____DEFUN-SK.html">defun-sk</a></span>.  See <a href="ACL2____DEFUN-SK.html">defun-sk</a> for detailed documentation.</p> 
 
 <ul> 
 
 <li>
<span class="v">Defun-sk</span> now modifies the <a href="ACL2____PE-TABLE.html">pe-table</a>, with the effect that if 
 you introduce a function <span class="v">NAME</span> with <span class="v">defun-sk</span>, then subsequent 
 evaluation of <span class="v">:pe NAME</span> will show the <span class="v">defun-sk</span> form rather than the 
 underlying <span class="v">defun</span> form.  As usual, you can invoke <span class="v">:</span><span class="tt"><a href="ACL2____PE_12.html">pe!</a></span> 
 instead, in order to see that <span class="v">defun</span> form.</li> 
 
 <li>When <span class="v">defun-sk</span> was supplied with keyword argument <span class="v">:strengthen t</span>, 
 the name of the generated theorem was always in the <span class="v">"ACL2"</span> package. 
 Now it is in the same package as the function symbol being defined.  Thanks to 
 Alessandro Coglio for suggesting this change.</li> 
 
 <li>
<span class="v">Defun-sk</span> now accepts <span class="tt"><a href="COMMON-LISP____DECLARE.html">declare</a></span> forms immediately after the 
 formal parameters, as is the case for <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span>.  Thanks to Eric Smith for 
 suggesting this enhancement.  The <span class="v">:witness-dcls</span> keyword is still 
 supported as well, but may become deprecated in the future.</li> 
 
 <li>An issue involving <a href="ACL2____GUARD.html">guard</a> verification for <span class="v">defun-sk</span> forms has 
 been addressed.  Thanks to Alessandro Coglio for suggesting this 
 improvement.</li> 
 
 <li>Syntax checking now produces improved error messages for 
 <span class="v">defun-sk</span>.</li> 
 
 </ul> 
 
 <p>The error message for a call of a undefined symbol now mentions defined 
 symbols in other packages with the same name, in case that is what the user 
 intended.  The message also points to a new documentation topic, <a href="ACL2____NEAR-MISSES.html">near-misses</a>, which provides a way (using certain books) to find approximate 
 matches that are defined.  Thanks to Jared Davis for suggesting such a 
 change.</p> 
 
 <p>ACL2 now accepts <span class="v">#\Return</span> as legal notation for the character with 
 <span class="tt"><a href="COMMON-LISP____CHAR-CODE.html">char-code</a></span> 13, and it prints that character as <span class="v">#\Return</span> rather 
 than moving the cursor (e.g., to the beginning of the line).  Thanks to 
 Alessandro Coglio, Eric McCarthy, and Eric Smith for requesting this change, 
 to help with the printing of failed subgoals that mention this character.</p> 
 
 <p>The macro <span class="tt"><a href="ACL2____GOOD-BYE.html">good-bye</a></span> no longer requires its argument to be a 
 (natural) number.  Any argument is now valid, and as before, is evaluated; if 
 that argument is not an integer, it is treated as 0.  The same change applies 
 to the aliases for <span class="tt"><a href="ACL2____GOOD-BYE.html">good-bye</a></span>, namely <span class="tt"><a href="ACL2____EXIT.html">exit</a></span> and <span class="tt"><a href="ACL2____QUIT.html">quit</a></span>. 
 Thanks to Eric Smith for suggesting this change.</p> 
 
 <p>When some subgoal in a set of key checkpoints is <span class="v">NIL</span>, then such a 
 subgoal will be printed first in the corresponding list, provided of course 
 that the list isn't entirely ignored because of a checkpoint-summary-limit of 
 0.  See <a href="ACL2____NIL-GOAL.html">nil-goal</a>, which has been updated.  Thanks to Eric Smith for 
 suggesting that <span class="v">NIL</span> subgoals should be seen in the checkpoints in spite 
 of the <a href="ACL2____SET-CHECKPOINT-SUMMARY-LIMIT.html">checkpoint-summary-limit</a>.</p> 
 
 <p>A new keyword argument, <span class="v">:ctx</span>, is available for <span class="v">value-triple</span>.  See 
 <a href="ACL2____VALUE-TRIPLE.html">value-triple</a>.</p> 
 
 <p><a href="ACL2____DEFINITION.html">Definition</a> rules with non-<span class="v">nil</span> values of 
 <span class="v">:install-body</span> (the default) are now permitted to have equivalence 
 relations other than <span class="tt"><a href="COMMON-LISP____EQUAL.html">equal</a></span>.</p> 
 
 <p>For macros such as <span class="tt"><a href="ACL2____PROG2_42.html">prog2$</a></span> that invoke <span class="tt"><a href="ACL2____RETURN-LAST.html">return-last</a></span>, an 
 argument to be evaluated with attachments (see <a href="ACL2____DEFATTACH.html">defattach</a>) was failing 
 to use attachments in some cases involving non-guard-verified functions.  This 
 has been fixed.  For an example, see the relevant comment in the form 
 <span class="v">(<a href="ACL2____DEFXDOC.html">defxdoc</a> note-7-3 ...)</span> in community book 
 <span class="v">books/system/doc/acl2-doc.lisp</span>.</p> 
 
 <p>The <span class="v">:</span><span class="tt"><a href="ACL2____TERMINATION-THEOREM.html">termination-theorem</a></span> <a href="ACL2____LEMMA-INSTANCE.html">lemma-instance</a> has been 
 improved so that old function symbols may be replaced with corresponding new 
 function symbols, either automatically or explicitly by the user.  See <a href="ACL2____LEMMA-INSTANCE.html">lemma-instance</a> and see <a href="ACL2____TERMINATION-THEOREM-EXAMPLE.html">termination-theorem-example</a>.  Thanks for 
 Alessandro Coglio and Eric Smith for helpful discussions, including pointing 
 out the previous deficiency.</p> 
 
 <p>A new key, <span class="v">:user</span>, is now legal for the <span class="tt"><a href="ACL2____ACL2-DEFAULTS-TABLE.html">ACL2-defaults-table</a></span>. 
 Its value must be an association list.  The key is reserved for users, who may 
 assume that the ACL2 system does not give it any special handling; see <a href="ACL2____ACL2-DEFAULTS-TABLE.html">ACL2-defaults-table</a>.  Thanks to Eric Smith for a helpful discussion leading 
 to this change.</p> 
 
 <p>A new macro, <span class="v">(<a href="ACL2____WITH-GUARD-CHECKING-EVENT.html">with-guard-checking-event</a> x form)</span>, is now legal for 
 event contexts; see <a href="ACL2____EMBEDDED-EVENT-FORM.html">embedded-event-form</a>.  Thanks to Eric Smith for 
 helpful discussions leading to this change.</p> 
 
 <p>For many years, it has been the case that when a <a href="ACL2____CONSTRAINT.html">constraint</a> is 
 proved that arises from a <span class="v">:functional-instance</span> lemma instance (see 
 [lemma-instance]), that information is stored so that the same constraint is 
 not re-proved on behalf of a later such lemma instance.  However, this had not 
 been the case when the original lemma instance was inside an <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> event.  Now, that information is stored provided the 
 <span class="v">encapsulate</span> event has an empty <a href="ACL2____SIGNATURE.html">signature</a> list and is not ``empty'' 
 (that is, stores at least one event).  Thanks to Eric Smith for sending us an 
 example to point out this problem.</p> 
 
 <p>The <a href="ACL2____PROOF-BUILDER.html">proof-builder</a>'s <span class="v">bash</span> and <span class="v">reduce</span> commands no longer 
 fail when the <span class="v">:hints</span> for <span class="v">"Goal"</span> include <span class="v">:do-not-induct t</span>. 
 Thus, it is no longer necessary to edit out such <span class="v">:do-not-induct</span> <a href="ACL2____HINTS.html">hints</a> when editing a proof-builder command by copying hints from an event 
 being developed.</p> 
 
 <p>By default, the <a href="ACL2____PROOF-BUILDER.html">proof-builder</a> command <span class="v">:s</span> now uses contextual 
 information when doing linear arithmetic.  The new keyword argument 
 <span class="v">:linear</span> can be set to <span class="v">nil</span> to get the previous behavior.  See <a href="ACL2-PC____S.html">ACL2-pc::s</a>.  Thanks to Eric Smith for requests that led us to make this 
 change.</p> 
 
 <p>Warning and error messages produced upon <span class="tt"><a href="ACL2____THEORY-INVARIANT.html">theory-invariant</a></span> 
 violations now include additional explanation.  Thanks to David Hardin and 
 Grant Passmore for helpful remarks leading us to make this change.  Those 
 messages also now show where the theory invariant was defined: a book 
 pathname, or ``top-level'' if directly in the loop.</p> 
 
 <p>The summary of ``Key checkpoint'' goals, at the end of a failed proof 
 attempt, has been improved.  It now indicates, inside the ``***'' banners, 
 every case in which proof has been aborted due to a <span class="v">:DO-NOT-INDUCT</span> hint 
 or generation of a goal of <span class="v">NIL</span>.</p> 
 
 <p>The <a href="ACL2____PROOF-BUILDER.html">proof-builder</a> command, <span class="v">noise</span>, no longer prints <a href="ACL2____PROOF-TREE.html">proof-tree</a> information, which can be obtained with the new command, 
 <span class="v">noise!</span>.  The <span class="v">quiet</span> command is unchanged, but a <span class="v">quiet!</span> command 
 turns off the printing of goal identifiers (as with <span class="tt"><a href="ACL2____SET-PRINT-CLAUSE-IDS.html">set-print-clause-ids</a></span>).</p> 
 
 <p>When <span class="tt"><a href="ACL2____DEFUND.html">defund</a></span> and <span class="tt"><a href="ACL2____DEFTHMD.html">defthmd</a></span> <a href="ACL2____EVENTS.html">events</a> fail, their output no 
 longer concludes with distracting output that mentions <span class="tt"><a href="ACL2____WITH-OUTPUT.html">with-output</a></span>.</p> 
 
 <h3>New Features</h3> 
 
 <p>New optional arguments allow the <span class="tt"><a href="ACL2____PSO.html">pso</a></span> utility to restrict output to 
 a single goal or a segment of the output (say, between two specified goals); 
 similarly for related utilities <span class="tt"><a href="ACL2____PSO_12.html">pso!</a></span>, <span class="tt"><a href="ACL2____PSOF.html">psof</a></span>, and <span class="tt"><a href="ACL2____PSOG.html">psog</a></span>. 
 Thanks to David Rager for a recent query leading to this enhancement.</p> 
 
 <p>The function <span class="tt"><a href="ACL2____CONS-WITH-HINT.html">cons-with-hint</a></span> provides an alternative to <a href="COMMON-LISP____CONS.html">cons</a> 
 that can sometimes avoid consing.  Thanks to Jared Davis and Sol Swords for 
 suggesting this function and providing an implementation and 
 documentation.  A few ACL2 source functions now call <span class="v">cons-with-hint</span>.</p> 
 
 <p>Function <span class="tt"><a href="ACL2____FILE-LENGTH_42.html">file-length$</a></span> computes efficiently the number of bytes in a 
 specified file.</p> 
 
 <p>Function <span class="tt"><a href="ACL2____DELETE-FILE_42.html">delete-file$</a></span> deletes a given file.  Thanks to Eric Smith 
 for requesting this utility.</p> 
 
 <p>New macros <span class="tt"><a href="ACL2____ACTIVE-OR-NON-RUNEP.html">active-or-non-runep</a></span> and <span class="tt"><a href="ACL2____INCOMPATIBLE_12.html">incompatible!</a></span> are 
 similar to <span class="tt"><a href="ACL2____ACTIVE-RUNEP.html">active-runep</a></span> and <span class="tt"><a href="ACL2____INCOMPATIBLE.html">incompatible</a></span> (respectively), 
 except that the new macros essentially consider non-<a href="ACL2____RUNE.html">rune</a>s to be 
 enabled.  Thanks to Eric Smith for feedback leading to these additions.</p> 
 
 <p>It is now possible to <span class="tt"><a href="COMMON-LISP____DECLARE.html">declare</a></span> formal parameters of <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span> 
 events to be irrelevant.  See <a href="ACL2____IRRELEVANT-FORMALS.html">irrelevant-formals</a>.  Thanks to Eric Smith 
 for requesting this feature.</p> 
 
 <p>The <span class="tt"><a href="ACL2____DEFTHEORY.html">deftheory</a></span> event now accepts a new keyword, <span class="v">:redundant-okp</span>, 
 to allow a limited form of redundancy (see <a href="ACL2____REDUNDANT-EVENTS.html">redundant-events</a>).  Thanks 
 to Eric Smith for requesting such support.  A new macro, <span class="tt"><a href="ACL2____DEFTHY.html">defthy</a></span>, 
 abbreviates <span class="v">deftheory</span> calls by adding <span class="v">:redundant-okp t</span>.</p> 
 
 <p>The <span class="tt"><a href="ACL2____FMT.html">fmt</a></span> family of functions has a new tilde directive, <span class="v">~S</span>, 
 which behaves like <span class="v">~s</span> except that margins are ignored.  Thanks to Jared 
 Davis for requesting this feature.</p> 
 
 <p>The iprinting utility has a new keyword option, <span class="v">:share</span>, which causes 
 iprint indices to be re-used (using so-called ``iprint sharing'' and ``iprint 
 eager sharing'').  See <a href="ACL2____SET-IPRINT.html">set-iprint</a>.  Thanks to David Rager for 
 suggesting a notion of iprint sharing.</p> 
 
 <p>A new function, <span class="tt"><a href="ACL2____SET-SERIALIZE-CHARACTER-SYSTEM.html">set-serialize-character-system</a></span>, can be used to turn 
 off (or on) the <a href="ACL2____SERIALIZE-WRITE.html">serialize-write</a> capability, which is on by default, for 
 writing certain files during book certification, including <a href="ACL2____CERTIFICATE.html">certificate</a> 
 files.  This capability has been useful for working around issues with 32-bit 
 CCL; thanks to Waqar Ahmed for working through that issue with us.</p> 
 
 <p>ACL2 now supports the reading of rational numbers expressed in 
 floating-point (scientific notation) syntax, using prefixes <span class="v">"#f"</span> and 
 <span class="v">"#fx"</span> for base 10 and base 16, respectively.  See <a href="ACL2____SHARP-F-READER.html">sharp-f-reader</a>.  Thanks to Dmitry Nadezhin for suggesting this 
 enhancement.</p> 
 
 <h3>Heuristic and Efficiency Improvements</h3> 
 
 <p>The raw-Lisp definition of <span class="tt"><a href="ACL2____DEFPKG.html">defpkg</a></span> has been modified in a way that 
 may improve performance for some host Lisps.  Thanks to Bob Boyer for emails 
 pointing to the (surprising) use of compilation by <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> in 
 CCL, which is eliminated (at least in some cases) by this change.</p> 
 
 <p><a href="ACL2____TYPE-SET.html">Type-set</a> reasoning has been improved in several basic ways.</p> 
 
 <ul> 
 
 <li>The first, for which we thank Jared Davis and Sol Swords for providing an 
 example, is illustrated in a comment in the form <span class="v">(<a href="ACL2____DEFXDOC.html">defxdoc</a> note-7-3 ...)</span> 
 in Community Books file <span class="v">system/doc/acl2-doc.lisp</span>)</li> 
 
 <li>When <a href="ACL2____DEFINITION.html">definition</a> bodies and <a href="ACL2____GUARD.html">guard</a>s are simplified, as they are 
 by default — see the new documentation for <a href="ACL2____NORMALIZE.html">normalize</a> — 
 <a href="ACL2____TYPE-SET.html">type-set</a> reasoning is now subjected to a <a href="ACL2____BACKCHAIN-LIMIT.html">backchain-limit</a> of 1 
 (unless it is already 0 globally).  Thanks to Jared Davis for sending an 
 example, for which <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> time has been cut to less than 10% of 
 what it had been, without changing the results of <a href="ACL2____NORMALIZATION.html">normalization</a>.  (That 
 said, regression timings suggest that this change will not be noticed for most 
 books.)</li> 
 
 <li>The collection of primitive <a href="ACL2____TYPE-SET.html">type-set</a>s supported by ACL2 has been 
 changed, by splitting the type of positive integers into two sets: the set 
 consisting solely of the number 1, and the set of integers greater than 1. 
 Thanks to Jared Davis for suggesting this change, and to him and Sol Swords 
 for pointing out deficiencies in our initial implementation.  For a discussion 
 of changes made to community books to accommodate this change, see the comment 
 immediately above the form <span class="v">(<a href="ACL2____DEFXDOC.html">defxdoc</a> note-7-3 ...)</span> in community book 
 <span class="v">books/system/doc/acl2-doc.lisp</span>.  Note that ACL2 has a newly-added 
 function, <span class="tt"><a href="ACL2____BITP.html">bitp</a></span>, whose built-in <a href="ACL2____COMPOUND-RECOGNIZER.html">compound-recognizer</a> rule 
 specifies that the value recognized by <span class="v">bitp</span> is either <span class="v">0</span> or <span class="v">1</span>, 
 that is, a member of the union of the primitive types <span class="v">{0}</span> and <span class="v">{1}</span>. 
 
 <p><b>Theorem: </b>bitp-compound-recognizer</p>
<pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> bitp-compound-recognizer
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ACL2____BITP.html">bitp</a> x)
               (<a href="COMMON-LISP____OR.html">or</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> x 0) (<a href="COMMON-LISP____EQUAL.html">equal</a> x 1)))
        :rule-classes :compound-recognizer)</pre> 
 
 ACL2 can reason a bit more powerfully about existing functions in some cases. 
 For example, it now proves the following theorem without including any books, 
 which was not the case previously. 
 
 <pre class="code">(<a href="ACL2____THM.html">thm</a> (<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____RATIONALP.html">rationalp</a> x) (<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____INTEGERP.html">integerp</a> x)))
              (<a href="COMMON-LISP_____C3.html">&lt;</a> 1 (<a href="COMMON-LISP____DENOMINATOR.html">denominator</a> x))))</pre> 
 
 You may need to change some of your books, however.  For example, if you 
 want to <a href="ACL2____DISABLE.html">disable</a> a function that always returns 1, then as was 
 previously the case for such functions that always return 0 instead (or t, or 
 nil), you'll want to disable the <a href="ACL2____TYPE-PRESCRIPTION.html">type-prescription</a> rule for that 
 function, too.</li> 
 
 <li>When a term of the form <span class="v">(<a href="COMMON-LISP____INTEGERP.html">integerp</a> (<a href="COMMON-LISP_____B2.html">+</a> k term))</span> is assumed true or 
 false, for an integer constant <span class="v">k</span>, ACL2 now essentially attempts to add 
 suitable type information for <span class="v">term</span> rather than for <span class="v">(<a href="COMMON-LISP_____B2.html">+</a> k term)</span>. 
 (Source function <span class="v">strengthen-recog-call</span> shows precisely what is done.)  We 
 also made analogous improvements for terms of the form <span class="v">(<a href="COMMON-LISP____RATIONALP.html">rationalp</a> (<a href="COMMON-LISP_____B2.html">+</a> k
 term))</span> and <span class="v">(<a href="COMMON-LISP____RATIONALP.html">rationalp</a> (<a href="COMMON-LISP_____A2.html">*</a> k term))</span>.  Example theorem now provable that 
 was not provable previously: 
 
 <pre class="code">(<a href="ACL2____THM.html">thm</a> (<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____ZP.html">zp</a> k) ; either k &lt;= 0 or k is not an integer
                   (<a href="COMMON-LISP____INTEGERP.html">integerp</a> (<a href="COMMON-LISP_____B2.html">+</a> 1 k))
                   (<a href="COMMON-LISP_____C3.html">&lt;</a> 0 (<a href="COMMON-LISP_____B2.html">+</a> 1 k))
                   (<a href="ACL2____ACL2-NUMBERP.html">acl2-numberp</a> k))
              (<a href="COMMON-LISP____EQUAL.html">equal</a> 2 (<a href="COMMON-LISP_____B2.html">+</a> 2 (<a href="COMMON-LISP_____A2.html">*</a> 2 k)))))</pre>
</li> 
 
 </ul> 
 
 <p>We eliminated a rather technical check during book certification. 
 (A bit of technical detail: we check for hidden packages in <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> 
 expansions, and an optimization eliminated that check for events in the book 
 occurring before the first such event that introduced a new package, if any. 
 But if no events in the book introduced a new package, then we were checking 
 all such expansions; now, we check none of them.)</p> 
 
 <p>Calls of the utility <span class="tt"><a href="ACL2____CLEAR-MEMOIZE-TABLE.html">clear-memoize-table</a></span> formerly discarded 
 relevant hash tables, building new ones when necessary.  Now, the hash tables 
 are typically retained but cleared (using Common Lisp function <span class="v">clrhash</span>), 
 although heuristics may determine that tables are ``too large'', in which case 
 the former discarding behavior applies.  Thanks to Jared Davis and Sol Swords 
 for contributing this change, which they found to speed up certain 
 computations significantly.  We expect that it will likely not slow others 
 down significantly.  Note that (as they have pointed out) the behavior of 
 related utility <span class="tt"><a href="ACL2____CLEAR-MEMOIZE-TABLES.html">clear-memoize-tables</a></span> remains unchanged; it continues 
 to discard relevant hash tables.</p> 
 
 <p>The generation of raw Lisp definitions of <a href="ACL2____STOBJ.html">stobj</a> creator functions 
 have been made potentially more efficient for stobjs with many fields.  Thanks 
 to Sol Swords and Jared Davis for reporting this issue and suggesting a fix, 
 we we adopted (in source function <span class="v">defstobj-raw-init</span>) with some small 
 changes.</p> 
 
 <p>We now avoid certain inefficiencies with <span class="tt"><a href="ACL2____MBE.html">mbe</a></span>.  The definition of 
 <span class="v">f8</span> below has taken 83.63 seconds in Version 7.2 built on CCL as the host 
 Lisp, but with that same machine and host Lisp the time was merely 0.11 second 
 after this change.  (Technical note: the explosion was in the time required to 
 compile the so-called ``*1* function''.)</p> 
 
 <pre class="code">(<a href="COMMON-LISP____DEFMACRO.html">defmacro</a> id (x) `(<a href="ACL2____MBE.html">mbe</a> :logic (<a href="COMMON-LISP____IDENTITY.html">identity</a> ,x) :exec (<a href="COMMON-LISP____IDENTITY.html">identity</a> ,x)))
(<a href="COMMON-LISP____DEFUN.html">defun</a> f8 (x) (id (id (id (id (id (id (id (id x)))))))))</pre> 
 
 <p>The heuristics for the ``eliminate-irrelevance'' clause processor (see 
 <a href="ACL2____HINTS.html">hints</a>) no longer drop applications of zero-ary functions or their 
 negations, e.g., <span class="v">(P)</span> or <span class="v">(<a href="COMMON-LISP____NOT.html">NOT</a> P)</span>.  Thanks to Marijn Heule for 
 feedback that led us towards modifying our initial change (twice!).</p> 
 
 <p>Several low-level efficiency improvements, which can speed up <a href="ACL2____READ-OBJECT.html">read-object</a>, may also speed up some other operations.</p> 
 
 <ul> 
 
 <li>Finding a package from a string can be faster (low-level raw Lisp function 
 <span class="v">find-package-fast</span>).</li> 
 
 <li>The implementation of low-level raw Lisp function <span class="v">bad-lisp-objectp</span> 
 was tweaked to use type recognizers, which are faster in some Lisps than 
 corresponding recognizer predicates; for example, the test <span class="v">(<a href="COMMON-LISP____CONSP.html">consp</a> x)</span> has 
 been replaced by the test <span class="v">(typep x 'cons)</span>.</li> 
 
 <li>New raw Lisp function <span class="v">bad-lisp-consp</span> processes conses on behalf of 
 <span class="v">bad-lisp-objectp</span>, and now <span class="v">bad-lisp-consp</span> is memoized at startup 
 instead of <span class="v">bad-lisp-objectp</span>.  Note that we continue to use memoization 
 option <span class="v">:forget t</span>, which throws away memoization information when exiting 
 the top-level call of the function.  With this change, we avoid the overhead 
 of memoization when checking non-cons values, which was perhaps of limited 
 value anyhow.  There could be slowdown when large EQ strings occur repeatedly 
 inside a cons pair, but we expect such slowdown to be at most negligible in 
 practice.</li> 
 
 <li>New utility <span class="tt"><a href="ACL2____SET-BAD-LISP-CONSP-MEMOIZE.html">set-bad-lisp-consp-memoize</a></span> can turn off memoization of 
 the new raw Lisp function <span class="v">bad-lisp-consp</span>.</li> 
 
 </ul> 
 
 <h3>Bug Fixes</h3> 
 
 <p>A soundness bug exploited the possibility that pathnames contain illegal 
 ACL2 characters.  Consider the following bash shell commands, which create a 
 file whose name is the euro sign and create a soft link, <span class="v">"foo"</span>, to that 
 file.  Thanks to Eric McCarthy for helpful discussions showing us how to 
 create such a file, which ultimately led us to discover this bug.</p> 
 
 <pre class="code">mkdir $'\xe2\x82\xac'
ln -s $'\xe2\x82\xac' foo</pre> 
 
 <p>Then the following book certified on a Mac, but now one gets an error 
 message complaining about a character with code 8364.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____IN-PACKAGE.html">in-package</a> "ACL2")
(<a href="ACL2____MAKE-EVENT.html">make-event</a>
 `(<a href="ACL2____DEFCONST.html">defconst</a> *c* ,(<a href="COMMON-LISP____CHAR.html">char</a> (<a href="ACL2____CANONICAL-PATHNAME.html">canonical-pathname</a> "foo" t state) 44)))
(<a href="ACL2____DEFTHM.html">defthm</a> bad
  nil
  :rule-classes nil
  :hints (("Goal"
           :in-theory (<a href="ACL2____THEORY.html">theory</a> 'minimal-theory)
           :use ((:instance char-code-linear (x *c*))))))</pre> 
 
 <p>The utility <span class="tt"><a href="ACL2____GETENV_42.html">getenv$</a></span> now causes an error if the value it would 
 otherwise return is not an ACL2 string, for example because it contains a 
 character whose <span class="tt"><a href="COMMON-LISP____CHAR-CODE.html">char-code</a></span> exceeds 255.  Many other changes, less 
 visible to the user, have been made in how ACL2 deals with strings that come 
 from outside ACL2, in particular, file names (see the related item just 
 above).</p> 
 
 <p>The handling of <a href="ACL2____META.html">meta</a>functions allowed an invariant to be violated, 
 that conjectures in the prover are always 100% <a href="ACL2____LOGIC.html">logic</a> mode.  An example 
 is in a comment in the ACL2 source code under <span class="v">(<a href="ACL2____DEFLABEL.html">deflabel</a> note-7-3 ...)</span>. 
 We have not exploited this bug to show that it leads to unsoundness, but that 
 seems possible.  Our fix is to extend the checks that all applications of 
 metafunctions and <a href="ACL2____CLAUSE-PROCESSOR.html">clause-processor</a>s produce <a href="ACL2____TERM.html">term</a>s, to check 
 additionally that those terms are all in logic mode.  An analogous change 
 applies to <a href="ACL2____WELL-FORMEDNESS-GUARANTEE.html">well-formedness-guarantee</a>s, using new functions <span class="tt"><a href="ACL2____LOGIC-TERMP.html">logic-termp</a></span>, <span class="tt"><a href="ACL2____LOGIC-TERM-LISTP.html">logic-term-listp</a></span>, and <span class="tt"><a href="ACL2____LOGIC-TERM-LIST-LISTP.html">logic-term-list-listp</a></span>, 
 where <span class="v">logic-termp</span> checks not only <span class="tt"><a href="ACL2____TERMP.html">termp</a></span> but also the new 
 predicate <span class="v">logic-fnsp</span>, and similarly for the others (<span class="v">logic-term-listp</span> 
 calls <span class="v">logic-fns-listp</span> and <span class="v">logic-term-list-listp</span> calls 
 <span class="v">logic-fns-list-listp</span>).</p> 
 
 <p>A bug has been fixed that could cause hard Lisp error when using the <a href="ACL2____IPRINT.html">iprint</a> utility.  Specifically, calling <span class="tt"><a href="ACL2____SET-IPRINT.html">set-iprint</a></span> with a small 
 <span class="v">:hard-bound</span> could cause a hard Lisp error during ``rollover'', as with 
 the following example.</p> 
 
 <pre class="code">(<a href="ACL2____SET-IPRINT.html">set-iprint</a> :reset-enable :hard-bound 200)
(<a href="ACL2____SET-IPRINT.html">set-iprint</a> t :hard-bound 1000)
(<a href="ACL2____F-GET-GLOBAL.html">f-get-global</a> 'iprint-ar state)
(<a href="ACL2____SET-EVISC-TUPLE.html">set-evisc-tuple</a> (<a href="ACL2____EVISC-TUPLE.html">evisc-tuple</a> 3 4 nil nil) :iprint t :sites :all)
(<a href="ACL2____THM.html">thm</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="COMMON-LISP____APPEND.html">append</a> (<a href="COMMON-LISP____APPEND.html">append</a> x y) x y x y x y x y)
            (<a href="COMMON-LISP____APPEND.html">append</a> x y x y x y x y x y)))
(<a href="ACL2____PSO.html">pso</a>)
(<a href="ACL2____PSO.html">pso</a>)
(<a href="ACL2____PSO.html">pso</a>)</pre> 
 
 <p>Thanks to David Rager for bringing this bug to our attention and for 
 describing how it occurred in his environment.  The fix is to convert the 
 argument <span class="v">t</span> of <span class="tt"><a href="ACL2____SET-IPRINT.html">set-iprint</a></span> to <span class="v">:reset-enable</span> when keyword 
 argument <span class="v">:hard-bound</span> is supplied.</p> 
 
 <p>The keyword <span class="v">:computed-hints-replacement</span> appeared in the source code a 
 few times where <span class="v">:computed-hint-replacement</span> was intended.  This has been 
 fixed.  We are not aware of any examples in practice where this makes a 
 noticeable difference; in particular, no <a href="ACL2____COMMUNITY-BOOKS.html">community-books</a> were modified 
 to accommodate this fix.</p> 
 
 <p>Redefinition can support certain uses of <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> within <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> forms, where formerly an error occurred.  (Technical note: Small 
 examples appear as comments in source function <span class="v">chk-embedded-event-form</span>; 
 search there for ``redefinition''.)  Thanks to Jared Davis for sending us an 
 example that exhibited this problem.  Strictly speaking, we don't really view 
 this as a bug; we have clarified in the documentation for <a href="ACL2____LD-REDEFINITION-ACTION.html">ld-redefinition-action</a> that redefinition may behave in unexpected ways.</p> 
 
 <p>We now avoid creating directories when reading rather than writing:</p> 
 
 <ul> 
 
 <li>It is no longer the case that <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> creates a directory 
 when attempting to include a book in a non-existent directory.  Thanks to 
 Jared Davis for bringing this bug to our attention.</li> 
 
 <li>In Version  7.2, we arranged that <span class="v">open-output-channel</span> and 
 <span class="v">open-output-channel!</span> attempt to create directories as needed. 
 Unfortunately, that change also caused this behavior for 
 <span class="v">open-input-channel</span>.  That has been fixed.  Thanks to Sol Swords for 
 pointing out that certifying books in CCL using <span class="v">cert.pl</span> could cause 
 creation of directories when including books; with this fix, that is no longer 
 the case.</li> 
 
 </ul> 
 
 <p>When submitting a call of <span class="tt"><a href="ACL2____DEFINE-TRUSTED-CLAUSE-PROCESSOR.html">define-trusted-clause-processor</a></span> with an 
 unsuitable signature, the resulting error message was causing a raw Lisp 
 error.  This has been fixed.  Thanks to Eric Smith for reporting this bug.</p> 
 
 <p>Contrary to its documentation, a <span class="tt"><a href="ACL2____DEFINE-TRUSTED-CLAUSE-PROCESSOR.html">define-trusted-clause-processor</a></span> 
 event was never redundant in the case that the values for keyword arguments 
 <span class="v">:label</span> and <span class="v">:partial-theory</span> were both <span class="v">nil</span> (or omitted).  Thanks 
 to Eric Smith for pointing out this bug.  Now, redundancy of the resulting 
 <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> event succeeds because a subsidiary <span class="tt"><a href="ACL2____DEFLABEL.html">deflabel</a></span> event 
 is generated by default.  (The previous behavior can be obtained by explicitly 
 supplying the keyword argument <span class="v">:label nil</span>.)  Also, the obsolete keyword 
 argument, <span class="v">:doc</span>, has been deleted for 
 <span class="v">define-trusted-clause-processor</span>.</p> 
 
 <p>It had been possible to get a <a href="ACL2____SLOW-ARRAY-WARNING.html">slow-array-warning</a> from computed hints 
 (see <a href="ACL2____COMPUTED-HINTS.html">computed-hints</a>) that directly modify so-called enabled structures. 
 This has been fixed by providing a suitable way for users to call system 
 function <span class="v">load-hint-settings-into-rcnst</span>, as is done in the <a href="ACL2____COMMUNITY-BOOKS.html">community-books</a> utility <a href="ACL2____EASY-SIMPLIFY-TERM.html">easy-simplify-term</a>, which calls a function 
 <span class="v">easy-simplify-term1-fn</span> that updates an enabled structure.  Thanks to 
 Jared Davis for sending an example that exhibited this problem through the 
 computed hint <span class="tt"><a href="ACL2____LOGBITP-REASONING.html">logbitp-reasoning</a></span>.  Also thanks to Sol Swords for a 
 helpful discussion that brought our attention to the community book mentioned 
 above.</p> 
 
 <p>Avoided an assertion <span class="v">(<a href="ACL2____ASSERT_42.html">ASSERT$</a> ACTUAL-ELEMENT ...)</span> that could occur 
 when including uncertified books, in particular when an included sub-book was 
 originally certified in a different directory from where it now resides. 
 Thanks to Eric Smith for reporting this bug and sending a helpful example.</p> 
 
 <p>Fixed function <span class="v">get-skipped-proofs-p</span> so that it returns <span class="v">nil</span> on 
 built-in functions.  Thanks to Eric Smith for bringing up this issue, for 
 example by pointing out that <span class="v">(<a href="ACL2____GET-SKIPPED-PROOFS-P.html">get-skipped-proofs-p</a> 'len (<a href="ACL2____W.html">w</a> state))</span> 
 evaluated to <span class="v">t</span>; now, it evaluates to <span class="v">nil</span>.</p> 
 
 <p>The utility <span class="tt"><a href="ACL2____UNMONITOR.html">unmonitor</a></span> was failing to carry out its task when 
 applied to a <a href="ACL2____RUNE.html">rune</a>.  This was due to a bug in ACL2 source function 
 <span class="v">delete-assoc-equal-lst</span>, which has been fixed.</p> 
 
 <p>The utility <span class="v">:</span><span class="tt"><a href="ACL2____PSOF.html">psof</a></span> now prints the <span class="v">Rules</span>, <span class="v">Hint-events</span>, 
 and <span class="v">Splitter rules</span> fields to the specified file instead of the terminal. 
 It also prints the interactive <a href="ACL2____PROOF-BUILDER.html">proof-builder</a> prompt to that file 
 instead of the terminal.</p> 
 
 <p>On rare occasions it seems that after book certification, the compiled file 
 was older than the corresponding <span class="v">.cert</span> file, which prevented subsequent 
 <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> forms from loading that compiled file.  (Technical note: 
 The problem was that we erroneously relied on Lisp function <span class="v">rename-file</span> 
 to preserve write-dates.)  This has been fixed.  Thanks to Gary Byers for 
 confirming that Lisp does not guarantee that <span class="v">rename-file</span> preserves 
 write-dates, and to Camm Maguire for reporting a related failure.</p> 
 
 <p>We fixed the <span class="v">:</span><span class="tt"><a href="ACL2____PUFF.html">puff</a></span> command so that it will no longer fail on 
 <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> commands followed by later <span class="v">include-book</span> events. 
 Thanks to Eric Smith for reporting the problem via a helpful example.</p> 
 
 <p>Some symbols were printed in a way that could not be read back in, but are 
 now printed with surrounding <span class="v">|...|</span>.  Thanks to Sol Swords for reporting 
 this problem for symbols with the Tab character.  Now that we are more careful 
 to print symbols readably in every host Lisp, but in a consistent manner for 
 all host Lisps, you may find more symbols printed with surrounding <span class="v">|...|</span> 
 than is necessary for your host Lisp.</p> 
 
 <p>It was possible to corrupt the system by evaluating ill-<a href="ACL2____GUARD.html">guard</a>ed 
 arguments on <a href="ACL2____PROGRAM.html">program</a>-mode functions with raw Lisp code when 
 guard-checking is off.  For example, after evaluating the forms 
 <span class="v">(<a href="ACL2____SET-GUARD-CHECKING.html">set-guard-checking</a> nil)</span> and <span class="v">(<a href="ACL2____VERBOSE-PSTACK.html">verbose-pstack</a> 23)</span>, the form <span class="v">(<a href="ACL2____THM.html">thm</a>
 (<a href="COMMON-LISP____EQUAL.html">equal</a> x x))</span> caused a raw Lisp error.  Now, the ill-guarded call above of 
 <span class="tt"><a href="ACL2____VERBOSE-PSTACK.html">verbose-pstack</a></span> causes a guard violation, even with guard-checking 
 off.</p> 
 
 <p>In host Lisps that do not compile on-the fly — that is, in host Lisps 
 other than CCL and SBCL — an error occurred when trying to evaluate 
 certain calls of <span class="tt"><a href="ACL2____COMP.html">comp</a></span>, including <span class="v">(<a href="ACL2____COMP.html">comp</a> t)</span> during <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> expansion.  This has been fixed; here is an example that can be 
 evaluated successfully now but not formerly.</p> 
 
 <pre class="code">(<a href="ACL2____MAKE-EVENT.html">make-event</a> (<a href="ACL2____ER-PROGN.html">er-progn</a> (<a href="ACL2____COMP.html">comp</a> t)
                      (<a href="ACL2____VALUE.html">value</a> '(<a href="ACL2____VALUE-TRIPLE.html">value-triple</a> nil))))</pre> 
 
 <p>ACL2 now avoids some needless escaping of symbol names with vertical bars, 
 as in the case of <span class="v">car</span> in base 16, among others supplied by Eric Smith, 
 whom we thank for the bug report:</p> 
 
 <pre class="code">ACL2 !&gt;(<a href="ACL2____SET-PRINT-BASE-RADIX.html">set-print-base-radix</a> 16 state)
&lt;state&gt;
ACL2 !&gt;'car
|CAR|
ACL2 !&gt;</pre> 
 
 <p>Vertical bars are used for symbols whose names are so-called ``potential 
 numbers'', which Common Lisp defines using several criteria.  Consecutive 
 letters disqualify a token from being a potential number, and ACL2's mistake 
 was in failing to treat characters <span class="v">#\A</span> through <span class="v">#\F</span> as letters.</p> 
 
 <p>We fixed a bug in the interaction between iprinting and brr.  For an 
 example, see the comment about ``interaction between iprinting and brr'' in 
 the form <span class="v">(<a href="ACL2____DEFXDOC.html">defxdoc</a> note-7-3 ...)</span> in community book 
 <span class="v">books/system/doc/acl2-doc.lisp</span>.  Thanks to Shilpi Goel for pointing out a 
 somewhat related problem introduced by a change originally made after 
 Version_7.2, which also has been fixed.</p> 
 
 <p>The documentation for <span class="tt"><a href="ACL2____LD.html">ld</a></span> specified that ``If <span class="tt"><a href="ACL2____STANDARD-CO.html">standard-co</a></span> 
 and <span class="tt"><a href="ACL2____PROOFS-CO.html">proofs-co</a></span> are equal strings, only one channel to that file is 
 opened and is used for both.''  This was only the case when <span class="v">proofs-co</span> was 
 a canonical absolute (full) pathname.  This has been fixed; now, the criterion 
 is that <span class="v">standard-co</span> and <span class="v">proofs-co</span> are strings that represent the 
 same file.</p> 
 
 <p>It is no longer illegal for <span class="tt"><a href="ACL2____DEFSTUB.html">defstub</a></span> to use an old style output 
 signature with variables that are not among the formals.  For example, the 
 following is now legal (note that <span class="v">u</span> is not among the list <span class="v">(x y)</span> of 
 formal parameters): <span class="v">(<a href="ACL2____DEFSTUB.html">defstub</a> foo (x y) (<a href="ACL2____MV.html">mv</a> u x))</span>.  Thanks to Eric Smith 
 for pointing out that this behavior is allowed by the documentation 
 (specifically, see the discussion of ``Old Style'' in the documentation for 
 <a href="ACL2____SIGNATURE.html">signature</a>).</p> 
 
 <p>We fixed a bug in the implementation of <span class="tt"><a href="ACL2____DEFATTACH.html">defattach</a></span>, which could 
 cause the wrong constraints to be generated in the case of more than one 
 function argument.</p> 
 
 <p>For a proposed <a href="ACL2____DEFINITION.html">definition</a> rule with a missing (or empty) 
 <span class="v">:CLIQUE</span> but a non-empty <span class="v">:CONTROLLER-ALIST</span>, the error message was 
 ill-formed.  This has been fixed.</p> 
 
 <p>Calls of the macro <span class="tt"><a href="ACL2____ADD-CUSTOM-KEYWORD-HINT.html">add-custom-keyword-hint</a></span> are no longer illegal 
 <a href="ACL2____EVENTS.html">events</a> in the context of <span class="tt"><a href="ACL2____LOCAL.html">local</a></span>.</p> 
 
 <p>Tweaked <span class="tt"><a href="ACL2____BREAK-ON-ERROR.html">break-on-error</a></span> to avoid rare error involving 
 <span class="v">STATE</span>.</p> 
 
 <h3>Changes at the System Level</h3> 
 
 <p>It was possible for a backtrace to be printed to the terminal by SBCL and 
 CMUCL, even when output is redirected to a file.  This has been fixed. 
 Moreover, we now print, just above a backtrace (with ACL2 function 
 <span class="v">print-call-history</span>), the full pathname of the book under certification, 
 in case this problem arises again.  Also, limited the number of frames in 
 CMUCL to the default in SBCL, namely, 1000.</p> 
 
 <p>When building the executable with `<span class="v">make</span>', ACL2 now prints a message of 
 the form ``<span class="v">Successfully built &lt;ACL2_executable_pathname&gt;</span>'' as the last 
 line of the log.  Thanks to Eric Smith for suggesting this change.  Note that 
 the exit status continues to be 0 upon success and non-zero upon failure.</p> 
 
 <p>An error now occurs when attempting to build ACL2 or certify the <a href="ACL2____COMMUNITY-BOOKS.html">community-books</a> (in the usual way, using <span class="v">make</span>) in a directory whose name 
 contains at least one space.  Thanks to Eric Smith for discussion leading to 
 this change.  Although the issue may only be with the infrastructure for 
 certifying community books, we cause an error for the ACL2 build as well, to 
 make installers aware of the problem with spaces as soon as possible; thus, we 
 added this check in both the top-level <span class="v">GNUmakefile</span> and in 
 <span class="v">books/GNUmakefile</span>.  Note that the installation instructions (file 
 <span class="v">installation/installation.html</span>) already said to install ACL2 ``in a 
 directory whose pathname does not contain whitespace''; now, this requirement 
 is enforced.  (If some in the community would like to update the 
 infrastructure for certifying books to support spaces in the build directory, 
 they are welcome to do so and then remove the check for spaces in 
 <span class="v">books/GNUmakefile</span>, at which time we would be happy to remove 
 corresponding code in the top-level <span class="v">GNUmakefile</span> as well.)</p> 
 
 <p>The <span class="v">rdtsc</span> feature is now used in function <a href="ACL2____MEMOIZATION.html">memoization</a> not only 
 for host Lisp CCL but also for SBCL.  Thanks to Bob Boyer for suggesting this 
 change and providing helpful code.</p> 
 
 <p>With a trust tag, it is now possible to apply <span class="tt"><a href="ACL2____VERIFY-TERMINATION.html">verify-termination</a></span> to 
 functions with under-the-hood raw Lisp code.  See <a href="ACL2____VERIFY-TERMINATION-ON-RAW-PROGRAM-OKP.html">verify-termination-on-raw-program-okp</a>.</p> 
 
 <p>An argument has been added to the built-in function, <span class="v">recursivep</span>.  The 
 old call <span class="v">(<a href="ACL2____RECURSIVEP.html">recursivep</a> fn wrld)</span> has been replaced by the equivalent new 
 call <span class="v">(<a href="ACL2____RECURSIVEP.html">recursivep</a> fn t wrld)</span> in some community books.  See <a href="ACL2____SYSTEM-UTILITIES.html">system-utilities</a> for a discussion of <span class="v">recursivep</span>.  Thanks to Alessandro 
 Coglio for suggesting this change.</p> 
 
 <p>There is now some documentation on ACL2 system development [formerly in the 
 topic, system-development, and its subtopics; now expanded into <a href="ACL2____DEVELOPERS-GUIDE.html">the Developer's Guide</a>].  These replace 
 the pages under web directory 
 <span class="v">http://www.cs.utexas.edu/users/moore/acl2/open-architecture/</span>.  Thanks to 
 Eric Smith for encouraging us to move that documentation to XDOC.</p> 
 
 <p>The Common Lisp variable <span class="v">*debug-io*</span> is now used in printing 
 backtraces, but also is bound to <span class="v">*standard-output*</span> when entering the ACL2 
 read-eval-print loop, which is done at start-up (see <a href="ACL2____LP.html">lp</a>).  These 
 changes avoid unfortunate printing of backtraces when certifying certain books 
 that mess with <span class="v">*debug-io*</span> using <a href="ACL2____DEFTTAG.html">trust 
 tags</a>, such as <a href="ACL2____COMMUNITY-BOOKS.html">community book</a>. 
 <span class="v">books/centaur/vl2014/server/server.lisp</span>.  Thanks to Jared Davis for a tip 
 that helped us to debug that issue (ACL2 GitHub Issue #634).</p> 
 
 <p>We improved ACL2's implementation of the <span class="v">#.</span> read macro so that it no 
 longer prints additional errors after the first.  Also, the error message now 
 mentions :DOC <a href="ACL2____SHARP-DOT-READER.html">sharp-dot-reader</a>, pointing in particular to a relevant 
 remark when the failure occurs during book certification.</p> 
 
 <p>(SBCL only) Increased the value of <span class="v">--dynamic-space-size</span> written to the 
 executable scripts to 24000, from 16000, in support of building the manual.</p> 
 
 <h3>EMACS Support</h3> 
 
 <p>The text-based display of <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> has been improved, that is, 
 for output from <span class="v">:</span><span class="tt"><a href="ACL2____DOC.html">doc</a></span> at the terminal and also for the <span class="tt"><a href="ACL2____ACL2-DOC.html">ACL2-doc</a></span> Emacs browser.</p> 
 
 <ul> 
 
 <li>Links are inserted much more reliably.  That is, the surrounding of text 
 by square brackets for text-based display now virtually always creates links 
 that can be followed to topics in the <a href="ACL2____ACL2-DOC.html">ACL2-doc</a> browser.  In particular, 
 that browser now handles names properly that contain the <span class="v">:</span> 
 character.</li> 
 
 <li>Text in square brackets, for example [1], is no longer recognized as a 
 link (though Emacs still highlights it).  Thanks to Mihir Mehta for pointing 
 out this issue.</li> 
 
 <li>Automatic insertion of links for expressions <span class="tt">@('(name ...)')</span>, as 
 <span class="tt">@('([name] ...)')</span>, should not happen for text-based display.  This 
 was however done when generating short strings for subtopics in <a href="ACL2____ACL2-DOC.html">ACL2-doc</a>; that no longer happens.</li> 
 
 <li>The <span class="v">see?</span> directive (see <a href="XDOC____PREPROCESSOR.html">xdoc::preprocessor</a>) now inserts links; 
 it did not do so before (for text-based display).</li> 
 
 <li>Certain ``raw'' topics, such as DEFXDOC-RAW, are now included that 
 formerly were only included in the web-based manual.</li> 
 
 <li>Text within ``<span class="v">&lt;stv&gt; ... &lt;/stv&gt;</span>'' is now replaced by the text 
 ``<span class="v">{STV display}</span>''.  A general mechanism is in place for extending this 
 behavior to other tags (see <span class="v">xdoc-tag-elide-alist</span> in <a href="ACL2____COMMUNITY-BOOKS.html">community-books</a> file 'books/xdoc/display.lisp').</li> 
 
 <li>In the <a href="ACL2____ACL2-DOC.html">ACL2-doc</a> browser, when the ``i'' (<span class="v">acl2-doc-index</span>) 
 command is invoked without a prefix argument, the mode line shows the number 
 of matches.  (The remaining matches continue to be accessible using the ``,'' 
 <span class="v">(acl2-doc-index-next)</span> command.)</li> 
 
 </ul> 
 
 <p>Incorporated changes to <span class="v">emacs/emacs-acl2.el</span> put forward by Keshav 
 Kini (thanks!), as follows.</p> 
 
 <ul> 
 
 <li>Now, <span class="v">meta-x new-shell</span> avoids buffer names that already exist.</li> 
 
 <li>An error occurs when attempting to switch to a non-existent ACL2 shell 
 buffer, rather than creating such a buffer with no process.</li> 
 
 <li>For a new shell, call <span class="v">shell</span> instead of <span class="v">make-comint</span>.</li> 
 
 <li>Did a bit of refactoring and improved some error messages.</li> 
 
 </ul> 
 
 <h3>Experimental Versions</h3> 
 
 <p>As before, <a href="ACL2____BRR.html">brr</a> does not work in ACL2(p) with <a href="ACL2____WATERFALL-PARALLELISM.html">waterfall-parallelism</a> enabled; see <a href="ACL2____UNSUPPORTED-WATERFALL-PARALLELISM-FEATURES.html">unsupported-waterfall-parallelism-features</a>.  But now it is an error to try to 
 enable both brr and waterfall-parallelism.  Thanks to David Rager for helpful 
 discussions pertaining to this change.</p> 
 
 
</body>
</html>
