<html>
<head>
<meta charset="UTF-8">
<title>Dead-events</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____DEAD-EVENTS">Click for Dead-events in the Full Manual</a></h3>

<p>Using proof supporters to identify dead code and unused theorems</p><p>Below, when we talk about ``an event <span class="v">A</span>'', we mean an event 
 whose name is <span class="v">A</span>.</p> 
 
 <p>When event <span class="v">A</span> is used in a proof performed to admit event <span class="v">B</span> that 
 you submit to ACL2, we say that <span class="v">A</span> is a ``proof-supporter'' of <span class="v">B</span>. 
 ACL2 stores an association list such that for every event <span class="v">B</span> with at least 
 one proof-supporter, <span class="v">B</span> is associated with a list of all of its 
 proof-supporters, sorted by <span class="tt"><a href="ACL2____SYMBOL_C3.html">symbol&lt;</a></span>.  The following form evaluates to 
 that alist, which is called the ``proof-supporters-alist''.</p> 
 
 <pre class="code">(global-val 'proof-supporters-alist (<a href="ACL2____W.html">w</a> state))</pre> 
 
 <p>By ``used in a proof'' above, we mean: applied as a rule or supplied 
 explicitly via <a href="ACL2____HINTS.html">hints</a> of type <span class="v">:use</span>, <span class="v">:by</span>, or 
 <span class="v">:clause-processor</span>.  That is, the <a href="ACL2____EVENTS.html">events</a> ``used in a proof'' for 
 admitting an event <span class="v">E</span> are those listed in the <a href="ACL2____SUMMARY.html">summary</a> printed at 
 the conclusion of admitting <span class="v">E</span>.</p> 
 
 <p>Note that if proofs are skipped when admitting event <span class="v">E</span>, say because 
 the last admission of <span class="v">E</span> was done by <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> (or 
 <span class="v">certify-book</span>, which ends with an <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span>), then there will 
 be no entry in that alist for <span class="v">E</span>.  (An exception is made however for 
 <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> <a href="ACL2____EVENTS.html">events</a>, where proof-supporters are remembered from 
 the first pass; see below.)  So if you want the proof-supporters-alist to 
 include supporters for events in a book, use <span class="tt"><a href="ACL2____LD.html">ld</a></span> rather than <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> or <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span> to process the events in that book.  If 
 however you are interested in the proof-supporters FROM a book that support a 
 later event, then it is fine to include that book.</p> 
 
 <p>The case for <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> is slightly tricky.  Consider an example 
 of the following form.</p> 
 
 <pre class="code">A ; event preceding the encapsulate
(<a href="ACL2____ENCAPSULATE.html">encapsulate</a>
 ()
 B
 (<a href="ACL2____LOCAL.html">local</a> C) ; uses A and B in a proof
 D ; uses C in a proof
 )</pre> 
 
 <p>At the conclusion of this <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> event, the 
 proof-supporters-alist associates <span class="v">D</span> with <span class="v">A</span> and <span class="v">B</span>, but not 
 <span class="v">C</span> (which has disappeared, since it is <a href="ACL2____LOCAL.html">local</a>).</p> 
 
 <p>Note that this sort of ``transitive closure'' operation is only performed 
 when necessary due to the disappearance of <a href="ACL2____LOCAL.html">local</a> <a href="ACL2____EVENTS.html">events</a>.  For 
 example, if we replace <span class="v">(<a href="ACL2____LOCAL.html">local</a> C)</span> above by just <span class="v">C</span>, then <span class="v">D</span> is 
 associated in the proof-supporters-alist only with <span class="v">C</span>, not with <span class="v">A</span> or 
 <span class="v">B</span>.  If you want the transitive closure of the relation computed by the 
 proof-supporters-alist, you have to compute it yourself. (This was a 
 deliberate design decision, in order to avoid slowing down event processing.) 
 However, there is help available on how to do such a computation:</p> 
 
 <p>A community book, <span class="v">books/tools/dead-events.lisp</span>, does such a transitive 
 closure, and moreover uses that information to find ``dead events'' relative 
 to a list of ``desired'' events.  For example, suppose you use <span class="tt"><a href="ACL2____LD.html">ld</a></span> to 
 process the events, with proofs, in a book intended to prove theorems 
 <span class="v">MAIN-1</span> and <span class="v">MAIN-2</span>.  (Remember, <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span> will not save 
 such information.)  Suppose furthermore that the book begins with some <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> forms followed by <span class="v">(<a href="ACL2____DEFLABEL.html">deflabel</a> book-start)</span>.  You could 
 evaluate this form:</p> 
 
 <pre class="code">(<a href="ACL2____DEAD-EVENTS.html">dead-events</a> '(main-1 main-2) :start 'book-start)</pre> 
 
 <p>The result is a list of events that you probably can delete from the book 
 without causing any proofs to fail.  See the <span class="v">dead-events.lisp</span> book for 
 further documentation.</p> 
 
 <p>You might also find the code in the above book to be helpful for writing 
 your own utilities based on the proof-supporters-alist.</p>
</body>
</html>
