<html>
<head>
<meta charset="UTF-8">
<title>Deflist</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=STD____DEFLIST">Click for Deflist in the Full Manual</a></h3>

<p>Introduce a recognizer for a typed list.</p><p>Deflist lets you to quickly introduce recognizers for typed lists 
like <a href="ACL2____NAT-LISTP.html">nat-listp</a>.  It defines the new recognizer function, sets up a basic 
theory with rules about <a href="ACL2____LEN.html">len</a>, <a href="COMMON-LISP____APPEND.html">append</a>, <a href="COMMON-LISP____MEMBER.html">member</a>, etc., and 
generates basic, automatic <a href="ACL2____XDOC.html">xdoc</a> documentation.</p> 
 
<h4>General Form</h4> 
 
<pre class="code">(<a href="STD____DEFLIST.html">deflist</a> name formals
  element
  [keyword options]
  [/// other events]
  )

Options                  Defaults
  :negatedp                nil
  :true-listp              nil
  :elementp-of-nil         :unknown
  :guard                   t
  :verify-guards           t
  :guard-hints             nil
  :guard-debug             nil
  :non-emptyp              nil
  :mode                    current defun-mode
  :cheap                   nil
  :verbosep                nil
  :parents                 nil
  :short                   nil
  :long                    nil
  :prepwork                nil</pre> 
 
<h4>Basic Examples</h4> 
 
<p>The following introduces a new function, <span class="v">my-integer-listp</span>, which 
recognizes lists whose every element satisfies <span class="v">integerp</span>, and also 
introduces many theorems about this new function.</p> 
 
<pre class="code">(<a href="STD____DEFLIST.html">deflist</a> my-integer-listp (x)
  (<a href="COMMON-LISP____INTEGERP.html">integerp</a> x))</pre> 
 
<p><b><font color="#ff0000">Note</font></b>: <span class="v">x</span> is treated in a special 
way.  It refers to the whole list in formals and guards, but refers to 
individual elements of the list in the <span class="v">element</span> portion.  This is similar 
to how other macros like <a href="STD____DEFALIST.html">defalist</a>, <a href="STD____DEFPROJECTION.html">defprojection</a>, and <a href="STD____DEFMAPAPPEND.html">defmapappend</a> handle <span class="v">x</span>.</p> 
 
<p>Here is a recognizer for lists with no natural numbers:</p> 
 
<pre class="code">(<a href="STD____DEFLIST.html">deflist</a> nat-free-listp (x)
  (<a href="ACL2____NATP.html">natp</a> x)
  :negatedp t)</pre> 
 
<p>Here is a recognizer for lists whose elements must exceed some minimum:</p> 
 
<pre class="code">(<a href="STD____DEFLIST.html">deflist</a> all-greaterp (<a href="COMMON-LISP____MIN.html">min</a> x)
  (<a href="COMMON-LISP_____E3.html">&gt;</a> x min)
  :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____NATP.html">natp</a> min)
              (<a href="ACL2____NAT-LISTP.html">nat-listp</a> x)))</pre> 
 
<h3>Usage and Optional Arguments</h3> 
 
<p>Let <span class="v">pkg</span> be the package of <span class="v">name</span>.  All functions, theorems, and 
variables are created in this package.  One of the formals must be <span class="v">pkg::x</span>, 
and this argument represents the list to check.  Otherwise, the only 
restriction on the formals is that you may not use the names <span class="v">pkg::a</span>, 
<span class="v">pkg::n</span>, or <span class="v">pkg::y</span>, because we use these variables in the theorems we 
generate.</p> 
 
<p>The optional <span class="v">:negatedp</span> keyword can be used to recognize a list whose 
every element does not satisfy elementp.</p> 
 
<p>The optional <span class="v">:true-listp</span> keyword can be used to require that the new 
recognizer is "strict" and will only accept lists that are 
<span class="v">nil</span>-terminated; by default the recognizer will be "loose" and will not 
pay attention to the final <span class="v">cdr</span>.  There are various reasons to prefer one 
behavior or another; see <a href="STD____STRICT-LIST-RECOGNIZERS.html">strict-list-recognizers</a> for details.</p> 
 
<p>The optional <span class="v">:elementp-of-nil</span> keyword can be used when <span class="v">(elementp nil
...)</span> is always known to be <span class="v">t</span> or <span class="v">nil</span>.  When it is provided, 
<span class="v">deflist</span> can generate slightly better theorems.</p> 
 
<p>The optional <span class="v">:guard</span>, <span class="v">:verify-guards</span>, <span class="v">:guard-debug</span>, and 
<span class="v">:guard-hints</span> are options for the <a href="COMMON-LISP____DEFUN.html">defun</a> we introduce.  These are for 
the guards of the new list recognizer, not the element recognizer.</p> 
 
<p>The optional <span class="v">:mode</span> keyword can be set to <span class="v">:logic</span> or <span class="v">:program</span> 
to introduce the recognizer in logic or program mode.  The default is whatever 
the current default defun-mode is for ACL2, i.e., if you are already in program 
mode, it will default to program mode, etc.</p> 
 
<p>The optional <span class="v">:verbosep</span> flag can be set to <span class="v">t</span> if you want deflist to 
print everything it's doing.  This may be useful if you run into any failures, 
or if you are simply curious about what is being introduced.</p> 
 
<p>The optional <span class="v">:cheap</span> flag can be set to <span class="v">t</span> to produce cheaper, less 
effective rule-classes for some rules; this may be convenient when the element 
type is a very common function such as <span class="v">consp</span>, in which case adding 
stronger rules might significantly slow down proofs.</p> 
 
<p>The optional <span class="v">:parents</span>, <span class="v">:short</span>, and <span class="v">:long</span> keywords are as in 
<a href="ACL2____DEFXDOC.html">defxdoc</a>.  Typically you only need to specify <span class="v">:parents</span>, perhaps 
implicitly with <a href="ACL2____SET-DEFAULT-PARENTS.html">ACL2::set-default-parents</a>, and suitable documentation 
will be automatically generated for <span class="v">:short</span> and <span class="v">:long</span>.  If you don't 
like this documentation, you can supply your own <span class="v">:short</span> and/or <span class="v">:long</span> 
to override it.</p> 
 
<p>The optional <span class="v">:prepwork</span> may provide a list of event forms that are 
submitted just before the generated events.  These are preparatory events, 
e.g. local lemmas to help prove <span class="v">:elementp-of-nil</span>.</p> 
 
<h3>Pluggable Architecture</h3> 
 
<p>Beginning in ACL2 6.5, deflist no longer hard-codes the set of theorems to 
be produced about every list recognizer.  Instead, <span class="v">def-listp-rule</span> forms 
pertaining to a generic list recognizer called <span class="v">element-list-p</span> are used as 
templates and instantiated for each deflist invocation.  These forms may be 
scattered throughout various libraries, so the set of books you have loaded 
determines the set of rules produced by a deflist invocation.  See <a href="ACL2____STD_F2LISTS_F2ABSTRACT.html">ACL2::std/lists/abstract</a> for more information about these rules and how to 
control what theorems are produced by deflist.</p> 
 
<p>"std/util/deflist.lisp" includes books that compose a set of rules to 
instantiate that should be more or less backward compatible with the theorems 
produced by deflist in ACL2 6.4 and previous.  "std/util/deflist-base.lisp" 
includes a much more basic set of rules.</p> 
 
<h3>Support for Other Events</h3> 
 
<p>Deflist implements the same <span class="v">///</span> syntax as other macros like <a href="ACL2____DEFINE.html">define</a>.  This allows you to put related events near the definition and have 
them included in the automatic documentation.  As with define, the new 
recognizer is enabled during the <span class="v">///</span> section.  Here is an example:</p> 
 
<pre class="code">(<a href="STD____DEFLIST.html">deflist</a> even-integer-list-p (x)
  (even-integer-p x)
  :true-listp t
  ///
  (<a href="ACL2____DEFTHM.html">defthm</a> integer-listp-when-even-integer-list-p
    (<a href="ACL2____IMPLIES.html">implies</a> (even-integer-list-p x)
             (<a href="ACL2____INTEGER-LISTP.html">integer-listp</a> x))))</pre> 
 
<p>Deprecated.  The optional <span class="v">:rest</span> keyword was a precursor to <span class="v">///</span>. 
It is still implemented, but its use is now discouraged.  If both <span class="v">:rest</span> 
and <span class="v">///</span> events are used, we arbitrarily put the <span class="v">:rest</span> events 
first.</p> 
 
<p>Deprecated.  The optional <span class="v">:already-definedp</span> keyword can be set if you 
have already defined the function.  This was previously useful when you wanted 
to generate the ordinary <span class="v">deflist</span> theorems without generating a <span class="v">defund</span> 
event, e.g., because you are dealing with mutually recursive recognizers.  We 
still accept this option for backwards compatibility but it is useless, because 
<span class="v">deflist</span> is now smart enough to notice that the function is already 
defined.</p>
</body>
</html>
