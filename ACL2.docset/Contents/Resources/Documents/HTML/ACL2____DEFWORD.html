<html>
<head>
<meta charset="UTF-8">
<title>Defword</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____DEFWORD">Click for Defword in the Full Manual</a></h3>

<p>A macro to define packed integer data structures.</p><p>Example:</p> 
 
<pre class="code">(<a href="ACL2____DEFWORD.html">DEFWORD</a> FM9001-INSTRUCTION-WORD
  ((RN-A 4 0) (MODE-A 2 4) (IMMEDIATE 9 0) (A-IMMEDIATE 1 9)
   (RN-B 4 10) (MODE-B 2 14)
   (SET-FLAGS 4 16) (STORE-CC 4 20) (OP-CODE 4 24))
  :CONC-NAME ||
  :SET-CONC-NAME SET-)</pre> 
 
<p>The above example defines the instruction word layout for the FM9001.  The 
macro defines accessing macros (RN-A i), ... ,(OP-CODE i), updating 
macros (SET-RN-A val i), ... ,(SET-OP-CODE val i), and a keyword updating 
macro <span class="v">(UPDATE-FM9001-INSTRUCTION-WORD val &amp;rest args)</span>.</p> 
 
<p>General form:</p> 
 
<pre class="code">(<a href="ACL2____DEFWORD.html">DEFWORD</a> name struct &amp;key conc-name set-conc-name keyword-updater)</pre> 
 
<p>The DEFWORD macro defines a packed integer data structure, for example an 
instruction word for a programmable processor or a status word.  DEFWORD is a 
simple macro that defines accessing and updating macros for the fields of the 
data structure. The utility of DEFWORD is mainly to simplify the specification 
of packed integer data structures, and to improve the readability of code 
manipulating these data structures without affecting performance. As long as 
the book "logops-lemmas" is loaded all of the important facts about the macro 
expansions should be available to the theorem prover.</p> 
 
<p>Arguments</p> 
 
<pre class="code">name:  The name of the data structure, a symbol.

struct : The field structure of the word. The form of this argument is
given by the following grammar:

&lt;tuple&gt;  := (&lt;field&gt; &lt;size&gt; &lt;pos&gt; [ &lt;doc&gt; ])
&lt;struct&gt; := () | (&lt;tuple&gt; . &lt;struct&gt;)

where:

(<a href="COMMON-LISP____SYMBOLP.html">SYMBOLP</a> &lt;field&gt;)
(<a href="COMMON-LISP____AND.html">AND</a> (<a href="COMMON-LISP____INTEGERP.html">INTEGERP</a> &lt;size&gt;) (<a href="COMMON-LISP_____E3.html">&gt;</a> &lt;size&gt; 0))
(<a href="COMMON-LISP____AND.html">AND</a> (<a href="COMMON-LISP____INTEGERP.html">INTEGERP</a> &lt;pos&gt;) (<a href="COMMON-LISP_____E3_D3.html">&gt;=</a> &lt;pos&gt; 0))
(<a href="COMMON-LISP____STRINGP.html">STRINGP</a> &lt;doc&gt;)</pre> 
 
<p>In other words, a list of tuples, the first element being a symbol, the 
second a positive integer, the third a nonnegative integer, and the optional 
fourth a string.</p> 
 
<p>Note that there are few other requirements on the <span class="v">&lt;struct&gt;</span> other than 
the syntactic ones above.  For example, the FM9001 DEFWORD shows that a word 
may have more than one possible structure - the first 9 bits of the FM9001 
instruction word are either an immediate value, or they include the RN-A and 
MODE-A fields.</p> 
 
<p>conc-name, set-conc-name: These are symbols whose print names will be 
concatenated with the field names to produce the name of the accessors and 
updaters respectively.  The default is <span class="v">&lt;name&gt;</span>- and <span class="v">SET-&lt;name&gt;</span>- 
respectively.  The access and update macro names will be interned in the 
package of name.</p> 
 
<p>keyword-updater:  This is a symbol, and specifies the name of the keyword 
updating macro (see below).  The default is <span class="v">UPDATE-&lt;name&gt;</span>.</p> 
 
 
<h3>Interpretation</h3> 
 
<p>DEFWORD creates an ACL2 DEFLABEL event named <span class="v">&lt;name&gt;</span>.</p> 
 
<p>Each tuple <span class="v">(&lt;field&gt; &lt;size&gt; &lt;pos&gt;)</span> represents a <span class="v">&lt;size&gt;</span>-bit field of 
a word at the bit position indicated.  Each field tuple produces an accessor 
macro</p> 
 
<pre class="code">(&lt;accessor&gt; word)</pre> 
 
<p>where <span class="v">&lt;accessor&gt;</span> is computed from the :conc-name (see above).  This 
accessor will expand into:</p> 
 
<pre class="code">(<a href="ACL2____RDB.html">RDB</a> (<a href="ACL2____BSP.html">BSP</a> &lt;size&gt; &lt;pos&gt;) word).</pre> 
 
<p>DEFWORD also generates an updating macro</p> 
 
<pre class="code">(&lt;updater&gt; val word)</pre> 
 
<p>where <span class="v">&lt;updater&gt;</span> is computed from the :set-conc-name (see above).  This 
macro will expand to</p> 
 
<pre class="code">(<a href="ACL2____WRB.html">WRB</a> val (<a href="ACL2____BSP.html">BSP</a> &lt;size&gt; &lt;pos&gt;) word)</pre> 
 
<p>The keyword updater</p> 
 
<pre class="code">(&lt;keyword-updater&gt; word &amp;rest args)</pre> 
 
<p>is equivalent to multiple nested calls of the updaters on the initial word. 
 For example,</p> 
 
<pre class="code">(UPDATE-FM9001-INSTRUCTION-WORD WORD :RN-A 10 :RN-B 12)</pre> 
 
<p>is the same as <span class="v">(SET-RN-A 10 (SET-RN-B 12 WORD))</span>.</p> 
 

</body>
</html>
