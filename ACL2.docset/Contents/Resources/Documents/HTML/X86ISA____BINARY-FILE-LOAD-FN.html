<html>
<head>
<meta charset="UTF-8">
<title>Binary-file-load-fn</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=X86ISA____BINARY-FILE-LOAD-FN">Click for Binary-file-load-fn in the Full Manual</a></h3>

<p>Function to read in an ELF or Mach-O binary and load text 
  and data sections into the x86 ISA model's memory</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(binary-file-load-fn filename exld::elf 
                     exld::mach-o x86 state &amp;key (elf 't) 
                     (mach-o 'nil)) 
 
  → 
(mv new-elf new-mach-o new-x86 state)</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">filename</span> — <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____STRINGP.html">stringp</a> filename)</span>.</font>
</dd> 
  <dd>
<span class="tt">elf</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____BOOLEANP.html">booleanp</a> elf)</span>.</font>
</dd> 
  <dd>
<span class="tt">mach-o</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____BOOLEANP.html">booleanp</a> mach-o)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">new-elf</span> — <font color="#606060">Type <span class="v">(<a href="EXLD____GOOD-ELF-P.html">exld::good-elf-p</a> new-elf)</span>, given <span class="v">(exld::elfp exld::good-elf-p)</span>.</font>
</dd> 
<dd>
<span class="tt">new-mach-o</span> — <font color="#606060">Type <span class="v">(<a href="EXLD____GOOD-MACH-O-P.html">exld::good-mach-o-p</a> new-mach-o)</span>, given <span class="v">(exld::mach-op exld::good-mach-o-p)</span>.</font>
</dd> 
<dd>
<span class="tt">new-x86</span> — <font color="#606060">Type <span class="v">(x86p new-x86)</span>, given <span class="v">(x86p x86)</span>.</font>
</dd> 
 
</dl></div> 
<p>The following macro makes it convenient to call this 
  function to load a program:</p> 
<pre class="code"> (binary-file-load "fib.o" :elf t) ;; or :mach-o t</pre> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>binary-file-load-fn-fn</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 binary-file-load-fn-fn
 (filename exld::elf
           exld::mach-o x86 state elf mach-o)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :stobjs (exld::elf exld::mach-o x86 state)))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____STRINGP.html">stringp</a> filename)
                             (<a href="ACL2____BOOLEANP.html">booleanp</a> elf)
                             (<a href="ACL2____BOOLEANP.html">booleanp</a> mach-o))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'binary-file-load-fn))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="COMMON-LISP____COND.html">cond</a>
   ((<a href="COMMON-LISP____AND.html">and</a> elf (<a href="COMMON-LISP____NOT.html">not</a> mach-o))
    (<a href="ACL2____B_A2.html">b*</a>
     (((<a href="ACL2____MV.html">mv</a> exld::elf state)
       (<a href="EXLD____POPULATE-ELF.html">exld::populate-elf</a> filename exld::elf state))
      ((<a href="ACL2____MV.html">mv</a> flg x86)
       (<a href="X86ISA____LOAD-ELF-SECTIONS.html">load-elf-sections</a> (exld::@sections exld::elf)
                          x86))
      ((when flg)
       (<a href="ACL2____PROG2_42.html">prog2$</a>
        (<a href="ACL2____RAISE.html">raise</a>
         "[ELF]: Error encountered while loading sections in the x86 model's memory!~%")
        (<a href="ACL2____MV.html">mv</a> exld::elf exld::mach-o x86 state))))
     (<a href="ACL2____MV.html">mv</a> exld::elf exld::mach-o x86 state)))
   ((<a href="COMMON-LISP____AND.html">and</a> mach-o (<a href="COMMON-LISP____NOT.html">not</a> elf))
    (<a href="ACL2____B_A2.html">b*</a>
     (((<a href="ACL2____MV.html">mv</a> ?alst exld::mach-o state)
       (<a href="EXLD____POPULATE-MACH-O.html">exld::populate-mach-o</a> filename exld::mach-o state))
      ((<a href="ACL2____MV.html">mv</a> flg0 x86)
       (mach-o-load-text-section exld::mach-o x86))
      ((<a href="ACL2____MV.html">mv</a> flg1 x86)
       (mach-o-load-data-section exld::mach-o x86))
      ((when (<a href="COMMON-LISP____OR.html">or</a> flg0 flg1))
       (<a href="ACL2____PROG2_42.html">prog2$</a>
        (<a href="ACL2____RAISE.html">raise</a>
         "[Mach-O]: Error encountered while loading sections in the x86 model's memory!~%")
        (<a href="ACL2____MV.html">mv</a> exld::elf exld::mach-o x86 state))))
     (<a href="ACL2____MV.html">mv</a> exld::elf exld::mach-o x86 state)))
   (t
    (<a href="ACL2____PROG2_42.html">prog2$</a>
     (<a href="ACL2____RAISE.html">raise</a>
      "~%We support only ELF and Mach-O files for now! Use this function with either :elf t ~
 or :mach-o t.~%")
     (<a href="ACL2____MV.html">mv</a> exld::elf exld::mach-o x86 state))))))</pre> 
<p><b>Theorem: </b>good-elf-p-of-binary-file-load-fn.new-elf</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 good-elf-p-of-binary-file-load-fn.new-elf
 (<a href="ACL2____IMPLIES.html">implies</a>
  (exld::elfp exld::good-elf-p)
  (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?new-elf
            ?new-mach-o ?new-x86 acl2::?state)
        (binary-file-load-fn-fn filename exld::elf
                                exld::mach-o x86 state elf mach-o)))
      (<a href="EXLD____GOOD-ELF-P.html">exld::good-elf-p</a> new-elf)))
 :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>good-mach-o-p-of-binary-file-load-fn.new-mach-o</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 good-mach-o-p-of-binary-file-load-fn.new-mach-o
 (<a href="ACL2____IMPLIES.html">implies</a>
  (exld::mach-op exld::good-mach-o-p)
  (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?new-elf
            ?new-mach-o ?new-x86 acl2::?state)
        (binary-file-load-fn-fn filename exld::elf
                                exld::mach-o x86 state elf mach-o)))
      (<a href="EXLD____GOOD-MACH-O-P.html">exld::good-mach-o-p</a> new-mach-o)))
 :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>x86p-of-binary-file-load-fn.new-x86</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 x86p-of-binary-file-load-fn.new-x86
 (<a href="ACL2____IMPLIES.html">implies</a>
  (x86p x86)
  (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?new-elf
            ?new-mach-o ?new-x86 acl2::?state)
        (binary-file-load-fn-fn filename exld::elf
                                exld::mach-o x86 state elf mach-o)))
      (x86p new-x86)))
 :rule-classes :rewrite)</pre> 

</body>
</html>
