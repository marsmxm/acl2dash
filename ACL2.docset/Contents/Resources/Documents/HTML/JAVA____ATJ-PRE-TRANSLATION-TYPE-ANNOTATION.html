<html>
<head>
<meta charset="UTF-8">
<title>Atj-pre-translation-type-annotation</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=JAVA____ATJ-PRE-TRANSLATION-TYPE-ANNOTATION">Click for Atj-pre-translation-type-annotation in the Full Manual</a></h3>

<p>Pre-translation step performed by ATJ: 
          addition of type annotations.</p><p>This is done only in the shallow embedding.</p><p>This step annotates ACL2 terms with ATJ types: 
     (i) each ACL2 term is wrapped with a function named <span class="v">[src&gt;dst]</span>, 
     where <span class="v">src</span> identifies the ATJ types of the term 
     and <span class="v">dst</span> identifies ATJ types to which the term must be converted to; 
     (ii) each ACL2 variable <span class="v">var</span> in a term is renamed to <span class="v">[type]var</span>, 
     where <span class="v">type</span> identifies the ATJ type of the variable.</p><p>Both <span class="v">src</span> and <span class="v">dst</span> above identify non-empty lists of ATJ types. 
     This is because an ACL2 term may return multiple values (see <span class="tt"><a href="ACL2____MV.html">mv</a></span>): 
     each list consists of two or more ATJ types when he ACL2 term does; 
     otherwise, it consists of one ATJ type only. 
     The two lists (for <span class="v">src</span> and <span class="v">dst</span>) will always have the same length, 
     because ACL2 prevents treating 
     single values as multiple values, 
     multiple values as single values, 
     or multiple values of a certain number 
     as multiple values of a different number. 
     Non-executable functions relax these restrictions, 
     but their body includes calls of <span class="v">acl2::throw-nonexec-error</span>, 
     which has raw Lisp code and is currently not whitelisted by ATJ.</p><p>These annotations facilitate the ACL2-to-Java translation, 
     which uses the type annotations as ``instructions'' for 
     (i) which types to declare Java local variables with, and 
     (ii) which Java conversion code to insert around expressions.</p><p>The annotated terms are still ACL2 terms, but with a specific structure. 
     This should let us prove, in the ACL2 logic, 
     the equality of the annotated terms with the original terms, 
     under suitable variable rebinding, 
     and by introducing the <span class="v">[src&gt;dst]</span> functions as identities. 
     (This has not been done yet.)</p>
</body>
</html>
