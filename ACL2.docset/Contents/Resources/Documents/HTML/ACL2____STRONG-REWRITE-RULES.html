<html>
<head>
<meta charset="UTF-8">
<title>Strong-rewrite-rules</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____STRONG-REWRITE-RULES">Click for Strong-rewrite-rules in the Full Manual</a></h3>

<p>Formulating good rewrite rules</p><p>Suppose you notice the following term in a Key Checkpoint:</p> 
 
 <pre class="code">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> (<a href="COMMON-LISP____CAR.html">CAR</a> A) (<a href="ACL2____REV.html">REV</a> B)).</pre> 
 
 <p>You might think of two theorems for handling this term, which we'll call 
 the ``weak'' and ``strong'' version of <span class="v">member-rev</span>.</p> 
 
 <pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> member-rev-weak
  (<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____MEMBER.html">member</a> e b)
           (<a href="COMMON-LISP____MEMBER.html">member</a> e (<a href="ACL2____REV.html">rev</a> b)))).

(<a href="ACL2____DEFTHM.html">defthm</a> member-rev-strong
  (<a href="ACL2____IFF.html">iff</a> (<a href="COMMON-LISP____MEMBER.html">member</a> e (<a href="ACL2____REV.html">rev</a> b))
       (<a href="COMMON-LISP____MEMBER.html">member</a> e b))).</pre> 
 
 <p>The ``strong'' version logically implies the ``weak'' version and so 
 deserves the adjective.  (Recall that ``<i>p</i> &lt;---&gt; <i>q</i>'' is 
 just ``<i>p</i> ---&gt; <i>q</i>'' and ``<i>q</i> ---&gt; <i>p</i>.''  So the 
 strong version quite literally says everything the weak version does and then 
 some.)</p> 
 
 <p>But the ``strong'' version also produces a <i>better</i> rewrite rule. 
 Here are the rules generated from these two formulas, phrased as directives to 
 ACL2's simplifier:</p> 
 
 <p><span class="v">member-rev-weak</span>: If you ever see an instance of <span class="v">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> e (<a href="ACL2____REV.html">REV</a>
 b))</span>, backchain to <span class="v">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> e b)</span> (i.e., turn your attention to that term) 
 and if you can show that it is true, replace <span class="v">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> e (<a href="ACL2____REV.html">REV</a> b))</span> by 
 <span class="v">T</span>.</p> 
 
 <p><span class="v">member-rev-strong</span>: If you ever see an instance of <span class="v">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> e (<a href="ACL2____REV.html">REV</a>
 b))</span>, replace it by <span class="v">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> e b)</span>.</p> 
 
 <p>Technical Note: Actually, both rules concern <i>propositional</i> 
 occurrences of the ``target'' expression, <span class="v">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> e (<a href="ACL2____REV.html">REV</a> b))</span>, i.e., 
 occurrences of the target in which its truth value is the only thing of 
 relevance.  (Recall that <span class="v">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> x y)</span> returns the tail of <span class="v">y</span> starting 
 with <span class="v">x</span>!  Evaluate some simple <span class="v">MEMBER</span> expressions, like <span class="v">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> 3
 '(1 2 3 4 5))</span> to see what we mean.)  Both theorems tell us about 
 circumstances in which the target is non-<span class="v">NIL</span> (i.e., ``true'') without 
 telling us its identity.  But ACL2 keeps track of when the target is in a 
 propositional occurrence and can use such rules to rewrite the target to 
 propositionally equivalent terms.</p> 
 
 <p>So the strong version is better because it will always eliminate <span class="v">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a>
 e (<a href="ACL2____REV.html">REV</a> b))</span> in favor of <span class="v">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> e b)</span>.  That simpler expression may be 
 further reduced if the context allows it.  But in any case, the strong version 
 eliminates <span class="v">REV</span> from the problem.  The weak version only eliminates 
 <span class="v">REV</span> when a side-condition can be proved.</p> 
 
 <p>While either version may permit us to prove the Key Checkpoint that 
 ``suggested'' the rule, the strong version is a better rule to have in the 
 database going forward.</p> 
 
 <p>For example, suppose <span class="v">NATS-BELOW</span> returns the list of natural numbers 
 below its argument.  Imagine two alternative scenarios in which a key 
 checkpoint is about to arise involving this term:</p> 
 
 <pre class="code">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> K (<a href="ACL2____REV.html">REV</a> (NATS-BELOW J)))</pre> 
 
 <p><b>Scenario 1</b> is when you've got the strong version in your database: 
 it will rewrite the key checkpoint term to</p> 
 
 <pre class="code">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> K (NATS-BELOW J))</pre> 
 
 <p>and that's what you'll see in the printed checkpoint unless other rules 
 reduce it further.</p> 
 
 <p><b>Scenario 2</b> is when you have only the weak version in your database: 
 the weak rule will attempt to reduce the term above to <span class="v">T</span> and will, if 
 there are sufficient rules and hypotheses about <span class="v">K</span>'s membership in 
 <span class="v">(NATS-BELOW J)</span>.  But if no such rules or hypotheses are available, you'll 
 be confronted with a key checkpoint involving</p> 
 
 <pre class="code">(<a href="COMMON-LISP____MEMBER.html">MEMBER</a> K (<a href="ACL2____REV.html">REV</a> (NATS-BELOW J)))</pre> 
 
 <p>and <i>it will not be obvious</i> that the problem would go away if you 
 could establish that <span class="v">K</span> is in <span class="v">(NATS-BELOW J)</span>.  Clearly, Scenario 1 is 
 better.</p> 
 
 <p>We recommend that you now practice formulating strong versions of rules 
 suggested by terms you might see.  See <a href="ACL2____PRACTICE-FORMULATING-STRONG-RULES.html">practice-formulating-strong-rules</a>.</p> 
 
 <p>When you are finished with that, use your browser's <b>Back Button</b> to 
 return to <a href="ACL2____INTRODUCTION-TO-KEY-CHECKPOINTS.html">introduction-to-key-checkpoints</a>.</p>
</body>
</html>
