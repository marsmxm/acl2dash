<html>
<head>
<meta charset="UTF-8">
<title>Atj-process-output-subdir</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=JAVA____ATJ-PROCESS-OUTPUT-SUBDIR">Click for Atj-process-output-subdir in the Full Manual</a></h3>

<p>Process the subdirectories specified by 
          the <span class="v">:output-dir</span> and <span class="v">:java-package</span> inputs.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(atj-process-output-subdir current-subdir 
                           current-exists next-subdirs ctx state) 
 
  → 
(mv erp final-dir state)</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">current-subdir</span> — <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____STRINGP.html">stringp</a> current-subdir)</span>.</font>
</dd> 
  <dd>
<span class="tt">current-exists</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____BOOLEANP.html">booleanp</a> current-exists)</span>.</font>
</dd> 
  <dd>
<span class="tt">next-subdirs</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____STRING-LISTP.html">string-listp</a> next-subdirs)</span>.</font>
</dd> 
  <dd>
<span class="tt">ctx</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____CTXP.html">ctxp</a> ctx)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">final-dir</span> — <font color="#606060">Type <span class="v">(<a href="COMMON-LISP____STRINGP.html">stringp</a> final-dir)</span>.</font>
</dd> 
 
</dl></div> 
<p>This is part of the processing of <span class="v">:output-dir</span>. 
     As explained in the user documentation, 
     if <span class="v">:java-package</span> is not <span class="v">nil</span>, 
     the Java files are generated in a subdirectory 
     of the directory specified by <span class="v">:output-dir</span>, 
     corresponding to the identifiers that form the Java package name.</p><p>Here we ensure that the subdirectories in the sequence 
     either exists and are directories, or do not exist. 
     It is allowed for no subdirectory to exist, 
     or for some initial prefix to exist, 
     or for all of them to exist; 
     any non-existing subdirectories will be created 
     just before generating the Java files.</p><p>This ACL2 function recursively checks the subdirectories. 
     The <span class="v">current-subdir</span> parameter is the path consisting of 
     the <span class="v">:output-dir</span> directory plus the subdirectories examined so far; 
     its initial value is <span class="v">:output-dir</span>. 
     The <span class="v">current-exists</span> parameter says whether 
     the <span class="v">current-subdir</span> exists or not; 
     its initial value is <span class="v">t</span>. 
     The <span class="v">next-subdirs</span> parameter contains 
     the remaining subdirectories to examine; 
     its initial value is the list of identifiers 
     that form the Java package name. 
     As soon as a subdirectory is encountered that does not exist, 
     the <span class="v">current-exists</span> is set to <span class="v">nil</span>, and it stays that way. 
     In any case eventually the final subdirectory path, 
     starting with <span class="v">:output-dir</span>, is returned.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>atj-process-output-subdir</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 atj-process-output-subdir
 (current-subdir current-exists next-subdirs ctx state)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :stobjs (<a href="ACL2____STATE.html">state</a>)))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____STRINGP.html">stringp</a> current-subdir)
                             (<a href="ACL2____BOOLEANP.html">booleanp</a> current-exists)
                             (<a href="ACL2____STRING-LISTP.html">string-listp</a> next-subdirs)
                             (<a href="ACL2____CTXP.html">ctxp</a> ctx))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'atj-process-output-subdir))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
   (((when (<a href="COMMON-LISP____ENDP.html">endp</a> next-subdirs))
     (<a href="ACL2____VALUE.html">value</a> (<a href="ACL2____MBE.html">mbe</a> :logic (<a href="ACL2____STR-FIX.html">str-fix</a> current-subdir)
                 :exec current-subdir)))
    (current-subdir
         (<a href="OSLIB____CATPATH.html">oslib::catpath</a> current-subdir (<a href="COMMON-LISP____CAR.html">car</a> next-subdirs)))
    ((when current-exists)
     (<a href="JAVA____ATJ-PROCESS-OUTPUT-SUBDIR.html">atj-process-output-subdir</a> current-subdir
                                current-exists (<a href="COMMON-LISP____CDR.html">cdr</a> next-subdirs)
                                ctx state))
    ((<a href="ACL2____MV.html">mv</a> err-msg exists state)
     (<a href="OSLIB____PATH-EXISTS-P.html">oslib::path-exists-p</a> current-subdir))
    ((when err-msg)
     (<a href="ACL2____ER-SOFT_B2.html">er-soft+</a>
      ctx t ""
      "The existence of the output subdirectory path ~x0 ~
                   cannot be tested.  ~@1"
      current-subdir err-msg))
    ((when (<a href="COMMON-LISP____NOT.html">not</a> exists))
     (<a href="JAVA____ATJ-PROCESS-OUTPUT-SUBDIR.html">atj-process-output-subdir</a> current-subdir t (<a href="COMMON-LISP____CDR.html">cdr</a> next-subdirs)
                                ctx state))
    ((<a href="ACL2____MV.html">mv</a> err-msg kind state)
     (<a href="OSLIB____FILE-KIND.html">oslib::file-kind</a> current-subdir))
    ((when err-msg)
     (<a href="ACL2____ER-SOFT_B2.html">er-soft+</a>
      ctx t ""
      "The kind of the output subdirectory path ~x0 ~
                   cannot be tested.  ~@1."
      current-subdir err-msg))
    ((unless (<a href="COMMON-LISP____EQ.html">eq</a> kind :directory))
     (<a href="ACL2____ER-SOFT_B2.html">er-soft+</a>
      ctx t ""
      "The output subdirectory path ~x0 ~
                   exists but is not a directory."
      current-subdir)))
   (<a href="JAVA____ATJ-PROCESS-OUTPUT-SUBDIR.html">atj-process-output-subdir</a> current-subdir nil (<a href="COMMON-LISP____CDR.html">cdr</a> next-subdirs)
                              ctx state))))</pre> 
<p><b>Theorem: </b>stringp-of-atj-process-output-subdir.final-dir</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> stringp-of-atj-process-output-subdir.final-dir
        (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?erp ?final-dir acl2::?state)
              (<a href="JAVA____ATJ-PROCESS-OUTPUT-SUBDIR.html">atj-process-output-subdir</a>
                   current-subdir
                   current-exists next-subdirs ctx state)))
            (<a href="COMMON-LISP____STRINGP.html">stringp</a> final-dir))
        :rule-classes :rewrite)</pre> 

</body>
</html>
