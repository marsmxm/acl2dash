<html>
<head>
<meta charset="UTF-8">
<title>Last-prover-steps</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____LAST-PROVER-STEPS">Click for Last-prover-steps in the Full Manual</a></h3>

<p>The number of prover steps most recently taken</p><p>For discussions of prover step limits, See <a href="ACL2____SET-PROVER-STEP-LIMIT.html">set-prover-step-limit</a> and see <a href="ACL2____WITH-PROVER-STEP-LIMIT.html">with-prover-step-limit</a>.</p> 
 
 <p>The <a href="ACL2____SUMMARY.html">summary</a> printed for an <a href="ACL2____EVENT.html">event</a> typically includes a line 
 showing the prover steps counted, for example as follows.</p> 
 
 <pre class="code">Prover steps counted:  7240</pre> 
 
 <p>The value of the form <span class="v">(<a href="ACL2____LAST-PROVER-STEPS.html">last-prover-steps</a> state)</span> indicates the number 
 of prover steps taken, in the sense described below, for the most recent 
 context in which an event <a href="ACL2____SUMMARY.html">summary</a> would normally be printed.  Note that 
 the value of <span class="v">(<a href="ACL2____LAST-PROVER-STEPS.html">last-prover-steps</a> state)</span> is updated for all <a href="ACL2____EVENTS.html">events</a>, 
 and more generally, for all forms that are set up to print a <a href="ACL2____SUMMARY.html">summary</a>, 
 such as calls of <span class="tt"><a href="ACL2____THM.html">thm</a></span> or <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span> â€” regardless of 
 whether or not summary output is inhibited (see <a href="ACL2____SET-INHIBIT-OUTPUT-LST.html">set-inhibit-output-lst</a> 
 and see <a href="ACL2____SET-INHIBITED-SUMMARY-TYPES.html">set-inhibited-summary-types</a>).  In particular, the value is 
 updated (typically to <span class="v">nil</span>) for <span class="tt"><a href="ACL2____TABLE.html">table</a></span> <a href="ACL2____EVENTS.html">events</a>, even when no 
 summary is printed; for example, the value is updated to <span class="v">nil</span> for 
 <span class="v">table</span> events such as <span class="v">(</span><span class="tt"><a href="ACL2____LOGIC.html">logic</a></span><span class="v">)</span>, <span class="v">(</span><span class="tt"><a href="ACL2____PROGRAM.html">program</a></span><span class="v">)</span>, and even calls of <span class="tt"><a href="ACL2____SET-PROVER-STEP-LIMIT.html">set-prover-step-limit</a></span>.</p> 
 
 <p>The value of <span class="v">(<a href="ACL2____LAST-PROVER-STEPS.html">last-prover-steps</a> state)</span> is determined as follows, based 
 on the most recent summary context (as described above):</p> 
 
 <blockquote> 
 
 <p><span class="v">nil</span>, if no prover steps were taken, e.g., with <span class="v">(<a href="ACL2____THM.html">thm</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> x x))</span>; 
 else,</p> 
 
 <p>the (positive) number of steps taken, if the number of steps did not exceed 
 the starting limit; else,</p> 
 
 <p>the negative of the starting limit.</p>
</blockquote> 
 
 <p>Note that the ``most recently completed event'' in this sense includes 
 compound events.  Consider the following example.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____PROGN.html">progn</a> (<a href="ACL2____THM.html">thm</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="COMMON-LISP____APPEND.html">append</a> (<a href="COMMON-LISP____APPEND.html">append</a> x y) z) (<a href="COMMON-LISP____APPEND.html">append</a> x y z)))
       (<a href="ACL2____THM.html">thm</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="COMMON-LISP____CAR.html">car</a> (<a href="COMMON-LISP____CONS.html">cons</a> x y)) x)))</pre> 
 
 <p>The summaries show (in some ACL2 versions, at least) 435 steps for the 
 first call of <span class="v">thm</span> and 7 steps for the second call of <span class="v">thm</span>, with 442 
 steps thus shown in the summary for the entire <span class="v">progn</span> call.  Subsequent 
 evaluation of <span class="v">(<a href="ACL2____LAST-PROVER-STEPS.html">last-prover-steps</a> state)</span> returns 442.  On the other hand, 
 suppose that <span class="v">(<a href="ACL2____SET-PROVER-STEP-LIMIT.html">set-prover-step-limit</a> 440)</span> is evaluated immediately before 
 evaluating the <span class="v">progn</span> call above.  Then the summaries show the following 
 for the two <span class="v">thm</span> calls and the <span class="v">progn</span> call, in order as follows.</p> 
 
 <pre class="code">Prover steps counted:  435
Prover steps counted:  More than 5
Prover steps counted:  More than 440</pre> 
 
 <p>Since the most recently completed event is the <span class="v">progn</span> call, then 
 <span class="v">(<a href="ACL2____LAST-PROVER-STEPS.html">last-prover-steps</a> state)</span> returns -440.</p> 
 
 <p>We conclude with two remarks for advanced users who wish to invoke 
 <span class="v">last-prover-steps</span> in the development of utilities that track prover 
 steps.</p> 
 
 <p>Remark 1.  Suppose that you want to write a utility that takes some action 
 based on the number of prover steps performed by the first event that is 
 generated within a sequence of events, for example the number of prover steps 
 taken to admit <span class="v">f1</span> in the following example.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____PROGN.html">progn</a> (<a href="COMMON-LISP____DEFUN.html">defun</a> f1 ...)
       (<a href="COMMON-LISP____DEFUN.html">defun</a> f2 ...))</pre> 
 
 <p>A solution is to record the steps taken by the first <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span> before 
 executing subsequent events, as follows (see <a href="ACL2____MAKE-EVENT.html">make-event</a>).</p> 
 
 <pre class="code">(<a href="COMMON-LISP____PROGN.html">progn</a> (<a href="COMMON-LISP____DEFUN.html">defun</a> f1 ...)
       (<a href="ACL2____MAKE-EVENT.html">make-event</a> (<a href="ACL2____PPROGN.html">pprogn</a> (<a href="ACL2____F-PUT-GLOBAL.html">f-put-global</a> 'my-step-count
                                         (<a href="ACL2____LAST-PROVER-STEPS.html">last-prover-steps</a> state)
                                         state)
                           (<a href="ACL2____VALUE.html">value</a> '(<a href="ACL2____VALUE-TRIPLE.html">value-triple</a> nil))))
       (<a href="COMMON-LISP____DEFUN.html">defun</a> f2 ...))</pre> 
 
 <p>Remark 2.  It is possible to write utilities that are treated as <a href="ACL2____EVENTS.html">events</a> for purposes of the discussion above; that is, their calls can be 
 followed by evaluating <span class="v">(<a href="ACL2____LAST-PROVER-STEPS.html">last-prover-steps</a> state)</span> as described above.  For 
 an example of how to do this using the ACL2 system macro 
 <span class="v">with-ctx-summarized</span>, see the implementation of <span class="tt"><a href="ACL2____PROVE_42.html">prove$</a></span> in <a href="ACL2____COMMUNITY-BOOK.html">community-book</a> <span class="v">books/tools/prove-dollar.lisp</span>.</p>
</body>
</html>
