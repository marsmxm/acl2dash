<html>
<head>
<meta charset="UTF-8">
<title>Atc-tutorial-conditionals-with-mbt</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=C____ATC-TUTORIAL-CONDITIONALS-WITH-MBT">Click for Atc-tutorial-conditionals-with-mbt in the Full Manual</a></h3>

<p>ATC tutorial: Treatment of ACL2 conditionals with <span class="tt"><a href="ACL2____MBT.html">mbt</a></span> or <span class="tt"><a href="ACL2____MBT_42.html">mbt$</a></span>.</p><p>After describing how ACL2 conditionals 
    represent C conditional statements and expressions 
    (in <a href="C____ATC-TUTORIAL-CONDITIONAL-STATEMENTS.html">atc-tutorial-conditional-statements</a> 
    and <a href="C____ATC-TUTORIAL-CONDITIONAL-EXPRESSIONS.html">atc-tutorial-conditional-expressions</a>), 
    this tutorial page describes how certain ACL2 conditionals 
    do not actually represent C conditional statements and expressions.</p><p>These are ACL2 conditionals whose tests are 
    calls of <span class="tt"><a href="ACL2____MBT.html">mbt</a></span> or <span class="tt"><a href="ACL2____MBT_42.html">mbt$</a></span>: 
    only their `then' branches represent (and are translated to) C code; 
    tests and `else' branches are ignored.</p><p>The argument of the built-in macro <span class="tt"><a href="ACL2____MBT.html">mbt</a></span> 
    must be provably equal to <span class="v">t</span> for guard verification to succeed. 
    Similarly, the argument of the library macro <span class="tt"><a href="ACL2____MBT_42.html">mbt$</a></span> 
    must be provably different from <span class="v">nil</span> for guard verification to succeed. 
    In fact, their execution is effectively skipped in guard-verified ACL2 code. 
    In particular, when they appear in an <span class="tt"><a href="COMMON-LISP____IF.html">if</a></span> test, 
    the `then' branch is always executed and the `else' branch is ignored.</p><p>As explained in <a href="C____ATC-TUTORIAL-INT-PROGRAMS.html">atc-tutorial-int-programs</a>, 
    ATC requires the target ACL2 functions to be guard-verified. 
    Accordingly, as explained in <a href="C____ATC-TUTORIAL-EVENTS.html">atc-tutorial-events</a>, 
    the functional correctness theorems generated by ATC 
    include the target functions' guards as hypotheses. 
    In other words, ATC generates C code that matches the ACL2 code 
    under the guards, which must be verified for ATC to generate code. 
    Thus, the behavior of the ACL2 functions or of the C code outside the guards 
    is irrelevant in some precise sense: 
    so long as the ATC-generated code is called 
    on values that satisfy the guards, 
    the behavior is provably equivalent to the ACL2 counterpart. 
    (Upcoming tutorial pages will describe more precisely 
    this contract between ATC-generated code and external code.)</p><p>Given the above, it should be clear why ATC ignores 
    (i.e. does not generate any C code for) 
    <span class="tt"><a href="ACL2____MBT.html">mbt</a></span> or <span class="tt"><a href="ACL2____MBT_42.html">mbt$</a></span> tests of <span class="tt"><a href="COMMON-LISP____IF.html">if</a></span>s 
    and corresponding `else' branches, 
    treating this kind of conditionals 
    as if they were just their `then' branches.</p><p>Conditionals with <span class="tt"><a href="ACL2____MBT.html">mbt</a></span> or <span class="tt"><a href="ACL2____MBT_42.html">mbt$</a></span> tests 
    are sometimes used in recursive ACL2 functions 
    to ensure that termination can be proved. 
    Recall that termination proofs ignore guards, 
    which are extra-logical in ACL2 
    (i.e. not part of the logic itself, 
    although they give rise to proof obligations 
    expressed in the logic).</p><p>Another circumstance in which <span class="tt"><a href="ACL2____MBT.html">mbt</a></span> or <span class="tt"><a href="ACL2____MBT_42.html">mbt$</a></span> may arise 
    is via certain APT transformations. 
    For instance, the <span class="tt"><a href="APT____RESTRICT.html">apt::restrict</a></span> transformation 
    generates a new function whose body has the form 
    <span class="v">(<a href="COMMON-LISP____IF.html">if</a> (<a href="ACL2____MBT_42.html">mbt$</a> &lt;test&gt;) &lt;then&gt; &lt;else&gt;)</span>. 
    As explained in <a href="C____ATC-TUTORIAL-APPROACH.html">atc-tutorial-approach</a>, 
    ATC is meant to be used in conjunction with APT, 
    namely by using APT to refine a specification into 
    forms that represent C code as recognized by ATC. 
    It is therefore quite possible that these APT transformations 
    produce <span class="tt"><a href="COMMON-LISP____IF.html">if</a></span>s with <span class="tt"><a href="ACL2____MBT.html">mbt</a></span> or <span class="tt"><a href="ACL2____MBT_42.html">mbt$</a></span> tests, 
    which make their way to ATC.</p><p>For example, both the ACL2 function</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> |f| (|x|)
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="C____SINTP.html">c::sintp</a> |x|)))
  (<a href="COMMON-LISP____IF.html">if</a> (<a href="ACL2____MBT.html">mbt</a> (<a href="C____SINTP.html">c::sintp</a> |x|))
      (<a href="C____LT-SINT-SINT.html">c::lt-sint-sint</a> |x| (<a href="C____SINT-DEC-CONST.html">c::sint-dec-const</a> 100))
    (<a href="COMMON-LISP____LIST.html">list</a> :this-is-not-translated-to-c)))</pre><p>and the ACL2 function</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> |f| (|x|)
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="C____SINTP.html">c::sintp</a> |x|)))
  (<a href="COMMON-LISP____IF.html">if</a> (<a href="ACL2____MBT_42.html">mbt$</a> (<a href="C____SINTP.html">c::sintp</a> |x|))
      (<a href="C____LT-SINT-SINT.html">c::lt-sint-sint</a> |x| (<a href="C____SINT-DEC-CONST.html">c::sint-dec-const</a> 100))
    (<a href="COMMON-LISP____LIST.html">list</a> :this-is-not-translated-to-c)))</pre><p>represent the C function</p><pre class="code">int f(int x) {
    return x &lt; 100;
}</pre><p>which is, in fact, also equally represented by the ACL2 function</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> |f| (|x|)
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="C____SINTP.html">c::sintp</a> |x|)))
  (<a href="C____LT-SINT-SINT.html">c::lt-sint-sint</a> |x| (<a href="C____SINT-DEC-CONST.html">c::sint-dec-const</a> 100)))</pre><div class="box"></div><p><b>Previous:</b> <a href="C____ATC-TUTORIAL-CONDITIONAL-EXPRESSIONS.html">ACL2 representation of C conditional expressions</a></p><p><b>Next:</b> <a href="C____ATC-TUTORIAL-CONDITIONALS-NONCONCLUDING.html">ACL2 representation of C conditional statements followed by more code</a></p>
</body>
</html>
