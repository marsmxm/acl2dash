<html>
<head>
<meta charset="UTF-8">
<title>Guard-holders</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____GUARD-HOLDERS">Click for Guard-holders in the Full Manual</a></h3>

<p>Remove trivial calls from a <a href="ACL2____TERM.html">term</a></p><p>For many <a href="ACL2____RULE-CLASSES.html">rule-classes</a>, the process of converting terms to 
 rules includes the removal of certain trivial calls from the term.  Such 
 removal is performed in some other settings as well, including <a href="ACL2____HINTS.html">hints</a> 
 processing, generating proof obligations for <a href="ACL2____GUARD.html">guard</a>s and termination, 
 and the storing of induction schemes and <a href="ACL2____CONSTRAINT.html">constraint</a>s.</p> 
 
 <p>In all such cases, the resulting term is provably equivalent to the input 
 term.  A common example is to replace the term <span class="v">(<a href="ACL2____PROG2_42.html">prog2$</a> term1 term2)</span> by 
 the term <span class="v">term2</span>.  But <span class="v">(<a href="ACL2____PROG2_42.html">prog2$</a> term1 term2)</span> is really an abbreviation 
 for (i.e., macroexpands to) the term <span class="v">(<a href="ACL2____RETURN-LAST.html">return-last</a> 'progn term1 term2)</span>; so 
 a more accurate explanation, at the level of proper ACL2 <a href="ACL2____TERM.html">term</a>s, is that 
 the call of function <span class="tt"><a href="ACL2____RETURN-LAST.html">return-last</a></span> is replaced by its last argument. 
 ACL2 identifies certain such transformations, from a term to a trivial 
 simplification of it, such that the input and output are provably equal.  We 
 historically have referred to the process of making such replacements as 
 ``removing guard holders.''  (For a discussion of the connection to guards, 
 see the ``Essay on the Removal of Guard Holders'' in the ACL2 sources.)</p> 
 
 <p>The process of removing guard-holders includes the transformations below. 
 That process is also applied to each argument of a function call and to the 
 bodies of <a href="COMMON-LISP____LAMBDA.html">lambda</a> expressions (see <a href="ACL2____TERM.html">term</a>), usually including 
 quoted lambda expressions that appear in an argument position with <a href="ACL2____ILK.html">ilk</a> 
 <span class="v">:FN</span> (see <a href="ACL2____APPLY_42.html">apply$</a>).</p> 
 
 <pre class="code">(<a href="ACL2____RETURN-LAST.html">return-last</a> term0 term1 term2)  ==&gt;  term2

(<a href="ACL2____MV-LIST.html">mv-list</a> n term)                 ==&gt;  term

(<a href="ACL2____CONS-WITH-HINT.html">cons-with-hint</a> x y)             ==&gt;  (<a href="COMMON-LISP____CONS.html">cons</a> x y)

(the-check guard x y)            ==&gt;  y

; For replacing a term (<a href="COMMON-LISP____THE.html">the</a> type term) by term:
((<a href="COMMON-LISP____LAMBDA.html">lambda</a> (y) (the-check guard x y))
 val)                            ==&gt;  val

; For replacing equality aliases; for example, this transforms
; the macroexpansion of (<a href="COMMON-LISP____MEMBER.html">member</a> x y) to (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> x y):
(('LAMBDA (f1 ... fk) ('RETURN-LAST ''MBE1-RAW exec logic))
 a1 ... ak)                      ==&gt;  logic

; For other than measure theorems and induction schemes, remove lambda
; applications that are ``trivial'' in either of the following two senses.

; For replacing a term (<a href="COMMON-LISP____LET.html">let</a> ((v term)) v) by term:
(('LAMBDA (v) v) term)           ==&gt;  term

; When each formal is equal to the corresponding actual:
(('LAMBDA (f1 ... fk) body)
 f1 ... fk)                      ==&gt;  body</pre> 
 
 <p>Because of how <span class="tt"><a href="ACL2____MBE.html">mbe</a></span> and <span class="tt"><a href="ACL2____EC-CALL.html">ec-call</a></span> are defined in terms of 
 <span class="tt"><a href="ACL2____RETURN-LAST.html">return-last</a></span>, the expressions <span class="v">(<a href="ACL2____MBE.html">mbe</a> :logic l :exec e)</span> and 
 <span class="v">(<a href="ACL2____EC-CALL.html">ec-call</a> (f t1 ... tk))</span> are effectively transformed by removing guard 
 holders into <span class="v">l</span> and <span class="v">(f t1 ... tk)</span>, respectively.</p> 
 
 <p>The final two classes of simplification above (removal of ``trivial'' 
 lambda applications) may be removed by executing the following form, which is 
 <span class="tt"><a href="ACL2____LOCAL.html">local</a></span> to an <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> form and to <a href="ACL2____BOOKS.html">books</a>.</p> 
 
 <pre class="code">(<a href="ACL2____DEFATTACH-SYSTEM.html">defattach-system</a> remove-guard-holders-lamp constant-nil-function-arity-0)</pre> 
 
 <p>Here is how to restore the default behavior.</p> 
 
 <pre class="code">(<a href="ACL2____DEFATTACH-SYSTEM.html">defattach-system</a> remove-guard-holders-lamp constant-t-function-arity-0)</pre> 
 
 <p>Note that by default, guard-holders are not removed inside calls of <span class="tt"><a href="ACL2____HIDE.html">hide</a></span>.  You can however cause them to be removed inside such calls after all, 
 as was the case through Version  8.2, as follows.</p> 
 
 <pre class="code">(<a href="ACL2____DEFATTACH-SYSTEM.html">defattach-system</a> ; generates (<a href="ACL2____LOCAL.html">local</a> (<a href="ACL2____DEFATTACH.html">defattach</a> ...))
  remove-guard-holders-blocked-by-hide-p
  constant-nil-function-arity-0)</pre>
</body>
</html>
