<html>
<head>
<meta charset="UTF-8">
<title>Normed</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____NORMED">Click for Normed in the Full Manual</a></h3>

<p>Normed objects are ACL2 Objects that are "canonical" or "unique" 
 in a certain sense.</p><p>In Common Lisp, we can tell whether an ACL2 object is <b>normed</b> 
 or not, but there is no way for an ordinary ACL2 function to see whether an 
 object is normed.  Hence, whether or not an object is normed is an 
 implementation-level concept.</p> 
 
 <p>The fundamental property of normed objects is that if A and B are both 
 normed, then <span class="v">(<a href="COMMON-LISP____EQUAL.html">equal</a> A B)</span> holds if and only if <span class="v">(<a href="COMMON-LISP____EQL.html">eql</a> A B)</span> holds.  For 
 strings and conses, <span class="v">(<a href="COMMON-LISP____EQL.html">eql</a> A B)</span> holds only when <span class="v">(<a href="COMMON-LISP____EQ.html">eq</a> A B)</span>, so any 
 normed conses or strings are <span class="tt"><a href="COMMON-LISP____EQUAL.html">equal</a></span> precisely when they are <span class="tt"><a href="COMMON-LISP____EQ.html">eq</a></span>. 
 The potential benefits of having normed objects include: constant-time 
 equality comparisons, reduced memory usage, fast association lists, and 
 function memoization.</p> 
 
 <p>Note that in our implementation, all symbols, characters, and numbers are 
 automatically normed, and whenever a cons is normed its car and cdr must also 
 be normed.</p> 
 
 <p>The Meaning of Normed in Common Lisp.</p> 
 
 <p>Recall that the ACL2 Objects are certain "good" Common Lisp symbols, 
 characters, strings, and numbers, and the conses which can be recursively 
 formed from these good atoms.</p> 
 
 <p>Not all properties of these objects are visible in the ACL2 logic.  An 
 example of an invisible property is the pointer identity of an object.  For 
 example, suppose we write the following.</p> 
 
 <pre class="code">(<a href="ACL2____DEFCONST.html">defconst</a> *x* (<a href="COMMON-LISP____CONS.html">cons</a> 1 2))
(<a href="ACL2____DEFCONST.html">defconst</a> *y* (<a href="COMMON-LISP____CONS.html">cons</a> 1 2))</pre> 
 
 <p>In Common Lisp, <span class="tt"><a href="COMMON-LISP____CONS.html">cons</a></span> is guaranteed to provide a new pair that is 
 distinct from any previously created pair, so we know that *x* and *y* will be 
 distinct objects and we will be able to tell them apart from one another using 
 <span class="v">eq</span>.  But this difference is not visible in the ACL2 logic, and no ACL2 
 function can tell *x* apart from *y*.</p> 
 
 <p>The normed-ness of an object is a similarly invisible property.  In Common 
 Lisp, invisible to ACL2, we maintain a data structure called a "Hons Space" 
 that records which objects are normed.  So, being normed is not an intrinsic 
 property of an object, but instead is determined by whether the object is 
 mentioned in this Hons Space.</p> 
 
 <p>Notes about Garbage Collection.</p> 
 
 <p>The Hons Space includes tables with pointers to every normed cons and 
 string.  One consequence of this is that normed objects cannot be reclaimed by 
 Lisp's ordinary garbage collector, even after they have become unreachable 
 from the perspective of an ACL2 program.</p> 
 
 <p>For CCL and GCL users only, <span class="tt"><a href="ACL2____HONS-WASH.html">hons-wash</a></span> is a special kind of garbage 
 collection that allows normed conses to be reclaimed.  For other Lisps, the 
 only option is to occasionally, manually clear out these Hons Space tables 
 with <span class="tt"><a href="ACL2____HONS-CLEAR.html">hons-clear</a></span>.</p>
</body>
</html>
