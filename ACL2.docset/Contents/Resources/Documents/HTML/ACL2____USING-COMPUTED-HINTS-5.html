<html>
<head>
<meta charset="UTF-8">
<title>Using-computed-hints-5</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____USING-COMPUTED-HINTS-5">Click for Using-computed-hints-5 in the Full Manual</a></h3>

<p>Debugging Computed Hints</p><p>We have found that it is sometimes helpful to define hints so that 
 they print out messages to the terminal when they fire, so you can see what 
 hint was generated and which of your computed hints did it.</p> 
 
 <p>To that end we have defined a macro we sometimes use.  Suppose you have a 
 <span class="v">:hints</span> specification such as:</p> 
 
 <pre class="code">:hints (computed-hint-fn (hint-expr id))</pre> 
 
 <p>If you defmacro the macro below you could then write instead:</p> 
 
 <pre class="code">:hints ((show-hint computed-hint-fn 1)
        (show-hint (hint-expr id) 2))</pre> 
 
 <p>with the effect that whenever either hint is fired (i.e., returns 
 non-<span class="v">nil</span>), a message identifying the hint by the marker (1 or 2, above) 
 and the non-<span class="v">nil</span> value is printed.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____DEFMACRO.html">defmacro</a> show-hint (hint &amp;optional marker)
  (<a href="COMMON-LISP____COND.html">cond</a>
   ((<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____CONSP.html">consp</a> hint)
         (<a href="COMMON-LISP____STRINGP.html">stringp</a> (<a href="COMMON-LISP____CAR.html">car</a> hint)))
    hint)
   (t
    `(<a href="COMMON-LISP____LET.html">let</a> ((marker ,marker)
           (ans ,(<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> hint)
                     `(,hint id clause world stable-under-simplificationp)
                   hint)))
       (<a href="COMMON-LISP____IF.html">if</a> ans
           (<a href="ACL2____PROG2_42.html">prog2$</a>
            (<a href="ACL2____CW.html">cw</a> "~%***** Computed Hint~#0~[~/ (from hint ~x1)~]~%~x2~%~%"
                (<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP____NULL.html">null</a> marker) 0 1)
                marker
                (<a href="COMMON-LISP____CONS.html">cons</a> (string-for-tilde-@-clause-id-phrase id)
                      ans))
            ans)
         nil)))))</pre> 
 
 <p>Note that when <span class="v">show-hint</span> is applied to a hint that is a symbol, e.g., 
 <span class="v">computed-hint-fn</span>, it applies the symbol to the four computed-hint 
 arguments: <span class="v">id</span>, <span class="v">clause</span>, <span class="v">world</span>, and 
 <span class="v">stable-under-simplificationp</span>.  If <span class="v">computed-hint-fn</span> is of arity 3 the 
 code above would cause an error.  One way to avoid it is to write</p> 
 
 <pre class="code">:hints ((show-hints (computed-hint-fn id clause world) 1)
        (show-hint (hint-expr id) 2)).</pre> 
 
 <p>If you only use computed hints of arity 3, you might eliminate the 
 occurrence of <span class="v">stable-under-simplificationp</span> in the definition of 
 <span class="v">show-hint</span> above.</p> 
 
 <p>Putting a <span class="v">show-hint</span> around a common hint has no effect.  If you find 
 yourself using this utility let us know and we'll consider putting it into the 
 system itself.  But it does illustrate that you can use computed hints to do 
 unusual things.</p>
</body>
</html>
