<html>
<head>
<meta charset="UTF-8">
<title>Smt-run</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=SMT____SMT-RUN">Click for Smt-run in the Full Manual</a></h3>

<p>SMT-run runs the configured SMT solver then interprets the result and feed it back to ACL2.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>smt-run</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
   smt-run (fname smt-conf)
   (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____STRINGP.html">stringp</a> fname)
                               (<a href="SMT____SMTLINK-CONFIG-P.html">smtlink-config-p</a> smt-conf))))
   (<a href="COMMON-LISP____LET.html">let</a> ((acl2::__function__ 'smt-run))
        (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> acl2::__function__))
        (<a href="COMMON-LISP____LET.html">let</a> ((cmd (<a href="COMMON-LISP____CONCATENATE.html">concatenate</a> 'string
                                (<a href="SMT____SMTLINK-CONFIG-_E3SMT-CMD.html">smtlink-config-&gt;smt-cmd</a> smt-conf)
                                " " fname)))
             (<a href="ACL2____TIME_42.html">time$</a> (<a href="ACL2____TSHELL-CALL.html">tshell-call</a> cmd :print nil :save t)
                    :msg "; SMT solver: `~s0`: ~st sec, ~sa bytes~%"
                    :args (<a href="COMMON-LISP____LIST.html">list</a> cmd)))))</pre> 
<p><b>Theorem: </b>natp-of-smt-run.exit-status</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> natp-of-smt-run.exit-status
        (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?exit-status ?lines)
              (<a href="SMT____SMT-RUN.html">smt-run</a> fname smt-conf)))
            (<a href="ACL2____NATP.html">natp</a> exit-status))
        :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>string-listp-of-smt-run.lines</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> string-listp-of-smt-run.lines
        (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?exit-status ?lines)
              (<a href="SMT____SMT-RUN.html">smt-run</a> fname smt-conf)))
            (<a href="ACL2____STRING-LISTP.html">string-listp</a> lines))
        :rule-classes :rewrite)</pre> 
<p><b>Function: </b>smt-interpret</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 smt-interpret
 (fname rm-file smt-conf state)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :stobjs (<a href="ACL2____STATE.html">state</a>)))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____STRINGP.html">stringp</a> fname)
                             (<a href="ACL2____BOOLEANP.html">booleanp</a> rm-file)
                             (<a href="SMT____SMTLINK-CONFIG-P.html">smtlink-config-p</a> smt-conf))))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :stobjs state))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((acl2::__function__ 'smt-interpret))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> acl2::__function__))
  (<a href="ACL2____B_A2.html">b*</a>
   (((<a href="ACL2____MV.html">mv</a> exit-status lines)
     (<a href="SMT____SMT-RUN.html">smt-run</a> fname smt-conf))
    ((unless (<a href="COMMON-LISP____EQUAL.html">equal</a> exit-status 0))
     (<a href="ACL2____MV.html">mv</a> (<a href="ACL2____ER.html">er</a> hard? 'smt-run=&gt;smt-interpret
             "Z3 failure: ~q0" lines)
         state))
    ((<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> lines nil))
     (<a href="ACL2____MV.html">mv</a> (<a href="ACL2____ER.html">er</a> hard? 'smt-run=&gt;smt-interpret
             "Nothing returned from SMT solver.")
         state))
    ((<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="COMMON-LISP____CAR.html">car</a> lines) "proved"))
     (<a href="ACL2____B_A2.html">b*</a> (((unless (<a href="COMMON-LISP____EQUAL.html">equal</a> rm-file nil))
           (<a href="ACL2____MV.html">mv</a> t state))
          (cmd (<a href="COMMON-LISP____CONCATENATE.html">concatenate</a> 'string "rm -f " fname))
          ((<a href="ACL2____MV.html">mv</a> exit-status-rm lines-rm)
           (<a href="ACL2____TIME_42.html">time$</a> (<a href="ACL2____TSHELL-CALL.html">tshell-call</a> cmd :print nil :save t)
                  :msg ""
                  :args (<a href="COMMON-LISP____LIST.html">list</a> cmd))))
         (<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> exit-status-rm 0)
             (<a href="ACL2____MV.html">mv</a> t state)
             (<a href="ACL2____MV.html">mv</a> (<a href="ACL2____ER.html">er</a> hard? 'smt-run=&gt;smt-interpret
                     "Remove file error.~% ~p0~%" lines-rm)
                 state))))
    ((<a href="ACL2____MV.html">mv</a> err str state)
     (<a href="ACL2____READ-STRING.html">read-string</a> (<a href="COMMON-LISP____CAR.html">car</a> lines) :state state))
    ((unless (<a href="COMMON-LISP____EQUAL.html">equal</a> err nil))
     (<a href="ACL2____PROG2_42.html">prog2$</a> (<a href="ACL2____ER.html">er</a> hard? 'smt-run=&gt;smt-interpret
                 "Read-string error.~%~p0~%" err)
             (<a href="ACL2____MV.html">mv</a> nil state)))
    ((unless (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____TRUE-LISTP.html">true-listp</a> str)
                  (<a href="COMMON-LISP____LISTP.html">listp</a> (<a href="COMMON-LISP____CAR.html">car</a> str))
                  (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="COMMON-LISP____CAAR.html">caar</a> str) 'quote)
                  (<a href="COMMON-LISP____CONSP.html">consp</a> (<a href="COMMON-LISP____CDAR.html">cdar</a> str))))
     (<a href="ACL2____PROG2_42.html">prog2$</a>
      (<a href="ACL2____ER.html">er</a>
       hard? 'smt-run=&gt;smt-interpret
       "We can't prove anything about the ~
thing returned by read-string. So we add a check for it. It's surprising that ~
the check for (<a href="ACL2____TRUE-LISTP.html">true-listp</a> str) and (<a href="COMMON-LISP____CONSP.html">consp</a> (<a href="COMMON-LISP____CAR.html">car</a> str)) failed: ~q0"
       str)
      (<a href="ACL2____MV.html">mv</a> nil state)))
    (<a href="COMMON-LISP____-.html">-</a>
     (<a href="ACL2____CW.html">cw</a>
      "Possible counter-example found: ~p0~%One can access it ~
                 through global variable SMT-cex by doing (<a href="ACL2_____04.html">@</a> SMT-cex).~%"
      (<a href="ACL2____UNQUOTE.html">unquote</a> (<a href="COMMON-LISP____CAR.html">car</a> str))))
    (<a href="ACL2____STATE.html">state</a> (<a href="ACL2____F-PUT-GLOBAL.html">f-put-global</a> 'smt-cex nil state))
    (<a href="ACL2____STATE.html">state</a> (<a href="ACL2____F-PUT-GLOBAL.html">f-put-global</a> 'smt-cex
                         (<a href="COMMON-LISP____CAR.html">car</a> str)
                         state)))
   (<a href="ACL2____MV.html">mv</a> nil state))))</pre> 
<p><b>Theorem: </b>booleanp-of-smt-interpret.proved?</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> booleanp-of-smt-interpret.proved?
        (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?proved? acl2::?state)
              (smt-interpret fname rm-file smt-conf state)))
            (<a href="ACL2____BOOLEANP.html">booleanp</a> proved?))
        :rule-classes :rewrite)</pre> 

</body>
</html>
