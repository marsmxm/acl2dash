<html>
<head>
<meta charset="UTF-8">
<title>Coverage-problems</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=GL____COVERAGE-PROBLEMS">Click for Coverage-problems in the Full Manual</a></h3>

<p>Proving the coverage obligation in GL-based proofs.</p><p>In order to prove a theorem using GL, one must show that the 
symbolic objects chosen to represent the inputs are sufficiently general to 
cover the entire set of interest.  See <a href="GL____SHAPE-SPECS.html">shape-specs</a> for a more in-depth 
discussion.  The <a href="ACL2____DEF-GL-THM.html">def-gl-thm</a> and <a href="ACL2____DEF-GL-PARAM-THM.html">def-gl-param-thm</a> events as well 
as the <a href="ACL2____GL-HINT.html">gl-hint</a> hints all provide some degree of automation for coverage 
proofs; often this is enough to satisfy the coverage obligation without further 
user interaction.  Here we discuss how to debug coverage proofs that do not 
succeed.</p> 
 
<p>First, it is probably important to be able to re-run a coverage proof easily 
without also re-running the associated symbolic execution, which may be quite 
time-consuming.  To do this, in either the <a href="ACL2____DEF-GL-THM.html">def-gl-thm</a> or <a href="ACL2____DEF-GL-PARAM-THM.html">def-gl-param-thm</a> forms, add the keyword argument <span class="v">:TEST-SIDE-GOALS T</span>. 
This form will then try to prove the coverage obligation in exactly the manner 
it would do during the real proof, but it will not attempt to prove the theorem 
itself, and will not record a new ACL2 theorem even if the proof is 
successful.</p> 
 
<p>During proof output, GL prints a message "Now proving coverage" when it 
begins the coverage proof.  The initial goal of a coverage proof will also have 
a hypothesis <span class="v">(GL::GL-CP-HINT 'GL::COVERAGE)</span>; this hypothesis is logically 
meaningless, but a useful indicator of the beginning of a coverage proof.</p> 
 
<p>When GL's usual set of heuristics is used, a coverage proof proceeds as 
follows.  The initial goal is as follows:</p> 
 
<pre class="code">(<a href="ACL2____IMPLIES.html">implies</a> &lt;theorem-hyps&gt;
         (gl::shape-spec-obj-in-range
           &lt;list-of-input-bindings&gt;
           &lt;list-of-input-variables&gt;))</pre> 
 
<p>The coverage heuristics proceed by repeatedly opening up the 
<span class="v">GL::SHAPE-SPEC-OBJ-IN-RANGE</span> function.  This effectively splits the proof 
into cases for each component of each variable; for example, if one variable's 
shape specifier binding is a cons of two :G-INTEGER forms, then its CAR and CDR 
will be considered separately.  Eventually, this results in several subgoals, 
each with conjunction of requirements for some component of some input.</p> 
 
<p>During this process of opening the <span class="v">GL::SHAPE-SPEC-OBJ-IN-RANGE</span> 
conclusion, the coverage heuristics also examine and manipulate the hypotheses. 
When the conclusion is focused on a certain input variable or component of that 
variable, and some hypothesis does not mention that variable, that hypothesis 
will be dropped so as to speed up the proof.  If a hypothesis does mention that 
variable, it may be expanded (if it is not a primitive) so as to try and gain 
more information about that variable.  This is a useful heuristic because often 
the hypotheses consist of a conjunction of predicates about different input 
variables or components of input variables, and some of these predicates are 
often themselves defined as conjunctions of predicates about subcomponents.</p> 
 
<p>However, sometimes this expansion goes too far.  In many cases, some 
conjuncts from the hypothesis have nothing to do with the coverage obligation. 
In these cases, the <span class="v">:DO-NOT-EXPAND</span> keyword argument to <span class="v">DEF-GL-THM</span> and 
<span class="v">DEF-GL-PARAM-THM</span> may be used.  This argument should evaluate to a list of 
function symbols; the coverage heuristic is then prohibited from expanding any 
of these functions.</p> 
 
<p>For efficiency, the set of rules used in coverage proofs is very restricted. 
Because of this, you may see in the proof output a goal which should be 
obvious, but is not proven because the necessary rule is not included.  The 
keyword argument <span class="v">:COV-THEORY-ADD</span> may be used to enable certain additional 
rules that are not included.  The set of rules that are used is defined in the 
ruleset <span class="v">GL::SHAPE-SPEC-OBJ-IN-RANGE-OPEN</span>, which can be listed using</p> 
 
<pre class="code">(get-ruleset 'gl::shape-spec-obj-in-range-open (<a href="ACL2____W.html">w</a> state)).</pre> 
 
<p>The default heuristics for coverage proofs may not always be useful. 
Therefore, the user may also supplement or replace the coverage heuristics with 
arbitrary computed hints.  The keyword argument <span class="v">:COV-HINTS</span> gives a list of 
computed hint forms which, according to the value of the keyword argument 
<span class="v">:COV-HINTS-POSITION</span>, either replaces or supplements the default hints. 
<span class="v">:COV-HINTS-POSITION</span> may be either <span class="v">:REPLACE</span>, in which case the 
defaults are not used at all; <span class="v">:FIRST</span>, in which case the user-provided 
<span class="v">:COV-HINTS</span> are tried first and the defaults afterward, or the default, 
<span class="v">:LAST</span>, in which case the default coverage heuristic is tried before the 
user-provided hints.</p> 
 
<p>Note that subgoal names will be different between a <span class="v">:TEST-SIDE-GOALS</span> 
and an actual attempt at proving the theorem.  Therefore, it is best not to 
write computed hints that depend on the <span class="v">ID</span> variable.</p>
</body>
</html>
