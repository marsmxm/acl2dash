<html>
<head>
<meta charset="UTF-8">
<title>Serialize-in-books</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____SERIALIZE-IN-BOOKS">Click for Serialize-in-books in the Full Manual</a></h3>

<p>Using serialization efficiently in books</p><p>Our serialize scheme was developed in order to allow very large 
 ACL2 objects to be loaded into books.  Ordinarily this is carried out using 
 <span class="tt"><a href="ACL2____SERIALIZE-READ.html">serialize-read</a></span> within a <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span>, e.g.,</p> 
 
 <pre class="code">(<a href="ACL2____MAKE-EVENT.html">make-event</a> (<a href="ACL2____MV-LET.html">mv-let</a> (obj state)
                    (<a href="ACL2____SERIALIZE-READ.html">serialize-read</a> "my-file")
                    (<a href="ACL2____VALUE.html">value</a> `(<a href="ACL2____DEFCONST.html">defconst</a> *my-file* ',obj))))</pre> 
 
 <p>But this scheme is not particularly efficient.</p> 
 
 <p>During <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span>, the actual call of <span class="v">serialize-read</span> is 
 carried out, and this is typically pretty fast.  But then a number of possibly 
 inefficient things occur.</p> 
 
 <ul> 
 
 <li> The ACL2 function <span class="v">bad-lisp-object</span> is run on the resulting object. 
 This is memoized for efficiency, but may still take considerable time when the 
 file is very large.</li> 
 
 <li> The <a href="ACL2____CHECKSUM.html">checksum</a> of the resulting object is computed (though this is 
 not the default; see <a href="ACL2____BOOK-HASH.html">book-hash</a>.  This is also memoized, but as before 
 may still take some time.</li> 
 
 <li> The object that was just read is then written into book.cert, essentially 
 with <span class="tt"><a href="ACL2____SERIALIZE-WRITE.html">serialize-write</a></span>.  This can take some time, and results in large 
 certificate files.</li> 
 
 </ul> 
 
 <p>Then, during <a href="ACL2____INCLUDE-BOOK.html">include-book</a>, the <span class="v">make-event</span> expansion is loaded. 
 This is now basically just a <span class="v">serialize-read</span>.</p> 
 
 <p>The moral of the story is that using serialize will only help your 
 <span class="v">certify-book</span> time, and it only impacts a portion of the overall time.</p> 
 
 <p>To avoid this overhead, we have developed an UNSOUND alternative to 
 <span class="v">serialize-read</span>, which is available only by loading an additional book. 
 So, if the above scheme is not performing well for you, you may wish to see 
 <a href="ACL2____UNSOUND-READ.html">unsound-read</a>.</p>
</body>
</html>
