<html>
<head>
<meta charset="UTF-8">
<title>Practice-formulating-strong-rules-1</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____PRACTICE-FORMULATING-STRONG-RULES-1">Click for Practice-formulating-strong-rules-1 in the Full Manual</a></h3>

<p>Rules suggested by <span class="v">(<a href="ACL2____TRUE-LISTP.html">TRUE-LISTP</a> (<a href="COMMON-LISP____APPEND.html">APPEND</a> (FOO A) (BAR B)))</span></p><p>What rules come to mind when looking at the following subterm of a 
 Key Checkpoint?  Think of <i>strong</i> rules (see <a href="ACL2____STRONG-REWRITE-RULES.html">strong-rewrite-rules</a>).</p> 
 
 <pre class="code">(<a href="ACL2____TRUE-LISTP.html">TRUE-LISTP</a> (<a href="COMMON-LISP____APPEND.html">APPEND</a> (FOO A) (BAR B)))</pre> 
 
 <p>Obviously, you must think about the conditions under which <span class="v">(<a href="COMMON-LISP____APPEND.html">APPEND</a> x
 y)</span> returns a true-list.  Recall that <span class="v">APPEND</span> concatenates <span class="v">x</span> and 
 <span class="v">y</span>, with <span class="v">y</span> being the terminal sublist.  Its definition is equivalent 
 to</p> 
 
 <pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> append (x y)
  (<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP____ENDP.html">endp</a> x)
      y
      (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CAR.html">car</a> x)
            (<a href="COMMON-LISP____APPEND.html">append</a> (<a href="COMMON-LISP____CDR.html">cdr</a> x) y))))</pre> 
 
 <p>Technical Note: <span class="v">Append</span> is really a macro that permits you to write 
 calls of <span class="v">append</span> with more than two arguments.</p> 
 
 <p>In a sense, <span class="v">append</span> ``expects'' its arguments to be lists ending in 
 <span class="v">nil</span>, so-called <span class="v">true-listp</span>s.  (Such expectations are formalized in 
 ACL2 by the notion of the ``<a href="ACL2____GUARD.html">guard</a>'' <a href="ACL2____A_02Tiny_02Warning_02Sign.html"><img src="../res/tours/twarning.gif"></a> 
 of the function, but we strongly recommend not investigating guards until 
 you're good at using the system.)</p> 
 
 <p>New users frequently start every new theorem by listing all their 
 expectations on the arguments of functions in the problem.  For example, if 
 the new user wants to make some statement about when <span class="v">(<a href="COMMON-LISP____APPEND.html">append</a> x y)</span> is a 
 <span class="v">true-listp</span>, it is not uncommon for him or her first to write:</p> 
 
 <pre class="code">(<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____TRUE-LISTP.html">true-listp</a> x)
              (<a href="ACL2____TRUE-LISTP.html">true-listp</a> y))
         ...)</pre> 
 
 <p>to get ``comfortable.''  Then, thinking about when <span class="v">(<a href="COMMON-LISP____APPEND.html">append</a> x y)</span> is a 
 <span class="v">true-listp</span> is easy: it always returns a <span class="v">true-listp</span>.  It's always a 
 <span class="v">true-listp</span>.''  This thinking produces the theorem:</p> 
 
 <pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> true-listp-append-really-weak
  (<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____TRUE-LISTP.html">true-listp</a> x)
                (<a href="ACL2____TRUE-LISTP.html">true-listp</a> y))
           (<a href="ACL2____TRUE-LISTP.html">true-listp</a> (<a href="COMMON-LISP____APPEND.html">append</a> x y))))</pre> 
 
 <p>You'll note we gave it a name suggesting it is ``really weak.''</p> 
 
 <p>One sense in which it is weak is that it has an unnecessary hypothesis.  If 
 <span class="v">y</span> is a <span class="v">true-listp</span>, then <span class="v">(<a href="COMMON-LISP____APPEND.html">append</a> x y)</span> is too, whether <span class="v">x</span> is 
 a <span class="v">true-listp</span> or not.  In ACL2, all functions are total.  Logically 
 speaking, it doesn't matter whether <span class="v">endp</span> expects its argument to be a 
 <span class="v">true-listp</span> or not, it behaves.  <span class="v">(<a href="COMMON-LISP____APPEND.html">Append</a> x y)</span> either returns <span class="v">y</span> 
 or a <span class="v">cons</span> whose second argument is generated by <span class="v">append</span>.  Thus, if 
 <span class="v">y</span> is a <span class="v">true-listp</span>, the answer is too.  So here is an improved 
 version of the rule:</p> 
 
 <pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> true-listp-append-weak
  (<a href="ACL2____IMPLIES.html">implies</a> (<a href="ACL2____TRUE-LISTP.html">true-listp</a> y)
           (<a href="ACL2____TRUE-LISTP.html">true-listp</a> (<a href="COMMON-LISP____APPEND.html">append</a> x y))))</pre> 
 
 <p>We still think of it as ``weak'' because it has a hypothesis that limits 
 its applicability.</p> 
 
 <p>The strong version of the rule is</p> 
 
 <pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> true-listp-append-strong
  (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ACL2____TRUE-LISTP.html">true-listp</a> (<a href="COMMON-LISP____APPEND.html">append</a> x y))
         (<a href="ACL2____TRUE-LISTP.html">true-listp</a> y))).</pre> 
 
 <p>That is, <span class="v">append</span> returns a <span class="v">true-listp</span> <i>precisely</i> when its 
 second argument is a <span class="v">true-listp</span>.  We recommend that the strong version be 
 made a <span class="v">:</span><span class="tt"><a href="ACL2____REWRITE.html">rewrite</a></span> <a href="ACL2____A_02Tiny_02Warning_02Sign.html"><img src="../res/tours/twarning.gif"></a> rule.</p> 
 
 <p>The weak version of the rule allows us to reduce <span class="v">(<a href="ACL2____TRUE-LISTP.html">TRUE-LISTP</a> (<a href="COMMON-LISP____APPEND.html">APPEND</a> x
 y))</span> to true if we can show that <span class="v">(<a href="ACL2____TRUE-LISTP.html">TRUE-LISTP</a> y)</span> is true.  But suppose 
 <span class="v">(<a href="ACL2____TRUE-LISTP.html">TRUE-LISTP</a> y)</span> is actually false.  Then <span class="v">(<a href="ACL2____TRUE-LISTP.html">TRUE-LISTP</a> (<a href="COMMON-LISP____APPEND.html">APPEND</a> x y))</span> 
 would not simplify under the weak version of the rule.  But under the strong 
 version it would simplify to <span class="v">NIL</span>.</p> 
 
 <p>Technical Note: The weak version of the rule is a useful <span class="v">:</span><span class="tt"><a href="ACL2____TYPE-PRESCRIPTION.html">type-prescription</a></span> <a href="ACL2____A_02Tiny_02Warning_02Sign.html"><img src="../res/tours/twarning.gif"></a> rule.  The type mechanism cannot currently exploit 
 the strong version of the rule.</p> 
 
 <p>The strategy of ``getting comfortable'' by adding a bunch of hypotheses 
 before you know you need them is not conducive to creating strong rules.  We 
 tend to state the main relationship that we intuit about some function and 
 then add the hypotheses we need to make it true.  In this case, there were no 
 necessary hypotheses.  But if there are, we first identify them and then we 
 ask ``what can I say about the function if these hypotheses aren't true?'' 
 and try to strengthen the statement still further.</p> 
 
 <p>Use your browser's <b>Back Button</b> now to return to <a href="ACL2____PRACTICE-FORMULATING-STRONG-RULES.html">practice-formulating-strong-rules</a>.</p>
</body>
</html>
