<html>
<head>
<meta charset="UTF-8">
<title>Atj-var-to-jvar</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=JAVA____ATJ-VAR-TO-JVAR">Click for Atj-var-to-jvar in the Full Manual</a></h3>

<p>Turn an ACL2 variable into a Java variable.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(atj-var-to-jvar var curr-pkg vars-by-name) → jvar</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">var</span> — <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> var)</span>.</font>
</dd> 
  <dd>
<span class="tt">curr-pkg</span> — <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____STRINGP.html">stringp</a> curr-pkg)</span>.</font>
</dd> 
  <dd>
<span class="tt">vars-by-name</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____STRING-SYMBOLLIST-ALISTP.html">string-symbollist-alistp</a> vars-by-name)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">jvar</span> — <font color="#606060">Type <span class="v">(<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> jvar)</span>.</font>
</dd> 
 
</dl></div> 
<p>If <span class="v">var</span> has name <span class="v">name</span> and package name <span class="v">pname</span>, 
     in general we return the symbol <span class="v">java::&lt;pname&gt;$$&lt;name&gt;</span>, 
     where <span class="v">&lt;pname&gt;</span> and <span class="v">&lt;name&gt;</span> are representations of the ACL2 names 
     that are valid for Java identifiers. 
     This is not necessarily the final name of the Java variable: 
     in general, a numeric index is added at the end, 
     via <span class="tt"><a href="JAVA____ATJ-VAR-ADD-INDEX.html">atj-var-add-index</a></span>. 
     So the final name of the Java variable has generally the form 
     <span class="v">java::&lt;pname&gt;$$&lt;name&gt;$&lt;index&gt;</span>.</p><p>Back to this function, which just produces <span class="v">java::&lt;pname&gt;$$&lt;name&gt;</span>, 
     note that the package of the new symbol is always <span class="v">"JAVA"</span>. 
     Other choices are possible, but the point is that we want to ignore it. 
     We incorporate the original package name <span class="v">pname</span> 
     into the new symbol name and deal with just the symbol name afterwards, 
     for greater simplicity. 
     If this package is ever changed, 
     it must be changed accordingly in <span class="tt"><a href="JAVA_____A2ATJ-INIT-INDICES_A2.html">*atj-init-indices*</a></span>.</p><p>Systematically prefixing, in the generated Java variables, 
     every symbol name with the package prefix affects readability. 
     In ACL2, package prefixes are normally omitted 
     for symbols in the current ACL2 package. 
     Here we do something similar for the Java variable names, 
     where the notion of current package is as follows: 
     in the shallow embedding approach, 
     each ACL2 function is turned into a Java method, 
     and this method is inside a Java class whose name is derived from 
     the ACL2 package name of the function name; 
     thus, the ``current package'' in this context is 
     the one of the function name, which is the <span class="v">curr-pkg</span> parameter. 
     If <span class="v">&lt;pname&gt;</span> is the same as the current package, 
     we omit <span class="v">&lt;pname&gt;$$</span>. 
     We omit <span class="v">&lt;pname&gt;$$</span> also when the variable 
     is the only one with name <span class="v">&lt;name&gt;</span> 
     within the ``current'' ACL2 function: 
     since the scope of Java method parameters and local variables 
     is limited to the method where they occur, 
     no naming conflict may arise in this case. 
     The parameter <span class="v">vars-by-name</span> consists of 
     all the variables in the current ACL2 function, 
     organized by symbol name for easy lookup. 
     We retrieve the variables with the same name of the variable, 
     we remove the variable being processed from them, 
     and we check if the result is empty: 
     in this case, this is the only variable with that name.</p><p>We call <span class="tt"><a href="JAVA____ATJ-CHARS-TO-JCHARS-ID.html">atj-chars-to-jchars-id</a></span> to create 
     <span class="v">&lt;pname&gt;</span> and <span class="v">&lt;name&gt;</span> from <span class="v">pname</span> and <span class="v">name</span>. 
     If there is a package prefix, the <span class="v">startp</span> flag is <span class="v">t</span> 
     only for <span class="v">pname</span>, but not for <span class="v">name</span>, 
     because <span class="v">&lt;name&gt;</span> is not the start of the Java identifier. 
     Otherwise, <span class="v">startp</span> is <span class="v">t</span> for <span class="v">name</span> 
     if there is no package prefix.</p><p>The variable <span class="v">var</span> passed to this function 
     is without markings or annotations. 
     The called removes them before calling this function.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>atj-var-to-jvar</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 atj-var-to-jvar
 (var curr-pkg vars-by-name)
 (<a href="COMMON-LISP____DECLARE.html">declare</a>
      (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> var)
                         (<a href="COMMON-LISP____STRINGP.html">stringp</a> curr-pkg)
                         (<a href="ACL2____STRING-SYMBOLLIST-ALISTP.html">string-symbollist-alistp</a> vars-by-name))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'atj-var-to-jvar))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
   ((pname (<a href="ACL2____SYMBOL-PACKAGE-NAME.html">symbol-package-name</a> var))
    (name (<a href="COMMON-LISP____SYMBOL-NAME.html">symbol-name</a> var))
    (omit-pname?
      (<a href="COMMON-LISP____OR.html">or</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> pname curr-pkg)
          (<a href="COMMON-LISP____NULL.html">null</a> (<a href="ACL2____REMOVE-EQ.html">remove-eq</a> var
                           (<a href="COMMON-LISP____CDR.html">cdr</a> (<a href="ACL2____ASSOC-EQUAL.html">assoc-equal</a> name vars-by-name))))))
    (pname$$-jchars
         (<a href="COMMON-LISP____IF.html">if</a> omit-pname? nil
             (<a href="COMMON-LISP____APPEND.html">append</a> (<a href="JAVA____ATJ-CHARS-TO-JCHARS-ID.html">atj-chars-to-jchars-id</a> (<a href="ACL2____EXPLODE.html">explode</a> pname)
                                             t
                                             :dash t)
                     (<a href="COMMON-LISP____LIST.html">list</a> #\$ #\$))))
    (name-jchars (<a href="JAVA____ATJ-CHARS-TO-JCHARS-ID.html">atj-chars-to-jchars-id</a> (<a href="ACL2____EXPLODE.html">explode</a> name)
                                         (<a href="COMMON-LISP____ENDP.html">endp</a> pname$$-jchars)
                                         :dash t))
    (jchars (<a href="COMMON-LISP____APPEND.html">append</a> pname$$-jchars name-jchars))
    (new-name (<a href="ACL2____IMPLODE.html">implode</a> jchars))
    (new-var (<a href="ACL2____INTERN_42.html">intern$</a> new-name "JAVA")))
   new-var)))</pre> 
<p><b>Theorem: </b>symbolp-of-atj-var-to-jvar</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> symbolp-of-atj-var-to-jvar
        (<a href="ACL2____B_A2.html">b*</a> ((jvar (<a href="JAVA____ATJ-VAR-TO-JVAR.html">atj-var-to-jvar</a> var curr-pkg vars-by-name)))
            (<a href="COMMON-LISP____SYMBOLP.html">symbolp</a> jvar))
        :rule-classes :rewrite)</pre> 

</body>
</html>
