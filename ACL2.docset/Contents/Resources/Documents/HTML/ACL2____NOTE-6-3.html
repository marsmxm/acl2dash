<html>
<head>
<meta charset="UTF-8">
<title>Note-6-3</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____NOTE-6-3">Click for Note-6-3 in the Full Manual</a></h3>

<p>ACL2 Version  6.3 (October, 2013) Notes</p><p>NOTE!  New users can ignore these release notes, because the <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> has been updated to reflect all changes that are recorded 
 here.</p> 
 
 <p>Below we roughly organize the changes since Version 6.2 into the following 
 categories of changes: existing features, new features, heuristic 
 improvements, bug fixes, changes at the system level, Emacs support, and 
 experimental versions.  Each change is described in just one category, though 
 of course many changes could be placed in more than one category.</p> 
 
 <p><b>CHANGES TO EXISTING FEATURES</b></p> 
 
 <p>The evaluation of a term from a <span class="tt"><a href="ACL2____BIND-FREE.html">bind-free</a></span> hypothesis had been 
 expected to produce an alist binding free variables to terms.  While that is 
 still legal, it is also legal for that evaluation to produce a list of such 
 alists: then each is considered, until one of them permits all remaining 
 hypotheses to be relieved.  See <a href="ACL2____BIND-FREE.html">bind-free</a>.  Thanks to Sol Swords for 
 requesting this enhancement.</p> 
 
 <p>ACL2 continues to provide a way to specify keyword command abbreviations 
 for the top-level loop; see <a href="ACL2____LD-KEYWORD-ALIASES.html">ld-keyword-aliases</a>.  However, <span class="tt"><a href="ACL2____LD-KEYWORD-ALIASES.html">ld-keyword-aliases</a></span> is now a <a href="ACL2____TABLE.html">table</a> rather than a <a href="ACL2____STATE.html">state</a> global; 
 it is thus no longer a so-called <a href="ACL2____LD.html">ld</a> special.  The functionality of 
 <span class="v">set-ld-keyword-aliases</span> has essentially been preserved, except that it is 
 now an event (see <a href="ACL2____EVENTS.html">events</a>), hence it may appear in a book; it is <a href="ACL2____LOCAL.html">local</a> to a book (or <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> event); and the <span class="tt"><a href="ACL2____STATE.html">state</a></span> 
 argument is optional, and deprecated.  A non-local version 
 (<span class="v">set-ld-keyword-aliases!</span>)  has been added, along with corresponding 
 utilities <span class="v">add-keyword-alias</span> and <span class="v">add-keyword-alias!</span> for adding a 
 single keyword alias.  See <a href="ACL2____LD-KEYWORD-ALIASES.html">ld-keyword-aliases</a>.  Thanks to Jared Davis 
 for correspondence that led us to make this change.</p> 
 
 <p>The <a href="ACL2____PROOF-BUILDER.html">proof-builder</a> command <span class="v">(<a href="ACL2____EXIT.html">exit</a> t)</span> now exits without a query 
 (but still prints an event to show the <span class="v">:INSTRUCTIONS</span>).  Thanks to Warren 
 Hunt for feedback leading us to make this change.</p> 
 
 <p>We made the following minor changes to the behavior of <span class="v">dmr</span>; see <a href="ACL2____DMR.html">dmr</a>.  First, if <span class="v">dmr</span> monitoring is enabled, then <span class="v">(dmr-start)</span> will 
 have no effect other than to print a corresponding observation, and if 
 monitoring is disabled, then <span class="v">(dmr-stop)</span> will have no effect other than to 
 print a corresponding observation.  Second, it had been the case that when 
 <span class="v">(dmr-start)</span> is invoked, the debugger was always automatically enabled 
 with value <span class="v">t</span> (see <a href="ACL2____SET-DEBUGGER-ENABLE.html">set-debugger-enable</a>), and the debugger remained 
 enabled when <span class="v">(dmr-stop)</span> was invoked.  Now, the debugger is only enabled 
 by <span class="v">(dmr-start)</span> if it is not already enabled and does not have setting 
 <span class="v">:never</span>.  Moreover, if such automatic enabling takes place, then the old 
 setting for the debugger is restored by <span class="v">(dmr-stop)</span> unless <span class="tt"><a href="ACL2____SET-DEBUGGER-ENABLE.html">set-debugger-enable</a></span> has first been called after that automatic enabling. 
 Finally, if the value of <a href="ACL2____STATE.html">state</a> global variable <span class="v">'debugger-enable</span> is 
 <span class="v">:bt</span>, then the new value will be <span class="v">:break-bt</span>, not <span class="v">t</span>.</p> 
 
 <p>When a call of <span class="tt"><a href="COMMON-LISP____PROGN.html">progn</a></span> is executed in the ACL2 loop, its constituent 
 <a href="ACL2____EVENTS.html">events</a> and their results are printed, just as was already done for 
 calls of <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span>.  Thanks to Jared Davis for a conversation 
 causing us to consider this change.</p> 
 
 <p>(CCL only) When <span class="tt"><a href="ACL2____SET-DEBUGGER-ENABLE.html">set-debugger-enable</a></span> is invoked with an argument 
 that prints a backtrace and CCL is the host Lisp, the backtrace will be 
 limited to 10,000 stack frames.  (We have seen more than 65,000 stack frames 
 before this change.)  This limit is the value of raw Lisp variable 
 <span class="v">*ccl-print-call-history-count*</span>, which may be assigned another positive 
 integer value to serve as the maximum number of stack frames to be 
 printed.</p> 
 
 <p>Improvements have been made pertaining to the disabling (inhibiting) of 
 individual types of warning.  Now, inhibited warnings are implemented in a 
 straightforward way using a separate <a href="ACL2____TABLE.html">table</a> for this purpose, the 
 <span class="v">inhibit-warnings-table</span>, rather than using the <span class="tt"><a href="ACL2____ACL2-DEFAULTS-TABLE.html">ACL2-defaults-table</a></span>.  See <a href="ACL2____SET-INHIBIT-WARNINGS.html">set-inhibit-warnings</a>, and see <a href="ACL2____SET-INHIBIT-WARNINGS_12.html">set-inhibit-warnings!</a> for a variant that is not <span class="tt"><a href="ACL2____LOCAL.html">local</a></span> to an <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> or a book in which it occurs.  Thanks to Sol Swords for sending 
 examples showing how <span class="tt"><a href="ACL2____SET-INHIBIT-WARNINGS.html">set-inhibit-warnings</a></span> did not always behave as one 
 might reasonably expect when books are involved.</p> 
 
 <p>It had been the case that <span class="tt"><a href="ACL2____LP.html">lp</a></span> took a single argument, <span class="v">'raw</span>. 
 This argument was not documented and also caused an error, so it has been 
 eliminated.</p> 
 
 <p>The functionality of <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> has been significantly expanded. 
 First: if the expansion is of the form <span class="v">(:OR e1 e2 ...)</span>, then event forms 
 <span class="v">e1</span>, <span class="v">e2</span>, and so on are evaluated, in order, until the evaluation of 
 some <span class="v">ek</span> completes without error.  In that case, the expansion is treated 
 simply as <span class="v">ek</span>.  With this capability, alternative expansions can be 
 attempted and the successful one does not need to be evaluated again.  See the 
 new version of community book <span class="v">books/make-event/proof-by-arith.lisp</span> for an 
 example.  Second, an expansion may be of the form <span class="v">(:DO-PROOFS e)</span>, in 
 which case the event <span class="v">e</span> is evaluated with proofs <b>not</b> skipped; see 
 <a href="ACL2____LD-SKIP-PROOFSP.html">ld-skip-proofsp</a>.  Third, new keyword <span class="v">:EXPANSION?</span> can be used to 
 avoid storing expansions in certificate files.  See <a href="ACL2____MAKE-EVENT.html">make-event</a>.</p> 
 
 <p>When a <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span> event prints a failure message in the summary, that 
 message now indicates when the failure is due to a failed proof of guard 
 verification or a failed proof of the measure theorem.  Thanks to Shilpi Goel 
 for requesting this enhancement.</p> 
 
 <p><b>NEW FEATURES</b></p> 
 
 <p>ACL2 can now be instructed to time activities using real time (wall clock 
 time) instead of run time (typically, cpu time).  See <a href="ACL2____GET-INTERNAL-TIME.html">get-internal-time</a>.  Thanks to Jared Davis for asking to be able to obtain 
 real-time reports in event summaries.</p> 
 
 <p>A new utility, <span class="tt"><a href="ACL2____SYS-CALL_B2.html">sys-call+</a></span>, is similar to existing utility <span class="tt"><a href="ACL2____SYS-CALL.html">sys-call</a></span> in that it executes a command.  Unlike <span class="v">sys-call</span>, however, 
 <span class="v">sys-call+</span> returns values that include output from the command (in 
 addition to the exit status), rather than simply printing the command.  See 
 <a href="ACL2____SYS-CALL_B2.html">sys-call+</a>.</p> 
 
 <p>The new macro <span class="tt"><a href="ACL2____VERIFY-GUARDS_B2.html">verify-guards+</a></span> extends the functionality of <span class="tt"><a href="ACL2____VERIFY-GUARDS.html">verify-guards</a></span> by permitting macro-aliases (see <a href="ACL2____MACRO-ALIASES-TABLE.html">macro-aliases-table</a>). 
 See <a href="ACL2____VERIFY-GUARDS_B2.html">verify-guards+</a>.  Thanks to Jared Davis for requesting this feature 
 and suggesting the use of <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> in its implementation.  We have 
 also modified <span class="tt"><a href="ACL2____VERIFY-GUARDS.html">verify-guards</a></span> to print a friendlier error message when 
 its argument is a macro-alias.</p> 
 
 <p>See <a href="ACL2____LAST-PROVER-STEPS.html">last-prover-steps</a> for a new utility that returns the number of 
 prover steps most recently taken.</p> 
 
 <p><b>HEURISTIC IMPROVEMENTS</b></p> 
 
 <p>The processing of <span class="v">:use</span> and <span class="v">:by</span> <a href="ACL2____HINTS.html">hints</a> has been changed in 
 the following two rather subtle ways, thanks to suggestions from Sol 
 Swords.</p> 
 
 <blockquote> 
 
 <p>o For <span class="v">:by</span> hints, the simplest check was an equality check, rather than 
 a more general subsumption check.  That equality check was made after removing 
 so-called ``guard holders'' (<span class="tt"><a href="ACL2____MUST-BE-EQUAL.html">must-be-equal</a></span>, <span class="tt"><a href="ACL2____PROG2_42.html">prog2$</a></span>, <span class="tt"><a href="ACL2____EC-CALL.html">ec-call</a></span>, <span class="tt"><a href="COMMON-LISP____THE.html">the</a></span>) from both the previous theorem and the purported 
 theorem.  Now, guard-holder removal has been strengthened, so that the results 
 are also put into so-called quote-normal form, for example replacing <span class="v">(<a href="COMMON-LISP____CONS.html">cons</a>
 '3 '4)</span> by <span class="v">'(3 . 4)</span>.</p> 
 
 <p>o For a <a href="ACL2____LEMMA-INSTANCE.html">lemma-instance</a> provided to a <span class="v">:use</span> or <span class="v">:by</span> hint that 
 is a <span class="v">:functional-instance</span>, if a <span class="v">:do-not</span> hint (see <a href="ACL2____HINTS.html">hints</a>) has 
 specified that <span class="v">preprocess-clause</span> is not to be used, then preprocessing 
 will not be used on the constraints.</p>
</blockquote> 
 
 <p>We eliminated certain warnings about being ``weak'' for every <span class="v">:</span><span class="tt"><a href="ACL2____TYPE-PRESCRIPTION.html">type-prescription</a></span> rule whose conclusion designates that the function call can 
 be equal to one of its arguments, e.g., <span class="v">(<a href="COMMON-LISP____OR.html">or</a> (<a href="COMMON-LISP____INTEGERP.html">integerp</a> (foo y)) (<a href="COMMON-LISP____EQUAL.html">equal</a> (foo
 y) y))</span>.  In many cases (such as the one above), such warnings about ``weak'' 
 simply aren't correct.</p> 
 
 <p><b>BUG FIXES</b></p> 
 
 <p>Fixed a soundness bug that was permitting a <a href="ACL2____STOBJ.html">stobj</a> to be bound by a 
 <span class="tt"><a href="COMMON-LISP____LET.html">let</a></span> or <span class="tt"><a href="ACL2____MV-LET.html">mv-let</a></span> form, without being among the outputs of that 
 form.  Thanks to Jen Davis and Dave Greve for reporting this bug.  Their 
 report included an example which forms the basis for a proof of <span class="v">nil</span>, 
 included as a comment in the form <span class="v">(<a href="ACL2____DEFLABEL.html">deflabel</a> note-6-3 ...)</span> in ACL2 source 
 file <span class="v">ld.lisp</span>.</p> 
 
 <p>(GCL only) Fixed an obscure soundness bug due to an error in the GCL 
 implementation of <span class="tt"><a href="ACL2____SET-DEBUGGER-ENABLE.html">set-debugger-enable</a></span>.  For details, see the relevant 
 comment in the ACL2 source code under <span class="v">(<a href="ACL2____DEFLABEL.html">deflabel</a> note-6-3 ...)</span>.</p> 
 
 <p>Fixed a bug in the case of a field of a (concrete) stobj that is an 
 abstract stobj (see <a href="ACL2____NESTED-STOBJS.html">nested-stobjs</a>).  Thanks to David Rager for bringing 
 this bug to our attention.</p> 
 
 <p>Splitter output for type <span class="v">if-intro</span> (see <a href="ACL2____SPLITTER.html">splitter</a>) could formerly 
 occur even when at most one subgoal is generated.  This has been fixed.</p> 
 
 <p>Fixed a bug in <span class="tt"><a href="ACL2____WOF.html">wof</a></span>, hence in <span class="tt"><a href="ACL2____PSOF.html">psof</a></span> (which uses <span class="v">wof</span>), 
 that was causing the printing of a bogus error message.</p> 
 
 <p>A small logical bug has been fixed in the logical definition of <span class="tt"><a href="ACL2____SYS-CALL-STATUS.html">sys-call-status</a></span>.  Formerly it always returned <span class="v">(<a href="ACL2____MV.html">mv</a> nil state)</span> whenever 
 the oracle of the state is non-empty (see <a href="ACL2____STATE.html">state</a>).</p> 
 
 <p>Fixed a bug that was causing an error upon evaluation of the form 
 <span class="v">(<a href="ACL2____SET-PROVER-STEP-LIMIT.html">set-prover-step-limit</a> nil)</span>.  Thanks to David Russinoff for reporting 
 this error.</p> 
 
 <p>The <span class="v">:measure</span> (if supplied) is now ignored when checking redundancy 
 with respect to a non-recursive definition that is not defined within a <span class="tt"><a href="ACL2____MUTUAL-RECURSION.html">mutual-recursion</a></span>.  (See <a href="ACL2____REDUNDANT-EVENTS.html">redundant-events</a> and see <a href="ACL2____XARGS.html">xargs</a>.)  It 
 had been possible to get a low-level ACL2 error in this situation.  Thanks to 
 Jared Davis for reporting this bug with a helpful example.</p> 
 
 <p>Eliminated a potential error when using <span class="tt"><a href="ACL2____COMP.html">comp</a></span> to compile an 
 uncompiled function defined under <span class="tt"><a href="ACL2____PROGN_12.html">progn!</a></span>, which we observed in 
 LispWorks.</p> 
 
 <p><b>CHANGES AT THE SYSTEM LEVEL</b></p> 
 
 <p>The ACL2 sources are now publicly available between ACL2 releases, using 
 svn; see the new ``<span class="v">acl2-devel</span>'' project hosted by Google code at 
 <span class="v">http://acl2-devel.googlecode.com</span>.  Although such a copy of ACL2 is likely 
 to work well with the latest svn (trunk) revision of the ACL2 community 
 books (see <a href="ACL2____COMMUNITY-BOOKS.html">community-books</a>), please take seriously the warning message 
 printed at startup: ``The authors of ACL2 consider svn distributions to be 
 experimental; they may be incomplete, fragile, and unable to pass our own 
 regression.''  That message also provides instructions for bug reports.  If 
 you decide to use svn versions of either the community books or ACL2, then you 
 should use both, as they tend to be kept in sync.  We fully expect ACL2 
 releases to continue from time to time, as usual.  Thanks to Jared Davis for 
 his efforts in setting up the new acl2-devel project and svn repository, and 
 to him and David Rager for convincing us to distribute ACL2 sources via svn 
 between releases.</p> 
 
 <p>Thanks to a suggestion from Jared Davis, over 30 built-in functions are now 
 declared to be inline in order to boost performance.  (The list may be found 
 by searching ACL2 source file <span class="v">axioms.lisp</span> for ``<span class="v">(declaim
 (<a href="COMMON-LISP____INLINE.html">inline</a></span>''.)</p> 
 
 <p>Better support has been provided for command line arguments, especially 
 those supplied directly by the user when calling ACL2.  For one, problems with 
 quoting have been solved using <span class="v">"$@"</span> in place of <span class="v">$*</span>.  Also, the 
 function <span class="tt"><a href="ACL2____SAVE-EXEC.html">save-exec</a></span> now allows specification of arguments, both for the 
 host Lisp as well as ``inert'' arguments that can be passed along to calls of 
 programs (as with <span class="tt"><a href="ACL2____SYS-CALL.html">sys-call</a></span>).  A keyword argument, 
 <span class="v">:return-from-lp</span>, specifies a form to evaluate before quitting the 
 read-eval-print loop at startup.  See <a href="ACL2____SAVE-EXEC.html">save-exec</a>.  Also see the source 
 function <span class="v">user-args-string</span> and its comments, source file 
 <span class="v">acl2-init.lisp</span>, for more information.  Thanks to Jared Davis for 
 suggesting the use of <span class="v">"$@"</span>, as well as modifications to <span class="tt"><a href="ACL2____SAVE-EXEC.html">save-exec</a></span> and helpful conversations about that.</p> 
 
 <p>A rather extensive overhaul has taken place for the function proclaiming 
 mechanism.  As before, this is only used when the host Lisp is GCL.  However, 
 building an executable is now faster for some Lisps, including GCL, by 
 avoiding repeated recompilation and perhaps repeated initialization.</p> 
 
 <p>(CCL only) We increased stack sizes when the host Lisp is CCL.  The default 
 for recent CCL versions is equivalent to specifying `<span class="v">-Z 2M</span>' on the 
 command line, but saved ACL2 scripts (including experimental versions ACL2(h), 
 ACL2(p), ACL2(r), and combinations of them) to `<span class="v">-Z 64M</span>', representing a 
 32-fold increase.  Thanks to Jared Davis for pointing us to community books 
 file <span class="v">books/centaur/ccl-config.lsp</span> and to Sol Swords for helpful 
 discussions.</p> 
 
 <p>(SBCL only) Fixed <span class="v">save-exec</span> for host Lisp SBCL to provide the same 
 export of variable <span class="v">SBCL_HOME</span> that was provided in the original 
 <span class="v">saved_acl2</span> script.</p> 
 
 <p>(GCL only) We made changes, following suggestions from Camm Maguire (whom 
 we thank for these suggestions), to support ACL2 builds on recent versions of 
 GCL (2.6.8 and 2.6.10; we recommend against using GCL 2.6.9, since issues 
 there were fixed in 2.6.10).  Specifically, we no longer set the hole size, 
 and we allocate contiguous pages sufficient to run an ACL2 regression without 
 failing due to memory limitations.</p> 
 
 <p><b>EMACS SUPPORT</b></p> 
 
 <p>Modified file <span class="v">emacs/emacs-acl2.el</span> to eliminate some warnings that were 
 appearing in a recent Emacs version, replacing <span class="v">(end-of-buffer)</span> by 
 <span class="v">(goto-char (point-max))</span> and <span class="v">next-line</span> by <span class="v">forward-line</span>.  Thanks 
 to Warren Hunt for bringing the warnings to our attention.</p> 
 
 <p><b>EXPERIMENTAL/ALTERNATE VERSIONS</b></p> 
 
 <p>(Allegro CL only) ACL2(h) now avoids blow-ups in hash table sizes that 
 could be caused by <a href="ACL2____FAST-ALIST-FORK.html">fast-alist-fork</a>.  Thanks to Jared Davis for 
 helping to debug this problem, and to David Rager for contributing the 
 community book <span class="v">books/parsers/earley/earley-parser.lisp</span>, which highlighted 
 this problem.</p> 
 
 <p>(SBCL only) Fixed a bug that was causing a Lisp break after turning on 
 <a href="ACL2____WATERFALL-PARALLELISM.html">waterfall-parallelism</a>.  Thanks to David Rager for confirming that our 
 proposed fix is correct.</p>
</body>
</html>
