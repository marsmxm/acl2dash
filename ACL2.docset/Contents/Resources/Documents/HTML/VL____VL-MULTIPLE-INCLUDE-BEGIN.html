<html>
<head>
<meta charset="UTF-8">
<title>Vl-multiple-include-begin</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=VL____VL-MULTIPLE-INCLUDE-BEGIN">Click for Vl-multiple-include-begin in the Full Manual</a></h3>

<p>Check a file for a proper include-guard header; if so, install a 
          special iframe and skip past the initial <span class="v">ifndef</span> part, otherwise 
          leave the file alone.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(vl-multiple-include-begin realfile contents ppst) 
  → 
(mv new-contents ppst)</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">realfile</span> — File name being loaded.<br>    <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____STRINGP.html">stringp</a> realfile)</span>.</font>
</dd> 
  <dd>
<span class="tt">contents</span> — Contents of that file.<br>    <font color="#606060">Guard <span class="v">(<a href="VL____VL-ECHARLIST-P.html">vl-echarlist-p</a> contents)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">new-contents</span> — On failure, the unmodified <span class="v">contents</span>.  On success, 
                              the remainder of the file just past the include guard.<br>    <font color="#606060">Type <span class="v">(<a href="VL____VL-ECHARLIST-P.html">vl-echarlist-p</a> new-contents)</span>.</font>
</dd> 
<dd>
<span class="tt">ppst</span> — Possibly updated with a special iframe for the include guard.</dd> 
 
</dl></div> 
 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>vl-multiple-include-begin</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 vl-multiple-include-begin
 (realfile contents ppst)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :stobjs (<a href="VL____PPST.html">ppst</a>)))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____STRINGP.html">stringp</a> realfile)
                             (<a href="VL____VL-ECHARLIST-P.html">vl-echarlist-p</a> contents))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'vl-multiple-include-begin))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
   ((contents (<a href="VL____VL-ECHARLIST-FIX.html">vl-echarlist-fix</a> contents))
    ((<a href="ACL2____MV.html">mv</a> controller1 controller1-loc post-ifndef)
     (<a href="VL____VL-MATCH-PROPER-HEADER-FILE-START-1.html">vl-match-proper-header-file-start-1</a> contents))
    ((<a href="ACL2____MV.html">mv</a> controller2 controller2-loc post-else)
     (<a href="COMMON-LISP____IF.html">if</a> controller1 (<a href="ACL2____MV.html">mv</a> nil nil nil)
         (<a href="VL____VL-MATCH-PROPER-HEADER-FILE-START-2.html">vl-match-proper-header-file-start-2</a> contents)))
    (controller (<a href="COMMON-LISP____OR.html">or</a> controller1 controller2))
    (resume-point (<a href="COMMON-LISP____IF.html">if</a> controller1 post-ifndef post-else))
    (controller-loc (<a href="COMMON-LISP____IF.html">if</a> controller1
                        controller1-loc controller2-loc))
    ((unless controller)
     (<a href="COMMON-LISP____LET.html">let</a>
      ((<a href="VL____PPST.html">ppst</a>
        (<a href="VL____VL-PPST-WARN.html">vl-ppst-warn</a>
         :type :vl-warn-include-guard
         :msg
         "~s0: included file has no include-guard.  (This is ~
                           fine but may reduce performance if the file is ~
                           included multiple times.)"
         :args (<a href="COMMON-LISP____LIST.html">list</a> realfile))))
      (<a href="ACL2____MV.html">mv</a> contents ppst)))
    (prev-def (<a href="VL____VL-FIND-DEFINE.html">vl-find-define</a> controller (<a href="VL____VL-PPST-_E3DEFINES.html">vl-ppst-&gt;defines</a>)))
    ((when prev-def)
     (<a href="COMMON-LISP____LET.html">let</a>
      ((<a href="VL____PPST.html">ppst</a>
        (<a href="VL____VL-PPST-WARN.html">vl-ppst-warn</a>
         :type :vl-warn-include-guard
         :msg
         "~s0: potential include guard controller, ~s1, is ~
                           already defined when reading the file; previous ~
                           definition from ~a2.  This is unusual and will ~
                           defeat multiple-include optimization for this file."
         :args (<a href="COMMON-LISP____LIST.html">list</a> realfile
                     controller (<a href="VL____VL-DEFINE-_E3LOC.html">vl-define-&gt;loc</a> prev-def)))))
      (<a href="ACL2____MV.html">mv</a> contents ppst)))
    (<a href="COMMON-LISP____-.html">-</a> (cw-unformatted (<a href="STR____CAT.html">cat</a> (<a href="VL____VL-PPST-PAD.html">vl-ppst-pad</a>)
                            " (multi-include candidate)" *nls*)))
    (iframe (<a href="VL____MAKE-VL-IFRAME.html">make-vl-iframe</a> :initially-activep t
                            :some-thing-satisfiedp t
                            :already-saw-elsep (<a href="COMMON-LISP____NOT.html">not</a> controller1)
                            :mi-controller controller
                            :mi-filename realfile))
    (<a href="VL____PPST.html">ppst</a> (<a href="VL____VL-PPST-RECORD-IFDEF-USE.html">vl-ppst-record-ifdef-use</a>
               controller
               (<a href="VL____MAKE-VL-IFDEF-CONTEXT.html">make-vl-ifdef-context</a> :loc controller-loc)))
    (istack (<a href="VL____VL-PPST-_E3ISTACK.html">vl-ppst-&gt;istack</a>))
    (<a href="VL____PPST.html">ppst</a> (<a href="VL____VL-PPST-UPDATE-ISTACK.html">vl-ppst-update-istack</a> (<a href="COMMON-LISP____CONS.html">cons</a> iframe istack))))
   (<a href="ACL2____MV.html">mv</a> resume-point ppst))))</pre> 
<p><b>Theorem: </b>vl-echarlist-p-of-vl-multiple-include-begin.new-contents</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> vl-echarlist-p-of-vl-multiple-include-begin.new-contents
        (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?new-contents ?ppst)
              (<a href="VL____VL-MULTIPLE-INCLUDE-BEGIN.html">vl-multiple-include-begin</a> realfile contents ppst)))
            (<a href="VL____VL-ECHARLIST-P.html">vl-echarlist-p</a> new-contents))
        :rule-classes :rewrite)</pre> 

</body>
</html>
