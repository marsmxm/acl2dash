<html>
<head>
<meta charset="UTF-8">
<title>Cons-ppr1</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=STR____CONS-PPR1">Click for Cons-ppr1 in the Full Manual</a></h3>

<p></p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(cons-ppr1 x rows width config eviscp)  new-rows</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">x</span>  A single printer instruction, representing either a DOT 
                       or a single object.  Intuitively this is the instruction 
                       for the <span class="v">car</span> of the list we're trying to print.<br><font color="#606060">Guard <span class="v">(<a href="STR____PINST-P.html">pinst-p</a> x)</span>.</font>
</dd> 
  <dd>
<span class="tt">rows</span>  A list of printer instructions that will be printed as a 
                       column.  Intuitively these are the instructions for the 
                       <span class="v">cdr</span> of the list we're trying to print.<br><font color="#606060">Guard <span class="v">(<a href="STR____PINSTLIST-P.html">pinstlist-p</a> rows)</span>.</font>
</dd> 
  <dd>
<span class="tt">width</span>  <font color="#606060">Guard <span class="v">(<a href="ACL2____POSP.html">posp</a> width)</span>.</font>
</dd> 
  <dd>
<span class="tt">config</span>  <font color="#606060">Guard <span class="v">(<a href="STR____PRINTCONFIG-P.html">printconfig-p</a> config)</span>.</font>
</dd> 
  <dd>
<span class="tt">eviscp</span>  <font color="#606060">Guard <span class="v">(<a href="ACL2____BOOLEANP.html">booleanp</a> eviscp)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">new-rows</span>  <font color="#606060">Type <span class="v">(<a href="STR____PINSTLIST-P.html">pinstlist-p</a> new-rows)</span>.</font>
</dd> 
 
</dl></div> 
<p>The goal here is to add <span class="v">x</span> to <span class="v">rows</span> by either merging it 
with the first row orif that won't work because it's too wideby 
putting it into a new row.  For instance, <span class="v">x</span> might be <span class="v">(FLAT 3 ABC)</span> and 
<span class="v">rows</span> could be <span class="v">((FLAT 7 DEF GHI) ...)</span>.  In this case we need to decide 
to either:</p> 
 
<pre class="code">add a new row                   merge with the first row
ABC                    -or-     ABC DEF GHI
DEF GHI                         ...
...</pre> 
 
<p>The default behavior is always to add a new row, i.e., to just cons <span class="v">x</span> 
onto <span class="v">rows</span>.  But if the first row is flat, and we can fit <span class="v">x</span> onto it 
without using up too many characters, then we should extend the first row.</p> 
 
<p>It is also here that we deal specially with keywords.  If <span class="v">x</span> is <span class="v">(FLAT
3 :ABC)</span> and column is <span class="v">((...) (...))</span> then we have the choice:</p> 
 
<pre class="code">add a new row                   merge with the first row
:ABC                   -or-     :ABC (...)
(...)                           (...)
(...)</pre> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>cons-ppr1</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 cons-ppr1 (x rows width config eviscp)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="STR____PINST-P.html">pinst-p</a> x)
                             (<a href="STR____PINSTLIST-P.html">pinstlist-p</a> rows)
                             (<a href="ACL2____POSP.html">posp</a> width)
                             (<a href="STR____PRINTCONFIG-P.html">printconfig-p</a> config)
                             (<a href="ACL2____BOOLEANP.html">booleanp</a> eviscp))))
 (<a href="COMMON-LISP____DECLARE.html">declare</a>
  (<a href="ACL2____XARGS.html">xargs</a>
       :guard
       (<a href="COMMON-LISP____CASE.html">case</a> (<a href="STR____PINST-KIND.html">pinst-kind</a> x)
             (:flat (<a href="COMMON-LISP____LET.html">let</a> ((what (<a href="STR____PFLAT-_E3WHAT.html">pflat-&gt;what</a> (<a href="STR____PINST-FLAT-_E3GUTS.html">pinst-flat-&gt;guts</a> x))))
                         (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____CONSP.html">consp</a> what) (<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____CDR.html">cdr</a> what)))))
             (otherwise t))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((acl2::__function__ 'cons-ppr1))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> acl2::__function__))
  (<a href="ACL2____B_A2.html">b*</a>
   ((x (<a href="STR____PINST-FIX.html">pinst-fix</a> x))
    (rows (<a href="STR____PINSTLIST-FIX.html">pinstlist-fix</a> rows))
    ((when (<a href="COMMON-LISP____ATOM.html">atom</a> rows)) (<a href="COMMON-LISP____CONS.html">cons</a> x rows))
    (xkind (<a href="STR____PINST-KIND.html">pinst-kind</a> x))
    ((when (<a href="COMMON-LISP____EQ.html">eq</a> xkind :flat))
     (<a href="ACL2____B_A2.html">b*</a> ((x.guts (<a href="STR____PINST-FLAT-_E3GUTS.html">pinst-flat-&gt;guts</a> x))
          (x.what (<a href="STR____PFLAT-_E3WHAT.html">pflat-&gt;what</a> x.guts))
          (x.obj (<a href="COMMON-LISP____FIRST.html">first</a> x.what))
          ((unless (<a href="COMMON-LISP____OR.html">or</a> (<a href="COMMON-LISP____ATOM.html">atom</a> x.obj)
                       (<a href="COMMON-LISP____AND.html">and</a> eviscp (<a href="STR____EVISCERATEDP.html">evisceratedp</a> x.obj))))
           (<a href="COMMON-LISP____CONS.html">cons</a> x rows))
          (row1 (<a href="COMMON-LISP____FIRST.html">first</a> rows))
          ((unless (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____KEYWORDP.html">keywordp</a> x.obj)
                        (<a href="STR____KEYWORD-PARAM-VALUEP.html">keyword-param-valuep</a> row1 eviscp)))
           (<a href="STR____MAYBE-MERGE-FLAT.html">maybe-merge-flat</a> x rows width config))
          ((unless (<a href="COMMON-LISP____OR.html">or</a> (<a href="COMMON-LISP____ATOM.html">atom</a> (<a href="COMMON-LISP____REST.html">rest</a> rows))
                       (<a href="COMMON-LISP____EQ.html">eq</a> (<a href="STR____PINST-KIND.html">pinst-kind</a> (<a href="COMMON-LISP____SECOND.html">second</a> rows)) :keypair)
                       (<a href="COMMON-LISP____EQ.html">eq</a> (<a href="STR____PINST-KIND.html">pinst-kind</a> (<a href="COMMON-LISP____SECOND.html">second</a> rows))
                           :keyline)))
           (<a href="STR____MAYBE-MERGE-FLAT.html">maybe-merge-flat</a> x rows width config))
          ((<a href="COMMON-LISP____THE.html">the</a> unsigned-byte x.width)
           (<a href="STR____PFLAT-_E3WIDTH.html">pflat-&gt;width</a> x.guts))
          ((<a href="COMMON-LISP____THE.html">the</a> unsigned-byte row1.width)
           (<a href="STR____PINST-_E3WIDTH.html">pinst-&gt;width</a> row1))
          (keypair-width (<a href="COMMON-LISP_____B2.html">+</a> 1 x.width row1.width))
          ((when (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> keypair-width width))
           (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="STR____MAKE-PINST-KEYPAIR.html">make-pinst-keypair</a> :width keypair-width
                                     :kwd x.guts
                                     :value row1)
                 (<a href="COMMON-LISP____CDR.html">cdr</a> rows))))
         (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="STR____MAKE-PINST-KEYLINE.html">make-pinst-keyline</a> :guts x.guts)
               rows)))
    ((when (<a href="COMMON-LISP____EQ.html">eq</a> xkind :dot))
     (<a href="ACL2____B_A2.html">b*</a>
      ((row1 (<a href="COMMON-LISP____FIRST.html">first</a> rows))
       ((unless (<a href="COMMON-LISP____EQ.html">eq</a> (<a href="STR____PINST-KIND.html">pinst-kind</a> row1) :flat))
        (<a href="COMMON-LISP____CONS.html">cons</a> x rows))
       (row1.guts (<a href="STR____PINST-FLAT-_E3GUTS.html">pinst-flat-&gt;guts</a> row1))
       (row1.width (<a href="STR____PFLAT-_E3WIDTH.html">pflat-&gt;width</a> row1.guts))
       (merged-width (<a href="COMMON-LISP_____B2.html">+</a> 2 row1.width))
       (flat-right-margin (<a href="STR____PRINTCONFIG-_E3FLAT-RIGHT-MARGIN.html">printconfig-&gt;flat-right-margin</a> config))
       ((unless (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> merged-width flat-right-margin)
                     (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> merged-width width)))
        (<a href="COMMON-LISP____CONS.html">cons</a> x rows))
       (new-guts
        (<a href="STR____MAKE-PFLAT.html">make-pflat</a> :width merged-width
                    :what (<a href="ACL2____EC-CALL.html">ec-call</a> (<a href="COMMON-LISP____CAR.html">car</a> (<a href="STR____PFLAT-_E3WHAT.html">pflat-&gt;what</a> row1.guts))))))
      (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="STR____MAKE-PINST-FLAT.html">make-pinst-flat</a> :guts new-guts)
            (<a href="COMMON-LISP____CDR.html">cdr</a> rows)))))
   (<a href="COMMON-LISP____CONS.html">cons</a> x rows))))</pre> 
<p><b>Theorem: </b>pinstlist-p-of-cons-ppr1</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> pinstlist-p-of-cons-ppr1
        (<a href="ACL2____B_A2.html">b*</a> ((new-rows (<a href="STR____CONS-PPR1.html">cons-ppr1</a> x rows width config eviscp)))
            (<a href="STR____PINSTLIST-P.html">pinstlist-p</a> new-rows))
        :rule-classes :rewrite)</pre> 

</body>
</html>
