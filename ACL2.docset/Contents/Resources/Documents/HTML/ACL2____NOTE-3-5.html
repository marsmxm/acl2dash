<html>
<head>
<meta charset="UTF-8">
<title>Note-3-5</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____NOTE-3-5">Click for Note-3-5 in the Full Manual</a></h3>

<p>ACL2 Version  3.5 (May, 2009) Notes</p><p>NOTE!  New users can ignore these release notes, because the <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> has been updated to reflect all changes that are recorded 
 here.</p> 
 
 <p>Below we roughly organize the changes since Version 3.4 into the following 
 categories: changes to existing features, new features, heuristic 
 improvements, bug fixes, new and updated books, Emacs support, and 
 experimental <span class="tt"><a href="ACL2____HONS.html">hons</a></span> version.  Each change is described in just one 
 category, though of course many changes could be placed in more than one 
 category.</p> 
 
 <p><b>CHANGES TO EXISTING FEATURES</b></p> 
 
 <p>Many improvements have been made to ACL2's ``evisceration'' mechanism for 
 hiding substructures of objects before they are printed, and to related 
 documentation:</p> 
 
 <blockquote> 
 
 <p>o A new documentation topic explains evisc-tuples.  See <a href="ACL2____EVISC-TUPLE.html">evisc-tuple</a>.</p> 
 
 <p>o A new interface, <span class="tt"><a href="ACL2____SET-EVISC-TUPLE.html">set-evisc-tuple</a></span>, has been provided for setting 
 the four global evisc-tuples.  See <a href="ACL2____SET-EVISC-TUPLE.html">set-evisc-tuple</a>.</p> 
 
 <p>o A new mode, ``iprinting'', allows eviscerated output to be read back in. 
 See <a href="ACL2____SET-IPRINT.html">set-iprint</a>.</p> 
 
 <p>o Function <span class="v">default-evisc-tuple</span> has been deprecated and will probably 
 be eliminated in future releases; use <span class="v">abbrev-evisc-tuple</span> instead.  Also 
 eliminated is the brr-term-evisc-tuple (also the user-brr-term-evisc-tuple). 
 The term-evisc-tuple controls printing formerly controlled by the 
 brr-term-evisc-tuple or user-brr-term-evisc-tuple.</p> 
 
 <p>o ACL2 output is done in a more consistent manner, respecting the intention 
 of those four global evisc-tuples.  In particular, more proof output is 
 sensitive to the term-evisc-tuple.  Again, see <a href="ACL2____SET-EVISC-TUPLE.html">set-evisc-tuple</a>.</p> 
 
 <p>o A special value, <span class="v">:DEFAULT</span>, may be provided to <span class="tt"><a href="ACL2____SET-EVISC-TUPLE.html">set-evisc-tuple</a></span> in order to restore these <a href="ACL2____EVISC-TUPLE.html">evisc-tuple</a>s to their 
 original settings.</p> 
 
 <p>o (Details for heavy users of the evisc-tuple mechanism) (1) There are no 
 longer <a href="ACL2____STATE.html">state</a> globals named <span class="v">user-term-evisc-tuple</span> or 
 <span class="v">user-default-evisc-tuple</span>.  (2) Because of the above-mentioned 
 <span class="v">:DEFAULT</span>, if you have referenced state globals directly, you should use 
 accessors instead, for example <span class="v">(abbrev-evisc-tuple state)</span> instead of 
 <span class="v">(<a href="ACL2_____04.html">@</a> abbrev-evisc-tuple)</span>.  (3) For uniformity, <span class="tt"><a href="ACL2____SET-TRACE-EVISC-TUPLE.html">set-trace-evisc-tuple</a></span> now takes a second argument, 
 <span class="v">state</span>.</p>
</blockquote> 
 
 <p>Improved <span class="tt"><a href="ACL2____BREAK-ON-ERROR.html">break-on-error</a></span> in several ways.  First, it breaks earlier 
 in a more appropriate place.  Thanks to Dave Greve for highlighting this 
 problem with the existing implementation.  Also, <span class="tt"><a href="ACL2____BREAK-ON-ERROR.html">break-on-error</a></span> now 
 breaks on hard errors, not only soft errors (see <a href="ACL2____ER.html">er</a>, options <span class="v">hard</span> 
 and <span class="v">hard?</span>).  Thanks to Warren Hunt and Anna Slobodova for sending an 
 example that showed a flaw in an initial improvement.  Finally, new options 
 cause printing of the call stack for some host Common Lisps.  See <a href="ACL2____BREAK-ON-ERROR.html">break-on-error</a>.  Thanks to Bob Boyer for requesting this feature.</p> 
 
 <p><span class="tt"><a href="ACL2____TRACE_12.html">Trace!</a></span> may now be used in raw Lisp (though please note that all 
 soundness claims are off any time you evaluate forms in raw Lisp!).  Thanks to 
 Bob Boyer for feedback that led to this enhancement.</p> 
 
 <p>ACL2 now searches for file <span class="v">acl2-customization.lsp</span> in addition to (and 
 just before) its existing search for <span class="v">acl2-customization.lisp</span>; See <a href="ACL2____ACL2-CUSTOMIZATION.html">ACL2-customization</a>.  Thanks to Jared Davis for suggesting this change, which 
 supports the methodology that files with a <span class="v">.lisp</span> extension are 
 certifiable books (thus avoiding the need to set the <span class="v">BOOKS</span> variable in 
 makefiles; see <a href="ACL2____BOOKS-CERTIFICATION-CLASSIC.html">books-certification-classic</a>).</p> 
 
 <p>Improved the error message for illegal <span class="tt"><a href="COMMON-LISP____DECLARE.html">declare</a></span> forms of the form 
 <span class="v">(<a href="COMMON-LISP____TYPE.html">type</a> (satisfies ...))</span>.  Thanks to Dave Greve for sending an example 
 highlighting the issue.</p> 
 
 <p>If trace output is going to a file (because <span class="tt"><a href="ACL2____OPEN-TRACE-FILE.html">open-trace-file</a></span> has 
 been executed), then a note will be printed to that effect at the time that a 
 call of <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span> or <span class="tt"><a href="ACL2____TRACE_12.html">trace!</a></span> is applied to one or more <a href="COMMON-LISP____TRACE.html">trace</a> specs.</p> 
 
 <p>The notion of redundancy (see <a href="ACL2____REDUNDANT-EVENTS.html">redundant-events</a>) has been made more 
 restrictive for <span class="tt"><a href="ACL2____MUTUAL-RECURSION.html">mutual-recursion</a></span> events.  Now, if either the old or 
 new event is a <span class="tt"><a href="ACL2____MUTUAL-RECURSION.html">mutual-recursion</a></span> event, then redundancy requires that 
 both are <span class="tt"><a href="ACL2____MUTUAL-RECURSION.html">mutual-recursion</a></span> events that define the same set of function 
 symbols.  Although we are not aware of any soundness bugs fixed by this 
 modification, nevertheless we believe that it reduces the risk of soundness 
 bugs in the future.</p> 
 
 <p>The definition of <span class="v">trace*</span> has been moved to a book, 
 <span class="v">misc/trace1.lisp</span>.  A new version, used in ACL2s, is in book 
 <span class="v">misc/trace-star.lisp</span>.  <a href="COMMON-LISP____TRACE.html">Trace</a> utilities <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span> and <span class="tt"><a href="ACL2____TRACE_12.html">trace!</a></span> are still built into ACL2.  [Note: File <span class="v">misc/trace1.lisp</span> was 
 deleted after Version 4.2.]</p> 
 
 <p>Certain <a href="ACL2____CERTIFICATE.html">certificate</a> files will now be much smaller, by printing in a 
 way that takes advantage of structure sharing.  Certifying the following 
 example produces a <span class="v">.cert</span> file of over 3M before this change, but less 
 than 1K after the change.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> nest (i)
  ;; Makes an exponentially-sized nest of conses i deep.
  (<a href="COMMON-LISP____IF.html">if</a> (<a href="ACL2____ZP.html">zp</a> i)
      nil
    (<a href="COMMON-LISP____LET.html">let</a> ((next (nest (<a href="COMMON-LISP____1-.html">1-</a> i))))
      (<a href="COMMON-LISP____CONS.html">cons</a> next next))))

(<a href="ACL2____MAKE-EVENT.html">make-event</a>
 `(<a href="ACL2____DEFCONST.html">defconst</a> *big* ',(nest 20)))</pre> 
 
 <p>Thanks to Sol Swords for providing the above example and to him as well as 
 to Bob Boyer, Jared Davis, and Warren Hunt for encouraging development of this 
 improvement.  We have also applied this improvement to the printing of 
 function definitions to files on behalf of <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span> and <span class="tt"><a href="ACL2____COMP.html">comp</a></span>.</p> 
 
 <p>Names of symbols are now printed with vertical bars according to the Common 
 Lisp spec.  Formerly, if the first character of a symbol name could be the 
 first character of the print representation of a number, then the symbol was 
 printed using vertical bars (<span class="v">|..|</span>) around its name.  Now, a much more 
 restrictive test for ``potential numbers'' is used, which can result in fewer 
 such vertical bars.  Base 16 is now carefully considered as well; see <a href="ACL2____SET-PRINT-BASE.html">set-print-base</a>.  Thanks to Bob Boyer for requesting this improvement.  Note 
 that macros <span class="v">set-acl2-print-base</span> and <span class="v">set-acl2-print-case</span> have been 
 replaced by functions; see <a href="ACL2____SET-PRINT-BASE.html">set-print-base</a> and see <a href="ACL2____SET-PRINT-CASE.html">set-print-case</a>.</p> 
 
 <p>The ACL2 reader now supports `<span class="v">#.</span>' syntax in place of the `<span class="v">#,</span> 
 syntax formerly supported.  Thanks to Bob Boyer for requesting this change. 
 See <a href="ACL2____SHARP-DOT-READER.html">sharp-dot-reader</a>.  NOTE that because of this change, `<span class="v">#.</span>' no 
 longer causes an abort; instead please use <span class="v">(<a href="ACL2____A_12.html">a!</a>)</span> or optionally, if in the 
 ACL2 loop, <span class="v">:a!</span>; see <a href="ACL2____A_12.html">a!</a>.</p> 
 
 <p>Some small changes have been made related to <a href="ACL2____GAG-MODE.html">gag-mode</a>:</p> 
 
 <blockquote> 
 
 <p>o <a href="ACL2____GAG-MODE.html">Gag-mode</a> now suppresses some messages that were being printed upon 
 encountering disjunctive splits from <span class="v">:OR</span> <a href="ACL2____HINTS.html">hints</a>.  Thanks to Sol 
 Swords for suggesting this improvement.</p> 
 
 <p>o ACL2 had printed ``<span class="v">Q.E.D.</span>'' with all output suppressed and <span class="tt"><a href="ACL2____GAG-MODE.html">gag-mode</a></span> enabled.  Now, ``<span class="v">Q.E.D.</span>'' will be suppressed when <span class="v">PROVE</span> 
 and <span class="v">SUMMARY</span> output are suppressed, even if <span class="v">gag-mode</span> is enabled.</p> 
 
 <p>o The use of <span class="tt"><a href="ACL2____SET-GAG-MODE.html">set-gag-mode</a></span> had drastic effects on the inhibited 
 output (see <a href="ACL2____SET-INHIBIT-OUTPUT-LST.html">set-inhibit-output-lst</a>), basically inhibiting nearly all 
 output (even most warnings) when turning on gag-mode and enabling all output 
 except <span class="v">proof-tree</span> output when turning off gag-mode.  Now, <span class="tt"><a href="ACL2____SET-GAG-MODE.html">set-gag-mode</a></span> only inhibits or enables proof (<span class="v">PROVE</span>) output, according to 
 whether gag-mode is being turned on or off (respectively).  The related 
 utility <span class="v">set-saved-output</span> has also been modified, basically to eliminate 
 <span class="v">:all</span> as a first argument and to allow <span class="v">t</span> and <span class="v">:all</span> as second 
 arguments, for inhibiting prover output or virtually all output, 
 respectively (see set-saved-output).</p>
</blockquote> 
 
 <p>A <span class="tt"><a href="ACL2____DEFSTUB.html">defstub</a></span> event <a href="ACL2____SIGNATURE.html">signature</a> specifying output of the form 
 <span class="v">(<a href="ACL2____MV.html">mv</a> ...)</span> now introduces a <span class="v">:</span><span class="tt"><a href="ACL2____TYPE-PRESCRIPTION.html">type-prescription</a></span> rule asserting 
 that the new function returns a <span class="tt"><a href="ACL2____TRUE-LISTP.html">true-listp</a></span> result.  Thanks to Bob 
 Boyer for sending the following example, which motivated this change.</p> 
 
 <pre class="code">(<a href="ACL2____DEFSTUB.html">defstub</a> census (<a href="COMMON-LISP_____A2.html">*</a>) =&gt; (<a href="ACL2____MV.html">mv</a> * *))
(<a href="ACL2____DEFN.html">defn</a> foo (x)
  (<a href="ACL2____MV-LET.html">mv-let</a> (a1 a2)
          (census x)
          (<a href="COMMON-LISP____LIST.html">list</a> a1 a2)))</pre> 
 
 <p>Improved the efficiency of <span class="tt"><a href="ACL2____STRING-APPEND.html">string-append</a></span> so that in raw Lisp, it 
 calls <span class="tt"><a href="COMMON-LISP____CONCATENATE.html">concatenate</a></span>.  Thanks to Jared Davis for suggesting this change, 
 including the use of <span class="tt"><a href="ACL2____MBE.html">mbe</a></span>.  A minor change was made to the definition 
 of <span class="tt"><a href="COMMON-LISP____CONCATENATE.html">concatenate</a></span> to support this change, and the lemma 
 <span class="v">append-to-nil</span> was added (see below).</p> 
 
 <p>The checksum algorithm used for <a href="ACL2____CERTIFICATE.html">certificate</a> files of <a href="ACL2____BOOKS.html">books</a> 
 has been changed.  Thanks to Jared Davis for contributing the new code.  This 
 change will likely not be noticed unless one is using the experimental <span class="tt"><a href="ACL2____HONS.html">hons</a></span> version of ACL2, where it can greatly speed up book certification and 
 inclusion because of function memoization (of source function 
 <span class="v">fchecksum-obj</span>).</p> 
 
 <p>Fewer calls are made to the checksum algorithm on behalf of <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span> and a few other operations.  Thanks to Jared Davis for providing 
 data that helped lead us to these changes.</p> 
 
 <p>Formatted printing directives <span class="v">~p</span>, <span class="v">~q</span>, <span class="v">~P</span>, and <span class="v">~Q</span> are 
 deprecated, though still supported.  See <a href="ACL2____FMT.html">fmt</a>.  Instead, please use 
 <span class="v">~x</span>, <span class="v">~y</span>, <span class="v">~X</span>, and <span class="v">~Y</span> (respectively).  As a by-product, rule 
 names in proof output are no longer hyphenated.</p> 
 
 <p>A new keyword, <span class="v">:multiplicity</span>, is available for tracing raw Lisp 
 functions using the ACL2 <a href="COMMON-LISP____TRACE.html">trace</a> utility.  See <a href="ACL2____TRACE_42.html">trace$</a>.</p> 
 
 <p>Users may now control whether or not a slow array access results in a 
 warning printed to the screen (which is the default, as before), and if so, 
 whether or not the warning is followed by a break.  See <a href="ACL2____SLOW-ARRAY-WARNING.html">slow-array-warning</a>.</p> 
 
 <p>On linux-like systems (including Mac OS X and SunOS), <span class="v">:</span><span class="tt"><a href="ACL2____COMP.html">comp</a></span> 
 will now write its temporary files into the <span class="v">"/tmp"</span> directory, which is 
 the value of <span class="tt"><a href="ACL2____STATE.html">state</a></span> global <span class="v">'tmp-dir</span>.  You can change that 
 directory with <span class="v">(<a href="ACL2____ASSIGN.html">assign</a> tmp-dir "&lt;your_temp_directory_path&gt;")</span>.</p> 
 
 <p>The messages printed for uncertified books have been enhanced.  Thanks to 
 Jared Davis for requesting such an improvement.</p> 
 
 <p>A function definition that would be redundant if in <span class="v">:</span><span class="tt"><a href="ACL2____LOGIC.html">logic</a></span> 
 mode is now considered redundant even if it (the new definition) is in 
 <span class="v">:</span><span class="tt"><a href="ACL2____PROGRAM.html">program</a></span> mode.  That is, if a definition is ``downgraded'' from 
 <span class="v">:logic</span> to <span class="v">:program</span> mode, the latter (<span class="v">:program</span> mode) definition 
 is considered redundant.  Previously, such redundancy was disallowed, but we 
 have relaxed that restriction because of a scenario brought to our attention 
 by Jared Davis: include a book with the <span class="v">:logic</span> mode definition, and then 
 include a book with the <span class="v">:program</span> mode definition followed by <span class="tt"><a href="ACL2____VERIFY-TERMINATION.html">verify-termination</a></span>.  Thanks, Jared.</p> 
 
 <p>The ACL2 reader no longer accepts characters other than those recognized by 
 <span class="tt"><a href="COMMON-LISP____STANDARD-CHAR-P.html">standard-char-p</a></span> except for <span class="v">#\Tab</span>, <span class="v">#\Page</span>, and 
 <span class="v">#\Rubout</span> (though it still accepts strings containing such characters). 
 As a result, no <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> expansion is allowed to contain any such 
 unacceptable character or string.  Thanks to Sol Swords for sending an example 
 that led us to make this restriction.  A simple example is the following 
 book:</p> 
 
 <pre class="code">(<a href="COMMON-LISP____IN-PACKAGE.html">in-package</a> "ACL2")
(<a href="ACL2____DEFCONST.html">defconst</a> *my-null* (<a href="COMMON-LISP____CODE-CHAR.html">code-char</a> 0))
(<a href="ACL2____MAKE-EVENT.html">make-event</a> `(<a href="ACL2____DEFCONST.html">defconst</a> *new-null* ,*my-null*))</pre> 
 
 <p>For this book, a call of <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span> formerly broke during the 
 compilation phase, but if there was no compilation, then a call of <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> broke.  Now, the error occurs upon evaluation of the <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> form.</p> 
 
 <p>ACL2 now collects up <a href="ACL2____GUARD.html">guard</a>s from <span class="tt"><a href="COMMON-LISP____DECLARE.html">declare</a></span> forms more as a 
 user might expect, without introducing an unexpected ordering of conjuncts. 
 We thank Jared Davis for sending us the following illustrative example, 
 explained below.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> f (x n)
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____STRINGP.html">stringp</a> x)
                              (<a href="ACL2____NATP.html">natp</a> n)
                              (<a href="COMMON-LISP_____D3.html">=</a> (<a href="COMMON-LISP____LENGTH.html">length</a> x) n)))
           (<a href="COMMON-LISP____TYPE.html">type</a> string x)
           (<a href="COMMON-LISP____IGNORE.html">ignore</a> x n))
  t)</pre> 
 
 <p>Formerly, a guard was generated for this example by unioning the conjuncts 
 from the <span class="v">:guard</span> onto a list containing the term <span class="v">(<a href="COMMON-LISP____STRING.html">string</a> x)</span> generated 
 from the <span class="v">type</span> declaration, resulting in an effective guard of:</p> 
 
 <pre class="code">(<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____NATP.html">natp</a> n)
     (<a href="COMMON-LISP_____D3.html">=</a> (<a href="COMMON-LISP____LENGTH.html">length</a> x) n)
     (<a href="COMMON-LISP____STRINGP.html">stringp</a> x))</pre> 
 
 <p>The guard of this guard failed to be verified because <span class="v">(<a href="COMMON-LISP____STRINGP.html">stringp</a> x))</span> now 
 comes after the call <span class="v">(<a href="COMMON-LISP____LENGTH.html">length</a> x)</span>.  With the fix, contributions to the 
 guards are collected up in the order in which they appear.  So in the above 
 example, the effective guard is the specified <span class="v">:guard</span>; the contribution 
 <span class="v">(<a href="COMMON-LISP____STRINGP.html">stringp</a> x)</span> comes later, and is thus dropped since it is redundant.  NOTE 
 by the way that if <span class="v">:guard</span> and <span class="v">:stobjs</span> are specified in the same 
 <span class="tt"><a href="ACL2____XARGS.html">xargs</a></span> form, then for purposes of collecting up the effective guard as 
 described above, <span class="v">:stobjs</span> will be treated as through it comes before the 
 <span class="v">:guard</span>.</p> 
 
 <p>Modified <span class="tt"><a href="ACL2____CLOSE-OUTPUT-CHANNEL.html">close-output-channel</a></span> to try to do a better job flushing 
 buffers.  Thanks to Bob Boyer for helpful correspondence.</p> 
 
 <p>The notion of ``subversive recursion'' has been modified so that some 
 functions are no longer marked as subversive.  See <a href="ACL2____SUBVERSIVE-RECURSIONS.html">subversive-recursions</a>, in particular the discussion elaborating on the notion 
 of ``involved in the termination argument'' at the end of that <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> topic.</p> 
 
 <p>Formerly, <span class="v">:</span><span class="tt"><a href="ACL2____TYPE-PRESCRIPTION.html">type-prescription</a></span> rules for new definitions inside 
 <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> forms were sometimes added as <a href="ACL2____CONSTRAINT.html">constraint</a>s.  This is 
 no longer the case.  See also discussion of the ``soundness bug in the forming 
 of constraints'', which is related.</p> 
 
 <p><b>NEW FEATURES</b></p> 
 
 <p>It is now possible to affect ACL2's termination analysis (and resulting 
 induction analysis).  Thanks to Peter Dillinger for requesting this feature. 
 The default behavior is essentially unchanged.  But for example, the following 
 definition is accepted by ACL2 because of the use of the new 
 <span class="v">:ruler-extenders</span> features; See <a href="ACL2____RULER-EXTENDERS.html">ruler-extenders</a>.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> f (x)
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :ruler-extenders :all))
  (<a href="COMMON-LISP____CONS.html">cons</a> 3
        (<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP____CONSP.html">consp</a> x)
            (f (<a href="COMMON-LISP____CDR.html">cdr</a> x))
          nil)))</pre> 
 
 <p>The following lemma was added in support of the improvement to <span class="tt"><a href="ACL2____STRING-APPEND.html">string-append</a></span> described above:</p> 
 
 <pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> append-to-nil
  (<a href="ACL2____IMPLIES.html">implies</a> (<a href="ACL2____TRUE-LISTP.html">true-listp</a> x)
           (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="COMMON-LISP____APPEND.html">append</a> x nil)
                  x)))</pre> 
 
 <p>A mechanism has been provided for users to contribute documentation.  See 
 <a href="ACL2____MANAGING-ACL2-PACKAGES.html">managing-ACL2-packages</a> for an example, which contains a link to an 
 external web page on effective use of ACL2 packages, kindly provided by Jared 
 Davis.  ACL2 <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> strings may now link to external web pages 
 using the new symbol, <span class="v">~url</span>; see markup.  Of course, those links 
 appear in the web version of the documentation, but you made need to take a 
 bit of action in order for these to appear as links in the Emacs Info version; 
 see <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a>.</p> 
 
 <p>Added <span class="tt"><a href="ACL2____INTERSECTP.html">intersectp</a></span> (similar to <span class="tt"><a href="ACL2____INTERSECTP-EQ.html">intersectp-eq</a></span> and <span class="tt"><a href="ACL2____INTERSECTP-EQUAL.html">intersectp-equal</a></span>).</p> 
 
 <p>The user now has more control over how ACL2 prints forms; See <a href="ACL2____PRINT-CONTROL.html">print-control</a>.  Thanks to Bob Boyer for useful discussions leading to this 
 enhancement.</p> 
 
 <p>Some Common Lisp implementations only allow the syntax 
 <span class="v">pkg-name::expression</span> when <span class="v">expression</span> is a symbol.  The ACL2 reader 
 has been modified to support a package prefix for arbitrary expressions; see 
 <a href="ACL2____SHARP-BANG-READER.html">sharp-bang-reader</a>.  Thanks to Hanbing Liu for a query that led to this 
 feature and to Pascal J. Bourguignon for suggesting an implementation.</p> 
 
 <p>Ill-formed <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> strings need not cause an error.  See 
 <span class="v">set-ignore-doc-string-error</span>.  Thanks to Bob Boyer for requesting this 
 feature.</p> 
 
 <p>Type declarations are now permitted in <span class="v">let*</span> forms; see <a href="COMMON-LISP____LET_A2.html">let*</a>, 
 see <a href="COMMON-LISP____DECLARE.html">declare</a>, and see <a href="ACL2____TYPE-SPEC.html">type-spec</a>.</p> 
 
 <p>(For Lisp programmers) Macro <span class="v">with-live-state</span> has been provided for 
 programmers who refer to free variable <span class="v">STATE</span>, for example with macros 
 that generate uses of <span class="v">STATE</span>, and want to avoid compiler warnings when 
 evaluating in raw Lisp.  For example, the following form can be submitted 
 either inside or outside the ACL2 loop to get the desired effect (see 
 <span class="v">doc-string</span>): <span class="v">(<a href="ACL2____WITH-LIVE-STATE.html">with-live-state</a> (<a href="ACL2____F-PUT-GLOBAL.html">f-put-global</a> 'doc-prefix " "
 state))</span>.  For another example use of this macro, see the definition of 
 <span class="v">trace$</span> (ACL2 source file <span class="v">other-events.lisp</span>).</p> 
 
 <p>(System hackers only) Added <span class="v">:</span><span class="tt"><a href="ACL2____REDEF-.html">redef-</a></span> to undo the effect of 
 <span class="v">:</span><span class="tt"><a href="ACL2____REDEF_B2.html">redef+</a></span>.  See <a href="ACL2____REDEF-.html">redef-</a>.</p> 
 
 <p>Function <span class="tt"><a href="ACL2____RANDOM_42.html">random$</a></span> is a built-in random number generator.  See <a href="ACL2____RANDOM_42.html">random$</a>.  Thanks to Sol Swords for requesting this feature and providing an 
 initial implementation.</p> 
 
 <p><b>HEURISTIC IMPROVEMENTS</b></p> 
 
 <p>Sped up <a href="ACL2____GUARD.html">guard</a> generation for some functions with large if-then-else 
 structures in their bodies.  Thanks to Sol Swords for sending an illustrative 
 example.</p> 
 
 <p>Sped up <a href="ACL2____GUARD.html">guard</a> generation in some cases by evaluating ground 
 (variable-free) subexpressions.  Thanks to Bob Boyer for sending a motivating 
 example: <span class="v">(<a href="ACL2____DEFN.html">defn</a> foo (x) (<a href="COMMON-LISP____CASE.html">case</a> x ((1 2) 1) ((3 4) 3) ... ((999 1000)
 999)))</span>.</p> 
 
 <p>Modified slightly a heuristic association of ``size'' with constants, which 
 can result in significant speed-ups in proofs involving constants that are 
 very large <span class="v">cons</span> trees.</p> 
 
 <p>Added a restriction in the linear arithmetic procedure for deleting 
 polynomial inequalities from the linear database.  Formerly, an inequality 
 could be deleted if it was implied by another inequality.  Now, such deletion 
 requires that certain heuristic ``parent tree'' information is at least as 
 restrictive for the weaker inequality as for the stronger.  Thanks to Dave 
 Greve for bringing a relevant example to our attention and working with us to 
 figure out some surprising behavior, and to Robert Krug for making a key 
 observation leading to the fix.</p> 
 
 <p>(GCL especially) Improved compiled code slightly by communicating to raw 
 Lisp the output type when a function body is of the form <span class="v">(<a href="COMMON-LISP____THE.html">the</a> character
 ...)</span>.  This tiny improvement will probably only be observed in GCL, if at 
 all.</p> 
 
 <p>Applied a correction suggested by Robert Krug to the variant of <span class="tt"><a href="ACL2____TERM-ORDER.html">term-order</a></span> used in parts of ACL2's arithmetic reasoning.</p> 
 
 <p><b>BUG FIXES</b></p> 
 
 <p>Fixed bugs in the handling of <span class="tt"><a href="COMMON-LISP____FLET.html">flet</a></span> expressions, one of which had 
 the capability of rendering ACL2 unsound.  Thanks to Sol Swords for pointing 
 out two issues and sending examples.  One example illustrated how ACL2 was in 
 essence throwing away outer <span class="tt"><a href="COMMON-LISP____FLET.html">flet</a></span> bindings when processing an inner 
 <span class="v">flet</span>.  We have exploited that example to prove a contradiction, as 
 follows: this book was certifiable before this fix.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____IN-PACKAGE.html">in-package</a> "ACL2")

(<a href="COMMON-LISP____DEFUN.html">defun</a> a (x)
  (<a href="COMMON-LISP____LIST.html">list</a> 'c x))

; Example from Sol Swords, which failed to be admitted (claiming that
; function A is undefined) without the above definition of A.
(<a href="COMMON-LISP____DEFUN.html">defun</a> foo1 (x y)
   (<a href="COMMON-LISP____FLET.html">flet</a> ((a (x) (<a href="COMMON-LISP____LIST.html">list</a> 'a x)))
     (<a href="COMMON-LISP____FLET.html">flet</a> ((b (y) (<a href="COMMON-LISP____LIST.html">list</a> 'b y)))
       (b (a (<a href="COMMON-LISP____LIST.html">list</a> x y))))))

(<a href="ACL2____DEFTHM.html">defthm</a> not-true
  (<a href="COMMON-LISP____EQUAL.html">equal</a> (foo1 3 4)
         '(b (c (3 4))))
  :hints (("Goal"
           :in-theory
           (<a href="ACL2____DISABLE.html">disable</a> (:executable-counterpart foo1))))
  :rule-classes nil)

(<a href="ACL2____DEFTHM.html">defthm</a> contradiction
  nil
  :hints (("Goal" :use not-true))
  :rule-classes nil)</pre> 
 
 <p>Sol's second example, below, pointed to a second bug related to computing 
 output signatures in the presence of nested <span class="v">flet</span> expressions, which we 
 have also fixed: this form failed before the fix.</p> 
 
 <pre class="code">:trans (<a href="COMMON-LISP____FLET.html">flet</a> ((foo (a) (<a href="COMMON-LISP____LIST.html">list</a> (<a href="COMMON-LISP____FLET.html">flet</a> ((bar (b) b)) a)))) x)</pre> 
 
 <p>Fixed a subtle soundness bug in the forming of constraints from deduced 
 type prescriptions.  As a result, when ACL2 prints a warning message labeling 
 encapsulated functions as ``subversive'', ACL2 will no longer deduce 
 <span class="v">:</span><span class="tt"><a href="ACL2____TYPE-PRESCRIPTION.html">type-prescription</a></span> rules for those functions.  Examples that 
 exploit the bug in ACL2 Version_3.4 may be found in comments in ACL2 source 
 function <span class="v">convert-type-set-to-term</span> (file <span class="v">other-processes.lisp</span>) and 
 especially in function <span class="v">putprop-type-prescription-lst</span> (file 
 <span class="v">defuns.lisp</span>).  For more on the general issue of ``subversive 
 recursions,'' see <a href="ACL2____SUBVERSIVE-RECURSIONS.html">subversive-recursions</a>.)</p> 
 
 <p>Fixed a soundness bug in the handling of inequalities by the <a href="ACL2____TYPE-SET.html">type-set</a> mechanism, which was using the inequality database inside the body 
 of a <span class="tt"><a href="COMMON-LISP____LAMBDA.html">lambda</a></span>.</p> 
 
 <p>Fixed a long-standing soundness bug in <span class="tt"><a href="ACL2____COMPRESS1.html">compress1</a></span> and <span class="tt"><a href="ACL2____COMPRESS2.html">compress2</a></span>, whose raw Lisp code gave the logically incorrect result in the 
 case of a single entry other than the <span class="tt"><a href="ACL2____HEADER.html">header</a></span>, where that entry mapped 
 an index to the <span class="tt"><a href="ACL2____DEFAULT.html">default</a></span> value.  Also fixed soundness bugs in <span class="tt"><a href="ACL2____COMPRESS1.html">compress1</a></span>, in the case of <span class="v">:order &gt;</span>, where the raw Lisp code could drop 
 the <span class="tt"><a href="ACL2____HEADER.html">header</a></span> from the result or, when the input alist had entries in 
 ascending order, fail to return an alist in descending order.  For example, 
 the following book certified successfully.</p> 
 
 <pre class="code">(<a href="COMMON-LISP____IN-PACKAGE.html">in-package</a> "ACL2")
(<a href="ACL2____DEFTHM.html">defthm</a> true-formula-1
  (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ACL2____COMPRESS1.html">compress1</a> 'a '((:HEADER :DIMENSIONS (4) :MAXIMUM-LENGTH 5
                                  :DEFAULT 1 :NAME A :ORDER &lt;)
                         (1 . 1)))
         '((:HEADER :DIMENSIONS (4) :MAXIMUM-LENGTH 5
                    :DEFAULT 1 :NAME A :ORDER &lt;)))
  :hints (("Goal" :in-theory (<a href="ACL2____DISABLE.html">disable</a> (<a href="ACL2____COMPRESS1.html">compress1</a>))))
  :rule-classes nil)
(<a href="ACL2____DEFTHM.html">defthm</a> ouch-1
  nil
  :hints (("Goal" :use true-formula-1))
  :rule-classes nil)
(<a href="ACL2____DEFTHM.html">defthm</a> true-formula-2
  (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ACL2____COMPRESS1.html">compress1</a> 'a '((:HEADER :DIMENSIONS (4) :MAXIMUM-LENGTH 5
                                  :DEFAULT NIL :NAME A :ORDER &gt;)
                         (1 . 1)
                         (2 . 2)))
         '((:HEADER :DIMENSIONS (4) :MAXIMUM-LENGTH 5
                    :DEFAULT NIL :NAME A :ORDER &gt;)
           (2 . 2)
           (1 . 1)))
  :hints (("Goal" :in-theory (<a href="ACL2____DISABLE.html">disable</a> (<a href="ACL2____COMPRESS1.html">compress1</a>))))
  :rule-classes nil)
(<a href="ACL2____DEFTHM.html">defthm</a> ouch-2
  nil
  :hints (("Goal" :use true-formula-2))
  :rule-classes nil)
(<a href="ACL2____DEFTHM.html">defthm</a> true-formula-3
  (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ACL2____COMPRESS1.html">compress1</a> 'a '((:HEADER :DIMENSIONS (3) :MAXIMUM-LENGTH 4
                                  :NAME A :ORDER &gt;)
                         (1 . B)
                         (0 . A)))
         '((:HEADER :DIMENSIONS (3) :MAXIMUM-LENGTH 4
                    :NAME A :ORDER &gt;)
           (1 . B)
           (0 . A)))
  :hints (("Goal" :in-theory (<a href="ACL2____DISABLE.html">disable</a> (<a href="ACL2____COMPRESS1.html">compress1</a>))))
  :rule-classes nil)
(<a href="ACL2____DEFTHM.html">defthm</a> ouch-3
  nil
  :hints (("Goal" :use true-formula-3))
  :rule-classes nil)</pre> 
 
 <p>Fixed a soundness bug involving measured subsets and <span class="tt"><a href="ACL2____VERIFY-TERMINATION.html">verify-termination</a></span>, by changing <span class="tt"><a href="ACL2____VERIFY-TERMINATION.html">verify-termination</a></span> so that it uses 
 <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span>.  See <a href="ACL2____VERIFY-TERMINATION.html">verify-termination</a>, in particular the 
 discussion about <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> near the end of that <a href="COMMON-LISP____DOCUMENTATION.html">documentation</a> 
 topic.  Peter Dillinger first raised the idea to us of making such a change; 
 when we found this soundness bug, we were certainly happy to do so!</p> 
 
 <p>Fixed a bug that could cause a hard Lisp error but not, apparently, 
 unsoundness.  The bug was in the lack of attention to the order of guard and 
 type declarations when checking for redundancy.  In the following example, the 
 second definition was redundant during the first pass of the <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> form.  The second definition, however, was stored on the second 
 pass with a guard of <span class="v">(<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____CONSP.html">consp</a> (<a href="COMMON-LISP____CAR.html">car</a> x)) (<a href="COMMON-LISP____CONSP.html">consp</a> x))</span>, which caused a hard 
 Lisp error when evaluating <span class="v">(foo 3)</span> due to a misguided attempt to evaluate 
 <span class="v">(<a href="COMMON-LISP____CAR.html">car</a> 3)</span> in raw Lisp.  The fix is to restrict redundancy of definitions so 
 that the guard and type declarations must be in the same order for the two 
 definitions.</p> 
 
 <pre class="code">(<a href="ACL2____ENCAPSULATE.html">encapsulate</a>
 ()
 (<a href="ACL2____LOCAL.html">local</a> (<a href="COMMON-LISP____DEFUN.html">defun</a> foo (x)
          (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____CONSP.html">consp</a> x)))
          (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____CONSP.html">consp</a> (<a href="COMMON-LISP____CAR.html">car</a> x))))
          x))
 (<a href="COMMON-LISP____DEFUN.html">defun</a> foo (x)
   (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____CONSP.html">consp</a> (<a href="COMMON-LISP____CAR.html">car</a> x))))
   (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____CONSP.html">consp</a> x)))
   x))
; Now we get a hard Lisp error from evaluation of the guard of foo:
(foo 3)</pre> 
 
 <p>Fixed a bug in the guard violation report for function <span class="tt"><a href="ACL2____INTERN-IN-PACKAGE-OF-SYMBOL.html">intern-in-package-of-symbol</a></span>.  Thanks to Dave Greve for bringing this bug to 
 our attention.</p> 
 
 <p>Made a change to allow certain <a href="ACL2____HINTS.html">hints</a>, in particular certain 
 <span class="v">:</span><span class="tt"><a href="ACL2____CLAUSE-PROCESSOR.html">clause-processor</a></span> hints, that had previously caused errors during 
 termination proofs by viewing the function being defined as not yet existing. 
 Thanks to Sol Swords for bringing this issue to our attention with a nice 
 example.</p> 
 
 <p>ACL2 now properly handles interrupts (via control-c) issued during printing 
 of the checkpoint summary.  Previously it was possible on some platforms to 
 make ACL2 hang when interrupting both during a proof and during the ensuing 
 printing of the checkpoint summary.  Thanks to Jared Davis and Sol Swords for 
 bringing this problem to our attention.</p> 
 
 <p>Fixed a bug that was preventing, inside some book <span class="v">"b"</span>, the use of a 
 <span class="v">:dir</span> argument to <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> that refers to a directory defined 
 using <span class="tt"><a href="ACL2____ADD-INCLUDE-BOOK-DIR.html">add-include-book-dir</a></span> earlier in the book <span class="v">"b"</span>.  (We found 
 this ourselves, but we thank John Cowles for observing it independently and 
 sending us a nice example.)</p> 
 
 <p>(GCL and CCL only) Fixed a bug in certain under-the-hood type inferencing. 
 Thanks to Sol Swords for sending an example using <a href="ACL2____STOBJ.html">stobj</a>s defined with 
 the <span class="v">:inline</span> keyword, along with a helpful backtrace in CCL, and to Gary 
 Byers for his debugging help.</p> 
 
 <p>Fixed a bug in <span class="tt"><a href="ACL2____PRINT-GV.html">print-gv</a></span>, which was mishandling calls of functions 
 with more than one argument.</p> 
 
 <p>Fixed a bug in the handling of <span class="tt"><a href="COMMON-LISP____AND.html">and</a></span> and <span class="tt"><a href="COMMON-LISP____OR.html">or</a></span> terms by the 
 <a href="ACL2____PROOF-BUILDER.html">proof-builder</a> command <span class="v">DV</span>, including numeric (``diving'') commands. 
 Thanks for Mark Reitblatt for bringing this problems to our attention with a 
 helpful example.</p> 
 
 <p>Fixed printing of goal names resulting from the application of <span class="v">:OR</span> 
 <a href="ACL2____HINTS.html">hints</a> so that they aren't ugly when working in other than the 
 <span class="v">"ACL2"</span> package.  Thanks to Sol Swords for bringing this issue to our 
 attention.</p> 
 
 <p>Fixed <a href="ACL2____PROOF-TREE.html">proof-tree</a> printing so that interrupts will not cause problems 
 with hiding ordinary output because of incomplete proof-tree output.  Thanks 
 to Peter Dillinger for pointing out this issue.</p> 
 
 <p>Fixed a hard error that could be caused by mishandling a <span class="tt"><a href="ACL2____FORCE.html">force</a></span>d 
 hypothesis during <a href="ACL2____FORWARD-CHAINING.html">forward-chaining</a>.  Thanks to Peter Dillinger for 
 bringing this bug to our attention by sending a useful example.</p> 
 
 <p>Fixed a bug that could cause simplifications to fail because of alleged 
 ``specious simplification.''  This bug could appear when deriving an equality 
 from the linear arithmetic database, and then attempting to add this equality 
 to the current goal's hypotheses when it was already present.  Thanks to Eric 
 Smith for sending a helpful example (in July 2005!) that helped us debug this 
 issue.</p> 
 
 <p>Fixed a bug in processing of <span class="v">:</span><span class="tt"><a href="ACL2____TYPE-SET-INVERTER.html">type-set-inverter</a></span> rules.</p> 
 
 <p>Fixed a bug that was causing an error, at least for an underlying Lisp of 
 CCL (OpenMCL), when <span class="tt"><a href="ACL2____EC-CALL.html">ec-call</a></span> was applied to a term returning multiple 
 values.  Thanks to Sol Swords for sending an example that brought this bug to 
 our attention.</p> 
 
 <p>Fixed handling of array orders to treat keyword value <span class="v">:order :none</span> 
 correctly from an array's <span class="tt"><a href="ACL2____HEADER.html">header</a></span>.  Previously, there were two 
 problems.  One problem was that <span class="v">:order :none</span> was treated like the default 
 for <span class="v">:order</span>, <span class="v">&lt;</span>, while <span class="v">:order nil</span> was treated in the manner 
 specified by <span class="v">:order :none</span> (see <a href="ACL2____ARRAYS.html">arrays</a>).  Now, both <span class="v">:order
 :none</span> and <span class="v">:order nil</span> are treated as <span class="v">:order nil</span> had been treated, 
 i.e., so that there is no reordering of the alist by <span class="tt"><a href="ACL2____COMPRESS1.html">compress1</a></span>.  The 
 other problem with this case of <span class="v">:order</span> was that the <span class="v">:maximum-length</span> 
 field of the <span class="tt"><a href="ACL2____HEADER.html">header</a></span> was not being respected: the length could grow 
 without bound.  Now, as previously explained (but not previously implemented) 
 — see <a href="ACL2____ARRAYS.html">arrays</a> — a <span class="tt"><a href="ACL2____COMPRESS1.html">compress1</a></span> call made on behalf of 
 <span class="v">aset1</span> causes a hard error if the header of the supplied array specifies 
 an <span class="v">:order</span> of <span class="v">:none</span> or <span class="v">nil</span>.</p> 
 
 <p>An <span class="v">ignorable</span> <span class="tt"><a href="COMMON-LISP____DECLARE.html">declare</a></span> form had caused an error in some contexts 
 when it should have been allowed.  In particular, this problem could arise 
 when using an <span class="v">ignorable</span> declaration at the top level in a <span class="tt"><a href="ACL2____DEFABBREV.html">defabbrev</a></span> form.  It could also arise upon calling <span class="tt"><a href="ACL2____VERIFY-TERMINATION.html">verify-termination</a></span> 
 when the corresponding <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span> form contained an <span class="v">ignorable</span> 
 declaration at the top level.  These bugs have been fixed.</p> 
 
 <p>Contrary to existing documentation (see <a href="ACL2____MAKE-EVENT-DETAILS.html">make-event-details</a>), the 
 value of ``<span class="tt"><a href="ACL2____LD.html">ld</a></span> special variable'' <span class="tt"><a href="ACL2____LD-SKIP-PROOFSP.html">ld-skip-proofsp</a></span> was always 
 set to <span class="v">nil</span> during <span class="tt"><a href="ACL2____MAKE-EVENT.html">make-event</a></span> expansion, not merely when the 
 <span class="v">make-event</span> form has a non-<span class="v">nil</span> value for keyword parameter 
 <span class="v">:check-expansion</span>.  This has been fixed.  Thanks to Sol Swords for 
 bringing this issue to our attention.</p> 
 
 <p>We have disallowed the certification of a book when not at the top-level, 
 either directly in the top-level loop or at the top level of <span class="tt"><a href="ACL2____LD.html">ld</a></span>. 
 Before this restriction, the following would certify a book with a definition 
 such as <span class="v">(<a href="COMMON-LISP____DEFUN.html">defun</a> foo (x) (h x))</span> that calls function <span class="v">h</span> before defining 
 it, if the certification was by way of the form such as:</p> 
 
 <pre class="code">(<a href="ACL2____ER-PROGN.html">er-progn</a> (<a href="COMMON-LISP____DEFUN.html">defun</a> h (x) x) (<a href="ACL2____CERTIFY-BOOK.html">certify-book</a> "my-book"))</pre> 
 
 <p>But a subsequent <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> of <span class="v">"my-book"</span> would then fail, 
 because <span class="v">h</span> is not defined at the top level.</p> 
 
 <p>Printing with <span class="tt"><a href="ACL2____FMT.html">fmt</a></span> directive <span class="v">~c</span> now works properly even when 
 the print-base is other than 10.  Thanks to Sol Swords for reporting this bug 
 and providing a fix for it.</p> 
 
 <p>(SBCL, CMUCL, and CCL only) Fixed a bug in <span class="tt"><a href="ACL2____SYS-CALL-STATUS.html">sys-call-status</a></span> in the 
 case that the underlying Common Lisp is SBCL, CMUCL, or CCL (OpenMCL).  Thanks 
 to Jun Sawada for bringing this bug to our attention and providing a fix.</p> 
 
 <p>Fixed a bug that was preventing <span class="tt"><a href="ACL2____LOCAL.html">local</a></span> <span class="tt"><a href="ACL2____DEFSTOBJ.html">defstobj</a></span> events in 
 <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> events.  Thanks to Jared Davis for bringing this bug to 
 our attention.</p> 
 
 <p>Fixed a bug evidenced by error message ``Unexpected form in certification 
 world'', which could result from attempting to certify a book after evaluating 
 an <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> form with a local <span class="tt"><a href="COMMON-LISP____DEFMACRO.html">defmacro</a></span>.  Thanks to Jared 
 Davis for pointing out this bug and sending the example:</p> 
 
 <pre class="code">(<a href="ACL2____ENCAPSULATE.html">encapsulate</a>
 ()
 (<a href="ACL2____LOCAL.html">local</a> (<a href="COMMON-LISP____DEFMACRO.html">defmacro</a> foo (x) `(<a href="ACL2____TABLE.html">table</a> foo 'bar ,x)))
 (<a href="ACL2____LOCAL.html">local</a> (foo 3)))</pre> 
 
 <p>Formerly, evaluating a <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span> form inside a <a href="ACL2____WORMHOLE.html">wormhole</a> such as 
 the <a href="ACL2____BREAK-REWRITE.html">break-rewrite</a> loop could leave the user in a bad state after 
 returning to the top level, in which that function could not be untraced. 
 This has been fixed.  Note however that when you proceed from a break in the 
 <a href="ACL2____BREAK-REWRITE.html">break-rewrite</a> loop, the tracing state will be the same as it was when 
 you entered that break: all effects of calling <span class="tt"><a href="ACL2____TRACE_42.html">trace$</a></span> and <span class="tt"><a href="ACL2____UNTRACE_42.html">untrace$</a></span> are erased when you proceed from the break.</p> 
 
 <p>A <span class="v">:</span><span class="tt"><a href="ACL2____GUARD.html">guard</a></span> of <span class="v">(<a href="COMMON-LISP____AND.html">and</a>)</span> is no longer ignored.  Thanks to Sol 
 Swords for bringing this bug to our attention.</p> 
 
 <p>A bug has been fixed that could result in needlessly weak induction schemes 
 in the case that a recursive call is made in the first argument of <span class="tt"><a href="ACL2____PROG2_42.html">prog2$</a></span>.  This has been fixed by including <span class="tt"><a href="ACL2____PROG2_42.html">prog2$</a></span> as a default 
 ruler-extender in the new ruler-extenders feature (see above, and see <a href="ACL2____RULER-EXTENDERS.html">ruler-extenders</a>).  For details on this bug see Example 11 in distributed book 
 <span class="v">books/misc/misc2/ruler-extenders-tests.lisp</span>.</p> 
 
 <p>(For CCL/OpenMCL on Windows) ACL2 should now build on CCL (OpenMCL) on 
 Windows.  Thanks to David Rager for bringing this issue to our attention and 
 helping with a fix that worked for CCL 1.2, and to the CCL team for improving 
 handling of Windows-style filenames in CCL 1.3.</p> 
 
 <p><b>NEW AND UPDATED BOOKS</b></p> 
 
 <p>See <a href="https://code.google.com/p/acl2-books/wiki/ReleaseVersionNumbers" target="_blank"><nobr>ReleaseVersionNumbers<img src="../Icon_External_Link.png" title="External link to https://code.google.com/p/acl2-books/wiki/ReleaseVersionNumbers"></nobr></a> 
 for a list of books in Version 3.5 of ACL2 but not Version 3.4.</p> 
 
 <p>Run the shell command</p> 
 
 <pre class="code"> <span class="v">svn log -r 94:HEAD</span> </pre> 
 
 <p>to see all changes to <span class="v">books/</span> since the release of Version 3.4.</p> 
 
 <p>Here are just a few highlights.</p> 
 
 <p>Thanks largely to Jared Davis, many <span class="v">Makefile</span>s have been improved to do 
 automatic dependency analysis.  See <a href="ACL2____BOOKS-CERTIFICATION-CLASSIC.html">books-certification-classic</a> for how 
 to get your own <span class="v">Makefile</span>s to do this by adding a line: <span class="v">-include
 Makefile-deps</span>.</p> 
 
 <p>Libraries <span class="v">books/arithmetic-4/</span> and <span class="v">books/rtl/rel7/</span> have been 
 eliminated from the default book certification (<span class="v">make regression</span>), in 
 favor of new libraries <span class="v">books/arithmetic-5/</span> and <span class="v">books/rtl/rel8/</span> 
 contributed by Robert Krug and Hanbing Liu, respectively.  They and Jun Sawada 
 have arranged the compatibility of these libraries; i.e., it is possible to 
 evaluate both of the following in the same session:</p> 
 
 <pre class="code">(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "arithmetic-5/top" :dir :system)
(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "rtl/rel8/lib/top" :dir :system)</pre> 
 
 <p>Library <span class="v">books/rtl/rel1/</span> is no longer certified by default (though it 
 is still distributed in support of ACL2(r); see <a href="COMMON-LISP____REAL.html">real</a>).</p> 
 
 <p><b>EMACS SUPPORT</b></p> 
 
 <p>Slightly modified <span class="v">Control-t e</span> (defined in <span class="v">emacs/emacs-acl2.el</span>) to 
 comprehend the notion of an ``ACL2 scope'', and added <span class="v">Control-t o</span> to 
 insert a superior <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> defining such a scope.  See the Emacs 
 documentation for <span class="v">Control-t e</span> (generally obtained after typing 
 <span class="v">Control-h k</span>).</p> 
 
 <p>Modified distributed file <span class="v">emacs/emacs-acl2.el</span> so that if you put the 
 following two forms in your <span class="v">~/.emacs</span> file above the form that loads 
 <span class="v">emacs/emacs-acl2.el</span>, then Emacs will not start up a shell.  Thanks to 
 Terry Parks for leading us to this modification.</p> 
 
 <pre class="code">(defvar acl2-skip-shell nil)
(setq acl2-skip-shell t)</pre> 
 
 <p><b>EXPERIMENTAL HONS VERSION</b></p> 
 
 <p>Bob Boyer and others have contributed numerous changes for the experimental 
 ``<span class="v">hons</span>'' version of ACL2 (see <a href="ACL2____HONS-AND-MEMOIZATION.html">hons-and-memoization</a>).</p> 
 
 <p>The ACL2 <span class="tt"><a href="ACL2____STATE.html">state</a></span> can now be queried with <span class="v">(<a href="ACL2_____04.html">@</a> hons-enabledp)</span> so 
 that a result of <span class="v">t</span> says that one is in the experimental <span class="v">hons</span> 
 version, while <span class="v">nil</span> says the opposite.</p>
</body>
</html>
