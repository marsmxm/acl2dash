<html>
<head>
<meta charset="UTF-8">
<title>Note-2-9-3</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____NOTE-2-9-3">Click for Note-2-9-3 in the Full Manual</a></h3>

<p>ACL2 Version  2.9.3 (August, 2005) Notes</p><p>Also see <a href="ACL2____NOTE-2-9-1.html">note-2-9-1</a> and see <a href="ACL2____NOTE-2-9-2.html">note-2-9-2</a> for other 
 changes since the last non-incremental release (Version_2.9).</p> 
 
 <p>We fixed a soundness bug that exploited the ability to define <span class="v">:</span><span class="tt"><a href="ACL2____PROGRAM.html">program</a></span> mode functions that are improperly guarded, and then to use those 
 functions in <span class="tt"><a href="ACL2____DEFCONST.html">defconst</a></span> forms.  The fix is to evaluate <span class="tt"><a href="ACL2____DEFCONST.html">defconst</a></span> 
 forms using the same ``safe-mode'' that is used in macroexpansion (see <a href="ACL2____GUARDS-AND-EVALUATION.html">guards-and-evaluation</a>).  Here is a proof of <span class="v">nil</span> that succeeded in 
 Allegro Common Lisp (but not, for example, GCL).  See also a long comment in 
 source function <span class="v">defconst-fn</span> for an example that does not require the use 
 of <span class="v">:set-guard-checking</span>.</p> 
 
 <pre class="code">:set-guard-checking nil ; execute before certifying the book below

(<a href="COMMON-LISP____IN-PACKAGE.html">in-package</a> "ACL2")

(<a href="ACL2____ENCAPSULATE.html">encapsulate</a>
 ()
 (<a href="ACL2____LOCAL.html">local</a> (<a href="COMMON-LISP____DEFUN.html">defun</a> f1 ()
          (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :mode :program))
          (<a href="COMMON-LISP____CHAR-UPCASE.html">char-upcase</a> (<a href="COMMON-LISP____CODE-CHAR.html">code-char</a> 224))))
 (<a href="ACL2____LOCAL.html">local</a> (<a href="ACL2____DEFCONST.html">defconst</a> *b* (f1)))
 (<a href="COMMON-LISP____DEFUN.html">defun</a> f1 ()
   (<a href="COMMON-LISP____CHAR-UPCASE.html">char-upcase</a> (<a href="COMMON-LISP____CODE-CHAR.html">code-char</a> 224)))
 (<a href="ACL2____DEFCONST.html">defconst</a> *b* (f1))
 (<a href="ACL2____DEFTHM.html">defthm</a> bad
   (<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> *b* (<a href="COMMON-LISP____CODE-CHAR.html">code-char</a> 224)))
   :rule-classes nil))

(<a href="ACL2____DEFTHM.html">defthm</a> ouch
  nil
  :hints (("Goal" :use bad))
  :rule-classes nil)</pre> 
 
 <p>We fixed a soundness hole due to the fact that the "LISP" package does 
 not exist in OpenMCL.  We now explicitly disallow this package name as an 
 argument to <span class="tt"><a href="ACL2____DEFPKG.html">defpkg</a></span>.  Thanks to Bob Boyer and Warren Hunt for bringing 
 an issue to our attention that led to this fix.</p> 
 
 <p>ACL2 now requires all package names to consist of standard characters (see 
 <a href="COMMON-LISP____STANDARD-CHAR-P.html">standard-char-p</a>, none of which is lower case.  The reason is that we 
 have seen at least one lisp implementation that does not handle lower case 
 package names correctly.  Consider for example the following raw lisp log 
 (some newlines omitted).</p> 
 
 <pre class="code">&gt;(make-package "foo")
#&lt;"foo" package&gt;
&gt;(package-name (symbol-package 'FOO::A))
"foo"
&gt;(package-name (symbol-package '|FOO|::A))
"foo"
&gt;</pre> 
 
 <p>Distributed book <span class="v">books/textbook/chap10/compiler</span>, as well as workshop 
 books in directory <span class="v">books/workshops/2004/cowles-gamboa/support/</span>, were 
 modified to accommodate the above change.</p> 
 
 <p>Added <span class="v">newline</span>, <span class="tt"><a href="ACL2____ADD-TO-SET-EQL.html">add-to-set-eql</a></span>, <span class="v">the-fixnum</span>, and 
 <span class="v">the-fixnum!</span>  to <span class="v">*acl2-exports*</span>.  Thanks to Jared Davis for bringing 
 these to our attention.</p> 
 
 <p>Added a line to <span class="v">acl2.lisp</span> to support CMUCL running on Mac OSX, thanks 
 to a suggestion from Fabricio Chalub Barbosa do Rosario.</p> 
 
 <p>The executable scripts for saved ACL2 images now include <span class="v">$*</span>, so that 
 command-line arguments will be passed along.</p> 
 
 <p>(For GCL profiling only) Fixed a colon (<span class="v">:</span>) that should have been a 
 semicolon (<span class="v">;</span>) in file <span class="v">save-gprof.lsp</span>.  Thanks to David Hardin for 
 pointing out this bug.</p> 
 
 <p>The documentation for <span class="v">:</span><span class="tt"><a href="ACL2____ELIM.html">elim</a></span> rules has been expanded and 
 improved, thanks to useful feedback from Hanbing Liu.</p> 
 
 <p>Fixed a bug in the guard for function <span class="v">include-book-dir</span>.</p> 
 
 <p>For those who want to experiment with an alternate implementation of <span class="tt"><a href="ACL2____MV.html">mv</a></span> and <span class="tt"><a href="ACL2____MV-LET.html">mv-let</a></span>, there is now support for under-the-hood implementation 
 of these in terms of raw Lisp functions <span class="v">values</span> and 
 <span class="v">multiple-value-bind</span>, respectively.  The regression suite has seen about a 
 10% speed-up in Allegro CL and about an 8% slowdown in GCL for builds with 
 this change.  See the makefile (<span class="v">GNUmakefile</span>) for examples of how to build 
 ACL2 by including the feature, <span class="v">:acl2-mv-as-values</span>.  Source file 
 <span class="v">init.lsp</span> has been renamed to <span class="v">init.lisp</span> in support of this change 
 (technical detail: otherwise GCL loads the init file too soon, before its 
 <span class="v">-eval</span> argument is evaluated).  Thanks to David Rager for inspiring this 
 change, by pointing out the problematic use of globals by the existing <span class="tt"><a href="ACL2____MV.html">mv</a></span> implementation from the standpoint of supporting parallel evaluation. 
 This capability is experimental: there is likely to be some remaining work to 
 be done on it.</p> 
 
 <p>A change related to the one just above is that we now limit the maximum 
 number of arguments to any call of <span class="tt"><a href="ACL2____MV.html">mv</a></span> to 32.  Thanks to Bob Boyer for 
 raising a question that lead to this change.</p> 
 
 <p>Eliminated some compiler warnings in OpenMCL.</p> 
 
 <p>In the rtl library (<span class="v">books/rtl/rel4/</span>), functions <span class="v">bits</span> and 
 <span class="v">setbits</span> have had their <a href="ACL2____GUARD.html">guard</a>s improved (as they had been too 
 restrictive, especially for <span class="v">setbits</span>).</p> 
 
 <p>A new function <span class="tt"><a href="ACL2____TIME_42.html">time$</a></span> permits timing of forms, by using (under the 
 hood) the host Common Lisp's <span class="v">time</span> utility.</p> 
 
 <p>We fixed an infinite loop that could occur during destructor elimination 
 (see <a href="ACL2____ELIM.html">elim</a>).  Thanks to Sol Swords to bringing this to our attention and 
 sending a nice example, and to Doug Harper for sending a second example that 
 we also found useful.</p> 
 
 <p>The method of speeding up GCL-based builds (see <a href="ACL2____NOTE-2-9-2.html">note-2-9-2</a>) has 
 changed slightly from Version_2.9.2.  Now, in the `make' command:</p> 
 
 <pre class="code">LISP='gcl -eval "(defparameter user::*fast-acl2-gcl-build* t)"</pre> 
 
 <p>We improved the pretty-printer's handling of keywords.  For example, before 
 this change one might see the following printed by ACL2.</p> 
 
 <pre class="code">(MODIFY TH S :KEY1 VAL1 :KEY2
        (<a href="COMMON-LISP____IF.html">IF</a> (<a href="COMMON-LISP____IF.html">IF</a> X Y Z) AAAAAAAAAA BBBBBBB))</pre> 
 
 <p>Now, the above might print as follows.  Notice that we have avoided 
 breaking after a keyword (see <a href="COMMON-LISP____KEYWORDP.html">keywordp</a>) that is preceded by other forms 
 on the same line.</p> 
 
 <pre class="code">(MODIFY TH S
        :KEY1 VAL1
        :KEY2 (<a href="COMMON-LISP____IF.html">IF</a> (<a href="COMMON-LISP____IF.html">IF</a> X Y Z) AAAAAAAAAA BBBBBBB))</pre> 
 
 <p>See <a href="ACL2____NOTE-2-9-3-PPR-CHANGE.html">note-2-9-3-ppr-change</a> for a detailed discussion of this 
 change.</p> 
 
 <p>(GCL ONLY) Evaluation in a break is no longer inhibited by ACL2 when built 
 on top of GCL, so GCL now matches other Common Lisps in this respect.</p> 
 
 <p>For ACL2 built on most host Common Lisps, you will see the string <span class="v">[RAW
 LISP]</span> in the prompt, at least at a break, to emphasize that one is inside a 
 break and hence should probably quit from the break.  See <a href="ACL2____BREAKS.html">breaks</a>.</p> 
 
 <p>Jared Davis suggested improvements to lemmas <span class="v">len-update-nth</span> (in source 
 file <span class="v">axioms.lisp</span>) and <span class="v">append-true-listp-type-prescription</span> (in 
 <span class="v">books/meta/term-defuns.lisp</span>), which have been incorporated.  The former 
 required a change in <span class="v">books/workshops</span> book 
 <span class="v">2004/ruiz-et-al/support/q-dag-unification.cert</span>, which has been made.</p> 
 
 <p>The <a href="ACL2____PROOF-BUILDER.html">proof-builder</a> command <span class="v">rewrite</span> allows further binding of 
 free variables in hypotheses, with new optional argument 
 <span class="v">instantiate-free</span>.  proof-builder command <span class="v">show-rewrites</span> (<span class="v">sr</span>) 
 gives corresponding additional information.  Documentation for these commands 
 has been improved; see <a href="ACL2____PROOF-BUILDER-COMMANDS.html">proof-builder-commands</a>.  Thanks to John Matthews 
 and Bill Young for suggestions and feedback leading to these improvements.</p> 
 
 <p>Fixed downcase printing so that the package name of a symbol is also 
 downcased.  For example, after execution of <span class="v">(<a href="ACL2____DEFPKG.html">defpkg</a> "FOO" nil)</span> and 
 <span class="v">(set-acl2-print-case :downcase)</span>, <span class="v">'foo::ab</span> will print back as the 
 same, rather than as <span class="v">'FOO::ab</span>.</p> 
 
 <p>It is now possible to control the output so that numbers are printed in 
 binary, octal, or hex, though the default is still radix 10.  See <a href="ACL2____SET-PRINT-BASE.html">set-print-base</a>.  Note that in support of this change, built-in functions 
 <span class="tt"><a href="ACL2____EXPLODE-NONNEGATIVE-INTEGER.html">explode-nonnegative-integer</a></span> and <span class="v">explode-atom</span> now take an extra 
 <span class="v">print-base</span> argument.  Different support for radix conversion may be found 
 in a book newly contributed by Jun Sawada, <span class="v">books/misc/radix.lisp</span>.</p> 
 
 <p>Built-in axiom <span class="v">car-cdr-elim</span> is now only an <span class="v">:</span><span class="tt"><a href="ACL2____ELIM.html">elim</a></span> rule. 
 It was formerly both an <span class="v">:elim</span> rule and a <span class="v">:</span><span class="tt"><a href="ACL2____REWRITE.html">rewrite</a></span> rule.  A 
 new rule, <span class="v">cons-car-cdr</span>, takes the place of the old <span class="v">:rewrite</span> rule, 
 but is instead a hypothesis-free rule that can cause a case split (see source 
 file <span class="v">axioms.lisp</span>).  Thanks to Jared Davis for suggesting this change.</p> 
 
 <p>Lemmas about <span class="tt"><a href="ACL2____ALPHORDER.html">alphorder</a></span> (<span class="v">alphorder-reflexive</span>, 
 <span class="v">alphorder-transitive</span>, <span class="v">alphorder-anti-symmetric</span>, and 
 <span class="v">alphorder-total</span>) are now available.  (They had been <span class="tt"><a href="ACL2____LOCAL.html">local</a></span> in 
 source file <span class="v">axioms.lisp</span>.)  Thanks to Serita Nelesen for bringing this 
 issue to our attention.</p> 
 
 <p>ACL2 has, for some time, printed a space in the event summary after the 
 open parenthesis for a <span class="tt"><a href="ACL2____DEFTHM.html">defthm</a></span> event, in order to ease backward 
 searching for the original form, for example <span class="v">(<a href="ACL2____DEFTHM.html">defthm</a> bar ...)</span>:</p> 
 
 <pre class="code">Form:  ( DEFTHM BAR ...)</pre> 
 
 <p>The intention was that this extra space should be printed for every event 
 form; but it was missing in some cases, for example, for <span class="tt"><a href="ACL2____VERIFY-GUARDS.html">verify-guards</a></span>.  This has been fixed.</p> 
 
 <p>In analogy to <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span>, now <span class="tt"><a href="ACL2____LD.html">ld</a></span> takes the (optional) 
 keyword argument <span class="v">:dir</span>.  Thanks to Jared Davis for providing an 
 implementation of this feature and to Eric Smith and Jeff Marshall for 
 requesting this feature.</p> 
 
 <p>We fixed a bug in <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> that could cause an error when 
 redefinition is on, for example:</p> 
 
 <pre class="code">(<a href="ACL2____SET-LD-REDEFINITION-ACTION.html">set-ld-redefinition-action</a> '(:warn! . :overwrite) state)
(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "/u/acl2/books/arithmetic/top")</pre> 
 
 <p>The behavior of <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> now matches the documentation: 
 handling of compiled files for uncertified <a href="ACL2____BOOKS.html">books</a> will follow the same 
 rules as for certified books.  In particular, if you create an object file in 
 raw Lisp for some book, then including that book will load that object file. 
 Thanks to Jared Davis for bringing this issue to our attention.</p> 
 
 <p>New documentation explains the interaction of redefinition and redundancy. 
 See <a href="ACL2____REDUNDANT-EVENTS.html">redundant-events</a> â€” the ``Note About Unfortunate 
 Redundancies'' is new.  Thanks to Grant Passmore for providing examples that 
 led us to write this additional documentation.</p> 
 
 <p>Solutions to exercises in <a href="http://www.cs.utexas.edu/users/moore/publications/how-to-prove-thms" target="_blank"><nobr> 
 How To Prove Theorems Formally<img src="../Icon_External_Link.png" title="External link to http://www.cs.utexas.edu/users/moore/publications/how-to-prove-thms"></nobr></a> are now available in distributed book 
 <span class="v">books/misc/how-to-prove-thms.lisp</span>.  Also in that directory may be found a 
 new book <span class="v">hanoi.lisp</span> that contains a solution to the Towers of Hanoi 
 problem.</p>
</body>
</html>
