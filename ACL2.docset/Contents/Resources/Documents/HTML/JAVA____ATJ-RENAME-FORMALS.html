<html>
<head>
<meta charset="UTF-8">
<title>Atj-rename-formals</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=JAVA____ATJ-RENAME-FORMALS">Click for Atj-rename-formals in the Full Manual</a></h3>

<p>Rename the formal parameters of 
          a defined function or lambda expression.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(atj-rename-formals formals renaming-new renaming-old 
                    indices curr-pkg vars-by-name) 
 
   
(mv new-formals new-renaming-new new-renaming-old new-indices)</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">formals</span>  <font color="#606060">Guard <span class="v">(<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> formals)</span>.</font>
</dd> 
  <dd>
<span class="tt">renaming-new</span>  <font color="#606060">Guard <span class="v">(<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> renaming-new)</span>.</font>
</dd> 
  <dd>
<span class="tt">renaming-old</span>  <font color="#606060">Guard <span class="v">(<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> renaming-old)</span>.</font>
</dd> 
  <dd>
<span class="tt">indices</span>  <font color="#606060">Guard <span class="v">(<a href="ACL2____SYMBOL-POS-ALISTP.html">symbol-pos-alistp</a> indices)</span>.</font>
</dd> 
  <dd>
<span class="tt">curr-pkg</span>  <font color="#606060">Guard <span class="v">(<a href="COMMON-LISP____STRINGP.html">stringp</a> curr-pkg)</span>.</font>
</dd> 
  <dd>
<span class="tt">vars-by-name</span>  <font color="#606060">Guard <span class="v">(<a href="ACL2____STRING-SYMBOLLIST-ALISTP.html">string-symbollist-alistp</a> vars-by-name)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">new-formals</span>  <font color="#606060">Type <span class="v">(<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> new-formals)</span>, given <span class="v">(<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> formals) (<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> renaming-new))</span>.</font>
</dd> 
<dd>
<span class="tt">new-renaming-new</span>  <font color="#606060">Type <span class="v">(<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> new-renaming-new)</span>, given <span class="v">(<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> formals) (<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> renaming-new))</span>.</font>
</dd> 
<dd>
<span class="tt">new-renaming-old</span>  <font color="#606060">Type <span class="v">(<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> new-renaming-old)</span>, given <span class="v">(<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> formals) (<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> renaming-old))</span>.</font>
</dd> 
<dd>
<span class="tt">new-indices</span>  <font color="#606060">Type <span class="v">(<a href="ACL2____SYMBOL-POS-ALISTP.html">symbol-pos-alistp</a> new-indices)</span>, given <span class="v">(<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> formals) (<a href="ACL2____SYMBOL-POS-ALISTP.html">symbol-pos-alistp</a> indices))</span>.</font>
</dd> 
 
</dl></div> 
<p>As explained in <span class="tt"><a href="JAVA____ATJ-RENAME-FORMAL.html">atj-rename-formal</a></span>, 
     the shallowly embedded ACL2 variables are made unique via indices. 
     There is an independent index for each ACL2 variable, 
     so we use an alist from symbols to natural numbers 
     to keep track of these indices. 
     This alist is threaded through the functions 
     that rename all the variables in ACL2 terms. 
     This pre-translation step happens 
     after the type annotation and new/old marking step, 
     but the variables in this alist are without annotations and markings, 
     because annotations and markings are discarded 
     when generating Java variables, 
     and thus two ACL2 variables that only differ in annotations or markings 
     must be renamed apart and must share the same index in the alist.</p><p>In ACL2, a variable is ``introduced'' 
     as a formal parameter of a function or lambda expression, 
     and then referenced in the body of the function or lambda expression. 
     The choice and use of the index must be done at this introduction time, 
     and not at every reference to the variable after its introduction. 
     Thus, when we encounter the formals of a function or lambda expression, 
     we generate the Java variable names for these ACL2 variables, 
     using the current indices, and update and return the indices. 
     This is the case only if the formal parameter is marked as `new'; 
     if instead it is marked as `old', 
     we look it up in a renaming map, 
     which is an alist from the old variable names to the new variable names, 
     i.e. it expresses the current renaming of variables. 
     There are actually two renaming alists: 
     one for the variables marked as `new', 
     and one for the variables marked as `old': 
     see <span class="tt"><a href="JAVA____ATJ-RENAME-TERM.html">atj-rename-term</a></span> for more information. 
     This function takes both renaming maps, 
     and augments both of them with the renamings for the formal parameters 
     that are marked as `new'. 
     The variables in the renaming maps are all type-annotated, 
     for faster lookup when renaming variables in terms. 
     The variables in the renaming maps are not marked as `new' or `old'; 
     as mentioned above, we have two separate maps for new and old variables.</p><p>Each ACL2 formal parameter in the input list 
     is processed differently based on whether it is marked `new' or `old'. 
     If it is marked `old', 
     it is simply renamed according to the <span class="v">renaming-old</span> alist, 
     which must include an entry for the variable. 
     When it is marked as `new', 
     it is unmarked and unannotated and passed to <span class="tt"><a href="JAVA____ATJ-RENAME-FORMAL.html">atj-rename-formal</a></span>, 
     which uses and updates the index associated to the variable.</p><p>The formals <span class="v">formals</span> being renamed are annotated, 
     because this pre-translation step happens after the type annotation step. 
     Thus, the type annotations are removed prior to the renaming 
     and added back after the renaming.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>atj-rename-formals</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 atj-rename-formals
 (<a href="ACL2____FORMALS.html">formals</a> renaming-new renaming-old
          indices curr-pkg vars-by-name)
 (<a href="COMMON-LISP____DECLARE.html">declare</a>
      (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> formals)
                         (<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> renaming-new)
                         (<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> renaming-old)
                         (<a href="ACL2____SYMBOL-POS-ALISTP.html">symbol-pos-alistp</a> indices)
                         (<a href="COMMON-LISP____STRINGP.html">stringp</a> curr-pkg)
                         (<a href="ACL2____STRING-SYMBOLLIST-ALISTP.html">string-symbollist-alistp</a> vars-by-name))))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> curr-pkg ""))))
 (<a href="COMMON-LISP____LET.html">let</a>
   ((__function__ 'atj-rename-formals))
   (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
   (<a href="ACL2____B_A2.html">b*</a> (((when (<a href="COMMON-LISP____ENDP.html">endp</a> formals))
         (<a href="ACL2____MV.html">mv</a> nil renaming-new renaming-old indices))
        (formal (<a href="COMMON-LISP____CAR.html">car</a> formals))
        ((<a href="ACL2____MV.html">mv</a> uformal new?)
         (<a href="JAVA____ATJ-UNMARK-VAR.html">atj-unmark-var</a> formal))
        ((when (<a href="COMMON-LISP____NOT.html">not</a> new?))
         (<a href="ACL2____B_A2.html">b*</a> ((renaming-pair (<a href="ACL2____ASSOC-EQ.html">assoc-eq</a> uformal renaming-old))
              ((unless (<a href="COMMON-LISP____CONSP.html">consp</a> renaming-pair))
               (<a href="ACL2____RAISE.html">raise</a> "Internal error: ~x0 has no renaming."
                      formal)
               (<a href="ACL2____MV.html">mv</a> (<a href="ACL2____TRUE-LIST-FIX.html">true-list-fix</a> formals)
                   renaming-new renaming-old indices))
              (new-uformal (<a href="COMMON-LISP____CDR.html">cdr</a> renaming-pair))
              (new-formal (<a href="JAVA____ATJ-MARK-VAR-OLD.html">atj-mark-var-old</a> new-uformal))
              ((<a href="ACL2____MV.html">mv</a> new-formals
                   renaming-new renaming-old indices)
               (<a href="JAVA____ATJ-RENAME-FORMALS.html">atj-rename-formals</a> (<a href="COMMON-LISP____CDR.html">cdr</a> formals)
                                   renaming-new renaming-old
                                   indices curr-pkg vars-by-name)))
             (<a href="ACL2____MV.html">mv</a> (<a href="COMMON-LISP____CONS.html">cons</a> new-formal new-formals)
                 renaming-new renaming-old indices)))
        ((<a href="ACL2____MV.html">mv</a> uuformal types)
         (<a href="JAVA____ATJ-TYPE-UNANNOTATE-VAR.html">atj-type-unannotate-var</a> uformal))
        ((<a href="ACL2____MV.html">mv</a> new-uuformal indices)
         (<a href="JAVA____ATJ-RENAME-FORMAL.html">atj-rename-formal</a> uuformal indices curr-pkg vars-by-name))
        (new-uformal (<a href="JAVA____ATJ-TYPE-ANNOTATE-VAR.html">atj-type-annotate-var</a> new-uuformal types))
        (renaming-new (<a href="COMMON-LISP____ACONS.html">acons</a> uformal new-uformal renaming-new))
        (renaming-old (<a href="COMMON-LISP____ACONS.html">acons</a> uformal new-uformal renaming-old))
        (new-formal (<a href="JAVA____ATJ-MARK-VAR-NEW.html">atj-mark-var-new</a> new-uformal))
        ((<a href="ACL2____MV.html">mv</a> new-formals
             renaming-new renaming-old indices)
         (<a href="JAVA____ATJ-RENAME-FORMALS.html">atj-rename-formals</a> (<a href="COMMON-LISP____CDR.html">cdr</a> formals)
                             renaming-new renaming-old
                             indices curr-pkg vars-by-name)))
       (<a href="ACL2____MV.html">mv</a> (<a href="COMMON-LISP____CONS.html">cons</a> new-formal new-formals)
           renaming-new renaming-old indices))))</pre> 
<p><b>Theorem: </b>symbol-listp-of-atj-rename-formals.new-formals</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
    symbol-listp-of-atj-rename-formals.new-formals
    (<a href="ACL2____IMPLIES.html">implies</a>
         (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> formals)
              (<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> renaming-new))
         (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?new-formals ?new-renaming-new
                   ?new-renaming-old ?new-indices)
               (<a href="JAVA____ATJ-RENAME-FORMALS.html">atj-rename-formals</a> formals renaming-new renaming-old
                                   indices curr-pkg vars-by-name)))
             (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> new-formals)))
    :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>symbol-symbol-alistp-of-atj-rename-formals.new-renaming-new</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
    symbol-symbol-alistp-of-atj-rename-formals.new-renaming-new
    (<a href="ACL2____IMPLIES.html">implies</a>
         (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> formals)
              (<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> renaming-new))
         (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?new-formals ?new-renaming-new
                   ?new-renaming-old ?new-indices)
               (<a href="JAVA____ATJ-RENAME-FORMALS.html">atj-rename-formals</a> formals renaming-new renaming-old
                                   indices curr-pkg vars-by-name)))
             (<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> new-renaming-new)))
    :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>symbol-symbol-alistp-of-atj-rename-formals.new-renaming-old</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
    symbol-symbol-alistp-of-atj-rename-formals.new-renaming-old
    (<a href="ACL2____IMPLIES.html">implies</a>
         (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> formals)
              (<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> renaming-old))
         (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?new-formals ?new-renaming-new
                   ?new-renaming-old ?new-indices)
               (<a href="JAVA____ATJ-RENAME-FORMALS.html">atj-rename-formals</a> formals renaming-new renaming-old
                                   indices curr-pkg vars-by-name)))
             (<a href="ACL2____SYMBOL-SYMBOL-ALISTP.html">symbol-symbol-alistp</a> new-renaming-old)))
    :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>symbol-pos-alistp-of-atj-rename-formals.new-indices</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
    symbol-pos-alistp-of-atj-rename-formals.new-indices
    (<a href="ACL2____IMPLIES.html">implies</a>
         (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____SYMBOL-LISTP.html">symbol-listp</a> formals)
              (<a href="ACL2____SYMBOL-POS-ALISTP.html">symbol-pos-alistp</a> indices))
         (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?new-formals ?new-renaming-new
                   ?new-renaming-old ?new-indices)
               (<a href="JAVA____ATJ-RENAME-FORMALS.html">atj-rename-formals</a> formals renaming-new renaming-old
                                   indices curr-pkg vars-by-name)))
             (<a href="ACL2____SYMBOL-POS-ALISTP.html">symbol-pos-alistp</a> new-indices)))
    :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>true-listp-of-atj-rename-formals.new-formals</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> true-listp-of-atj-rename-formals.new-formals
        (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?new-formals ?new-renaming-new
                  ?new-renaming-old ?new-indices)
              (<a href="JAVA____ATJ-RENAME-FORMALS.html">atj-rename-formals</a> formals renaming-new renaming-old
                                  indices curr-pkg vars-by-name)))
            (<a href="ACL2____TRUE-LISTP.html">true-listp</a> new-formals))
        :rule-classes :type-prescription)</pre> 
<p><b>Theorem: </b>len-of-atj-rename-formals.new-formals</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> len-of-atj-rename-formals.new-formals
        (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?new-formals ?new-renaming-new
                  ?new-renaming-old ?new-indices)
              (<a href="JAVA____ATJ-RENAME-FORMALS.html">atj-rename-formals</a> formals renaming-new renaming-old
                                  indices curr-pkg vars-by-name)))
            (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="ACL2____LEN.html">len</a> new-formals)
                   (<a href="ACL2____LEN.html">len</a> formals))))</pre> 

</body>
</html>
