<html>
<head>
<meta charset="UTF-8">
<title>Atj-other-function-type-fn</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=JAVA____ATJ-OTHER-FUNCTION-TYPE-FN">Click for Atj-other-function-type-fn in the Full Manual</a></h3>

<p>Top-level event generated by <span class="tt"><a href="JAVA____ATJ-OTHER-FUNCTION-TYPE.html">atj-other-function-type</a></span>.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(atj-other-function-type-fn fn in-type-specs 
                            out-type-spec/specs hints wrld) 
 
  → 
event</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">hints</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____TRUE-LISTP.html">true-listp</a> hints)</span>.</font>
</dd> 
  <dd>
<span class="tt">wrld</span> — <font color="#606060">Guard <span class="v">(<a href="ACL2____PLIST-WORLDP.html">plist-worldp</a> wrld)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">event</span> — A <span class="tt"><a href="ACL2____MAYBE-PSEUDO-EVENT-FORMP.html">ACL2::maybe-pseudo-event-formp</a></span>.</dd> 
 
</dl></div> 
<p>This includes the theorem(s) stating that 
     the guard and input types imply the output type(s), 
     as well as an event to record the function type in the table.</p><p>It is an error if the function does not have a primary type already; 
     that is, <span class="tt"><a href="JAVA____ATJ-MAIN-FUNCTION-TYPE.html">atj-main-function-type</a></span> must be called 
     before calling <span class="tt"><a href="JAVA____ATJ-OTHER-FUNCTION-TYPE.html">atj-other-function-type</a></span>.</p><p>The proposed input types must be narrower than the primary input types; 
     otherwise, there would be no advantage 
     in adding these secondary input types, 
     and in generating overloaded method corresponding to these types. 
     The proposed output types must be narrower than or the same as 
     the primary output types: 
     since the primary output types are proved under the guard assumption only, 
     while the secondary output types are proved 
     with additional type hypotheses, 
     it does not make sense that the secondary output types 
     is wider than, or unrelated to, the primary output types; 
     this situation probably signals the misstatement of some types 
     to either <span class="tt"><a href="JAVA____ATJ-MAIN-FUNCTION-TYPE.html">atj-main-function-type</a></span> 
     or <span class="tt"><a href="JAVA____ATJ-OTHER-FUNCTION-TYPE.html">atj-other-function-type</a></span>.</p><p>If the proposed function type is already in the table, 
     the call of <span class="tt"><a href="JAVA____ATJ-OTHER-FUNCTION-TYPE.html">atj-other-function-type</a></span> is considered redundant 
     and no further action is taken.</p><p>We also ensure that the addition of the proposed types 
     does not cause type ambiguities: 
     see <span class="tt"><a href="JAVA____ATJ-CHECK-OTHER-FUNCTION-TYPE.html">atj-check-other-function-type</a></span> for details.</p><p>We may add additional sanity checks in the future, 
     e.g. that if the new input types are narrower than or equal to 
     some already existing secondary types, 
     then the output types must satisfy that relation too. 
     The reason is analogous to the one discussed above 
     to motivate the check against the primary output types; 
     but here we are talking about the secondary output types.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>atj-other-function-type-fn</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 atj-other-function-type-fn
 (fn in-type-specs
     out-type-spec/specs hints wrld)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="ACL2____TRUE-LISTP.html">true-listp</a> hints)
                             (<a href="ACL2____PLIST-WORLDP.html">plist-worldp</a> wrld))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'atj-other-function-type-fn))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
   (((unless (<a href="ACL2____FUNCTION-NAMEP.html">function-namep</a> fn wrld))
     (<a href="ACL2____RAISE.html">raise</a> "The first input, ~x0, must be the name of a function."
            fn))
    (<a href="ACL2____FORMALS.html">formals</a> (<a href="ACL2____FORMALS.html">formals</a> fn wrld))
    ((unless (<a href="ACL2____KEYWORD-LISTP.html">keyword-listp</a> in-type-specs))
     (<a href="ACL2____RAISE.html">raise</a>
      "The second input, ~x0, ~
                must be a list of ATJ type keywords."
      in-type-specs))
    (in-types (<a href="JAVA____ATJ-TYPE-LIST-FROM-KEYWORD-LIST.html">atj-type-list-from-keyword-list</a> in-type-specs))
    ((unless (<a href="COMMON-LISP_____D3.html">=</a> (<a href="ACL2____LEN.html">len</a> in-types) (<a href="ACL2____LEN.html">len</a> formals)))
     (<a href="ACL2____RAISE.html">raise</a>
      "The number of input types ~x0 must match ~
                the arity ~x1 of the function ~x2."
      in-type-specs (<a href="ACL2____LEN.html">len</a> formals)
      fn))
    (nresults (<a href="JAVA____ATJ-NUMBER-OF-RESULTS.html">atj-number-of-results</a> fn wrld))
    ((<a href="ACL2____MV.html">mv</a> out-types arrays)
     (<a href="COMMON-LISP____IF.html">if</a>
      (<a href="COMMON-LISP_____D3.html">=</a> nresults 1)
      (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> out-type array)
            (<a href="JAVA____ATJ-PROCESS-OUTPUT-TYPE-SPEC.html">atj-process-output-type-spec</a>
                 out-type-spec/specs formals in-types)))
          (<a href="ACL2____MV.html">mv</a> (<a href="COMMON-LISP____LIST.html">list</a> out-type) (<a href="COMMON-LISP____LIST.html">list</a> array)))
      (<a href="COMMON-LISP____IF.html">if</a>
       (<a href="ACL2____TUPLEP.html">tuplep</a> nresults out-type-spec/specs)
       (<a href="JAVA____ATJ-PROCESS-OUTPUT-TYPE-SPECS.html">atj-process-output-type-specs</a>
            out-type-spec/specs formals in-types)
       (<a href="ACL2____PROG2_42.html">prog2$</a>
        (<a href="ACL2____RAISE.html">raise</a>
         "The third input, ~x0, ~
                            must be a list of length ~x1 ~
                            of output type specifications."
         out-type-spec/specs nresults)
        (<a href="ACL2____MV.html">mv</a> nil nil)))))
    ((unless (<a href="ACL2____NO-DUPLICATESP-EQ.html">no-duplicatesp-eq</a> (<a href="ACL2____REMOVE-EQ.html">remove-eq</a> nil arrays)))
     (<a href="ACL2____RAISE.html">raise</a>
      "The list of output array names, ~x0, ~
                contains non-NIL duplicates."
      arrays))
    (fn-info? (<a href="JAVA____ATJ-GET-FUNCTION-TYPE-INFO-FROM-TABLE.html">atj-get-function-type-info-from-table</a> fn wrld))
    ((unless fn-info?)
     (<a href="ACL2____RAISE.html">raise</a>
      "The function ~x0 does not have a primary function type yet. ~
                Use ATJ-MAIN-FUNCTION-TYPE to define it, ~
                and then try again this ATJ-OTHER-FUNCTION-TYPE."
      fn))
    (main-fn-type (<a href="JAVA____ATJ-FUNCTION-TYPE-INFO-_E3MAIN.html">atj-function-type-info-&gt;main</a> fn-info?))
    (main-in-types (<a href="JAVA____ATJ-FUNCTION-TYPE-_E3INPUTS.html">atj-function-type-&gt;inputs</a> main-fn-type))
    (main-out-types (<a href="JAVA____ATJ-FUNCTION-TYPE-_E3OUTPUTS.html">atj-function-type-&gt;outputs</a> main-fn-type))
    ((unless (<a href="JAVA____ATJ-TYPE-LIST-_C3.html">atj-type-list-&lt;</a> in-types main-in-types))
     (<a href="ACL2____RAISE.html">raise</a>
      "The proposed inputs types ~x0 must be strictly narrower ~
                than the primary input types ~x1."
      in-type-specs
      (<a href="JAVA____ATJ-TYPE-LIST-TO-KEYWORD-LIST.html">atj-type-list-to-keyword-list</a> main-in-types)))
    ((unless (<a href="JAVA____ATJ-TYPE-LIST-_C3_D3.html">atj-type-list-&lt;=</a> out-types main-out-types))
     (<a href="ACL2____RAISE.html">raise</a>
      "The proposed output types ~x0 must be ~
                narrower than or equal to, ~
                the primary output types ~x1."
      out-type-spec/specs
      (<a href="JAVA____ATJ-TYPE-LIST-TO-KEYWORD-LIST.html">atj-type-list-to-keyword-list</a> main-out-types)))
    (other-fn-types (<a href="JAVA____ATJ-FUNCTION-TYPE-INFO-_E3OTHERS.html">atj-function-type-info-&gt;others</a> fn-info?))
    (new-fn-type
         (<a href="JAVA____MAKE-ATJ-FUNCTION-TYPE.html">make-atj-function-type</a> :inputs in-types
                                 :outputs out-types
                                 :arrays (<a href="ACL2____REPEAT.html">repeat</a> nresults nil)))
    ((when (<a href="ACL2____MEMBER-EQUAL.html">member-equal</a> new-fn-type other-fn-types))
     '(<a href="ACL2____VALUE-TRIPLE.html">value-triple</a> :redundant))
    (other-in-types (<a href="JAVA____ATJ-FUNCTION-TYPE-LIST-_E3INPUTS.html">atj-function-type-list-&gt;inputs</a> other-fn-types))
    (all-in-typess (<a href="COMMON-LISP____CONS.html">cons</a> in-types other-in-types))
    (<a href="COMMON-LISP____-.html">-</a> (<a href="JAVA____ATJ-CHECK-OTHER-FUNCTION-TYPE.html">atj-check-other-function-type</a>
            in-types other-fn-types all-in-typess))
    (<a href="ACL2____GUARD.html">guard</a> (<a href="ACL2____GUARD.html">guard</a> fn nil wrld))
    (thms (<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP_____D3.html">=</a> nresults 1)
              (<a href="COMMON-LISP____LIST.html">list</a> (<a href="JAVA____ATJ-OTHER-FUNCTION-TYPE-THEOREM.html">atj-other-function-type-theorem</a>
                         fn guard
                         formals in-types nil (<a href="COMMON-LISP____CAR.html">car</a> out-types)
                         hints wrld))
              (<a href="JAVA____ATJ-OTHER-FUNCTION-TYPE-THEOREMS.html">atj-other-function-type-theorems</a>
                   fn guard formals in-types
                   nresults out-types hints wrld)))
    (new-fn-info (<a href="JAVA____CHANGE-ATJ-FUNCTION-TYPE-INFO.html">change-atj-function-type-info</a>
                      fn-info?
                      :others (<a href="COMMON-LISP____CONS.html">cons</a> new-fn-type other-fn-types))))
   (<a href="COMMON-LISP____CONS.html">cons</a>
    'encapsulate
    (<a href="COMMON-LISP____CONS.html">cons</a>
     'nil
     (<a href="COMMON-LISP____CONS.html">cons</a>
      '(<a href="ACL2____SET-IGNORE-OK.html">set-ignore-ok</a> t)
      (<a href="COMMON-LISP____APPEND.html">append</a>
       thms
       (<a href="COMMON-LISP____CONS.html">cons</a>
        (<a href="COMMON-LISP____CONS.html">cons</a>
             'table
             (<a href="COMMON-LISP____CONS.html">cons</a> *atj-function-type-info-table-name*
                   (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CONS.html">cons</a> 'quote (<a href="COMMON-LISP____CONS.html">cons</a> fn 'nil))
                         (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CONS.html">cons</a> 'quote (<a href="COMMON-LISP____CONS.html">cons</a> new-fn-info 'nil))
                               'nil))))
        'nil))))))))</pre> 

</body>
</html>
