<html>
<head>
<meta charset="UTF-8">
<title>Read-*ip</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=X86ISA____READ-_A2IP">Click for Read-*ip in the Full Manual</a></h3>

<p>Read the instruction pointer from the register RIP, EIP, or IP.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(read-*ip proc-mode x86) → *ip</pre></dt>
<dt>Returns</dt>
<dd>
<span class="tt">*ip</span> — <font color="#606060">Type <span class="v">(<a href="X86ISA____I48P.html">i48p</a> *ip)</span>, given <span class="v">(x86p x86)</span>.</font>
</dd> 
 
</dl></div> 
<p> 
     In 64-bit mode, a 64-bit instruction pointer is read from the full RIP. 
     Since, in the model, this is a 48-bit signed integer, 
     this function returns a 48-bit signed integer. 
     </p> 
     <p> 
     In 32-bit mode, a 32-bit or 16-bit instruction pointer is read from 
     EIP (i.e. the low 32 bits of RIP) 
     or IP (i.e. the low 16 bits of RIP), 
     based on the CS.D bit, 
     i.e. the D bit of the current code segment descriptor. 
     Either way, this function returns an unsigned 32-bit or 16-bit integer, 
     which is also a signed 48-bit integer. 
     </p> 
     <p> 
     See AMD manual, Oct'13, Vol. 1, Sec. 2.2.4 and Sec. 2.5. 
     AMD manual, Apr'16, Vol. 2, Sec 4.7.2., 
     and Intel manual, Mar'17, Vol. 1, Sec. 3.6. 
     </p> 
     <p> 
     In 32-bit mode, the address-size override prefix (if present) 
     should not affect the instruction pointer size. 
     It does not seem to make sense 
     to change the instruction pointer size on a per-instruction basis. 
     </p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>read-*ip$inline</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 read-*ip$inline (proc-mode x86)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :stobjs (x86)))
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____TYPE.html">type</a> (integer 0 4) proc-mode))
 (<a href="ACL2____B_A2.html">b*</a>
  ((*ip (<a href="COMMON-LISP____THE.html">the</a> (signed-byte 48) (rip x86))))
  (<a href="COMMON-LISP____CASE.html">case</a>
   proc-mode (0 *ip)
   (1
    (<a href="ACL2____B_A2.html">b*</a> (((<a href="COMMON-LISP____THE.html">the</a> (unsigned-byte 16) cs-attr)
          (seg-hidden-attri 1 x86))
         (cs.d (<a href="X86ISA____CODE-SEGMENT-DESCRIPTOR-ATTRIBUTESBITS-_E3D.html">code-segment-descriptor-attributesbits-&gt;d</a> cs-attr)))
        (<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP_____D3.html">=</a> cs.d 1) (<a href="X86ISA____N32.html">n32</a> *ip) (<a href="X86ISA____N16.html">n16</a> *ip))))
   (otherwise 0))))</pre> 
<p><b>Theorem: </b>i48p-of-read-*ip</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> i48p-of-read-*ip
        (<a href="ACL2____IMPLIES.html">implies</a> (x86p x86)
                 (<a href="ACL2____B_A2.html">b*</a> ((*ip (read-*ip$inline proc-mode x86)))
                     (<a href="X86ISA____I48P.html">i48p</a> *ip)))
        :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>read-*ip-is-i48p</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 read-*ip-is-i48p
 (<a href="ACL2____IMPLIES.html">implies</a> (x86p x86)
          (<a href="ACL2____SIGNED-BYTE-P.html">signed-byte-p</a> 48 (<a href="X86ISA____READ-_A2IP.html">read-*ip</a> proc-mode x86)))
 :rule-classes
 (:rewrite
  (:type-prescription
      :corollary (<a href="ACL2____IMPLIES.html">implies</a> (x86p x86)
                          (<a href="COMMON-LISP____INTEGERP.html">integerp</a> (<a href="X86ISA____READ-_A2IP.html">read-*ip</a> proc-mode x86)))
      :hints (("Goal" :in-theory '(<a href="ACL2____SIGNED-BYTE-P.html">signed-byte-p</a> integer-range-p))))
  (:linear
    :corollary (<a href="ACL2____IMPLIES.html">implies</a> (x86p x86)
                        (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> -140737488355328
                                 (<a href="X86ISA____READ-_A2IP.html">read-*ip</a> proc-mode x86))
                             (<a href="COMMON-LISP_____C3.html">&lt;</a> (<a href="X86ISA____READ-_A2IP.html">read-*ip</a> proc-mode x86)
                                140737488355328)))
    :hints
    (("Goal"
          :in-theory '(<a href="ACL2____SIGNED-BYTE-P.html">signed-byte-p</a> integer-range-p (:e expt)))))))</pre> 
<p><b>Theorem: </b>read-*ip-when-64-bit-modep</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> read-*ip-when-64-bit-modep
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="X86ISA____READ-_A2IP.html">read-*ip</a> 0 x86) (rip x86)))</pre> 
<p><b>Theorem: </b>read-*ip-when-not-64-bit-modep</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
 read-*ip-when-not-64-bit-modep
 (<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> proc-mode 0))
          (<a href="ACL2____UNSIGNED-BYTE-P.html">unsigned-byte-p</a> 32 (<a href="X86ISA____READ-_A2IP.html">read-*ip</a> proc-mode x86)))
 :rule-classes
 (:rewrite
  (:type-prescription
      :corollary (<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> proc-mode 0))
                          (<a href="ACL2____NATP.html">natp</a> (<a href="X86ISA____READ-_A2IP.html">read-*ip</a> proc-mode x86)))
      :hints
      (("Goal" :in-theory '(<a href="ACL2____UNSIGNED-BYTE-P.html">unsigned-byte-p</a> integer-range-p natp))))
  (:linear
   :corollary (<a href="ACL2____IMPLIES.html">implies</a> (<a href="COMMON-LISP____NOT.html">not</a> (<a href="COMMON-LISP____EQUAL.html">equal</a> proc-mode 0))
                       (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP_____C3_D3.html">&lt;=</a> 0 (<a href="X86ISA____READ-_A2IP.html">read-*ip</a> proc-mode x86))
                            (<a href="COMMON-LISP_____C3.html">&lt;</a> (<a href="X86ISA____READ-_A2IP.html">read-*ip</a> proc-mode x86)
                               4294967296)))
   :hints
   (("Goal"
        :in-theory '(<a href="ACL2____UNSIGNED-BYTE-P.html">unsigned-byte-p</a> integer-range-p (:e expt)))))))</pre> 

</body>
</html>
