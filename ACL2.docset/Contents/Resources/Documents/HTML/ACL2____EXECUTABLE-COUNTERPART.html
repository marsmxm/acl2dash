<html>
<head>
<meta charset="UTF-8">
<title>Executable-counterpart</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____EXECUTABLE-COUNTERPART">Click for Executable-counterpart in the Full Manual</a></h3>

<p>A rule for computing the value of a function</p><p>This topic is about a type of <a href="ACL2____RUNE.html">rune</a> that controls evaluation 
 using the executable-counterpart of a function.  For discussion of 
 executable-counterparts of functions, see <a href="ACL2____EVALUATION.html">evaluation</a>.</p> 
 
 <pre class="code">Example:
(:executable-counterpart length)</pre> 
 
 <p>which may be abbreviated in <a href="ACL2____THEORY.html">theory</a> expressions in either of the 
 following two ways (see <a href="ACL2____RUNE.html">rune</a>).</p> 
 
 <pre class="code">(:e length)
(<a href="COMMON-LISP____LENGTH.html">length</a>)</pre> 
 
 <p>Every <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span> introduces at least two rules used by the theorem 
 prover.  Suppose <span class="v">fn</span> is the name of a <span class="tt"><a href="COMMON-LISP____DEFUN.html">defun</a></span>'d function.  Then 
 <span class="v">(:definition fn)</span> is the rune (see <a href="ACL2____RUNE.html">rune</a>) naming the rule that 
 allows the simplifier to replace calls of <span class="v">fn</span> by its instantiated body. 
 <span class="v">(:executable-counterpart fn)</span> is the <a href="ACL2____RUNE.html">rune</a> for the rule for how to 
 evaluate the function on known constants.</p> 
 
 <p>When typing <a href="ACL2____THEORIES.html">theories</a> it is convenient to know that <span class="v">(fn)</span> is a 
 runic designator that denotes <span class="v">(:executable-counterpart fn)</span>.  See <a href="ACL2____THEORIES.html">theories</a>.</p> 
 
 <p>If <span class="v">(:executable-counterpart fn)</span> is <a href="ACL2____ENABLE.html">enable</a>d, then when 
 applications of <span class="v">fn</span> to known constants are seen by the simplifier they are 
 computed out by executing the Common Lisp code for <span class="v">fn</span> (with the 
 appropriate handling of <a href="ACL2____GUARD.html">guard</a>s).  Suppose <span class="v">fact</span> is defined as the 
 factorial function.  If the executable-counterpart <a href="ACL2____RUNE.html">rune</a> of <span class="v">fact</span>, 
 <span class="v">(:executable-counterpart fact)</span>, is <a href="ACL2____ENABLE.html">enable</a>d when the simplifier 
 encounters <span class="v">(fact 12)</span>, then that term will be ``immediately'' expanded to 
 <span class="v">479001600</span>.  Note that even if subroutines of <span class="v">fn</span> have disabled 
 executable-counterparts, <span class="v">fn</span> will call their Lisp code nonetheless: once 
 an executable-counterpart function is applied, no subsidiary enable checks are 
 made.</p> 
 
 <p>Such one-step expansions are sometimes counterproductive because they 
 prevent the anticipated application of certain lemmas about the subroutines of 
 the expanded function.  Such computed expansions can be prevented by disabling 
 the executable-counterpart <a href="ACL2____RUNE.html">rune</a> of the relevant function.  For example, 
 if <span class="v">(:executable-counterpart fact)</span> is <a href="ACL2____DISABLE.html">disable</a>d, <span class="v">(fact 12)</span> will 
 not be expanded by computation.  In this situation, <span class="v">(fact 12)</span> may be 
 rewritten to <span class="v">(<a href="COMMON-LISP_____A2.html">*</a> 12 (fact 11))</span>, using the rule named <span class="v">(:definition
 fact)</span>, provided the system's heuristics permit the introduction of the term 
 <span class="v">(fact 11)</span>.  Note that lemmas about multiplication may then be applicable 
 (while such lemmas would be inapplicable to <span class="v">479001600</span>).  In many proofs 
 it is desirable to <a href="ACL2____DISABLE.html">disable</a> the executable-counterpart <a href="ACL2____RUNE.html">rune</a>s of 
 certain functions to prevent their expansion by computation.  See <a href="ACL2____EXECUTABLE-COUNTERPART-THEORY.html">executable-counterpart-theory</a>.</p> 
 
 <p>Finally: What do we do about functions that are ``constrained'' rather than 
 defined, such as the following?  (See <a href="ACL2____ENCAPSULATE.html">encapsulate</a>.)</p> 
 
 <pre class="code">(<a href="ACL2____ENCAPSULATE.html">encapsulate</a> (((foo *) =&gt; *))
             (<a href="ACL2____LOCAL.html">local</a> (<a href="COMMON-LISP____DEFUN.html">defun</a> foo (x) x)))</pre> 
 
 <p>Does <span class="v">foo</span> have an executable-counterpart?  Yes: since the vast majority 
 of functions have sensible executable-counterparts, it was decided that 
 <b>all</b> functions, even such ``constrained'' ones, have 
 executable-counterparts.  We essentially ``trap'' when such calls are 
 inappropriate.  Thus, consider for example:</p> 
 
 <pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a> bar (x)
  (<a href="COMMON-LISP____IF.html">if</a> (<a href="COMMON-LISP____RATIONALP.html">rationalp</a> x)
      (<a href="COMMON-LISP_____B2.html">+</a> x 1)
    (foo x)))</pre> 
 
 <p>If the term <span class="v">(bar '3)</span> is encountered by the ACL2 rewriter during a 
 proof, and if the <span class="v">:executable-counterpart</span> of <span class="v">bar</span> is <a href="ACL2____ENABLE.html">enable</a>d, 
 then it will be invoked to reduce this term to <span class="v">'4</span>.  However, if the term 
 <span class="v">(bar 'a)</span> is encountered during a proof, then since <span class="v">'a</span> is not a 
 <span class="tt"><a href="COMMON-LISP____RATIONALP.html">rationalp</a></span> and since the <span class="v">:executable-counterpart</span> of <span class="v">foo</span> is 
 only a ``trap,'' then this call of the <span class="v">:executable-counterpart</span> of 
 <span class="v">bar</span> will result in a ``trap.'' In that case, the rewriter will return the 
 term <span class="v">(<a href="ACL2____HIDE.html">hide</a> (bar 'a))</span> so that it never has to go through this process 
 again.  See <a href="ACL2____HIDE.html">hide</a>.</p>
</body>
</html>
