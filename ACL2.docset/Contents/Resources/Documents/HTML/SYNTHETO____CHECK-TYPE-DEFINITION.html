<html>
<head>
<meta charset="UTF-8">
<title>Check-type-definition</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=SYNTHETO____CHECK-TYPE-DEFINITION">Click for Check-type-definition in the Full Manual</a></h3>

<p>Check if a type definition (at the top level) 
          is statically well-formed.</p><div class="box"><dl> 
  <dt>Signature</dt>
<dt><pre class="code">(check-type-definition typedef ctxt) → (mv err? obligs)</pre></dt>  <dt>Arguments</dt>  <dd>
<span class="tt">typedef</span> — <font color="#606060">Guard <span class="v">(<a href="SYNTHETO____TYPE-DEFINITIONP.html">type-definitionp</a> typedef)</span>.</font>
</dd> 
  <dd>
<span class="tt">ctxt</span> — <font color="#606060">Guard <span class="v">(<a href="SYNTHETO____CONTEXTP.html">contextp</a> ctxt)</span>.</font>
</dd> 
<dt>Returns</dt>
<dd>
<span class="tt">obligs</span> — <font color="#606060">Type <span class="v">(<a href="SYNTHETO____PROOF-OBLIGATION-LISTP.html">proof-obligation-listp</a> obligs)</span>.</font>
</dd> 
 
</dl></div> 
<p>This is used on top-level type definitions; 
     we use <span class="tt"><a href="SYNTHETO____CHECK-TYPE-DEFINITION-IN-RECURSION.html">check-type-definition-in-recursion</a></span> 
     for type definitions in type recursions.</p><p>At the top level, the context has no 
     types being defined, 
     functions being defined, 
     variables in scope, 
     obligation variables, or 
     obligation hypotheses. 
     This motivates the extra guard condition of this ACL2 function.</p><p>We ensure that the type being defined here is not already defined. 
     In order to allow (singly) recursive type definitions, 
     we augment the context with the name of the type being defined, 
     and then we check the definition body. 
     For now we allow any form of recursion, 
     but we will add checks to constrain it to be well-formed, 
     so that we can generate a termination proof 
     when we translate the type definition to ACL2. 
     (For now, ACL2 will stop with an error 
     if it cannot automatically prove termination.</p> 
 
<h3>Definitions and Theorems</h3><p><b>Function: </b>check-type-definition</p><pre class="code">(<a href="COMMON-LISP____DEFUN.html">defun</a>
 check-type-definition (typedef ctxt)
 (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="SYNTHETO____TYPE-DEFINITIONP.html">type-definitionp</a> typedef)
                             (<a href="SYNTHETO____CONTEXTP.html">contextp</a> ctxt))))
 (<a href="COMMON-LISP____DECLARE.html">declare</a>
      (<a href="ACL2____XARGS.html">xargs</a> :guard (<a href="COMMON-LISP____AND.html">and</a> (<a href="COMMON-LISP____NULL.html">null</a> (<a href="SYNTHETO____CONTEXT-_E3TYPES.html">context-&gt;types</a> ctxt))
                         (<a href="COMMON-LISP____NULL.html">null</a> (<a href="SYNTHETO____CONTEXT-_E3FUNCTIONS.html">context-&gt;functions</a> ctxt))
                         (<a href="OMAP____EMPTY.html">omap::empty</a> (<a href="SYNTHETO____CONTEXT-_E3VARIABLES.html">context-&gt;variables</a> ctxt))
                         (<a href="COMMON-LISP____NULL.html">null</a> (<a href="SYNTHETO____CONTEXT-_E3OBLIGATION-VARS.html">context-&gt;obligation-vars</a> ctxt))
                         (<a href="COMMON-LISP____NULL.html">null</a> (<a href="SYNTHETO____CONTEXT-_E3OBLIGATION-HYPS.html">context-&gt;obligation-hyps</a> ctxt)))))
 (<a href="COMMON-LISP____LET.html">let</a>
  ((__function__ 'check-type-definition))
  (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="COMMON-LISP____IGNORABLE.html">ignorable</a> __function__))
  (<a href="ACL2____B_A2.html">b*</a>
    (((<a href="SYNTHETO____TYPE-DEFINITION.html">type-definition</a> typedef) typedef)
     ((when (<a href="SYNTHETO____GET-TYPE-DEFINITION.html">get-type-definition</a> typedef.name (<a href="SYNTHETO____CONTEXT-_E3TOPS.html">context-&gt;tops</a> ctxt)))
      (<a href="ACL2____MV.html">mv</a> (<a href="COMMON-LISP____LIST.html">list</a> :type-already-defined typedef.name)
          nil))
     (ctxt (<a href="SYNTHETO____CHANGE-CONTEXT.html">change-context</a>
                ctxt
                :types (<a href="COMMON-LISP____CONS.html">cons</a> typedef.name (<a href="SYNTHETO____CONTEXT-_E3TYPES.html">context-&gt;types</a> ctxt)))))
    (<a href="SYNTHETO____CHECK-TYPE-DEFINER.html">check-type-definer</a> typedef.body ctxt))))</pre> 
<p><b>Theorem: </b>proof-obligation-listp-of-check-type-definition.obligs</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> proof-obligation-listp-of-check-type-definition.obligs
        (<a href="ACL2____B_A2.html">b*</a> (((<a href="ACL2____MV.html">mv</a> ?err? ?obligs)
              (<a href="SYNTHETO____CHECK-TYPE-DEFINITION.html">check-type-definition</a> typedef ctxt)))
            (<a href="SYNTHETO____PROOF-OBLIGATION-LISTP.html">proof-obligation-listp</a> obligs))
        :rule-classes :rewrite)</pre> 
<p><b>Theorem: </b>check-type-definition-of-type-definition-fix-typedef</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> check-type-definition-of-type-definition-fix-typedef
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="SYNTHETO____CHECK-TYPE-DEFINITION.html">check-type-definition</a> (<a href="SYNTHETO____TYPE-DEFINITION-FIX.html">type-definition-fix</a> typedef)
                                      ctxt)
               (<a href="SYNTHETO____CHECK-TYPE-DEFINITION.html">check-type-definition</a> typedef ctxt)))</pre> 
<p><b>Theorem: </b>check-type-definition-type-definition-equiv-congruence-on-typedef</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a>
   check-type-definition-type-definition-equiv-congruence-on-typedef
   (<a href="ACL2____IMPLIES.html">implies</a> (<a href="SYNTHETO____TYPE-DEFINITION-EQUIV.html">type-definition-equiv</a> typedef typedef-equiv)
            (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="SYNTHETO____CHECK-TYPE-DEFINITION.html">check-type-definition</a> typedef ctxt)
                   (<a href="SYNTHETO____CHECK-TYPE-DEFINITION.html">check-type-definition</a> typedef-equiv ctxt)))
   :rule-classes :congruence)</pre> 
<p><b>Theorem: </b>check-type-definition-of-context-fix-ctxt</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> check-type-definition-of-context-fix-ctxt
        (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="SYNTHETO____CHECK-TYPE-DEFINITION.html">check-type-definition</a> typedef (<a href="SYNTHETO____CONTEXT-FIX.html">context-fix</a> ctxt))
               (<a href="SYNTHETO____CHECK-TYPE-DEFINITION.html">check-type-definition</a> typedef ctxt)))</pre> 
<p><b>Theorem: </b>check-type-definition-context-equiv-congruence-on-ctxt</p><pre class="code">(<a href="ACL2____DEFTHM.html">defthm</a> check-type-definition-context-equiv-congruence-on-ctxt
        (<a href="ACL2____IMPLIES.html">implies</a> (<a href="SYNTHETO____CONTEXT-EQUIV.html">context-equiv</a> ctxt ctxt-equiv)
                 (<a href="COMMON-LISP____EQUAL.html">equal</a> (<a href="SYNTHETO____CHECK-TYPE-DEFINITION.html">check-type-definition</a> typedef ctxt)
                        (<a href="SYNTHETO____CHECK-TYPE-DEFINITION.html">check-type-definition</a> typedef ctxt-equiv)))
        :rule-classes :congruence)</pre> 

</body>
</html>
