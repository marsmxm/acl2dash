<html>
<head>
<meta charset="UTF-8">
<title>Trust-mfc</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____TRUST-MFC">Click for Trust-mfc in the Full Manual</a></h3>

<p>A macro that supports testing of extended metafunctions)</p> <pre class="code">Example Form:
(<a href="ACL2____TRUST-MFC.html">trust-mfc</a> (<a href="ACL2____MFC-TS.html">mfc-ts</a> term mfc state))

General Form:
(<a href="ACL2____TRUST-MFC.html">trust-mfc</a> form)</pre> 
 
 <p>where <span class="v">form</span> is any form, but is typically a call of an extended 
 metafunction such as <span class="v">mfc-ts</span> or <span class="v">mfc-rw</span>.</p> 
 
 <p>Extended metafunctions (see <a href="ACL2____EXTENDED-METAFUNCTIONS.html">extended-metafunctions</a>) may 
 normally only be invoked during proofs.  <span class="v">Trust-mfc</span> is an advanced utility 
 that relaxes that requirement, thus supporting the testing of 
 extended-metafunctions outside calls of the ACL2 prover.  When you use 
 <span class="v">trust-mfc</span>, you are taking on the responsibility to pass only well-formed 
 <span class="tt"><a href="ACL2____MFC.html">mfc</a></span> arguments to your calls of extended-metafunctions, since otherwise 
 raw Lisp errors may be signaled.  Because of this danger, the logical 
 definition of <span class="v">trust-mfc</span> causes an error, thus making it useless at the 
 top level and in <span class="v">:</span><span class="tt"><a href="ACL2____LOGIC.html">logic</a></span>-mode code:</p> 
 
 <p><b>Macro: </b>trust-mfc</p><pre class="code">(<a href="COMMON-LISP____DEFMACRO.html">defmacro</a>
 trust-mfc (<a href="COMMON-LISP_____62WHOLE.html">&amp;whole</a> whole form)
 (<a href="COMMON-LISP____CONS.html">cons</a>
  'prog2$
  (<a href="COMMON-LISP____CONS.html">cons</a>
   (<a href="COMMON-LISP____CONS.html">cons</a>
    'er
    (<a href="COMMON-LISP____CONS.html">cons</a>
     'hard
     (<a href="COMMON-LISP____CONS.html">cons</a>
      ''trust-mfc
      (<a href="COMMON-LISP____CONS.html">cons</a>
       '"It is illegal to run ~x0 except in raw Lisp, ~
                                 typically by way of a :program-mode function ~
                                 body. ~ See :DOC trust-mfc.  Evaluation of ~
                                 the form ~x1 has led to this error."
       (<a href="COMMON-LISP____CONS.html">cons</a> ''trust-mfc
             (<a href="COMMON-LISP____CONS.html">cons</a> (<a href="COMMON-LISP____CONS.html">cons</a> 'quote (<a href="COMMON-LISP____CONS.html">cons</a> whole 'nil))
                   'nil))))))
   (<a href="COMMON-LISP____CONS.html">cons</a> form 'nil))))</pre> 
 
 <p>However, <span class="v">trust-mfc</span> can be very useful when used in <span class="v">:</span><span class="tt"><a href="ACL2____PROGRAM.html">program</a></span>-mode code that calls extended metafunctions, which makes it useful 
 for <span class="v">:logic</span>-mode code as well; see <a href="ACL2____PROGRAM-WRAPPER.html">program-wrapper</a>.  The log below 
 illustrates typical usage.</p> 
 
 <pre class="code">ACL2 !&gt;(<a href="COMMON-LISP____DEFUN.html">defun</a> my-mfc (<a href="ACL2____STATE.html">state</a>)
         ;; Define a simple metafunction-contextx.
         (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :mode :program :guard t :stobjs state))
         (<a href="ACL2____MAKE.html">make</a> metafunction-context
               :rdepth 10000
               :type-alist nil
               :obj '?
               :geneqv nil
               :wrld (<a href="ACL2____W.html">w</a> state)
               :fnstack nil
               :ancestors nil
               :backchain-limit nil
               :simplify-clause-pot-lst nil
               :rcnst (initial-rcnst-from-ens (ens state) (<a href="ACL2____W.html">w</a> state) state nil)
               :gstack nil
               :ttree nil
               :unify-subst nil))

Summary
Form:  ( DEFUN MY-MFC ...)
Rules: NIL
Time:  0.00 seconds (prove: 0.00, print: 0.00, other: 0.00)
 MY-MFC
ACL2 !&gt;(<a href="ACL2____MFC-TS.html">mfc-ts</a> '(<a href="COMMON-LISP____CONS.html">cons</a> x y) (my-mfc state) state) ; error: not in prover


Meta-level function Problem:  This error can quite possibly be avoided;
see :DOC trust-mfc.  You or some meta-level function applied MFC-TS
but not from within the theorem prover's meta-level function handler.
This suggests you are trying to test a meta-level function and have
evidently manufactured an allegedly suitable context.  Perhaps so.
But that is so difficult to check that we don't bother.  Instead we
cause this error and urge you to test your meta-level function by having
the meta-level function handler invoke it as part of a test proof-
attempt. To do this, assume the metatheorem that you intend eventually
to prove.  You may do this by executing the appropriate DEFTHM event
embedded in a SKIP-PROOFS form.  Then use THM to submit conjectures
for proof and observe the behavior of your metafunction.  Remember
to undo the assumed metatheorem before you attempt genuine proofs!
If this suggestion isn't applicable to your situation, contact the
authors.



ACL2 Error in TOP-LEVEL:  ACL2 cannot ev the call of non-executable
function MFC-TS on argument list:

((<a href="COMMON-LISP____CONS.html">CONS</a> X Y) MFC STATE)

To debug see :DOC print-gv, see :DOC trace, and see :DOC wet.

ACL2 !&gt;(<a href="ACL2____TRUST-MFC.html">trust-mfc</a> (<a href="ACL2____MFC-TS.html">mfc-ts</a> '(<a href="COMMON-LISP____CONS.html">cons</a> x y) (my-mfc state) state)) ; top-level (bad)


HARD ACL2 ERROR in TRUST-MFC:  It is illegal to run TRUST-MFC except
in raw Lisp, typically by way of a :program-mode function body.  See
:DOC trust-mfc.  Evaluation of the form
(<a href="ACL2____TRUST-MFC.html">TRUST-MFC</a> (<a href="ACL2____MFC-TS.html">MFC-TS</a> '(<a href="COMMON-LISP____CONS.html">CONS</a> X Y) (MY-MFC STATE) STATE)) has led to this
error.



ACL2 Error in TOP-LEVEL:  Evaluation aborted.  To debug see :DOC print-
gv, see :DOC trace, and see :DOC wet.

ACL2 !&gt;(<a href="COMMON-LISP____DEFUN.html">defun</a> my-mfc-ts (<a href="ACL2____TERM.html">term</a> mfc state)
         (<a href="COMMON-LISP____DECLARE.html">declare</a> (<a href="ACL2____XARGS.html">xargs</a> :mode :program :stobjs state))
         (<a href="ACL2____TRUST-MFC.html">trust-mfc</a> (<a href="ACL2____MFC-TS.html">mfc-ts</a> term mfc state)))

Summary
Form:  ( DEFUN MY-MFC-TS ...)
Rules: NIL
Time:  0.00 seconds (prove: 0.00, print: 0.00, other: 0.00)
 MY-MFC-TS
ACL2 !&gt;(my-mfc-ts '(<a href="COMMON-LISP____CONS.html">cons</a> x y) (my-mfc state) state)
3072
ACL2 !&gt;(decode-type-set 3072) ; let's see that the result above is reasonable
*TS-CONS*
ACL2 !&gt;</pre>
</body>
</html>
