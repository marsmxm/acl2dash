<html>
<head>
<meta charset="UTF-8">
<title>Include-book</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____INCLUDE-BOOK">Click for Include-book in the Full Manual</a></h3>

<p>Load the <a href="ACL2____EVENTS.html">events</a> in a file</p><pre class="code">Examples:

; Include using relative pathnames:
(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "my-arith")
(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "/../../my-arith")

; Include using absolute pathname:
(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "/home/smith/my-arith")

; Include a community book:
(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> "arithmetic/top-with-meta" :dir :system)

General Form:
(<a href="ACL2____INCLUDE-BOOK.html">include-book</a> file :load-compiled-file action
                   :uncertified-okp t/nil/:ignore-certs  ; [default t]
                   :defaxioms-okp t/nil                  ; [default t]
                   :skip-proofs-okp t/nil                ; [default t]
                   :ttags ttags                          ; [default nil]
                   :dir directory)</pre> 
 
 <p>where <span class="v">file</span> is a book name.  See <a href="ACL2____BOOKS.html">books</a> for general information, 
 see <a href="ACL2____BOOK-NAME.html">book-name</a> for information about book names, and see <a href="COMMON-LISP____PATHNAME.html">pathname</a> 
 for information about file names.  <span class="v">Action</span> is one of <span class="v">t</span>, <span class="v">nil</span>, 
 <span class="v">:default</span>, <span class="v">:warn</span>, or <span class="v">:comp</span>; these values are explained below, 
 and the default is <span class="v">:default</span>.  The three <span class="v">-okp</span> keyword arguments, 
 which default to <span class="v">t</span>, determine whether errors or warnings are generated 
 under certain conditions explained below; when the argument is <span class="v">t</span>, 
 warnings are generated.  The <span class="v">dir</span> argument, if supplied, is a keyword that 
 represents an absolute pathname for a directory (see <a href="COMMON-LISP____PATHNAME.html">pathname</a>), to be 
 used instead of the current book directory (see <a href="ACL2____CBD.html">cbd</a>) for resolving the 
 given <span class="v">file</span> argument to an absolute pathname.  In particular, by default 
 <span class="v">:dir :system</span> resolves <span class="v">file</span> using the <span class="v">books/</span> directory of your 
 ACL2 installation, unless your ACL2 executable was built somewhere other than 
 where it currently resides; please see the ``Books Directory'' below.  To 
 define other keywords that can be used for <span class="v">dir</span>, see <a href="ACL2____ADD-INCLUDE-BOOK-DIR.html">add-include-book-dir</a>.  If the book has no <a href="ACL2____CERTIFICATE.html">certificate</a>, if its 
 certificate is invalid (say, because its <a href="ACL2____BOOK-HASH.html">book-hash</a> shows that books 
 have changed after their certification), or if the certificate was produced by 
 a different <a href="ACL2____VERSION.html">version</a> of ACL2, a warning is printed and the book is 
 included anyway; see <a href="ACL2____CERTIFICATE.html">certificate</a>.  This can lead to serious errors, 
 perhaps mitigated by the presence of a <span class="v">.port</span> file from an earlier 
 certification; see <a href="ACL2____UNCERTIFIED-BOOKS.html">uncertified-books</a>.  If the portcullis of the <a href="ACL2____CERTIFICATE.html">certificate</a> (see <a href="ACL2____PORTCULLIS.html">portcullis</a>) cannot be raised in the host logical 
 <a href="ACL2____WORLD.html">world</a>, an error is caused and no change occurs to the logic. 
 Otherwise, the non-<span class="tt"><a href="ACL2____LOCAL.html">local</a></span> <a href="ACL2____EVENTS.html">events</a> in file are assumed.  Then the 
 <a href="ACL2____KEEP.html">keep</a> of the <a href="ACL2____CERTIFICATE.html">certificate</a> is checked to ensure that the correct 
 files were read; see <a href="ACL2____KEEP.html">keep</a>.  A warning is printed if uncertified <a href="ACL2____BOOKS.html">books</a> were included.  Even if no warning is printed, <span class="v">include-book</span> places 
 a burden on you; see <a href="ACL2____CERTIFICATE.html">certificate</a>.</p> 
 
 <p>If you use <a href="ACL2____GUARD.html">guard</a>s, please note <span class="v">include-book</span> is executed as 
 though <span class="v">(<a href="ACL2____SET-GUARD-CHECKING.html">set-guard-checking</a> t)</span> has been evaluated; see <a href="ACL2____SET-GUARD-CHECKING.html">set-guard-checking</a>.  If you want to run with different guard-checking, 
 consider using <span class="v">ld</span> instead, or in addition; see <a href="ACL2____LD.html">ld</a>.</p> 
 
 <p>The value of <span class="v">:load-compiled-file</span> controls whether a compiled file for 
 the given <span class="v">file</span> is loaded by <span class="v">include-book</span>.  Note that this keyword 
 applies only to the given <span class="v">file</span>, not to any included sub-books.  In order 
 to skip loading all compiled files, for the given <span class="v">file</span> as well as all 
 included sub-books — for example, to avoid Lisp errors such as ``Wrong 
 FASL version'' — use <span class="v">(<a href="ACL2____SET-COMPILER-ENABLED.html">set-compiler-enabled</a> nil state)</span>; see <a href="ACL2____COMPILATION.html">compilation</a>.  Otherwise, if keyword argument <span class="v">:load-compiled-file</span> is 
 missing or its value is the keyword <span class="v">:default</span>, then it is treated as 
 <span class="v">:warn</span>.  If its value is <span class="v">nil</span>, no attempt is made to load the compiled 
 file for the book provided.  In order to load the compiled file, it must be 
 more recent than the book's <a href="ACL2____CERTIFICATE.html">certificate</a> (except in raw mode, where it 
 must be more recent than the book itself; see <a href="ACL2____SET-RAW-MODE.html">set-raw-mode</a>).  For 
 non-<span class="v">nil</span> values of <span class="v">:load-compiled-file</span> that do not result in a loaded 
 compiled file, ACL2 proceeds as follows.  Note that a load of a compiled file 
 or expansion file aborts partway through whenever an <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> form 
 is encountered for which no suitable compiled or expansion file can be loaded. 
 For much more detail, see <a href="ACL2____BOOK-COMPILED-FILE.html">book-compiled-file</a>.</p> 
 
 <blockquote> 
 
 <p><span class="v">t</span>: Cause an error if the compiled file is not loaded.  This same 
 requirement is imposed on every <span class="tt"><a href="ACL2____INCLUDE-BOOK.html">include-book</a></span> form evaluated during the 
 course of evaluation of the present <span class="v">include-book</span> form, except that for 
 those subsidiary <span class="v">include-book</span>s that do not themselves specify 
 <span class="v">:load-compiled-file t</span>, it suffices to load the expansion file (see <a href="ACL2____BOOK-COMPILED-FILE.html">book-compiled-file</a>).</p> 
 
 <p><span class="v">:warn</span>: An attempt is made to load the compiled file, and a warning is 
 printed if that load fails to run to completion.</p> 
 
 <p><span class="v">:comp</span>: A compiled file is loaded as with value <span class="v">t</span>, except that if 
 a suitable ``expansion file'' exists but the compiled file does not, then the 
 compiled file is first created.  See <a href="ACL2____BOOK-COMPILED-FILE.html">book-compiled-file</a>.</p>
</blockquote> 
 
 <p>The three <span class="v">-okp</span> arguments, <span class="v">:uncertified-okp</span>, <span class="v">defaxioms-okp</span>, 
 and <span class="v">skip-proofs-okp</span>, determine the system's behavior when the book or any 
 sub-book is found to be uncertified, when the book or any sub-book is found to 
 contain <span class="tt"><a href="ACL2____DEFAXIOM.html">defaxiom</a></span> events, and when the book or any sub-book is found to 
 contain <span class="tt"><a href="ACL2____SKIP-PROOFS.html">skip-proofs</a></span> events, respectively.  All three default to 
 <span class="v">t</span>, which means it is ``ok'' for the condition to arise.  In this case, a 
 warning is printed but the processing to load the book is allowed to proceed. 
 When one of these arguments is <span class="v">nil</span> and the corresponding condition 
 arises, an error is signaled and processing is aborted.  <b>Exceptions</b>: 
 <span class="v">:uncertified-okp t</span> is ignored if the <span class="v">include-book</span> is being performed 
 on behalf of a <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span>, and <span class="v">:uncertified-okp :ignore-certs</span> 
 is an advanced option explained later in this topic.</p> 
 
 <p>The keyword argument <span class="v">:ttags</span> may normally be omitted.  A few 
 constructs, used for example if you are building your own system based on 
 ACL2, may require it.  See <a href="ACL2____DEFTTAG.html">defttag</a> for an explanation of this 
 argument.</p> 
 
 <p><span class="v">Include-book</span> is similar in spirit to <span class="tt"><a href="ACL2____ENCAPSULATE.html">encapsulate</a></span> in that it is 
 a single event that ``contains'' other <a href="ACL2____EVENTS.html">events</a>, in this case the <a href="ACL2____EVENTS.html">events</a> listed in the file named.  <span class="v">Include-book</span> processes the non-<span class="tt"><a href="ACL2____LOCAL.html">local</a></span> event forms in the file, assuming that each is admissible.  <span class="tt"><a href="ACL2____LOCAL.html">Local</a></span> <a href="ACL2____EVENTS.html">events</a> in the file are ignored.  You may use <span class="v">include-book</span> 
 to load several <a href="ACL2____BOOKS.html">books</a>, creating the logical <a href="ACL2____WORLD.html">world</a> that contains 
 the definitions and theorems of all of them.</p> 
 
 <p>If any non-<span class="tt"><a href="ACL2____LOCAL.html">local</a></span> event of the book attempts to define a <a href="ACL2____NAME.html">name</a> 
 that has already been defined — and the book's definition is not 
 syntactically identical to the existing definition — the attempt to 
 include the book fails, an error message is printed, and no change to the 
 logical <a href="ACL2____WORLD.html">world</a> occurs.  See <a href="ACL2____REDUNDANT-EVENTS.html">redundant-events</a> for the details.</p> 
 
 <p>When a book is included, the default <a href="ACL2____DEFUN-MODE.html">defun-mode</a> (see <a href="ACL2____DEFAULT-DEFUN-MODE.html">default-defun-mode</a>) for the first event is always <span class="v">:</span><span class="tt"><a href="ACL2____LOGIC.html">logic</a></span>.  That 
 is, the default <a href="ACL2____DEFUN-MODE.html">defun-mode</a> ``outside'' the book — in the 
 environment in which <span class="v">include-book</span> was called — is irrelevant to the 
 book.  <a href="ACL2____EVENTS.html">Events</a> that change the <a href="ACL2____DEFUN-MODE.html">defun-mode</a> are permitted within a 
 book (provided they are not in <span class="tt"><a href="ACL2____LOCAL.html">local</a></span> forms).  However, such changes 
 within a book are not exported, i.e., at the conclusion of an 
 <span class="v">include-book</span>, the ``outside'' default <a href="ACL2____DEFUN-MODE.html">defun-mode</a> is always the 
 same as it was before the <span class="v">include-book</span>.</p> 
 
 <p>Unlike every other event in ACL2, <span class="v">include-book</span> puts a burden on you. 
 Used improperly, <span class="v">include-book</span> can be unsound in the sense that it can 
 create an inconsistent extension of a consistent logical <a href="ACL2____WORLD.html">world</a>.  A 
 certification mechanism is available to help you carry this burden — but 
 it must be understood up front that even certification is no guarantee against 
 inconsistency here.  The fundamental problem is one of file system security. 
 See <a href="ACL2____CERTIFICATE.html">certificate</a> for a discussion of the security issues.</p> 
 
 <p>At the beginning of execution of an <span class="v">include-book</span> form, even before 
 executing <a href="ACL2____PORTCULLIS.html">portcullis</a> <a href="ACL2____COMMAND.html">command</a>s, the value of <span class="tt"><a href="ACL2____ACL2-DEFAULTS-TABLE.html">ACL2-defaults-table</a></span> is restored to the value it had at startup.  After 
 execution of an <span class="v">include-book</span> form, the value of <span class="tt"><a href="ACL2____ACL2-DEFAULTS-TABLE.html">ACL2-defaults-table</a></span> is restored to what it was immediately before that 
 <span class="v">include-book</span> form was executed.  See <a href="ACL2____ACL2-DEFAULTS-TABLE.html">ACL2-defaults-table</a>.</p> 
 
 <p>An advanced option is <span class="v">:uncertified-okp :ignore-certs</span>.  This tells ACL2 
 to ignore all <a href="ACL2____CERTIFICATE.html">certificate</a> files while including the book and its 
 sub-books, thus treating all these books as uncertified.  This option may be 
 useful when writing a <span class="v">.acl2x</span> file for the first ``run'' of a ``two-runs 
 approach'' to certification; see <a href="ACL2____SET-WRITE-ACL2X.html">set-write-ACL2x</a>.  Note however that 
 ordinary certification (the second ``run'') will then fail unless care is 
 taken to avoid <span class="v">:uncertified-okp :ignore-certs</span> during that second 
 certification run.  Finally (and speaking in general, not particularly about a 
 <span class="tt"><a href="ACL2____CERTIFY-BOOK.html">certify-book</a></span> context), we emphasize that the option 
 <span class="v">:uncertified-okp :ignore-certs</span> applies when including all sub-books, not 
 only for the current book.  In particular, a subsidiary <span class="v">include-book</span> call 
 specifying <span class="v">:uncertified-okp nil</span> will fail, because the superior 
 <span class="v">:ignore-certs</span> value causes the subsidiary book to be treated as 
 uncertified, which conflicts with the requirement of <span class="v">:uncertified-okp
 nil</span>.</p> 
 
 <p><b>Books Directory.</b> We refer to the ``books directory'' of an 
 executable image as the full pathname string of the directory associated with 
 <span class="v">include-book</span> keyword option <span class="v">:dir :system</span> for that image.  By 
 default, it is the <span class="v">books/</span> subdirectory of the directory where the sources 
 reside and the executable image is thus built (except for ACL2(r) — see 
 <a href="COMMON-LISP____REAL.html">real</a> —, where it is <span class="v">books/nonstd/</span>).  If those books reside 
 elsewhere, the environment variable <span class="v">ACL2_SYSTEM_BOOKS</span> can be set to the 
 <span class="v">books/</span> directory under which they reside (a Unix-style pathname, 
 typically ending in <span class="v">books/</span> or <span class="v">books</span>, is permissible).  In most 
 cases, your ACL2 executable is a small script in which you can set this 
 environment variable just above the line on which the actual ACL2 image is 
 invoked, for example:</p> 
 
 <pre class="code">export ACL2_SYSTEM_BOOKS
ACL2_SYSTEM_BOOKS=/home/acl2/4-0/acl2-sources/books</pre> 
 
 <p>If you follow suggestions in the installation instructions, these books 
 will be the ACL2 community books; see <a href="ACL2____COMMUNITY-BOOKS.html">community-books</a>.</p> 
 
 <p>This concludes the guided tour through <a href="ACL2____BOOKS.html">books</a>.  See <a href="ACL2____SET-COMPILE-FNS.html">set-compile-fns</a> for a subtle point about the interaction between 
 <span class="v">include-book</span> and on-the-fly <a href="ACL2____COMPILATION.html">compilation</a>.  See <a href="ACL2____CERTIFY-BOOK.html">certify-book</a> 
 for a discussion of how to certify a book.</p>
</body>
</html>
