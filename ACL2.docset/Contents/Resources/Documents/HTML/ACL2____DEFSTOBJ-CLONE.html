<html>
<head>
<meta charset="UTF-8">
<title>Defstobj-clone</title>
<link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>

<h3><a href="../index.html?topic=ACL2____DEFSTOBJ-CLONE">Click for Defstobj-clone in the Full Manual</a></h3>

<p>Create a new stobj that is <span class="v">:congruent-to</span> an existing (concrete 
or abstract) stobj, and can be given to functions that operate on the old 
stobj.</p><p><span class="v">Defstobj-clone</span> lets you easily introduce a new <a href="ACL2____STOBJ.html">stobj</a> 
that is <span class="v">:congruent-to</span> an existing stobj.  This allows you to have two (or 
more) copies of a stobj that coexist simultaneously.</p> 
 
<h3>Basic Example</h3> 
 
<p>If you want to write an algorithm that operates on two bit arrays, you might 
clone the <a href="ACL2____BITARR.html">bitarr</a> to get a second stobj, <span class="v">bitarr2</span>.  A minimal way to 
do this is:</p> 
 
<pre class="code">(<a href="ACL2____DEFSTOBJ-CLONE.html">defstobj-clone</a> bitarr2 bitarr :suffix "2")</pre> 
 
<p>This introduces:</p> 
 
<ul> 
 
<li>A new stobj, <span class="v">bitarr2</span>, which is congruent to <span class="v">bitarr</span>, and</li> 
 
<li>New functions that are basically renamed <span class="v">bitarr</span> operations.  In 
particular, whereas <span class="v">bitarr</span> has operations like <span class="v">get-bit</span> and 
<span class="v">set-bit</span>, we'll get new functions named <span class="v">get-bit2</span> and 
<span class="v">set-bit2</span>.</li> 
 
</ul> 
 
<p>Usually you can just <b>ignore</b> these new functions.  They are added only 
because of the way that ACL2 stobj definition works and, strictly speaking, are 
not really necessary for anything else because you can still use the original 
stobj's functions on the new stobj.</p> 
 
<p>Ignoring the new functions is particularly useful when you have already 
built up more complex functionality on top of a stobj.  That is, if you've 
implemented functions like <span class="v">clear-range</span> and <span class="v">invert-range</span> or similar, 
you can just use these on <span class="v">bitarr2</span> without reimplementing them.</p> 
 
 
<h3>Renaming Accessors</h3> 
 
<p>On the other hand, it may occasionally be useful for code clarity to rename 
the new functions in some semantically meaningful way.  For instance, if your 
cloned bit array will be used as a seen table, it may be convenient to use 
operations like ('set-seen') instead of <span class="v">set-bit</span>.</p> 
 
<p>To support using such semantically meaningful names, <span class="v">defstobj-clone</span> has 
a variety of options.  Here is a contrived example that uses all of them:</p> 
 
<pre class="code">(<a href="ACL2____DEFSTOBJ-CLONE.html">defstobj-clone</a> fancy-bitarr bitarr
  :strsubst (("GET" . "FETCH")     ;; Substring replacements to make
             ("SET" . "INSTALL"))  ;;   (capitalized per symbol names)
  :prefix "MY-"                      ;; Name prefix to add
  :suffix "-FOR-JUSTICE"             ;; Name suffix to add
  :pkg acl2::rewrite                   ;; Package for new symbols
                                       ;;   default: new stobj name
  )</pre> 
 
<p>The result is to define new analogues of the <span class="v">bitarr</span> functions with the 
following names:</p> 
 
<pre class="code">bitarrp       --&gt;  fancy-bitarrp
create-bitarr --&gt;  create-fancy-bitarr
bits-length   --&gt;  my-bits-length-for-justice
get-bit       --&gt;  my-fetch-bit-for-justice
set-bit       --&gt;  my-install-bit-for-justice
resize-bits   --&gt;  my-resize-bits-for-justice</pre> 
 
 
<h3>Alternate Syntax for Abstract Stobjs</h3> 
 
<p>For an abstract stobj, the accessors/updaters are known as "exports". 
Another way to specifying their names in the new stobj is to provide the 
<span class="v">:exports</span> argument, which should be a list of symbols corresponding to the 
exported functions from the original abstract stobj.  When this is provided, 
the other keyword arguments are unused.  For example:</p> 
 
<pre class="code">(<a href="ACL2____DEFSTOBJ-CLONE.html">defstobj-clone</a> xx-bitarr bitarr
  :exports (xx-size xx-nth !xx-nth xx-resize))</pre> 
 
<p>Defines a new <span class="v">xx-bitarr</span> stobj with:</p> 
 
<pre class="code">bitarrp       --&gt; xx-bitarrp
create-bitarr --&gt; create-xx-bitarr
bits-length   --&gt; xx-size
get-bit       --&gt; xx-nth
set-bit       --&gt; !xx-nth
resize-bits   --&gt; xx-resize</pre>
</body>
</html>
